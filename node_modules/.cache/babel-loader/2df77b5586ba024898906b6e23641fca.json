{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/dialog/ScaleMachineDownDialog.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/dialog/ScaleMachineDownDialog.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/babel.config.js","mtime":1725268750245},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tICIvaG9tZS91YnVudHUvc3VzZWNvbi0yMDI0LWV4dC1kZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmRlbGV0ZS1hbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmV2ZXJ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmZpbmQta2V5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAua2V5LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5tYXAta2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAubWFwLXZhbHVlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAubWVyZ2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAudXBkYXRlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCB7IENBUEkgYXMgQ0FQSV9MQUJFTFMgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IE1BTkFHRU1FTlQsIENBUEkgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IEdlbmVyaWNQcm9tcHQgZnJvbSAnLi9HZW5lcmljUHJvbXB0JzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEdlbmVyaWNQcm9tcHQ6IEdlbmVyaWNQcm9tcHQKICB9LAogIHByb3BzOiB7CiAgICByZXNvdXJjZXM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpZiAoIV90aGlzLmlzUmtlMikgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW190aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgewogICAgICAgICAgICAgIHR5cGU6IENBUEkuTUFDSElORV9ERVBMT1lNRU5UCiAgICAgICAgICAgIH0pLCBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsKICAgICAgICAgICAgICB0eXBlOiBDQVBJLk1BQ0hJTkUKICAgICAgICAgICAgfSldKTsKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsKICAgICAgICAgICAgICB0eXBlOiBNQU5BR0VNRU5ULk5PREVfUE9PTAogICAgICAgICAgICB9KSwgX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7CiAgICAgICAgICAgICAgdHlwZTogTUFOQUdFTUVOVC5OT0RFCiAgICAgICAgICAgIH0pXSk7CiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgX3RoaXMkcmVzb3VyY2VzJDAkY2x1OwogICAgdmFyIGlzUmtlMiA9IChfdGhpcyRyZXNvdXJjZXMkMCRjbHUgPSB0aGlzLnJlc291cmNlc1swXS5jbHVzdGVyKSA9PT0gbnVsbCB8fCBfdGhpcyRyZXNvdXJjZXMkMCRjbHUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHJlc291cmNlcyQwJGNsdS5pc1JrZTI7CiAgICB2YXIgY2x1c3RlciA9IGlzUmtlMiA/IHRoaXMucmVzb3VyY2VzWzBdLmNsdXN0ZXIgOiB0aGlzLnJlc291cmNlc1swXS5wcm92aXNpb25pbmdDbHVzdGVyOwoKICAgIC8vIE5vdCBhbGwgbWFjaGluZXMgY2FuIGJlIGRlbGV0ZWQsIHRoZXJlIG11c3QgYWx3YXlzIGJlIGF0IGxlYXN0IG9uZSBsZWZ0IGZvciByb2xlcyBjb250cm9sIHBsYW5lIGFuZCBldGNkCiAgICAvLyBGaXJzdCBlbnN1cmUgdGhhdCBhdCBsZWFzdCBvbmUgY29udHJvbCBwbGFuZSBleGlzdHMuLi4gYW5kIHRoZW4gY2hlY2sgZnJvbSB0aGUgcmVtYWluaW5nIG1hY2hpbmVzIHRoYXQgYXQgbGVhc3Qgb25lIGV0Y2QgZXhpc3RzCiAgICAvLyBUaGlzIGlzbid0IG9wdGltaXNpZWQsIHRoZXJlIG1heSBiZSBjYXNlcyB0aGF0IHJldGFpbmluZyBhIHNpbmdsZSBtYWNoaW5lIHdpdGggYm90aCByb2xlcyB3b3VsZCBiZSBiZXR0ZXIgdGhhbiByZXRhaW5pbmcgdHdvIHdpdGggc2luZ2xlIHJvbGVzCiAgICB2YXIgX3RoaXMkZGVsZXRlVHlwZSA9IHRoaXMuZGVsZXRlVHlwZSgnaXNDb250cm9sUGxhbmUnLCB0aGlzLnJlc291cmNlcywgY2x1c3RlciwgaXNSa2UyKSwKICAgICAgX3RoaXMkZGVsZXRlVHlwZTIgPSBfc2xpY2VkVG9BcnJheShfdGhpcyRkZWxldGVUeXBlLCAyKSwKICAgICAgaWdub3JlZENvbnRyb2xQbGFuZSA9IF90aGlzJGRlbGV0ZVR5cGUyWzBdLAogICAgICBzYWZlQ29udHJvbGVQbGFuZU1hY2hpbmVzVG9EZWxldGUgPSBfdGhpcyRkZWxldGVUeXBlMlsxXTsKICAgIHZhciBfdGhpcyRkZWxldGVUeXBlMyA9IHRoaXMuZGVsZXRlVHlwZSgnaXNFdGNkJywgc2FmZUNvbnRyb2xlUGxhbmVNYWNoaW5lc1RvRGVsZXRlLCBjbHVzdGVyLCBpc1JrZTIpLAogICAgICBfdGhpcyRkZWxldGVUeXBlNCA9IF9zbGljZWRUb0FycmF5KF90aGlzJGRlbGV0ZVR5cGUzLCAyKSwKICAgICAgaWdub3JlZEV0Y2QgPSBfdGhpcyRkZWxldGVUeXBlNFswXSwKICAgICAgc2FmZU1hY2hpbmVzVG9EZWxldGUgPSBfdGhpcyRkZWxldGVUeXBlNFsxXTsKICAgIHZhciBpZ25vcmVkID0gW2lnbm9yZWRDb250cm9sUGxhbmUsIGlnbm9yZWRFdGNkXS5maWx0ZXIoZnVuY3Rpb24gKGkpIHsKICAgICAgcmV0dXJuICEhaTsKICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgY2x1c3RlcjogY2x1c3RlciwKICAgICAgaXNSa2UyOiBpc1JrZTIsCiAgICAgIGFsbFRvRGVsZXRlOiB0aGlzLnJlc291cmNlcywKICAgICAgc2FmZU1hY2hpbmVzVG9EZWxldGU6IHNhZmVNYWNoaW5lc1RvRGVsZXRlLAogICAgICBpZ25vcmVkOiBpZ25vcmVkLAogICAgICB0eXBlOiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9sYWJlbEZvciddKHRoaXMucmVzb3VyY2VzWzBdLnNjaGVtYSwgdGhpcy5yZXNvdXJjZXMubGVuZ3RoKSwKICAgICAgY29uZmlnOiB7CiAgICAgICAgdGl0bGU6IHRoaXMudCgncHJvbXB0UmVtb3ZlLnRpdGxlJyksCiAgICAgICAgYXBwbHlNb2RlOiAnZGVsZXRlJywKICAgICAgICBhcHBseUFjdGlvbjogdGhpcy5yZW1vdmUKICAgICAgfQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZVR5cGU6IGZ1bmN0aW9uIGRlbGV0ZVR5cGUodHlwZSwgYWxsVG9EZWxldGUsIGNsdXN0ZXIsIGlzUmtlMikgewogICAgICB2YXIgYWxsVG9EZWxldGVCeVR5cGUgPSBhbGxUb0RlbGV0ZS5yZWR1Y2UoZnVuY3Rpb24gKHJlcywgbSkgewogICAgICAgIGlmIChtW3R5cGVdKSB7CiAgICAgICAgICByZXMudHlwZWQucHVzaChtKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzLm90aGVycy5wdXNoKG0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzOwogICAgICB9LCB7CiAgICAgICAgdHlwZWQ6IFtdLAogICAgICAgIG90aGVyczogW10KICAgICAgfSk7CiAgICAgIHZhciBtYWNoaW5lcyA9IGlzUmtlMiA/IGNsdXN0ZXIubWFjaGluZXMgOiBjbHVzdGVyLm5vZGVzOwogICAgICB2YXIgdG90YWxUeXBlcyA9IG1hY2hpbmVzLmZpbHRlcihmdW5jdGlvbiAobSkgewogICAgICAgIHJldHVybiBtW3R5cGVdOwogICAgICB9KS5sZW5ndGg7CiAgICAgIHZhciB0eXBlc1RvRGVsZXRlID0gYWxsVG9EZWxldGVCeVR5cGUudHlwZWQubGVuZ3RoOwogICAgICAvLyBJZiB3ZSdyZSBhdHRlbXB0aW5nIHRvIHJlbW92ZSBhbGwgY29udHJvbCBwbGFuIG1hY2hpbmVzLi4uLiBpZ25vcmUgb25lCiAgICAgIHZhciBpZ25vcmVkVHlwZSA9IHRvdGFsVHlwZXMgLSB0eXBlc1RvRGVsZXRlID09PSAwID8gYWxsVG9EZWxldGVCeVR5cGUudHlwZWQucG9wKCkgOiB1bmRlZmluZWQ7CiAgICAgIHZhciBzYWZlTWFjaGluZXNUb0RlbGV0ZSA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYWxsVG9EZWxldGVCeVR5cGUudHlwZWQpLCBfdG9Db25zdW1hYmxlQXJyYXkoYWxsVG9EZWxldGVCeVR5cGUub3RoZXJzKSk7CiAgICAgIHJldHVybiBbaWdub3JlZFR5cGUsIHNhZmVNYWNoaW5lc1RvRGVsZXRlXTsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgcG9vbEluZm8sIGZsYXRBcnJheTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmIChfdGhpczIuaXNSa2UyKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChfdGhpczIuc2FmZU1hY2hpbmVzVG9EZWxldGUubWFwKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgICB2YXIgX25vZGUkbm9ybWFuOwogICAgICAgICAgICAgICAgcmV0dXJuIChfbm9kZSRub3JtYW4gPSBub2RlLm5vcm1hbikgPT09IG51bGwgfHwgX25vZGUkbm9ybWFuID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbm9kZSRub3JtYW4uZG9BY3Rpb24oJ3NjYWxlZG93bicpOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIC8vIEdyb3VwIG1hY2hpbmVzIGludG8gcG9vbHMKICAgICAgICAgICAgICBwb29sSW5mbyA9IF90aGlzMi5zYWZlTWFjaGluZXNUb0RlbGV0ZS5yZWR1Y2UoZnVuY3Rpb24gKHJlcywgbSkgewogICAgICAgICAgICAgICAgcmVzLnNldChtLnBvb2wsIHJlcy5nZXQobS5wb29sKSB8fCBbXSk7CiAgICAgICAgICAgICAgICByZXMuZ2V0KG0ucG9vbCkucHVzaChtKTsKICAgICAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgICAgICAgfSwgbmV3IE1hcCgpKTsgLy8gTWFyayBhbGwgbWFjaGluZXMgZm9yIGRlbGV0aW9uIGFuZCB0aGVuIHNjYWxlIGRvd24gdGhlaXIgcG9vbCB0byB0aGUgbmV3IHNpemUKICAgICAgICAgICAgICBmbGF0QXJyYXkgPSBBcnJheS5mcm9tKHBvb2xJbmZvLmVudHJpZXMoKSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChmbGF0QXJyYXkubWFwKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgICAgICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSwKICAgICAgICAgICAgICAgICAgcG9vbCA9IF9yZWYyWzBdLAogICAgICAgICAgICAgICAgICBtYWNoaW5lcyA9IF9yZWYyWzFdOwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKG1hY2hpbmVzLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgICAgICAgICAgICBtLnNldEFubm90YXRpb24oQ0FQSV9MQUJFTFMuREVMRVRFX01BQ0hJTkUsICd0cnVlJyk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBtLnNhdmUoKTsKICAgICAgICAgICAgICAgIH0pKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvb2wuc2NhbGVQb29sKC1tYWNoaW5lcy5sZW5ndGgsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5jbHVzdGVyLnNhdmUoKTsKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"names":["CAPI","CAPI_LABELS","MANAGEMENT","GenericPrompt","components","props","resources","type","Array","required","fetch","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","isRke2","Promise","all","$store","dispatch","MACHINE_DEPLOYMENT","MACHINE","NODE_POOL","NODE","stop","data","_this$resources$0$clu","cluster","provisioningCluster","_this$deleteType","deleteType","_this$deleteType2","_slicedToArray","ignoredControlPlane","safeControlePlaneMachinesToDelete","_this$deleteType3","_this$deleteType4","ignoredEtcd","safeMachinesToDelete","ignored","filter","i","allToDelete","getters","schema","length","config","title","t","applyMode","applyAction","remove","methods","allToDeleteByType","reduce","res","m","typed","push","others","machines","nodes","totalTypes","typesToDelete","ignoredType","pop","undefined","concat","_toConsumableArray","_this2","_callee2","poolInfo","flatArray","_callee2$","_context2","map","node","_node$norman","norman","doAction","abrupt","set","pool","get","Map","from","entries","_ref","_ref2","setAnnotation","DELETE_MACHINE","save","then","scalePool"],"sources":["node_modules/@rancher/shell/dialog/ScaleMachineDownDialog.vue"],"sourcesContent":["<script>\nimport { CAPI as CAPI_LABELS } from '@shell/config/labels-annotations';\nimport { MANAGEMENT, CAPI } from '@shell/config/types';\nimport GenericPrompt from './GenericPrompt';\n\nexport default {\n  components: { GenericPrompt },\n\n  props: {\n    resources: {\n      type:     Array,\n      required: true\n    }\n  },\n\n  async fetch() {\n    if (this.isRke2) {\n      await Promise.all([\n        this.$store.dispatch('management/findAll', { type: CAPI.MACHINE_DEPLOYMENT }),\n        this.$store.dispatch('management/findAll', { type: CAPI.MACHINE })\n      ]);\n    } else {\n      await Promise.all([\n        this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_POOL }),\n        this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE })\n      ]);\n    }\n  },\n\n  data() {\n    const isRke2 = this.resources[0].cluster?.isRke2;\n    const cluster = isRke2 ? this.resources[0].cluster : this.resources[0].provisioningCluster;\n\n    // Not all machines can be deleted, there must always be at least one left for roles control plane and etcd\n    // First ensure that at least one control plane exists... and then check from the remaining machines that at least one etcd exists\n    // This isn't optimisied, there may be cases that retaining a single machine with both roles would be better than retaining two with single roles\n    const [ignoredControlPlane, safeControlePlaneMachinesToDelete] = this.deleteType('isControlPlane', this.resources, cluster, isRke2);\n    const [ignoredEtcd, safeMachinesToDelete] = this.deleteType('isEtcd', safeControlePlaneMachinesToDelete, cluster, isRke2);\n    const ignored = [ignoredControlPlane, ignoredEtcd].filter((i) => !!i);\n\n    return {\n      cluster,\n      isRke2,\n      allToDelete: this.resources,\n      safeMachinesToDelete,\n      ignored,\n      type:        this.$store.getters['type-map/labelFor'](this.resources[0].schema, this.resources.length),\n      config:      {\n        title:       this.t('promptRemove.title'),\n        applyMode:   'delete',\n        applyAction: this.remove,\n      }\n    };\n  },\n\n  methods: {\n    deleteType(type, allToDelete, cluster, isRke2) {\n      const allToDeleteByType = allToDelete.reduce((res, m) => {\n        if (m[type]) {\n          res.typed.push(m);\n        } else {\n          res.others.push(m);\n        }\n\n        return res;\n      }, { typed: [], others: [] });\n\n      const machines = isRke2 ? cluster.machines : cluster.nodes;\n      const totalTypes = machines.filter((m) => m[type]).length;\n      const typesToDelete = allToDeleteByType.typed.length;\n      // If we're attempting to remove all control plan machines.... ignore one\n      const ignoredType = totalTypes - typesToDelete === 0 ? allToDeleteByType.typed.pop() : undefined;\n      const safeMachinesToDelete = [...allToDeleteByType.typed, ...allToDeleteByType.others];\n\n      return [ignoredType, safeMachinesToDelete];\n    },\n\n    async remove() {\n      if (!this.isRke2) {\n        await Promise.all(this.safeMachinesToDelete.map((node) => {\n          return node.norman?.doAction('scaledown');\n        }));\n\n        return;\n      }\n\n      // Group machines into pools\n      const poolInfo = this.safeMachinesToDelete.reduce((res, m) => {\n        res.set(m.pool, res.get(m.pool) || []);\n        res.get(m.pool).push(m);\n\n        return res;\n      }, new Map());\n\n      // Mark all machines for deletion and then scale down their pool to the new size\n      const flatArray = Array.from(poolInfo.entries());\n\n      await Promise.all(flatArray.map(([pool, machines]) => {\n        return Promise\n          .all(machines.map((m) => {\n            m.setAnnotation(CAPI_LABELS.DELETE_MACHINE, 'true');\n\n            return m.save();\n          }))\n          .then(() => pool.scalePool(-machines.length, false));\n      }));\n\n      // Pool scale info is kept in the cluster itself, so now we've made the changes we can save them\n      await this.cluster.save();\n    }\n  }\n};\n</script>\n\n<template>\n  <GenericPrompt\n    v-bind=\"config\"\n    @close=\"$emit('close')\"\n  >\n    <template slot=\"body\">\n      <div class=\"pl-10 pr-10 mt-20 mb-20 body\">\n        <div v-if=\"allToDelete.length === 1\">\n          {{ t('promptRemove.attemptingToRemove', { type }) }} <b>{{ safeMachinesToDelete[0].nameDisplay }}</b>\n        </div>\n        <div v-else>\n          {{ t('promptScaleMachineDown.attemptingToRemove', { type, count: allToDelete.length }, true) }}\n        </div>\n        <div\n          v-if=\"ignored.length\"\n          class=\"retained-machine\"\n        >\n          <span class=\"mb-20\">{{ t('promptScaleMachineDown.retainedMachine1') }}</span>\n          <span\n            v-for=\"i in ignored\"\n            :key=\"i.nameDisplay\"\n            v-clean-html=\"t('promptScaleMachineDown.retainedMachine2', { name: i.nameDisplay }, true)\"\n          />\n        </div>\n      </div>\n    </template>\n  </GenericPrompt>\n</template>\n\n<style lang='scss' scoped>\n  .body {\n    div:not(:last-of-type) {\n      padding-bottom: 15px;\n    }\n    .retained-machine {\n      display: flex;\n      flex-direction: column;\n    }\n  }\n</style>\n"],"mappings":"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","ignoreList":[]}]}