{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHQpKSA6IG93bktleXMoT2JqZWN0KHQpKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTsgfSk7IH0gcmV0dXJuIGU7IH0KaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5lbmRzLXdpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL2hvbWUvdWJ1bnR1L3N1c2Vjb25mL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IF9DUkVBVEUgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCB7IGdldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBIQ0kgYXMgSENJX0xBQkVMU19BTk5PVEFUSU9OUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKaW1wb3J0IHsgU0VSVklDRSB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwp2YXIgSEFSVkVTVEVSX0FERF9PTl9DT05GSUcgPSBbewogIHZhcmlhYmxlTmFtZTogJ2lwYW0nLAogIGtleTogSENJX0xBQkVMU19BTk5PVEFUSU9OUy5DTE9VRF9QUk9WSURFUl9JUEFNLAogIGRlZmF1bHQ6ICdkaGNwJwp9LCB7CiAgdmFyaWFibGVOYW1lOiAnc2hhcmVkU2VydmljZScsCiAga2V5OiBIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLlBSSU1BUllfU0VSVklDRSwKICBkZWZhdWx0OiAnJwp9XTsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIExhYmVsZWRTZWxlY3Q6IExhYmVsZWRTZWxlY3QKICB9LAogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogX0NSRUFURQogICAgfSwKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9LAogICAgcmVnaXN0ZXJCZWZvcmVIb29rOiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMucmVnaXN0ZXJCZWZvcmVIb29rKSB7CiAgICAgIHRoaXMucmVnaXN0ZXJCZWZvcmVIb29rKHRoaXMud2lsbFNhdmUsICdoYXJ2ZXN0ZXJXaWxsU2F2ZScpOwogICAgfQogIH0sCiAgZmV0Y2g6IGZ1bmN0aW9uIGZldGNoKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBpblN0b3JlLCBoYXNoLCByZXM7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpblN0b3JlID0gX3RoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRQcm9kdWN0J10uaW5TdG9yZTsKICAgICAgICAgICAgaGFzaCA9IHsKICAgICAgICAgICAgICBya2UyVmVyc2lvbnM6IF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9yZXF1ZXN0JywgewogICAgICAgICAgICAgICAgdXJsOiAnL3YxLXJrZTItcmVsZWFzZS9yZWxlYXNlcycKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBzZXJ2aWNlczogX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdChpblN0b3JlLCAiL2ZpbmRBbGwiKSwgewogICAgICAgICAgICAgICAgdHlwZTogU0VSVklDRQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gYWxsSGFzaChoYXNoKTsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgcmVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgX3RoaXMucmtlMlZlcnNpb25zID0gcmVzLnJrZTJWZXJzaW9uczsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgdmFyIGhhcnZlc3RlckFkZE9uQ29uZmlnID0ge307CiAgICBIQVJWRVNURVJfQUREX09OX0NPTkZJRy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7CiAgICAgIGhhcnZlc3RlckFkZE9uQ29uZmlnW2MudmFyaWFibGVOYW1lXSA9IF90aGlzMi52YWx1ZS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tjLmtleV0gfHwgYy5kZWZhdWx0OwogICAgfSk7CiAgICB2YXIgc2hvd1NoYXJlSVA7CiAgICBpZiAodGhpcy52YWx1ZS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLlBSSU1BUllfU0VSVklDRV0pIHsKICAgICAgc2hvd1NoYXJlSVAgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgc2hvd1NoYXJlSVAgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGhhcnZlc3RlckFkZE9uQ29uZmlnKSwge30sIHsKICAgICAgc2hvd1NoYXJlSVA6IHNob3dTaGFyZUlQLAogICAgICBya2UyVmVyc2lvbnM6IHt9CiAgICB9KTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWydhbGxvd2VkTmFtZXNwYWNlcycsICduYW1lc3BhY2VzJywgJ2N1cnJlbnRDbHVzdGVyJ10pKSwge30sIHsKICAgIGlwYW1PcHRpb25zOiBmdW5jdGlvbiBpcGFtT3B0aW9ucygpIHsKICAgICAgcmV0dXJuIFt7CiAgICAgICAgbGFiZWw6ICdESENQJywKICAgICAgICB2YWx1ZTogJ2RoY3AnCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ1Bvb2wnLAogICAgICAgIHZhbHVlOiAncG9vbCcKICAgICAgfV07CiAgICB9LAogICAgcG9ydE9wdGlvbnM6IGZ1bmN0aW9uIHBvcnRPcHRpb25zKCkgewogICAgICB2YXIgX3RoaXMkdmFsdWU7CiAgICAgIHZhciBwb3J0cyA9ICgoX3RoaXMkdmFsdWUgPSB0aGlzLnZhbHVlKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZSA9PT0gdm9pZCAwIHx8IChfdGhpcyR2YWx1ZSA9IF90aGlzJHZhbHVlLnNwZWMpID09PSBudWxsIHx8IF90aGlzJHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR2YWx1ZS5wb3J0cykgfHwgW107CiAgICAgIHJldHVybiBwb3J0cy5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICByZXR1cm4gcC5wb3J0ICYmIHAucHJvdG9jb2wgPT09ICdUQ1AnOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKHApIHsKICAgICAgICByZXR1cm4gcC5wb3J0OwogICAgICB9KSB8fCBbXTsKICAgIH0sCiAgICBzZXJ2aWNlT3B0aW9uczogZnVuY3Rpb24gc2VydmljZU9wdGlvbnMoKSB7CiAgICAgIHZhciBpblN0b3JlID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY3VycmVudFByb2R1Y3QnXS5pblN0b3JlOwogICAgICB2YXIgc2VydmljZXMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWyIiLmNvbmNhdChpblN0b3JlLCAiL2FsbCIpXShTRVJWSUNFKTsKICAgICAgdmFyIG5hbWVzcGFjZXMgPSB0aGlzLm5hbWVzcGFjZXMoKTsKICAgICAgdmFyIG91dCA9IHNlcnZpY2VzLmZpbHRlcihmdW5jdGlvbiAocykgewogICAgICAgIHZhciBfcyRzdGF0dXMsIF9zJG1ldGFkYXRhLCBfcyRzcGVjOwogICAgICAgIHZhciBpbmdyZXNzID0gKHMgPT09IG51bGwgfHwgcyA9PT0gdm9pZCAwIHx8IChfcyRzdGF0dXMgPSBzLnN0YXR1cykgPT09IG51bGwgfHwgX3Mkc3RhdHVzID09PSB2b2lkIDAgfHwgKF9zJHN0YXR1cyA9IF9zJHN0YXR1cy5sb2FkQmFsYW5jZXIpID09PSBudWxsIHx8IF9zJHN0YXR1cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Mkc3RhdHVzLmluZ3Jlc3MpIHx8IFtdOwogICAgICAgIHJldHVybiBpbmdyZXNzLmxlbmd0aCA+IDAgJiYgIShzICE9PSBudWxsICYmIHMgIT09IHZvaWQgMCAmJiAoX3MkbWV0YWRhdGEgPSBzLm1ldGFkYXRhKSAhPT0gbnVsbCAmJiBfcyRtZXRhZGF0YSAhPT0gdm9pZCAwICYmIChfcyRtZXRhZGF0YSA9IF9zJG1ldGFkYXRhLmFubm90YXRpb25zKSAhPT0gbnVsbCAmJiBfcyRtZXRhZGF0YSAhPT0gdm9pZCAwICYmIF9zJG1ldGFkYXRhWydjbG91ZHByb3ZpZGVyLmhhcnZlc3RlcmhjaS5pby9wcmltYXJ5LXNlcnZpY2UnXSkgJiYgKChfcyRzcGVjID0gcy5zcGVjKSA9PT0gbnVsbCB8fCBfcyRzcGVjID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcyRzcGVjLnR5cGUpID09PSAnTG9hZEJhbGFuY2VyJyAmJiBuYW1lc3BhY2VzW3MubWV0YWRhdGEubmFtZXNwYWNlXTsKICAgICAgfSk7CiAgICAgIHJldHVybiBvdXQubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgcmV0dXJuIHMuaWQ7CiAgICAgIH0pOwogICAgfSwKICAgIHNoYXJlSVBFbmFibGVkOiBmdW5jdGlvbiBzaGFyZUlQRW5hYmxlZCgpIHsKICAgICAgdmFyIGt1YmVybmV0ZXNWZXJzaW9uID0gdGhpcy5jdXJyZW50Q2x1c3Rlci5rdWJlcm5ldGVzVmVyc2lvbiB8fCAnJzsKICAgICAgdmFyIGt1YmVybmV0ZXNWZXJzaW9uRXh0ZW5zaW9uID0gdGhpcy5jdXJyZW50Q2x1c3Rlci5rdWJlcm5ldGVzVmVyc2lvbkV4dGVuc2lvbjsKICAgICAgaWYgKGt1YmVybmV0ZXNWZXJzaW9uRXh0ZW5zaW9uLnN0YXJ0c1dpdGgoJytya2UyJykpIHsKICAgICAgICB2YXIgX3RoaXMkcmtlMlZlcnNpb25zLCBfY2hhcnRzJGhhcnZlc3RlckNsbzsKICAgICAgICB2YXIgY2hhcnRzID0gKCgoKF90aGlzJHJrZTJWZXJzaW9ucyA9IHRoaXMucmtlMlZlcnNpb25zKSA9PT0gbnVsbCB8fCBfdGhpcyRya2UyVmVyc2lvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHJrZTJWZXJzaW9ucy5kYXRhKSB8fCBbXSkuZmluZChmdW5jdGlvbiAodikgewogICAgICAgICAgcmV0dXJuIHYuaWQgPT09IGt1YmVybmV0ZXNWZXJzaW9uOwogICAgICAgIH0pIHx8IHt9KS5jaGFydHM7CiAgICAgICAgdmFyIGNjbVZlcnNpb24gPSAoY2hhcnRzID09PSBudWxsIHx8IGNoYXJ0cyA9PT0gdm9pZCAwIHx8IChfY2hhcnRzJGhhcnZlc3RlckNsbyA9IGNoYXJ0c1snaGFydmVzdGVyLWNsb3VkLXByb3ZpZGVyJ10pID09PSBudWxsIHx8IF9jaGFydHMkaGFydmVzdGVyQ2xvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2hhcnRzJGhhcnZlc3RlckNsby52ZXJzaW9uKSB8fCAnJzsKICAgICAgICBpZiAoY2NtVmVyc2lvbi5lbmRzV2l0aCgnMDAnKSkgewogICAgICAgICAgY2NtVmVyc2lvbiA9IGNjbVZlcnNpb24uc2xpY2UoMCwgLTIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VtdmVyLnNhdGlzZmllcyhjY21WZXJzaW9uLCAnPj0wLjIuMCcpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9CiAgfSksCiAgbWV0aG9kczogewogICAgd2lsbFNhdmU6IGZ1bmN0aW9uIHdpbGxTYXZlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdmFyIGVycm9ycyA9IFtdOwogICAgICBpZiAodGhpcy5zaG93U2hhcmVJUCkgewogICAgICAgIGlmICghdGhpcy5zaGFyZWRTZXJ2aWNlKSB7CiAgICAgICAgICBlcnJvcnMucHVzaCh0aGlzLnQoJ3ZhbGlkYXRpb24ucmVxdWlyZWQnLCB7CiAgICAgICAgICAgIGtleTogdGhpcy50KCdzZXJ2aWNlc1BhZ2UuaGFydmVzdGVyLnNoYXJlSVAubGFiZWwnKQogICAgICAgICAgfSwgdHJ1ZSkpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3JzKTsKICAgICAgfQogICAgICBIQVJWRVNURVJfQUREX09OX0NPTkZJRy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgX3RoaXMzLnZhbHVlLm1ldGFkYXRhLmFubm90YXRpb25zW2Mua2V5XSA9IFN0cmluZyhnZXQoX3RoaXMzLCBjLnZhcmlhYmxlTmFtZSkpOwogICAgICB9KTsKICAgICAgaWYgKHRoaXMuc2hvd1NoYXJlSVApIHsKICAgICAgICBkZWxldGUgdGhpcy52YWx1ZS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLkNMT1VEX1BST1ZJREVSX0lQQU1dOwogICAgICB9IGVsc2UgewogICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLm1ldGFkYXRhLmFubm90YXRpb25zW0hDSV9MQUJFTFNfQU5OT1RBVElPTlMuUFJJTUFSWV9TRVJWSUNFXTsKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZVNoYXJlSVA6IGZ1bmN0aW9uIHRvZ2dsZVNoYXJlSVAoKSB7CiAgICAgIHRoaXMuc2hvd1NoYXJlSVAgPSAhdGhpcy5zaG93U2hhcmVJUDsKICAgIH0KICB9Cn07"},{"version":3,"names":["mapGetters","semver","LabeledSelect","_CREATE","get","HCI","HCI_LABELS_ANNOTATIONS","SERVICE","allHash","HARVESTER_ADD_ON_CONFIG","variableName","key","CLOUD_PROVIDER_IPAM","default","PRIMARY_SERVICE","components","props","mode","type","String","value","Object","registerBeforeHook","Function","created","willSave","fetch","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","inStore","hash","res","wrap","_callee$","_context","prev","next","$store","getters","rke2Versions","dispatch","url","services","concat","sent","stop","data","_this2","harvesterAddOnConfig","forEach","c","metadata","annotations","showShareIP","_objectSpread","computed","ipamOptions","label","portOptions","_this$value","ports","spec","filter","p","port","protocol","map","serviceOptions","namespaces","out","s","_s$status","_s$metadata","_s$spec","ingress","status","loadBalancer","length","namespace","id","shareIPEnabled","kubernetesVersion","currentCluster","kubernetesVersionExtension","startsWith","_this$rke2Versions","_charts$harvesterClo","charts","find","v","ccmVersion","version","endsWith","slice","satisfies","methods","_this3","errors","sharedService","push","t","Promise","reject","toggleShareIP"],"sources":["node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue"],"sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport semver from 'semver';\n\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { _CREATE } from '@shell/config/query-params';\nimport { get } from '@shell/utils/object';\nimport { HCI as HCI_LABELS_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { SERVICE } from '@shell/config/types';\nimport { allHash } from '@shell/utils/promise';\n\nconst HARVESTER_ADD_ON_CONFIG = [{\n  variableName: 'ipam',\n  key:          HCI_LABELS_ANNOTATIONS.CLOUD_PROVIDER_IPAM,\n  default:      'dhcp'\n}, {\n  variableName: 'sharedService',\n  key:          HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE,\n  default:      ''\n}];\n\nexport default {\n  components: { LabeledSelect },\n\n  props: {\n    mode: {\n      type:    String,\n      default: _CREATE,\n    },\n\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n\n    registerBeforeHook: {\n      type:    Function,\n      default: null\n    },\n  },\n\n  created() {\n    if (this.registerBeforeHook) {\n      this.registerBeforeHook(this.willSave, 'harvesterWillSave');\n    }\n  },\n\n  async fetch() {\n    const inStore = this.$store.getters['currentProduct'].inStore;\n\n    const hash = {\n      rke2Versions: this.$store.dispatch('management/request', { url: '/v1-rke2-release/releases' }),\n      services:     this.$store.dispatch(`${ inStore }/findAll`, { type: SERVICE }),\n    };\n\n    const res = await allHash(hash);\n\n    this.rke2Versions = res.rke2Versions;\n  },\n\n  data() {\n    const harvesterAddOnConfig = {};\n\n    HARVESTER_ADD_ON_CONFIG.forEach((c) => {\n      harvesterAddOnConfig[c.variableName] = this.value.metadata.annotations[c.key] || c.default;\n    });\n\n    let showShareIP;\n\n    if (this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE]) {\n      showShareIP = true;\n    } else {\n      showShareIP = false;\n    }\n\n    return {\n      ...harvesterAddOnConfig,\n      showShareIP,\n      rke2Versions: {},\n    };\n  },\n\n  computed: {\n    ...mapGetters(['allowedNamespaces', 'namespaces', 'currentCluster']),\n\n    ipamOptions() {\n      return [{\n        label: 'DHCP',\n        value: 'dhcp',\n      }, {\n        label: 'Pool',\n        value: 'pool',\n      }];\n    },\n\n    portOptions() {\n      const ports = this.value?.spec?.ports || [];\n\n      return ports.filter((p) => p.port && p.protocol === 'TCP').map((p) => p.port) || [];\n    },\n\n    serviceOptions() {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const services = this.$store.getters[`${ inStore }/all`](SERVICE);\n\n      const namespaces = this.namespaces();\n\n      const out = services.filter((s) => {\n        const ingress = s?.status?.loadBalancer?.ingress || [];\n\n        return ingress.length > 0 &&\n                !s?.metadata?.annotations?.['cloudprovider.harvesterhci.io/primary-service'] &&\n                s.spec?.type === 'LoadBalancer' &&\n                namespaces[s.metadata.namespace];\n      });\n\n      return out.map((s) => s.id);\n    },\n\n    shareIPEnabled() {\n      const kubernetesVersion = this.currentCluster.kubernetesVersion || '';\n      const kubernetesVersionExtension = this.currentCluster.kubernetesVersionExtension;\n\n      if (kubernetesVersionExtension.startsWith('+rke2')) {\n        const charts = ((this.rke2Versions?.data || []).find((v) => v.id === kubernetesVersion) || {}).charts;\n        let ccmVersion = charts?.['harvester-cloud-provider']?.version || '';\n\n        if (ccmVersion.endsWith('00')) {\n          ccmVersion = ccmVersion.slice(0, -2);\n        }\n\n        return semver.satisfies(ccmVersion, '>=0.2.0');\n      } else {\n        return true;\n      }\n    },\n  },\n\n  methods: {\n    willSave() {\n      const errors = [];\n\n      if (this.showShareIP) {\n        if (!this.sharedService) {\n          errors.push(this.t('validation.required', { key: this.t('servicesPage.harvester.shareIP.label') }, true));\n        }\n      }\n\n      if (errors.length > 0) {\n        return Promise.reject(errors);\n      }\n\n      HARVESTER_ADD_ON_CONFIG.forEach((c) => {\n        this.value.metadata.annotations[c.key] = String(get(this, c.variableName));\n      });\n\n      if (this.showShareIP) {\n        delete this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.CLOUD_PROVIDER_IPAM];\n      } else {\n        delete this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE];\n      }\n    },\n\n    toggleShareIP() {\n      this.showShareIP = !this.showShareIP;\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row mt-30\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-if=\"showShareIP\"\n          v-model=\"sharedService\"\n          :mode=\"mode\"\n          :options=\"serviceOptions\"\n          :label=\"t('servicesPage.harvester.shareIP.label')\"\n          :disabled=\"mode === 'edit'\"\n        />\n        <LabeledSelect\n          v-else\n          v-model=\"ipam\"\n          :mode=\"mode\"\n          :options=\"ipamOptions\"\n          :label=\"t('servicesPage.harvester.ipam.label')\"\n          :disabled=\"mode === 'edit'\"\n        />\n        <div\n          v-if=\"mode === 'create'\"\n          class=\"mt-10\"\n        >\n          <a\n            role=\"button\"\n            @click=\"toggleShareIP\"\n          >\n            {{ showShareIP ? t('servicesPage.harvester.useIpam.label') : t('servicesPage.harvester.useShareIP.label') }}\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n"],"mappings":"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","ignoreList":[]}]}