{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/cis.cattle.io.clusterscan.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/cis.cattle.io.clusterscan.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHQpKSA6IG93bktleXMoT2JqZWN0KHQpKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTsgfSk7IH0gcmV0dXJuIGU7IH0KaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL2hvbWUvdWJ1bnR1L3N1c2Vjb25mL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IENydVJlc291cmNlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NydVJlc291cmNlJzsKaW1wb3J0IExhYmVsZWRTZWxlY3QgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9MYWJlbGVkU2VsZWN0JzsKaW1wb3J0IHsgTGFiZWxlZElucHV0IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9MYWJlbGVkSW5wdXQnOwppbXBvcnQgVW5pdElucHV0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vVW5pdElucHV0JzsKaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCB7IENJUywgQ09ORklHX01BUCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCBjcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwppbXBvcnQgeyBDaGVja2JveCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vQ2hlY2tib3gnOwppbXBvcnQgeyBSYWRpb0dyb3VwIH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9SYWRpbyc7CmltcG9ydCB7IGdldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBfVklFVywgX0NSRUFURSB9IGZyb20gJ0BzaGVsbC9jb25maWcvcXVlcnktcGFyYW1zJzsKaW1wb3J0IHsgaXNWYWxpZENyb24gfSBmcm9tICdjcm9uLXZhbGlkYXRvcic7CmltcG9ydCB7IGZldGNoU3BlY3NTY2hlZHVsZWRTY2FuQ29uZmlnIH0gZnJvbSAnQHNoZWxsL21vZGVscy9jaXMuY2F0dGxlLmlvLmNsdXN0ZXJzY2FuJzsKdmFyIHNlbXZlciA9IHJlcXVpcmUoJ3NlbXZlcicpOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ3J1UmVzb3VyY2U6IENydVJlc291cmNlLAogICAgTGFiZWxlZFNlbGVjdDogTGFiZWxlZFNlbGVjdCwKICAgIEJhbm5lcjogQmFubmVyLAogICAgTG9hZGluZzogTG9hZGluZywKICAgIENoZWNrYm94OiBDaGVja2JveCwKICAgIExhYmVsZWRJbnB1dDogTGFiZWxlZElucHV0LAogICAgUmFkaW9Hcm91cDogUmFkaW9Hcm91cCwKICAgIFVuaXRJbnB1dDogVW5pdElucHV0CiAgfSwKICBtaXhpbnM6IFtjcmVhdGVFZGl0Vmlld10sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9LAogICAgbW9kZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdjcmVhdGUnCiAgICB9CiAgfSwKICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGhhc2gsIHNjYW5Qcm9maWxlTmFtZSwgcHJveHlPYmo7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGFsbEhhc2goewogICAgICAgICAgICAgIHByb2ZpbGVzOiBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsKICAgICAgICAgICAgICAgIHR5cGU6IENJUy5DTFVTVEVSX1NDQU5fUFJPRklMRQogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGJlbmNobWFya3M6IF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kQWxsJywgewogICAgICAgICAgICAgICAgdHlwZTogQ0lTLkJFTkNITUFSSwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIC8vIEVuc3VyZSB0aGUgY2x1c3RlcnNjYW4gbW9kZWwgaGFzIGV2ZXJ5dGhpbmcgaXQgbmVlZHMKICAgICAgICAgICAgICBoYXNTY2hlZHVsZWRTY2FuQ29uZmlnOiBmZXRjaFNwZWNzU2NoZWR1bGVkU2NhbkNvbmZpZyhfdGhpcy5zY2hlbWEpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBoYXNoID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDM7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICByZXR1cm4gX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmQnLCB7CiAgICAgICAgICAgICAgdHlwZTogQ09ORklHX01BUCwKICAgICAgICAgICAgICBpZDogJ2Npcy1vcGVyYXRvci1zeXN0ZW0vZGVmYXVsdC1jbHVzdGVyc2NhbnByb2ZpbGVzJwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgX3RoaXMuZGVmYXVsdENvbmZpZ01hcCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA5OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDMpOwogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgX3RoaXMuYWxsUHJvZmlsZXMgPSBoYXNoLnByb2ZpbGVzOwogICAgICAgICAgICBzY2FuUHJvZmlsZU5hbWUgPSBfdGhpcy52YWx1ZS5zcGVjLnNjYW5Qcm9maWxlTmFtZTsgLy8gaWYgbW9kZSBpcyBfQ1JFQVRFIGFuZCBzY2FuUHJvZmlsZU5hbWUgaXMgZGVmaW5lZCwgdGhpcyBpcyBhIGNsb25lCiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBwcm9maWxlIHJlZmVycmVkIHRvIGluIHRoZSBvcmlnaW5hbCBzcGVjIHN0aWxsIGV4aXN0cwogICAgICAgICAgICBpZiAoc2NhblByb2ZpbGVOYW1lICYmIF90aGlzLm1vZGUgPT09IF9DUkVBVEUpIHsKICAgICAgICAgICAgICBwcm94eU9iaiA9IF90aGlzLmFsbFByb2ZpbGVzLmZpbHRlcihmdW5jdGlvbiAocHJvZmlsZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGUuaWQgPT09IHNjYW5Qcm9maWxlTmFtZTsKICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgICBpZiAoIXByb3h5T2JqKSB7CiAgICAgICAgICAgICAgICBfdGhpcy4kc2V0KF90aGlzLnZhbHVlLnNwZWMsICdzY2FuUHJvZmlsZU5hbWUnLCAnJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMywgOV1dKTsKICAgIH0pKSgpOwogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIGlmICghdGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lKSB7CiAgICAgIHRoaXMudmFsdWUubWV0YWRhdGEuZ2VuZXJhdGVOYW1lID0gJ3NjYW4tJzsKICAgIH0KICAgIGlmICghdGhpcy52YWx1ZS5zcGVjLnNjaGVkdWxlZFNjYW5Db25maWcpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuc3BlYywgJ3NjaGVkdWxlZFNjYW5Db25maWcnLCB7CiAgICAgICAgc2NhbkFsZXJ0UnVsZToge30KICAgICAgfSk7CiAgICB9CiAgICBpZiAoIXRoaXMudmFsdWUuc3BlYy5zY2hlZHVsZWRTY2FuQ29uZmlnLnNjYW5BbGVydFJ1bGUpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuc3BlYy5zY2hlZHVsZWRTY2FuQ29uZmlnLCAnc2NhbkFsZXJ0UnVsZScsIHt9KTsKICAgIH0KICAgIHZhciBpc1NjaGVkdWxlZCA9ICEhZ2V0KHRoaXMudmFsdWUsICdzcGVjLnNjaGVkdWxlZFNjYW5Db25maWcuY3JvblNjaGVkdWxlJyk7CiAgICByZXR1cm4gewogICAgICBhbGxQcm9maWxlczogW10sCiAgICAgIGRlZmF1bHRDb25maWdNYXA6IG51bGwsCiAgICAgIHNjaGVkdWxlZFNjYW5Db25maWc6IHRoaXMudmFsdWUuc3BlYy5zY2hlZHVsZWRTY2FuQ29uZmlnLAogICAgICBzY2FuQWxlcnRSdWxlOiB0aGlzLnZhbHVlLnNwZWMuc2NoZWR1bGVkU2NhbkNvbmZpZy5zY2FuQWxlcnRSdWxlLAogICAgICBoYXNBbGVydE1hbmFnZXI6IGZhbHNlLAogICAgICBpc1NjaGVkdWxlZDogaXNTY2hlZHVsZWQKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKHsKICAgIGN1cnJlbnRDbHVzdGVyOiAnY3VycmVudENsdXN0ZXInLAogICAgdDogJ2kxOG4vdCcKICB9KSksIHt9LCB7CiAgICBjYW5CZVNjaGVkdWxlZDogZnVuY3Rpb24gY2FuQmVTY2hlZHVsZWQoKSB7CiAgICAgIC8vIGNoZWNrIGlmIHNjYW4gd2FzIGNyZWF0ZWQgYW5kIHJ1biB3aXRoIGFuIG9sZGVyIGNpcyBpbnN0YWxsIHRoYXQgZG9lc24ndCBzdXBwb3J0IHNjaGVkdWxpbmcvYWxlcnRpbmcvd2FybiBzdGF0ZQogICAgICBpZiAodGhpcy5tb2RlID09PSBfVklFVykgewogICAgICAgIHZhciB3YXJuID0gZ2V0KHRoaXMudmFsdWUsICdzdGF0dXMuc3VtbWFyeS53YXJuJyk7CiAgICAgICAgcmV0dXJuICEhd2FybiB8fCB3YXJuID09PSAwOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNhbkJlU2NoZWR1bGVkKCk7CiAgICB9LAogICAgdmFsaWRQcm9maWxlczogZnVuY3Rpb24gdmFsaWRQcm9maWxlcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBwcm9maWxlTmFtZXMgPSB0aGlzLmFsbFByb2ZpbGVzLmZpbHRlcihmdW5jdGlvbiAocHJvZmlsZSkgewogICAgICAgIHZhciBfcHJvZmlsZSRzcGVjOwogICAgICAgIHZhciBiZW5jaG1hcmtWZXJzaW9uID0gcHJvZmlsZSA9PT0gbnVsbCB8fCBwcm9maWxlID09PSB2b2lkIDAgfHwgKF9wcm9maWxlJHNwZWMgPSBwcm9maWxlLnNwZWMpID09PSBudWxsIHx8IF9wcm9maWxlJHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wcm9maWxlJHNwZWMuYmVuY2htYXJrVmVyc2lvbjsKICAgICAgICB2YXIgYmVuY2htYXJrID0gX3RoaXMyLiRzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL2J5SWQnXShDSVMuQkVOQ0hNQVJLLCBiZW5jaG1hcmtWZXJzaW9uKTsKICAgICAgICByZXR1cm4gX3RoaXMyLnZhbGlkYXRlQmVuY2htYXJrKGJlbmNobWFyaywgX3RoaXMyLmN1cnJlbnRDbHVzdGVyKTsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChwcm9maWxlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGxhYmVsOiBwcm9maWxlLmlkLAogICAgICAgICAgdmFsdWU6IHByb2ZpbGUuaWQKICAgICAgICB9OwogICAgICB9KTsKICAgICAgcmV0dXJuIHByb2ZpbGVOYW1lczsKICAgIH0sCiAgICBkZWZhdWx0UHJvZmlsZTogZnVuY3Rpb24gZGVmYXVsdFByb2ZpbGUoKSB7CiAgICAgIGlmICh0aGlzLmRlZmF1bHRDb25maWdNYXApIHsKICAgICAgICB2YXIgcHJvZmlsZXMgPSB0aGlzLmRlZmF1bHRDb25maWdNYXAuZGF0YTsKICAgICAgICB2YXIgcHJvdmlkZXIgPSB0aGlzLmN1cnJlbnRDbHVzdGVyLnN0YXR1cy5wcm92aWRlcjsKICAgICAgICB2YXIgbmFtZSA9IHByb2ZpbGVzW3Byb3ZpZGVyXSB8fCBwcm9maWxlcy5kZWZhdWx0OwogICAgICAgIGlmIChuYW1lLmluY2x1ZGVzKCc6JykpIHsKICAgICAgICAgIHZhciBwYWlycyA9IG5hbWUuc3BsaXQoJ1xuJyk7CiAgICAgICAgICB2YXIgY2x1c3RlclZlcnNpb24gPSB0aGlzLmN1cnJlbnRDbHVzdGVyLmt1YmVybmV0ZXNWZXJzaW9uOwogICAgICAgICAgcGFpcnMuZm9yRWFjaChmdW5jdGlvbiAocGFpcikgewogICAgICAgICAgICB2YXIgdmVyc2lvbiA9IChwYWlyLm1hdGNoKC9bPD49XStbLS5fYS16QS1aMC05XSsvKSB8fCBbXSlbMF07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgaWYgKHNlbXZlci5zYXRpc2ZpZXMoY2x1c3RlclZlcnNpb24sIHZlcnNpb24pKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gcGFpci5yZXBsYWNlKC9bPD49XStbLS5fYS16QS1aMC05XSs6IC8sICcnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAvLyBJZ25vcmUgZW50cmllcyB3aXRoIGludmFsaWQgc2VtdmVyCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBpZiAobmFtZSkgewogICAgICAgICAgdmFyIF9wcm9maWxlJHNwZWMyOwogICAgICAgICAgdmFyIHByb2ZpbGUgPSB0aGlzLmFsbFByb2ZpbGVzLmZpbmQoZnVuY3Rpb24gKHByb2ZpbGUpIHsKICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGUuaWQgPT09IG5hbWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBiZW5jaG1hcmtWZXJzaW9uID0gcHJvZmlsZSA9PT0gbnVsbCB8fCBwcm9maWxlID09PSB2b2lkIDAgfHwgKF9wcm9maWxlJHNwZWMyID0gcHJvZmlsZS5zcGVjKSA9PT0gbnVsbCB8fCBfcHJvZmlsZSRzcGVjMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Byb2ZpbGUkc3BlYzIuYmVuY2htYXJrVmVyc2lvbjsKICAgICAgICAgIHZhciBiZW5jaG1hcmsgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL2J5SWQnXShDSVMuQkVOQ0hNQVJLLCBiZW5jaG1hcmtWZXJzaW9uKTsKICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlQmVuY2htYXJrKGJlbmNobWFyaywgdGhpcy5jdXJyZW50Q2x1c3RlcikpIHsKICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciBjaXMxNiA9IHRoaXMudmFsaWRQcm9maWxlcy5maW5kKGZ1bmN0aW9uIChwcm9maWxlKSB7CiAgICAgICAgICByZXR1cm4gcHJvZmlsZS52YWx1ZSA9PT0gJ2Npcy0xLjYtcHJvZmlsZSc7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKGNpczE2KSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5hbGxQcm9maWxlcy5maW5kKGZ1bmN0aW9uIChwcm9maWxlKSB7CiAgICAgICAgICAgIHJldHVybiBwcm9maWxlLmlkID09PSAnY2lzLTEuNi1wcm9maWxlJzsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5hbGxQcm9maWxlcy5maW5kKGZ1bmN0aW9uIChwcm9maWxlKSB7CiAgICAgICAgICAgIHJldHVybiBwcm9maWxlLmlkID09PSAnY2lzLTEuNS1wcm9maWxlJzsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICBtb25pdG9yaW5nVXJsOiBmdW5jdGlvbiBtb25pdG9yaW5nVXJsKCkgewogICAgICByZXR1cm4gdGhpcy4kcm91dGVyLnJlc29sdmUoewogICAgICAgIG5hbWU6ICdjLWNsdXN0ZXItbW9uaXRvcmluZycsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBjbHVzdGVyOiB0aGlzLiRyb3V0ZS5wYXJhbXMuY2x1c3RlcgogICAgICAgIH0KICAgICAgfSkuaHJlZjsKICAgIH0sCiAgICB2YWxpZGF0ZWQ6IGZ1bmN0aW9uIHZhbGlkYXRlZCgpIHsKICAgICAgaWYgKHRoaXMuaXNTY2hlZHVsZWQpIHsKICAgICAgICB2YXIgc2NoZWR1bGUgPSBnZXQodGhpcy52YWx1ZSwgJ3NwZWMuc2NoZWR1bGVkU2NhbkNvbmZpZy5jcm9uU2NoZWR1bGUnKTsKICAgICAgICBpZiAoIXNjaGVkdWxlKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBpc1ZhbGlkQ3JvbihzY2hlZHVsZSkgJiYgISF0aGlzLnZhbHVlLnNwZWMuc2NhblByb2ZpbGVOYW1lOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gISF0aGlzLnZhbHVlLnNwZWMuc2NhblByb2ZpbGVOYW1lOwogICAgfQogIH0pLAogIHdhdGNoOiB7CiAgICBkZWZhdWx0UHJvZmlsZTogZnVuY3Rpb24gZGVmYXVsdFByb2ZpbGUobmV1KSB7CiAgICAgIGlmIChuZXUgJiYgIXRoaXMudmFsdWUuc3BlYy5zY2FuUHJvZmlsZU5hbWUpIHsKICAgICAgICB2YXIgX25ldSRzcGVjOwogICAgICAgIHZhciBiZW5jaG1hcmtWZXJzaW9uID0gbmV1ID09PSBudWxsIHx8IG5ldSA9PT0gdm9pZCAwIHx8IChfbmV1JHNwZWMgPSBuZXUuc3BlYykgPT09IG51bGwgfHwgX25ldSRzcGVjID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmV1JHNwZWMuYmVuY2htYXJrVmVyc2lvbjsKICAgICAgICB2YXIgYmVuY2htYXJrID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9ieUlkJ10oQ0lTLkJFTkNITUFSSywgYmVuY2htYXJrVmVyc2lvbik7CiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlQmVuY2htYXJrKGJlbmNobWFyaywgdGhpcy5jdXJyZW50Q2x1c3RlcikpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy52YWx1ZS5zcGVjLnNjYW5Qcm9maWxlTmFtZSA9IG5ldSA9PT0gbnVsbCB8fCBuZXUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5ldS5pZDsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgdmFsaWRhdGVCZW5jaG1hcms6IGZ1bmN0aW9uIHZhbGlkYXRlQmVuY2htYXJrKGJlbmNobWFyaywgY3VycmVudENsdXN0ZXIpIHsKICAgICAgdmFyIF9iZW5jaG1hcmskc3BlYzsKICAgICAgaWYgKCEhKGJlbmNobWFyayAhPT0gbnVsbCAmJiBiZW5jaG1hcmsgIT09IHZvaWQgMCAmJiAoX2JlbmNobWFyayRzcGVjID0gYmVuY2htYXJrLnNwZWMpICE9PSBudWxsICYmIF9iZW5jaG1hcmskc3BlYyAhPT0gdm9pZCAwICYmIF9iZW5jaG1hcmskc3BlYy5jbHVzdGVyUHJvdmlkZXIpKSB7CiAgICAgICAgdmFyIF9iZW5jaG1hcmskc3BlYzI7CiAgICAgICAgaWYgKChiZW5jaG1hcmsgPT09IG51bGwgfHwgYmVuY2htYXJrID09PSB2b2lkIDAgfHwgKF9iZW5jaG1hcmskc3BlYzIgPSBiZW5jaG1hcmsuc3BlYykgPT09IG51bGwgfHwgX2JlbmNobWFyayRzcGVjMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2JlbmNobWFyayRzcGVjMi5jbHVzdGVyUHJvdmlkZXIpICE9PSBjdXJyZW50Q2x1c3Rlci5zdGF0dXMucHJvdmlkZXIpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICB2YXIgX2JlbmNobWFyayRzcGVjMywgX2JlbmNobWFyayRzcGVjNTsKICAgICAgICB2YXIgY2x1c3RlclZlcnNpb24gPSBjdXJyZW50Q2x1c3Rlci5rdWJlcm5ldGVzVmVyc2lvbkRpc3BsYXk7CiAgICAgICAgaWYgKGJlbmNobWFyayAhPT0gbnVsbCAmJiBiZW5jaG1hcmsgIT09IHZvaWQgMCAmJiAoX2JlbmNobWFyayRzcGVjMyA9IGJlbmNobWFyay5zcGVjKSAhPT0gbnVsbCAmJiBfYmVuY2htYXJrJHNwZWMzICE9PSB2b2lkIDAgJiYgX2JlbmNobWFyayRzcGVjMy5taW5LdWJlcm5ldGVzVmVyc2lvbikgewogICAgICAgICAgdmFyIF9iZW5jaG1hcmskc3BlYzQ7CiAgICAgICAgICBpZiAoc2VtdmVyLmd0KGJlbmNobWFyayA9PT0gbnVsbCB8fCBiZW5jaG1hcmsgPT09IHZvaWQgMCB8fCAoX2JlbmNobWFyayRzcGVjNCA9IGJlbmNobWFyay5zcGVjKSA9PT0gbnVsbCB8fCBfYmVuY2htYXJrJHNwZWM0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYmVuY2htYXJrJHNwZWM0Lm1pbkt1YmVybmV0ZXNWZXJzaW9uLCBjbHVzdGVyVmVyc2lvbikpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoYmVuY2htYXJrICE9PSBudWxsICYmIGJlbmNobWFyayAhPT0gdm9pZCAwICYmIChfYmVuY2htYXJrJHNwZWM1ID0gYmVuY2htYXJrLnNwZWMpICE9PSBudWxsICYmIF9iZW5jaG1hcmskc3BlYzUgIT09IHZvaWQgMCAmJiBfYmVuY2htYXJrJHNwZWM1Lm1heEt1YmVybmV0ZXNWZXJzaW9uKSB7CiAgICAgICAgICB2YXIgX2JlbmNobWFyayRzcGVjNjsKICAgICAgICAgIGlmIChzZW12ZXIuZ3QoY2x1c3RlclZlcnNpb24sIGJlbmNobWFyayA9PT0gbnVsbCB8fCBiZW5jaG1hcmsgPT09IHZvaWQgMCB8fCAoX2JlbmNobWFyayRzcGVjNiA9IGJlbmNobWFyay5zcGVjKSA9PT0gbnVsbCB8fCBfYmVuY2htYXJrJHNwZWM2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYmVuY2htYXJrJHNwZWM2Lm1heEt1YmVybmV0ZXNWZXJzaW9uKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLy8gSWdub3JlIGVycm9yIGlmIHNvbWV0aGluZyBpcyBpbnZhbGlkIHNlbXZlcgogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIHNhdmVTY2FuOiBmdW5jdGlvbiBzYXZlU2NhbihjYikgewogICAgICBpZiAoIXRoaXMudmFsdWUuaXNTY2hlZHVsZWQgfHwgIXRoaXMuaXNTY2hlZHVsZWQpIHsKICAgICAgICBkZWxldGUgdGhpcy52YWx1ZS5zcGVjLnNjaGVkdWxlZFNjYW5Db25maWc7CiAgICAgIH0KICAgICAgdGhpcy5zYXZlKGNiKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["CruResource","LabeledSelect","LabeledInput","UnitInput","Banner","Loading","CIS","CONFIG_MAP","mapGetters","createEditView","allHash","Checkbox","RadioGroup","get","_VIEW","_CREATE","isValidCron","fetchSpecsScheduledScanConfig","semver","require","components","mixins","props","value","type","Object","default","mode","String","fetch","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","hash","scanProfileName","proxyObj","wrap","_callee$","_context","prev","next","profiles","$store","dispatch","CLUSTER_SCAN_PROFILE","benchmarks","BENCHMARK","hasScheduledScanConfig","schema","sent","id","defaultConfigMap","t0","allProfiles","spec","filter","profile","$set","stop","data","metadata","name","generateName","scheduledScanConfig","scanAlertRule","isScheduled","hasAlertManager","computed","_objectSpread","currentCluster","t","canBeScheduled","warn","validProfiles","_this2","profileNames","_profile$spec","benchmarkVersion","benchmark","getters","validateBenchmark","map","label","defaultProfile","provider","status","includes","pairs","split","clusterVersion","kubernetesVersion","forEach","pair","version","match","satisfies","replace","e","_profile$spec2","find","cis16","monitoringUrl","$router","resolve","params","cluster","$route","href","validated","schedule","watch","neu","_neu$spec","methods","_benchmark$spec","clusterProvider","_benchmark$spec2","_benchmark$spec3","_benchmark$spec5","kubernetesVersionDisplay","minKubernetesVersion","_benchmark$spec4","gt","maxKubernetesVersion","_benchmark$spec6","saveScan","cb","save"],"sources":["node_modules/@rancher/shell/edit/cis.cattle.io.clusterscan.vue"],"sourcesContent":["<script>\nimport CruResource from '@shell/components/CruResource';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport UnitInput from '@shell/components/form/UnitInput';\nimport { Banner } from '@components/Banner';\nimport Loading from '@shell/components/Loading';\nimport { CIS, CONFIG_MAP } from '@shell/config/types';\nimport { mapGetters } from 'vuex';\nimport createEditView from '@shell/mixins/create-edit-view';\nimport { allHash } from '@shell/utils/promise';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { RadioGroup } from '@components/Form/Radio';\nimport { get } from '@shell/utils/object';\nimport { _VIEW, _CREATE } from '@shell/config/query-params';\nimport { isValidCron } from 'cron-validator';\nimport { fetchSpecsScheduledScanConfig } from '@shell/models/cis.cattle.io.clusterscan';\n\nconst semver = require('semver');\n\nexport default {\n  components: {\n    CruResource, LabeledSelect, Banner, Loading, Checkbox, LabeledInput, RadioGroup, UnitInput\n  },\n\n  mixins: [createEditView],\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    mode: {\n      type:    String,\n      default: 'create'\n    }\n  },\n\n  async fetch() {\n    const hash = await allHash({\n      profiles:               this.$store.dispatch('cluster/findAll', { type: CIS.CLUSTER_SCAN_PROFILE }),\n      benchmarks:             this.$store.dispatch('cluster/findAll', { type: CIS.BENCHMARK }),\n      // Ensure the clusterscan model has everything it needs\n      hasScheduledScanConfig: fetchSpecsScheduledScanConfig(this.schema),\n    });\n\n    try {\n      this.defaultConfigMap = await this.$store.dispatch('cluster/find', { type: CONFIG_MAP, id: 'cis-operator-system/default-clusterscanprofiles' });\n    } catch {}\n\n    this.allProfiles = hash.profiles;\n    const { scanProfileName } = this.value.spec;\n\n    // if mode is _CREATE and scanProfileName is defined, this is a clone\n    // check if the profile referred to in the original spec still exists\n    if (scanProfileName && this.mode === _CREATE) {\n      const proxyObj = this.allProfiles.filter((profile) => profile.id === scanProfileName)[0];\n\n      if (!proxyObj) {\n        this.$set(this.value.spec, 'scanProfileName', '');\n      }\n    }\n  },\n\n  data() {\n    if (!this.value.metadata.name) {\n      this.value.metadata.generateName = 'scan-';\n    }\n    if (!this.value.spec.scheduledScanConfig) {\n      this.$set(this.value.spec, 'scheduledScanConfig', { scanAlertRule: {} });\n    }\n    if (!this.value.spec.scheduledScanConfig.scanAlertRule) {\n      this.$set(this.value.spec.scheduledScanConfig, 'scanAlertRule', { });\n    }\n    const isScheduled = !!get(this.value, 'spec.scheduledScanConfig.cronSchedule');\n\n    return {\n      allProfiles:         [],\n      defaultConfigMap:    null,\n      scheduledScanConfig: this.value.spec.scheduledScanConfig,\n      scanAlertRule:       this.value.spec.scheduledScanConfig.scanAlertRule,\n      hasAlertManager:     false,\n      isScheduled\n    };\n  },\n\n  computed: {\n    ...mapGetters({ currentCluster: 'currentCluster', t: 'i18n/t' }),\n\n    canBeScheduled() {\n      // check if scan was created and run with an older cis install that doesn't support scheduling/alerting/warn state\n      if (this.mode === _VIEW) {\n        const warn = get(this.value, 'status.summary.warn');\n\n        return !!warn || warn === 0;\n      }\n\n      return this.value.canBeScheduled();\n    },\n\n    validProfiles() {\n      const profileNames = this.allProfiles.filter((profile) => {\n        const benchmarkVersion = profile?.spec?.benchmarkVersion;\n        const benchmark = this.$store.getters['cluster/byId'](CIS.BENCHMARK, benchmarkVersion);\n\n        return this.validateBenchmark(benchmark, this.currentCluster );\n      }).map((profile) => {\n        return { label: profile.id, value: profile.id };\n      });\n\n      return profileNames;\n    },\n\n    defaultProfile() {\n      if (this.defaultConfigMap) {\n        const profiles = this.defaultConfigMap.data;\n        const provider = this.currentCluster.status.provider;\n\n        let name = profiles[provider] || profiles.default;\n\n        if (name.includes(':')) {\n          const pairs = name.split('\\n');\n          const clusterVersion = this.currentCluster.kubernetesVersion;\n\n          pairs.forEach((pair) => {\n            const version = (pair.match(/[<>=]+[-._a-zA-Z0-9]+/) || [])[0];\n\n            try {\n              if (semver.satisfies(clusterVersion, version)) {\n                name = pair.replace(/[<>=]+[-._a-zA-Z0-9]+: /, '');\n              }\n            } catch (e) {\n              // Ignore entries with invalid semver\n            }\n          });\n        }\n        if (name) {\n          const profile = this.allProfiles.find((profile) => profile.id === name);\n          const benchmarkVersion = profile?.spec?.benchmarkVersion;\n          const benchmark = this.$store.getters['cluster/byId'](CIS.BENCHMARK, benchmarkVersion);\n\n          if (this.validateBenchmark(benchmark, this.currentCluster )) {\n            return profile;\n          }\n        }\n        const cis16 = this.validProfiles.find((profile) => profile.value === 'cis-1.6-profile');\n\n        if (cis16) {\n          return this.allProfiles.find((profile) => profile.id === 'cis-1.6-profile');\n        } else {\n          return this.allProfiles.find((profile) => profile.id === 'cis-1.5-profile');\n        }\n      }\n\n      return null;\n    },\n\n    monitoringUrl() {\n      return this.$router.resolve({\n        name:   'c-cluster-monitoring',\n        params: { cluster: this.$route.params.cluster }\n      }).href;\n    },\n\n    validated() {\n      if (this.isScheduled) {\n        const schedule = get(this.value, 'spec.scheduledScanConfig.cronSchedule');\n\n        if (!schedule) {\n          return false;\n        } else {\n          return isValidCron(schedule) && !!this.value.spec.scanProfileName;\n        }\n      }\n\n      return !!this.value.spec.scanProfileName;\n    }\n\n  },\n\n  watch: {\n    defaultProfile(neu) {\n      if (neu && !this.value.spec.scanProfileName) {\n        const benchmarkVersion = neu?.spec?.benchmarkVersion;\n        const benchmark = this.$store.getters['cluster/byId'](CIS.BENCHMARK, benchmarkVersion);\n\n        if (!this.validateBenchmark(benchmark, this.currentCluster)) {\n          return;\n        }\n        this.value.spec.scanProfileName = neu?.id;\n      }\n    },\n  },\n\n  methods: {\n    validateBenchmark(benchmark, currentCluster) {\n      if (!!benchmark?.spec?.clusterProvider) {\n        if ( benchmark?.spec?.clusterProvider !== currentCluster.status.provider) {\n          return false;\n        }\n      }\n\n      try {\n        const clusterVersion = currentCluster.kubernetesVersionDisplay;\n\n        if (benchmark?.spec?.minKubernetesVersion) {\n          if (semver.gt(benchmark?.spec?.minKubernetesVersion, clusterVersion)) {\n            return false;\n          }\n        }\n        if (benchmark?.spec?.maxKubernetesVersion) {\n          if (semver.gt(clusterVersion, benchmark?.spec?.maxKubernetesVersion)) {\n            return false;\n          }\n        }\n      } catch (e) {\n        // Ignore error if something is invalid semver\n      }\n\n      return true;\n    },\n\n    saveScan(cb) {\n      if (!this.value.isScheduled || !this.isScheduled) {\n        delete this.value.spec.scheduledScanConfig;\n      }\n      this.save(cb);\n    },\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n\n  <CruResource\n    v-else\n    :validation-passed=\"validated\"\n    :done-route=\"doneRoute\"\n    :resource=\"value\"\n    :mode=\"mode\"\n    :errors=\"errors\"\n    @finish=\"saveScan\"\n    @error=\"e=>errors = e\"\n  >\n    <template>\n      <Banner\n        v-if=\"!validProfiles.length\"\n        color=\"warning\"\n        :label=\"t('cis.noProfiles')\"\n      />\n\n      <div\n        v-else\n        class=\"row mb-20\"\n      >\n        <div class=\"col span-6\">\n          <LabeledSelect\n            v-model=\"value.spec.scanProfileName\"\n            :mode=\"mode\"\n            :label=\"t('cis.profile')\"\n            :options=\"validProfiles\"\n          />\n        </div>\n        <div\n          v-if=\"canBeScheduled\"\n          class=\"col span-6\"\n        >\n          <span>{{ t('cis.scoreWarning.label') }}</span> <i\n            v-clean-tooltip=\"t('cis.scoreWarning.protip')\"\n            class=\"icon icon-info\"\n          />\n          <RadioGroup\n            v-model=\"value.spec.scoreWarning\"\n            :mode=\"mode\"\n            name=\"scoreWarning\"\n            :options=\"['pass', 'fail']\"\n            :labels=\"[t('cis.scan.pass'), t('cis.scan.fail')]\"\n          />\n        </div>\n      </div>\n      <template v-if=\"canBeScheduled\">\n        <h3>Scheduling</h3>\n        <div class=\"row mb-20\">\n          <div class=\"col\">\n            <RadioGroup\n              v-model=\"isScheduled\"\n              :mode=\"mode\"\n              name=\"scheduling\"\n              :options=\"[ {value: false, label: t('cis.scheduling.disable')}, {value: true, label: t('cis.scheduling.enable')}]\"\n            />\n          </div>\n        </div>\n        <template v-if=\"isScheduled\">\n          <div class=\"row mb-20\">\n            <div class=\"col span-6\">\n              <LabeledInput\n                v-model=\"scheduledScanConfig.cronSchedule\"\n                required\n                :mode=\"mode\"\n                :label=\"t('cis.cronSchedule.label')\"\n                :placeholder=\"t('cis.cronSchedule.placeholder')\"\n                type=\"cron\"\n              />\n            </div>\n            <div class=\"col span-6\">\n              <UnitInput\n                v-model.number=\"scheduledScanConfig.retentionCount\"\n                :suffix=\"t('cis.reports')\"\n                type=\"number\"\n                :mode=\"mode\"\n                :label=\"t('cis.retention')\"\n              />\n            </div>\n          </div>\n          <h3>\n            Alerting\n          </h3>\n          <div class=\"row mb-20\">\n            <div class=\"col span-12\">\n              <Banner\n                v-if=\"scanAlertRule.alertOnFailure || scanAlertRule.alertOnComplete\"\n                class=\"mt-0\"\n                :color=\"hasAlertManager ? 'info' : 'warning'\"\n              >\n                <span v-clean-html=\"t('cis.alertNeeded', {link: monitoringUrl}, true)\" />\n              </banner>\n              <Checkbox\n                v-model=\"scanAlertRule.alertOnComplete\"\n                :mode=\"mode\"\n                :label=\"t('cis.alertOnComplete')\"\n              />\n              <Checkbox\n                v-model=\"scanAlertRule.alertOnFailure\"\n                :mode=\"mode\"\n                :label=\"t('cis.alertOnFailure')\"\n              />\n            </div>\n          </div>\n        </template>\n      </template>\n    </template>\n  </CruResource>\n</template>\n"],"mappings":"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","ignoreList":[]}]}