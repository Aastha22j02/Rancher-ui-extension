{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/plugins/dashboard-store/mutations.js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/plugins/dashboard-store/mutations.js","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIociwgZSkgeyB2YXIgdCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBTeW1ib2wgJiYgcltTeW1ib2wuaXRlcmF0b3JdIHx8IHJbIkBAaXRlcmF0b3IiXTsgaWYgKCF0KSB7IGlmIChBcnJheS5pc0FycmF5KHIpIHx8ICh0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIpKSB8fCBlICYmIHIgJiYgIm51bWJlciIgPT0gdHlwZW9mIHIubGVuZ3RoKSB7IHQgJiYgKHIgPSB0KTsgdmFyIF9uID0gMCwgRiA9IGZ1bmN0aW9uIEYoKSB7fTsgcmV0dXJuIHsgczogRiwgbjogZnVuY3Rpb24gbigpIHsgcmV0dXJuIF9uID49IHIubGVuZ3RoID8geyBkb25lOiAhMCB9IDogeyBkb25lOiAhMSwgdmFsdWU6IHJbX24rK10gfTsgfSwgZTogZnVuY3Rpb24gZShyKSB7IHRocm93IHI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG8sIGEgPSAhMCwgdSA9ICExOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyB0ID0gdC5jYWxsKHIpOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgciA9IHQubmV4dCgpOyByZXR1cm4gYSA9IHIuZG9uZSwgcjsgfSwgZTogZnVuY3Rpb24gZShyKSB7IHUgPSAhMCwgbyA9IHI7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGEgfHwgbnVsbCA9PSB0LnJldHVybiB8fCB0LnJldHVybigpOyB9IGZpbmFsbHkgeyBpZiAodSkgdGhyb3cgbzsgfSB9IH07IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIsIGEpIHsgaWYgKHIpIHsgaWYgKCJzdHJpbmciID09IHR5cGVvZiByKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkociwgYSk7IHZhciB0ID0ge30udG9TdHJpbmcuY2FsbChyKS5zbGljZSg4LCAtMSk7IHJldHVybiAiT2JqZWN0IiA9PT0gdCAmJiByLmNvbnN0cnVjdG9yICYmICh0ID0gci5jb25zdHJ1Y3Rvci5uYW1lKSwgIk1hcCIgPT09IHQgfHwgIlNldCIgPT09IHQgPyBBcnJheS5mcm9tKHIpIDogIkFyZ3VtZW50cyIgPT09IHQgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QodCkgPyBfYXJyYXlMaWtlVG9BcnJheShyLCBhKSA6IHZvaWQgMDsgfSB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KHIsIGEpIHsgKG51bGwgPT0gYSB8fCBhID4gci5sZW5ndGgpICYmIChhID0gci5sZW5ndGgpOyBmb3IgKHZhciBlID0gMCwgbiA9IEFycmF5KGEpOyBlIDwgYTsgZSsrKSBuW2VdID0gcltlXTsgcmV0dXJuIG47IH0KZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHQpKSA6IG93bktleXMoT2JqZWN0KHQpKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTsgfSk7IH0gcmV0dXJuIGU7IH0KaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuYXNzaWduLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmVudHJpZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmRlbGV0ZS1hbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmV2ZXJ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLmZpbmQta2V5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAua2V5LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lm1hcC5tYXAta2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAubWFwLXZhbHVlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAubWVyZ2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQubWFwLnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5tYXAudXBkYXRlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgVnVlLCB7IG1hcmtSYXcgfSBmcm9tICd2dWUnOwppbXBvcnQgeyBhZGRPYmplY3QsIGFkZE9iamVjdHMsIGNsZWFyLCByZW1vdmVPYmplY3QgfSBmcm9tICdAc2hlbGwvdXRpbHMvYXJyYXknOwppbXBvcnQgeyBTQ0hFTUEsIENPVU5UIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IG5vcm1hbGl6ZVR5cGUsIGtleUZpZWxkRm9yIH0gZnJvbSAnQHNoZWxsL3BsdWdpbnMvZGFzaGJvYXJkLXN0b3JlL25vcm1hbGl6ZSc7CmltcG9ydCB7IGFkZFNjaGVtYUluZGV4RmllbGRzIH0gZnJvbSAnQHNoZWxsL3BsdWdpbnMvc3RldmUvc2NoZW1hLnV0aWxzJzsKaW1wb3J0IHsgY2xhc3NpZnkgfSBmcm9tICdAc2hlbGwvcGx1Z2lucy9kYXNoYm9hcmQtc3RvcmUvY2xhc3NpZnknOwppbXBvcnQgZ2FyYmFnZUNvbGxlY3QgZnJvbSAnQHNoZWxsL3V0aWxzL2djL2djJzsKZnVuY3Rpb24gcmVnaXN0ZXJUeXBlKHN0YXRlLCB0eXBlKSB7CiAgdmFyIGNhY2hlID0gc3RhdGUudHlwZXNbdHlwZV07CiAgaWYgKCFjYWNoZSkgewogICAgY2FjaGUgPSB7CiAgICAgIGxpc3Q6IFtdLAogICAgICBoYXZlQWxsOiBmYWxzZSwKICAgICAgaGF2ZVNlbGVjdG9yOiB7fSwKICAgICAgLyoqCiAgICAgICAqIElmIHRoZSBjYWNoZWQgbGlzdCBvbmx5IGNvbnRhaW5zIHJlc291cmNlcyBmb3IgYSBuYW1lc3BhY2UsIHRoaXMgd2lsbCBjb250YWluIHRoZSBucyBuYW1lCiAgICAgICAqLwogICAgICBoYXZlTmFtZXNwYWNlOiB1bmRlZmluZWQsCiAgICAgIC8qKgogICAgICAgKiBJZiB0aGUgY2FjaGVkIGxpc3Qgb25seSBjb250YWlucyByZXNvdXJjZXMgZnJvbSBhIHBhZ2luYXRpb24gcmVxdWVzdCwgdGhpcyB3aWxsIGNvbnRhaW4gdGhlIHBhZ2luYXRpb24gc2V0dGluZ3MgKGBTdG9yZVBhZ2luYXRpb25gKQogICAgICAgKi8KICAgICAgaGF2ZVBhZ2U6IHVuZGVmaW5lZCwKICAgICAgLyoqCiAgICAgICAqIFRoZSBoaWdoZXN0IGtub3duIHJlc291cmNlVmVyc2lvbiBmcm9tIHRoZSBzZXJ2ZXIgZm9yIHRoaXMgdHlwZQogICAgICAgKi8KICAgICAgcmV2aXNpb246IDAsCiAgICAgIC8qKgogICAgICAgKiBVcGRhdGVkIGV2ZXJ5IHRpbWUgc29tZXRoaW5nIGlzIGxvYWRlZCBmb3IgdGhpcyB0eXBlCiAgICAgICAqLwogICAgICBnZW5lcmF0aW9uOiAwLAogICAgICAvKioKICAgICAgICogVXNlZCB0byBjYW5jZWwgaW5jcmVtZW50YWwgbG9hZHMgaWYgdGhlIHBhZ2UgY2hhbmdlcyBkdXJpbmcgbG9hZAogICAgICAgKi8KICAgICAgbG9hZENvdW50ZXI6IDAsCiAgICAgIC8vIE5vdCBlbnVtZXJhYmxlIHNvIHRoZXkgZG9uJ3QgZ2V0IHNlbnQgYmFjayB0byB0aGUgY2xpZW50IGZvciBTU1IKICAgICAgbWFwOiBtYXJrUmF3KG5ldyBNYXAoKSkKICAgIH07CiAgICBWdWUuc2V0KHN0YXRlLnR5cGVzLCB0eXBlLCBjYWNoZSk7CiAgfQogIHJldHVybiBjYWNoZTsKfQpleHBvcnQgZnVuY3Rpb24gcmVwbGFjZShleGlzdGluZywgZGF0YSkgewogIGZvciAodmFyIF9pID0gMCwgX09iamVjdCRrZXlzID0gT2JqZWN0LmtleXMoZXhpc3RpbmcpOyBfaSA8IF9PYmplY3Qka2V5cy5sZW5ndGg7IF9pKyspIHsKICAgIHZhciBrID0gX09iamVjdCRrZXlzW19pXTsKICAgIGRlbGV0ZSBleGlzdGluZ1trXTsKICB9CiAgZm9yICh2YXIgX2kyID0gMCwgX09iamVjdCRrZXlzMiA9IE9iamVjdC5rZXlzKGRhdGEpOyBfaTIgPCBfT2JqZWN0JGtleXMyLmxlbmd0aDsgX2kyKyspIHsKICAgIHZhciBfayA9IF9PYmplY3Qka2V5czJbX2kyXTsKICAgIFZ1ZS5zZXQoZXhpc3RpbmcsIF9rLCBkYXRhW19rXSk7CiAgfQogIHJldHVybiBleGlzdGluZzsKfQpmdW5jdGlvbiByZXBsYWNlUmVzb3VyY2UoZXhpc3RpbmcsIGRhdGEsIGdldHRlcnMpIHsKICBkYXRhID0gZ2V0dGVycy5jbGVhblJlc291cmNlKGV4aXN0aW5nLCBkYXRhKTsKICByZXR1cm4gcmVwbGFjZShleGlzdGluZywgZGF0YSk7Cn0KCi8qKgogKiBgbG9hZGAgY2FuIGJlIGNhbGxlZCBhcyBwYXJ0IG9mIGEgbG9vcC4gdG8gYXZvaWQgY29tbW9uIGxvb2sgdXBzIGNyZWF0ZSB0aGVtIHVwIGZyb250IGFuZCBwYXNzIGFzIGBjYWNoZWRBcmdzYAogKi8KZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvYWRBcmdzKGN0eCwgZGF0YVR5cGUpIHsKICB2YXIgZ2V0dGVycyA9IGN0eC5nZXR0ZXJzOwogIHZhciB0eXBlID0gbm9ybWFsaXplVHlwZShkYXRhVHlwZSk7CiAgdmFyIGtleUZpZWxkID0gZ2V0dGVycy5rZXlGaWVsZEZvclR5cGUodHlwZSk7CiAgdmFyIG9wdHMgPSBjdHgucm9vdEdldHRlcnNbInR5cGUtbWFwL29wdGlvbnNGb3IiXSh0eXBlKTsKICByZXR1cm4gewogICAgdHlwZTogdHlwZSwKICAgIGtleUZpZWxkOiBrZXlGaWVsZCwKICAgIG9wdHM6IG9wdHMKICB9Owp9CmV4cG9ydCBmdW5jdGlvbiBsb2FkKHN0YXRlLCBfcmVmKSB7CiAgdmFyIGRhdGEgPSBfcmVmLmRhdGEsCiAgICBjdHggPSBfcmVmLmN0eCwKICAgIGV4aXN0aW5nID0gX3JlZi5leGlzdGluZywKICAgIGNhY2hlZEFyZ3MgPSBfcmVmLmNhY2hlZEFyZ3M7CiAgdmFyIGdldHRlcnMgPSBjdHguZ2V0dGVyczsKICAvLyBPcHRpbWlzYXRpb24uIFRoaXMgY2FuIHJ1biBvbmNlIHBlciByZXNvdXJjZSBsb2FkZWQuLiwgc28gcGFzcyBpbiBmcm9tIHBhcmVudAogIHZhciBfcmVmMiA9IGNhY2hlZEFyZ3MgfHwgY3JlYXRlTG9hZEFyZ3MoY3R4LCBkYXRhLnR5cGUpLAogICAgY2FjaGVkVHlwZSA9IF9yZWYyLnR5cGUsCiAgICBrZXlGaWVsZCA9IF9yZWYyLmtleUZpZWxkLAogICAgb3B0cyA9IF9yZWYyLm9wdHM7CiAgdmFyIHR5cGUgPSBjYWNoZWRUeXBlOwogIHZhciBsaW1pdCA9IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0cy5saW1pdDsKCiAgLy8gSW5qZWN0IHNwZWNpYWwgZmllbGRzIGZvciBpbmRleGluZyBzY2hlbWFzCiAgaWYgKHR5cGUgPT09IFNDSEVNQSkgewogICAgYWRkU2NoZW1hSW5kZXhGaWVsZHMoZGF0YSk7CiAgfQogIHZhciBpZCA9IGRhdGFba2V5RmllbGRdOwogIHZhciBjYWNoZSA9IHJlZ2lzdGVyVHlwZShzdGF0ZSwgdHlwZSk7CiAgY2FjaGUuZ2VuZXJhdGlvbisrOwogIHZhciBlbnRyeSA9IGNhY2hlLm1hcC5nZXQoaWQpOwogIHZhciBpbk1hcCA9ICEhZW50cnk7CgogIC8vCiAgLy8gRGV0ZXJtaW5lIHRoZSBgZW50cnlgIHRoYXQgc2hvdWxkIGJlIGluIHRoZSBsb2NhbCBtYXAgYW5kIGxpc3QgY2FjaGUKICAvLwogIGlmIChleGlzdGluZyAmJiAhZXhpc3RpbmcuaWQpIHsKICAgIC8vIEEgc3BlY2lmaWMgcHJveHkgaW5zdGFuY2UgdG8gdXNlIHdhcyBwYXNzZWQgaW4gKGZvciBjcmVhdGUgLT4gc2F2ZSksIHVzZSBpdCBpbnN0ZWFkIG9mIG1ha2luZyBhIG5ldyBwcm94eQogICAgLy8gYGV4aXN0aW5nYCBpcyBhIGNsYXNzaWZpZWQgcmVzb3VyY2UgY3JlYXRlZCBsb2NhbGx5IHRoYXQgaXMgbW9zdCBwcm9iYWJseSBub3QgaW4gdGhlIHN0b3JlICh1bmxlc3MgYSBzbG93IGNvbm5lY3Rpb24gbWVhbnMgaXQncyBhZGRlZCBieSBzb2NrZXQgYmVmb3JlIHRoZSBBUEkgcmVzcG9uZHMpCiAgICAvLyBOb3RlIC0gYGV4aXN0aW5nYCBoYXMgbm8gYGlkYCBiZWNhdXNlIHRoZSByZXNvdXJjZSB3YXMgY3JlYXRlZCBsb2NhbGx5IGFuZCBub3Qgc3VwcGxpZWQgYnkgUmFuY2hlciBBUEkKCiAgICAvLyBHZXQgdGhlIGxhdGVzdCBhbmQgZ3JlYXRlc3QgdmVyc2lvbiBvZiB0aGUgcmVzb3VyY2UKICAgIHZhciBsYXRlc3RFbnRyeSA9IHJlcGxhY2VSZXNvdXJjZShleGlzdGluZywgZGF0YSwgZ2V0dGVycyk7CiAgICBpZiAoaW5NYXApIHsKICAgICAgLy8gVGhlcmUncyBhbHJlYWR5IGFuIGVudHJ5IGluIHRoZSBzdG9yZSwgc28gbWVyZ2UgY2hhbmdlcyBpbnRvIGl0LiBUaGUgbGlzdCBlbnRyeSBpcyBhIHJlZmVyZW5jZSB0byB0aGUgbWFwIChhbmQgdmljZSB2ZXJzYSkKICAgICAgZW50cnkgPSByZXBsYWNlUmVzb3VyY2UoZW50cnksIGxhdGVzdEVudHJ5LCBnZXR0ZXJzKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoZXJlJ3Mgbm8gZW50cnksIHVzaW5nIGV4aXN0aW5nIHByb3h5CiAgICAgIGVudHJ5ID0gbGF0ZXN0RW50cnk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChpbk1hcCkgewogICAgICAvLyBUaGVyZSdzIGFscmVhZHkgYW4gZW50cnkgaW4gdGhlIHN0b3JlLCBzbyBtZXJnZSBjaGFuZ2VzIGludG8gaXQuIFRoZSBsaXN0IGVudHJ5IGlzIGEgcmVmZXJlbmNlIHRvIHRoZSBtYXAgKGFuZCB2aWNlIHZlcnNhKQogICAgICBlbnRyeSA9IHJlcGxhY2VSZXNvdXJjZShlbnRyeSwgZGF0YSwgZ2V0dGVycyk7CiAgICB9IGVsc2UgewogICAgICAvLyBUaGVyZSdzIG5vIGVudHJ5LCBtYWtlIGEgbmV3IHByb3h5CiAgICAgIGVudHJ5ID0gY2xhc3NpZnkoY3R4LCBkYXRhKTsKICAgIH0KICB9CgogIC8vCiAgLy8gRW5zdXJlIHRoZSBgZW50cnlgIGlzIGluIGJvdGggYm90aCBsaXN0IGFuZCBjYWNoZQogIC8vIE5vdGUgLSBXZSBzaG91bGQgYmUgc2FmZSBhc3N1bWluZyB0aGUgdHdvIGNvbGxlY3Rpb25zIGhhdmUgcGFyaXR5IChub3QgaW4gbWFwIG1lYW5zIG5vdCBpbiBsaXN0KQogIC8vCiAgaWYgKCFpbk1hcCkgewogICAgY2FjaGUubGlzdC5wdXNoKGVudHJ5KTsKICAgIGNhY2hlLm1hcC5zZXQoaWQsIGVudHJ5KTsKICB9CgogIC8vIElmIHRoZXJlIGlzIGEgbGltaXQgdG8gdGhlIG51bWJlciBvZiByZXNvdXJjZXMgd2UgY2FuIHN0b3JlIGZvciB0aGlzIHR5cGUgdGhlbgogIC8vIHJlbW92ZSB0aGUgZmlyc3Qgb25lIHRvIGtlZXAgdGhlIGxpc3Qgc2l6ZSB0byB0aGF0IGxpbWl0CiAgaWYgKGxpbWl0ICYmIGNhY2hlLmxpc3QubGVuZ3RoID4gbGltaXQpIHsKICAgIHZhciBybSA9IGNhY2hlLmxpc3Quc2hpZnQoKTsKICAgIGNhY2hlLm1hcC5kZWxldGUocm0uaWQpOwogIH0KICBpZiAoZGF0YS5iYXNlVHlwZSkgewogICAgdHlwZSA9IG5vcm1hbGl6ZVR5cGUoZGF0YS5iYXNlVHlwZSk7CiAgICBjYWNoZSA9IHN0YXRlLnR5cGVzW3R5cGVdOwogICAgaWYgKGNhY2hlKSB7CiAgICAgIGFkZE9iamVjdChjYWNoZS5saXN0LCBlbnRyeSk7CiAgICAgIGNhY2hlLm1hcC5zZXQoaWQsIGVudHJ5KTsKICAgIH0KICB9CiAgcmV0dXJuIGVudHJ5Owp9CmV4cG9ydCBmdW5jdGlvbiBmb3JnZXRUeXBlKHN0YXRlLCB0eXBlKSB7CiAgdmFyIGNhY2hlID0gc3RhdGUudHlwZXNbdHlwZV07CiAgaWYgKGNhY2hlKSB7CiAgICBjYWNoZS5oYXZlQWxsID0gZmFsc2U7CiAgICBjYWNoZS5oYXZlU2VsZWN0b3IgPSB7fTsKICAgIGNhY2hlLmhhdmVOYW1lc3BhY2UgPSB1bmRlZmluZWQ7CiAgICBjYWNoZS5oYXZlUGFnZSA9IHVuZGVmaW5lZDsKICAgIGNhY2hlLnJldmlzaW9uID0gMDsKICAgIGNhY2hlLmdlbmVyYXRpb24gPSAwOwogICAgY2xlYXIoY2FjaGUubGlzdCk7CiAgICBjYWNoZS5tYXAuY2xlYXIoKTsKICAgIGRlbGV0ZSBzdGF0ZS50eXBlc1t0eXBlXTsKICAgIGdhcmJhZ2VDb2xsZWN0LmdjUmVzZXRUeXBlKHN0YXRlLCB0eXBlKTsKICAgIHJldHVybiB0cnVlOwogIH0KfQpleHBvcnQgZnVuY3Rpb24gcmVzZXRTdG9yZShzdGF0ZSwgY29tbWl0KSB7CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICBjb25zb2xlLmxvZygnUmVzZXQgc3RvcmU6ICcsIHN0YXRlLmNvbmZpZy5uYW1lc3BhY2UpOwogIGZvciAodmFyIF9pMyA9IDAsIF9PYmplY3Qka2V5czMgPSBPYmplY3Qua2V5cyhzdGF0ZS50eXBlcyk7IF9pMyA8IF9PYmplY3Qka2V5czMubGVuZ3RoOyBfaTMrKykgewogICAgdmFyIHR5cGUgPSBfT2JqZWN0JGtleXMzW19pM107CiAgICBjb21taXQoIiIuY29uY2F0KHN0YXRlLmNvbmZpZy5uYW1lc3BhY2UsICIvZm9yZ2V0VHlwZSIpLCB0eXBlKTsKICB9CiAgZ2FyYmFnZUNvbGxlY3QuZ2NSZXNldFN0b3JlKHN0YXRlKTsKfQpmdW5jdGlvbiBfcmVtb3ZlKHN0YXRlLCBvYmosIGdldHRlcnMpIHsKICBpZiAob2JqKSB7CiAgICB2YXIgdHlwZSA9IG5vcm1hbGl6ZVR5cGUob2JqLnR5cGUpOwogICAgdmFyIGtleUZpZWxkID0gZ2V0dGVyc1siIi5jb25jYXQoc3RhdGUuY29uZmlnLm5hbWVzcGFjZSwgIi9rZXlGaWVsZEZvclR5cGUiKV0odHlwZSk7CiAgICB2YXIgaWQgPSBvYmpba2V5RmllbGRdOwogICAgdmFyIGVudHJ5ID0gc3RhdGUudHlwZXNbdHlwZV07CiAgICBpZiAoZW50cnkpIHsKICAgICAgcmVtb3ZlT2JqZWN0KGVudHJ5Lmxpc3QsIG9iaik7CiAgICAgIGVudHJ5Lm1hcC5kZWxldGUoaWQpOwogICAgfQogICAgaWYgKG9iai5iYXNlVHlwZSkgewogICAgICB0eXBlID0gbm9ybWFsaXplVHlwZShvYmouYmFzZVR5cGUpOwogICAgICBlbnRyeSA9IHN0YXRlLnR5cGVzW3R5cGVdOwogICAgICBpZiAoZW50cnkpIHsKICAgICAgICByZW1vdmVPYmplY3QoZW50cnkubGlzdCwgb2JqKTsKICAgICAgICBlbnRyeS5tYXAuZGVsZXRlKGlkKTsKICAgICAgfQogICAgfQogIH0KfQpleHBvcnQgeyBfcmVtb3ZlIGFzIHJlbW92ZSB9OwpleHBvcnQgZnVuY3Rpb24gYmF0Y2hDaGFuZ2VzKHN0YXRlLCBfcmVmMykgewogIHZhciBjdHggPSBfcmVmMy5jdHgsCiAgICBiYXRjaCA9IF9yZWYzLmJhdGNoOwogIHZhciBiYXRjaFR5cGVzID0gT2JqZWN0LmtleXMoYmF0Y2gpOwogIHZhciBjb21iaW5lZEJhdGNoID0ge307CiAgYmF0Y2hUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChiYXRjaFR5cGUpIHsKICAgIHZhciBfdHlwZU9wdGlvbiRhbGlhczsKICAgIGNvbWJpbmVkQmF0Y2hbYmF0Y2hUeXBlXSA9IGJhdGNoW2JhdGNoVHlwZV07CiAgICB2YXIgdHlwZU9wdGlvbiA9IGN0eC5yb290R2V0dGVyc1sndHlwZS1tYXAvb3B0aW9uc0ZvciddKGJhdGNoVHlwZSk7CiAgICBpZiAoKHR5cGVPcHRpb24gPT09IG51bGwgfHwgdHlwZU9wdGlvbiA9PT0gdm9pZCAwIHx8IChfdHlwZU9wdGlvbiRhbGlhcyA9IHR5cGVPcHRpb24uYWxpYXMpID09PSBudWxsIHx8IF90eXBlT3B0aW9uJGFsaWFzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdHlwZU9wdGlvbiRhbGlhcy5sZW5ndGgpID4gMCkgewogICAgICB2YXIgYWxpYXMgPSAodHlwZU9wdGlvbiA9PT0gbnVsbCB8fCB0eXBlT3B0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0eXBlT3B0aW9uLmFsaWFzKSB8fCBbXTsKICAgICAgYWxpYXMuZm9yRWFjaChmdW5jdGlvbiAoYWxpYXNUeXBlKSB7CiAgICAgICAgY29tYmluZWRCYXRjaFthbGlhc1R5cGVdID0ge307CiAgICAgICAgZm9yICh2YXIgX2k0ID0gMCwgX09iamVjdCRlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoYmF0Y2hbYmF0Y2hUeXBlXSk7IF9pNCA8IF9PYmplY3QkZW50cmllcy5sZW5ndGg7IF9pNCsrKSB7CiAgICAgICAgICB2YXIgX09iamVjdCRlbnRyaWVzJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzW19pNF0sIDIpLAogICAgICAgICAgICBrZXkgPSBfT2JqZWN0JGVudHJpZXMkX2lbMF0sCiAgICAgICAgICAgIHZhbHVlID0gX09iamVjdCRlbnRyaWVzJF9pWzFdOwogICAgICAgICAgY29tYmluZWRCYXRjaFthbGlhc1R5cGVdW2tleV0gPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHZhbHVlKSwge30sIHsKICAgICAgICAgICAgdHlwZTogYWxpYXNUeXBlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwogIHZhciBjb21iaW5lZEJhdGNoVHlwZXMgPSBPYmplY3Qua2V5cyhjb21iaW5lZEJhdGNoKTsKICBjb21iaW5lZEJhdGNoVHlwZXMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogICAgdmFyIG5vcm1hbGl6ZWRUeXBlID0gbm9ybWFsaXplVHlwZSh0eXBlID09PSAnY291bnRzJyA/IENPVU5UIDogdHlwZSk7CiAgICB2YXIga2V5RmllbGQgPSBrZXlGaWVsZEZvcihub3JtYWxpemVkVHlwZSk7CiAgICB2YXIgdHlwZUNhY2hlID0gcmVnaXN0ZXJUeXBlKHN0YXRlLCBub3JtYWxpemVkVHlwZSk7CgogICAgLy8gbWFraW5nIGEgbWFwIGZvciBldmVyeSByZXNvdXJjZSdzIGxvY2F0aW9uIGluIHRoZSBsaXN0IGlzIGdvbm5hIGVuc3VyZSB3ZSBvbmx5IGhhdmUgdG8gbG9vcCB0aHJvdWdoIHRoZSBiaWcgbGlzdCBvbmNlLgogICAgdmFyIHR5cGVDYWNoZUluZGV4TWFwID0ge307CiAgICB0eXBlQ2FjaGUubGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChyZXNvdXJjZSwgaW5kZXgpIHsKICAgICAgdHlwZUNhY2hlSW5kZXhNYXBbcmVzb3VyY2Vba2V5RmllbGRdXSA9IGluZGV4OwogICAgfSk7CiAgICB2YXIgcmVtb3ZlQXRJbmRleGVzID0gW107CgogICAgLy8gbG9vcGluZyB0aHJvdWdoIHRoZSBiYXRjaCwgZXhlY3V0aW5nIGNoYW5nZXMsIGRlZmVycmluZyBjcmVhdGVzIGFuZCByZW1vdmVzIHNpbmNlIHRoZXkgY2hhbmdlIHRoZSBhcnJheSBsZW5ndGgKICAgIE9iamVjdC5rZXlzKGNvbWJpbmVkQmF0Y2hbbm9ybWFsaXplZFR5cGVdKS5mb3JFYWNoKGZ1bmN0aW9uIChpZCkgewogICAgICB2YXIgaW5kZXggPSB0eXBlQ2FjaGVJbmRleE1hcFtpZF07CiAgICAgIHZhciByZXNvdXJjZSA9IGNvbWJpbmVkQmF0Y2hbbm9ybWFsaXplZFR5cGVdW2lkXTsKCiAgICAgIC8vIGFuIGVtcHR5IHJlc291cmNlIHBhc3NlZCBpbnRvIGJhdGNoIGNoYW5nZXMgaXMgaG93IHdlJ2xsIHNpZ25hbCB3aGljaCBvbmVzIHRvIGRlbGV0ZQogICAgICBpZiAoT2JqZWN0LmtleXMocmVzb3VyY2UpLmxlbmd0aCA9PT0gMCAmJiBpbmRleCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdHlwZUNhY2hlLm1hcC5kZWxldGUoaWQpOwogICAgICAgIHJlbW92ZUF0SW5kZXhlcy5wdXNoKGluZGV4KTsKICAgICAgfSBlbHNlIGlmIChPYmplY3Qua2V5cyhyZXNvdXJjZSkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gTm8gb3AuIFdlJ3JlIHJlbW92aW5nIGl0Li4uIGJ1dCB3ZSBkb24ndCBoYXZlIGl0IGluIHRoZSBjYWNoZQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChub3JtYWxpemVkVHlwZSA9PT0gU0NIRU1BKSB7CiAgICAgICAgICBhZGRTY2hlbWFJbmRleEZpZWxkcyhyZXNvdXJjZSk7CiAgICAgICAgfQogICAgICAgIHZhciBjbGFzc3lSZXNvdXJjZSA9IGNsYXNzaWZ5KGN0eCwgcmVzb3VyY2UpOwogICAgICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0eXBlQ2FjaGUubGlzdC5wdXNoKGNsYXNzeVJlc291cmNlKTsKICAgICAgICAgIHR5cGVDYWNoZS5tYXAuc2V0KGlkLCBjbGFzc3lSZXNvdXJjZSk7CiAgICAgICAgICB0eXBlQ2FjaGVJbmRleE1hcFtjbGFzc3lSZXNvdXJjZVtrZXlGaWVsZF1dID0gdHlwZUNhY2hlLmxpc3QubGVuZ3RoIC0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVwbGFjZVJlc291cmNlKHR5cGVDYWNoZS5saXN0W2luZGV4XSwgcmVzb3VyY2UsIGN0eC5nZXR0ZXJzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIGxvb3BpbmcgdGhyb3VnaCB0aGUgcmVtb3ZlQXRJbmRleGVzLCBtYWtpbmcgc3VyZSB0byBvZmZzZXQgYnkgaXRlcmF0aW9uIHNvIHRoZSBhcnJheSBjaGFuZ2luZyBkb2Vzbid0IG1lc3MgdXMgdXAKICAgIHJlbW92ZUF0SW5kZXhlcy5zb3J0KCkuZm9yRWFjaChmdW5jdGlvbiAoY2FjaGVJbmRleCwgbG9vcEluZGV4KSB7CiAgICAgIHR5cGVDYWNoZS5saXN0LnNwbGljZShjYWNoZUluZGV4IC0gbG9vcEluZGV4LCAxKTsKICAgIH0pOwogICAgdmFyIG9wdHMgPSBjdHgucm9vdEdldHRlcnNbInR5cGUtbWFwL29wdGlvbnNGb3IiXSh0eXBlKTsKICAgIHZhciBsaW1pdCA9IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0cy5saW1pdDsKCiAgICAvLyBJZiB0aGVyZSBpcyBhIGxpbWl0IHRvIHRoZSBudW1iZXIgb2YgcmVzb3VyY2VzIHdlIGNhbiBzdG9yZSBmb3IgdGhpcyB0eXBlIHRoZW4KICAgIC8vIHJlbW92ZSB0aGUgZmlyc3Qgb25lIHRvIGtlZXAgdGhlIGxpc3Qgc2l6ZSB0byB0aGF0IGxpbWl0CiAgICBpZiAobGltaXQgJiYgdHlwZUNhY2hlLmxpc3QubGVuZ3RoID4gbGltaXQpIHsKICAgICAgdmFyIHJtID0gdHlwZUNhY2hlLmxpc3Quc2hpZnQoKTsKICAgICAgdHlwZUNhY2hlLm1hcC5kZWxldGUocm0uaWQpOwogICAgfQogICAgdHlwZUNhY2hlLmdlbmVyYXRpb24rKzsKICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gbG9hZEFsbChzdGF0ZSwgX3JlZjQpIHsKICB2YXIgdHlwZSA9IF9yZWY0LnR5cGUsCiAgICBkYXRhID0gX3JlZjQuZGF0YSwKICAgIGN0eCA9IF9yZWY0LmN0eCwKICAgIHNraXBIYXZlQWxsID0gX3JlZjQuc2tpcEhhdmVBbGwsCiAgICBuYW1lc3BhY2UgPSBfcmVmNC5uYW1lc3BhY2UsCiAgICByZXZpc2lvbiA9IF9yZWY0LnJldmlzaW9uOwogIHZhciBnZXR0ZXJzID0gY3R4LmdldHRlcnM7CiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBvcHRzID0gY3R4LnJvb3RHZXR0ZXJzWyJ0eXBlLW1hcC9vcHRpb25zRm9yIl0odHlwZSk7CiAgdmFyIGxpbWl0ID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLmxpbWl0OwoKICAvLyBJZiB0aGVyZSBpcyBhIGxpbWl0LCBvbmx5IHN0b3JlIHRoZSBsYXN0IGVsZW1lbnRzIGZyb20gdGhlIGxpc3QgdG8ga2VlcCB0byB0aGF0IGxpbWl0CiAgaWYgKGxpbWl0KSB7CiAgICBkYXRhID0gZGF0YS5zbGljZSgtbGltaXQpOwogIH0KICB2YXIga2V5RmllbGQgPSBnZXR0ZXJzLmtleUZpZWxkRm9yVHlwZSh0eXBlKTsKICB2YXIgcHJveGllcyA9IGRhdGEubWFwKGZ1bmN0aW9uICh4KSB7CiAgICByZXR1cm4gY2xhc3NpZnkoY3R4LCB4KTsKICB9KTsKICB2YXIgY2FjaGUgPSByZWdpc3RlclR5cGUoc3RhdGUsIHR5cGUpOwogIGNsZWFyKGNhY2hlLmxpc3QpOwogIGNhY2hlLm1hcC5jbGVhcigpOwogIGNhY2hlLnJldmlzaW9uID0gcmV2aXNpb24gfHwgMDsKICBjYWNoZS5nZW5lcmF0aW9uKys7CiAgYWRkT2JqZWN0cyhjYWNoZS5saXN0LCBwcm94aWVzKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3hpZXMubGVuZ3RoOyBpKyspIHsKICAgIGNhY2hlLm1hcC5zZXQocHJveGllc1tpXVtrZXlGaWVsZF0sIHByb3hpZXNbaV0pOwogIH0KCiAgLy8gQWxsb3cgcmVxdWVzdGVyIHRvIHNraXAgc2V0dGluZyB0aGF0IGV2ZXJ5dGhpbmcgaGFzIGxvYWRlZAogIGlmICghc2tpcEhhdmVBbGwpIHsKICAgIGlmIChuYW1lc3BhY2UpIHsKICAgICAgY2FjaGUuaGF2ZVBhZ2UgPSBmYWxzZTsKICAgICAgY2FjaGUuaGF2ZU5hbWVzcGFjZSA9IG5hbWVzcGFjZTsKICAgICAgY2FjaGUuaGF2ZUFsbCA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgY2FjaGUuaGF2ZVBhZ2UgPSBmYWxzZTsKICAgICAgY2FjaGUuaGF2ZU5hbWVzcGFjZSA9IGZhbHNlOwogICAgICBjYWNoZS5oYXZlQWxsID0gdHJ1ZTsKICAgIH0KICB9CiAgcmV0dXJuIHByb3hpZXM7Cn0KCi8qKgogKiBBZGQgYSBzZXQgb2YgcmVzb3VyY2VzIHRvIHRoZSBzdG9yZSBmb3IgYSBnaXZlbiB0eXBlCiAqCiAqIERvbid0IG1hcmsgdGhlICdoYXZlQWxsJyBmaWVsZCAtIHRoaXMgaXMgdXNlZCBmb3IgaW5jcmVtZW50YWwgbG9hZGluZwogKi8KZXhwb3J0IGZ1bmN0aW9uIGxvYWRBZGQoc3RhdGUsIF9yZWY1KSB7CiAgdmFyIF9hbGxMYXRlc3QkOwogIHZhciB0eXBlID0gX3JlZjUudHlwZSwKICAgIGFsbExhdGVzdCA9IF9yZWY1LmRhdGEsCiAgICBjdHggPSBfcmVmNS5jdHg7CiAgdmFyIGdldHRlcnMgPSBjdHguZ2V0dGVyczsKICB2YXIga2V5RmllbGQgPSBnZXR0ZXJzLmtleUZpZWxkRm9yVHlwZSh0eXBlKTsKICB2YXIgY2FjaGVkQXJncyA9IGNyZWF0ZUxvYWRBcmdzKGN0eCwgYWxsTGF0ZXN0ID09PSBudWxsIHx8IGFsbExhdGVzdCA9PT0gdm9pZCAwIHx8IChfYWxsTGF0ZXN0JCA9IGFsbExhdGVzdFswXSkgPT09IG51bGwgfHwgX2FsbExhdGVzdCQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hbGxMYXRlc3QkLnR5cGUpOwogIGFsbExhdGVzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgdmFyIGV4aXN0aW5nID0gc3RhdGUudHlwZXNbdHlwZV0ubWFwLmdldChlbnRyeVtrZXlGaWVsZF0pOwogICAgbG9hZChzdGF0ZSwgewogICAgICBkYXRhOiBlbnRyeSwKICAgICAgY3R4OiBjdHgsCiAgICAgIGV4aXN0aW5nOiBleGlzdGluZywKICAgICAgY2FjaGVkQXJnczogY2FjaGVkQXJncwogICAgfSk7CiAgfSk7Cn0KZXhwb3J0IGRlZmF1bHQgewogIHJlZ2lzdGVyVHlwZTogcmVnaXN0ZXJUeXBlLAogIGxvYWQ6IGxvYWQsCiAgYXBwbHlDb25maWc6IGZ1bmN0aW9uIGFwcGx5Q29uZmlnKHN0YXRlLCBjb25maWcpIHsKICAgIGlmICghc3RhdGUuY29uZmlnKSB7CiAgICAgIHN0YXRlLmNvbmZpZyA9IHt9OwogICAgfQogICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5jb25maWcsIGNvbmZpZyk7CiAgfSwKICAvKioKICAgKiBMb2FkIG11bHRpcGxlIGRpZmZlcmVudCB0eXBlcyBvZiByZXNvdXJjZXMKICAgKi8KICBsb2FkTXVsdGk6IGZ1bmN0aW9uIGxvYWRNdWx0aShzdGF0ZSwgX3JlZjYpIHsKICAgIHZhciBkYXRhID0gX3JlZjYuZGF0YSwKICAgICAgY3R4ID0gX3JlZjYuY3R4OwogICAgLy8gY29uc29sZS5sb2coJyMjIyBNdXRhdGlvbiBsb2FkTXVsdGknLCBkYXRhPy5sZW5ndGgpOwogICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGRhdGEpLAogICAgICBfc3RlcDsKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIGVudHJ5ID0gX3N0ZXAudmFsdWU7CiAgICAgICAgbG9hZChzdGF0ZSwgewogICAgICAgICAgZGF0YTogZW50cnksCiAgICAgICAgICBjdHg6IGN0eAogICAgICAgIH0pOwogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgIH0gZmluYWxseSB7CiAgICAgIF9pdGVyYXRvci5mKCk7CiAgICB9CiAgfSwKICBsb2FkU2VsZWN0b3I6IGZ1bmN0aW9uIGxvYWRTZWxlY3RvcihzdGF0ZSwgX3JlZjcpIHsKICAgIHZhciBfZW50cmllcyQ7CiAgICB2YXIgdHlwZSA9IF9yZWY3LnR5cGUsCiAgICAgIGVudHJpZXMgPSBfcmVmNy5lbnRyaWVzLAogICAgICBjdHggPSBfcmVmNy5jdHgsCiAgICAgIHNlbGVjdG9yID0gX3JlZjcuc2VsZWN0b3IsCiAgICAgIHJldmlzaW9uID0gX3JlZjcucmV2aXNpb247CiAgICB2YXIgY2FjaGUgPSByZWdpc3RlclR5cGUoc3RhdGUsIHR5cGUpOwogICAgdmFyIGNhY2hlZEFyZ3MgPSBjcmVhdGVMb2FkQXJncyhjdHgsIGVudHJpZXMgPT09IG51bGwgfHwgZW50cmllcyA9PT0gdm9pZCAwIHx8IChfZW50cmllcyQgPSBlbnRyaWVzWzBdKSA9PT0gbnVsbCB8fCBfZW50cmllcyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lbnRyaWVzJC50eXBlKTsKICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZW50cmllcyksCiAgICAgIF9zdGVwMjsKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIGRhdGEgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgbG9hZChzdGF0ZSwgewogICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgIGN0eDogY3R4LAogICAgICAgICAgY2FjaGVkQXJnczogY2FjaGVkQXJncwogICAgICAgIH0pOwogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IyLmYoKTsKICAgIH0KICAgIGNhY2hlLmhhdmVTZWxlY3RvcltzZWxlY3Rvcl0gPSB0cnVlOwogICAgY2FjaGUucmV2aXNpb24gPSByZXZpc2lvbiB8fCAwOwogIH0sCiAgbG9hZEFsbDogbG9hZEFsbCwKICAvKioKICAgKiBIYW5kbGVzIGNoYW5nZXMgKGFkZCwgdXBkYXRlLCByZW1vdmUpIHRvIG11bHRpcGxlIHJlc291cmNlcyBmb3IgbXVsdGlwbGUgdHlwZXMKICAgKi8KICBiYXRjaENoYW5nZXM6IGJhdGNoQ2hhbmdlcywKICBsb2FkTWVyZ2U6IGZ1bmN0aW9uIGxvYWRNZXJnZShzdGF0ZSwgX3JlZjgpIHsKICAgIHZhciB0eXBlID0gX3JlZjgudHlwZSwKICAgICAgYWxsTGF0ZXN0ID0gX3JlZjguZGF0YSwKICAgICAgY3R4ID0gX3JlZjguY3R4OwogICAgdmFyIGNvbW1pdCA9IGN0eC5jb21taXQsCiAgICAgIGdldHRlcnMgPSBjdHguZ2V0dGVyczsKICAgIC8vIGNvbnN0IGFsbExhdGVzdCA9IGF3YWl0IGRpc3BhdGNoKCdmaW5kQWxsJywgeyB0eXBlLCBvcHQ6IHsgZm9yY2U6IHRydWUsIGxvYWQsIF9OT05FIH0gfSk7CiAgICAvLyBjb25zdCBhbGxFeGlzdGluZyA9IGdldHRlcnMuYWxsKHt0eXBlfSk7CiAgICB2YXIga2V5RmllbGQgPSBnZXR0ZXJzLmtleUZpZWxkRm9yVHlwZSh0eXBlKTsKICAgIHZhciBjYWNoZSA9IHN0YXRlLnR5cGVzW3R5cGVdOwogICAgdmFyIGNhY2hlZEFyZ3MgPSBjcmVhdGVMb2FkQXJncyhjdHgsIGFsbExhdGVzdCA9PT0gbnVsbCB8fCBhbGxMYXRlc3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFsbExhdGVzdFswXS50eXBlKTsKICAgIGFsbExhdGVzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICB2YXIgZXhpc3RpbmcgPSBzdGF0ZS50eXBlc1t0eXBlXS5tYXAuZ2V0KGVudHJ5W2tleUZpZWxkXSk7CiAgICAgIGxvYWQoc3RhdGUsIHsKICAgICAgICBkYXRhOiBlbnRyeSwKICAgICAgICBjdHg6IGN0eCwKICAgICAgICBleGlzdGluZzogZXhpc3RpbmcsCiAgICAgICAgY2FjaGVkQXJnczogY2FjaGVkQXJncwogICAgICB9KTsKICAgIH0pOwogICAgY2FjaGUubGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICBpZiAoIWFsbExhdGVzdC5maW5kKGZ1bmN0aW9uICh0b0xvYWRFbnRyeSkgewogICAgICAgIHJldHVybiB0b0xvYWRFbnRyeS5pZCA9PT0gZW50cnkuaWQ7CiAgICAgIH0pKSB7CiAgICAgICAgY29tbWl0KCdyZW1vdmUnLCBlbnRyeSk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgbG9hZEFkZDogbG9hZEFkZCwKICBsb2FkUGFnZTogZnVuY3Rpb24gbG9hZFBhZ2Uoc3RhdGUsIF9yZWY5KSB7CiAgICB2YXIgdHlwZSA9IF9yZWY5LnR5cGUsCiAgICAgIGRhdGEgPSBfcmVmOS5kYXRhLAogICAgICBjdHggPSBfcmVmOS5jdHgsCiAgICAgIHBhZ2luYXRpb24gPSBfcmVmOS5wYWdpbmF0aW9uOwogICAgaWYgKCFkYXRhKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciBrZXlGaWVsZCA9IGN0eC5nZXR0ZXJzLmtleUZpZWxkRm9yVHlwZSh0eXBlKTsKICAgIHZhciBwcm94aWVzID0gZGF0YS5tYXAoZnVuY3Rpb24gKHgpIHsKICAgICAgcmV0dXJuIGNsYXNzaWZ5KGN0eCwgeCk7CiAgICB9KTsKICAgIHZhciBjYWNoZSA9IHJlZ2lzdGVyVHlwZShzdGF0ZSwgdHlwZSk7CiAgICBjbGVhcihjYWNoZS5saXN0KTsKICAgIGNhY2hlLm1hcC5jbGVhcigpOwogICAgY2FjaGUuZ2VuZXJhdGlvbisrOwogICAgYWRkT2JqZWN0cyhjYWNoZS5saXN0LCBwcm94aWVzKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJveGllcy5sZW5ndGg7IGkrKykgewogICAgICBjYWNoZS5tYXAuc2V0KHByb3hpZXNbaV1ba2V5RmllbGRdLCBwcm94aWVzW2ldKTsKICAgIH0KCiAgICAvLyBoYXZlUGFnZSBpcyBvZiB0eXBlIGBTdG9yZVBhZ2luYXRpb25gCiAgICBjYWNoZS5oYXZlUGFnZSA9IHBhZ2luYXRpb247CiAgICBjYWNoZS5oYXZlTmFtZXNwYWNlID0gdW5kZWZpbmVkOwogICAgY2FjaGUuaGF2ZUFsbCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBwcm94aWVzOwogIH0sCiAgZm9yZ2V0QWxsOiBmdW5jdGlvbiBmb3JnZXRBbGwoc3RhdGUsIF9yZWYxMCkgewogICAgdmFyIHR5cGUgPSBfcmVmMTAudHlwZTsKICAgIHZhciBjYWNoZSA9IHJlZ2lzdGVyVHlwZShzdGF0ZSwgdHlwZSk7CiAgICBjbGVhcihjYWNoZS5saXN0KTsKICAgIGNhY2hlLm1hcC5jbGVhcigpOwogICAgY2FjaGUuZ2VuZXJhdGlvbisrOwogIH0sCiAgc2V0SGF2ZUFsbDogZnVuY3Rpb24gc2V0SGF2ZUFsbChzdGF0ZSwgX3JlZjExKSB7CiAgICB2YXIgdHlwZSA9IF9yZWYxMS50eXBlOwogICAgdmFyIGNhY2hlID0gcmVnaXN0ZXJUeXBlKHN0YXRlLCB0eXBlKTsKICAgIGNhY2hlLmhhdmVBbGwgPSB0cnVlOwogIH0sCiAgc2V0SGF2ZU5hbWVzcGFjZTogZnVuY3Rpb24gc2V0SGF2ZU5hbWVzcGFjZShzdGF0ZSwgX3JlZjEyKSB7CiAgICB2YXIgdHlwZSA9IF9yZWYxMi50eXBlLAogICAgICBuYW1lc3BhY2UgPSBfcmVmMTIubmFtZXNwYWNlOwogICAgdmFyIGNhY2hlID0gcmVnaXN0ZXJUeXBlKHN0YXRlLCB0eXBlKTsKICAgIGNhY2hlLmhhdmVOYW1lc3BhY2UgPSBuYW1lc3BhY2U7CiAgfSwKICBsb2FkZWRBbGw6IGZ1bmN0aW9uIGxvYWRlZEFsbChzdGF0ZSwgX3JlZjEzKSB7CiAgICB2YXIgdHlwZSA9IF9yZWYxMy50eXBlOwogICAgdmFyIGNhY2hlID0gcmVnaXN0ZXJUeXBlKHN0YXRlLCB0eXBlKTsKICAgIGNhY2hlLmdlbmVyYXRpb24rKzsKICAgIGNhY2hlLmhhdmVBbGwgPSB0cnVlOwogIH0sCiAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoc3RhdGUsIG9iaikgewogICAgaWYgKG9iaikgewogICAgICBfcmVtb3ZlKHN0YXRlLCBvYmosIHRoaXMuZ2V0dGVycyk7CiAgICB9CiAgfSwKICByZXNldDogZnVuY3Rpb24gcmVzZXQoc3RhdGUpIHsKICAgIHJlc2V0U3RvcmUoc3RhdGUsIHRoaXMuY29tbWl0KTsKICB9LAogIGZvcmdldFR5cGU6IGZvcmdldFR5cGUsCiAgaW5jcmVtZW50TG9hZENvdW50ZXI6IGZ1bmN0aW9uIGluY3JlbWVudExvYWRDb3VudGVyKHN0YXRlLCB0eXBlKSB7CiAgICB2YXIgdHlwZURhdGEgPSBzdGF0ZS50eXBlc1t0eXBlXTsKICAgIGlmICh0eXBlRGF0YSkgewogICAgICB0eXBlRGF0YS5sb2FkQ291bnRlcisrOwogICAgfQogIH0KfTs="},{"version":3,"names":["Vue","markRaw","addObject","addObjects","clear","removeObject","SCHEMA","COUNT","normalizeType","keyFieldFor","addSchemaIndexFields","classify","garbageCollect","registerType","state","type","cache","types","list","haveAll","haveSelector","haveNamespace","undefined","havePage","revision","generation","loadCounter","map","Map","set","replace","existing","data","_i","_Object$keys","Object","keys","length","k","_i2","_Object$keys2","replaceResource","getters","cleanResource","createLoadArgs","ctx","dataType","keyField","keyFieldForType","opts","rootGetters","load","_ref","cachedArgs","_ref2","cachedType","limit","id","entry","get","inMap","latestEntry","push","rm","shift","delete","baseType","forgetType","gcResetType","resetStore","commit","console","log","config","namespace","_i3","_Object$keys3","concat","gcResetStore","remove","obj","_remove","batchChanges","_ref3","batch","batchTypes","combinedBatch","forEach","batchType","_typeOption$alias","typeOption","alias","aliasType","_i4","_Object$entries","entries","_Object$entries$_i","_slicedToArray","key","value","_objectSpread","combinedBatchTypes","normalizedType","typeCache","typeCacheIndexMap","resource","index","removeAtIndexes","classyResource","sort","cacheIndex","loopIndex","splice","loadAll","_ref4","skipHaveAll","slice","proxies","x","i","loadAdd","_ref5","_allLatest$","allLatest","applyConfig","assign","loadMulti","_ref6","_iterator","_createForOfIteratorHelper","_step","s","n","done","err","e","f","loadSelector","_ref7","_entries$","selector","_iterator2","_step2","loadMerge","_ref8","find","toLoadEntry","loadPage","_ref9","pagination","forgetAll","_ref10","setHaveAll","_ref11","setHaveNamespace","_ref12","loadedAll","_ref13","reset","incrementLoadCounter","typeData"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/plugins/dashboard-store/mutations.js"],"sourcesContent":["import Vue, { markRaw } from 'vue';\nimport { addObject, addObjects, clear, removeObject } from '@shell/utils/array';\nimport { SCHEMA, COUNT } from '@shell/config/types';\nimport { normalizeType, keyFieldFor } from '@shell/plugins/dashboard-store/normalize';\nimport { addSchemaIndexFields } from '@shell/plugins/steve/schema.utils';\nimport { classify } from '@shell/plugins/dashboard-store/classify';\nimport garbageCollect from '@shell/utils/gc/gc';\n\nfunction registerType(state, type) {\n  let cache = state.types[type];\n\n  if ( !cache ) {\n    cache = {\n      list:          [],\n      haveAll:       false,\n      haveSelector:  {},\n      /**\n       * If the cached list only contains resources for a namespace, this will contain the ns name\n       */\n      haveNamespace: undefined,\n      /**\n       * If the cached list only contains resources from a pagination request, this will contain the pagination settings (`StorePagination`)\n       */\n      havePage:      undefined,\n      /**\n       * The highest known resourceVersion from the server for this type\n       */\n      revision:      0,\n      /**\n       * Updated every time something is loaded for this type\n       */\n      generation:    0,\n      /**\n       * Used to cancel incremental loads if the page changes during load\n       */\n      loadCounter:   0,\n\n      // Not enumerable so they don't get sent back to the client for SSR\n      map: markRaw(new Map()),\n    };\n\n    Vue.set(state.types, type, cache);\n  }\n\n  return cache;\n}\n\nexport function replace(existing, data) {\n  for ( const k of Object.keys(existing) ) {\n    delete existing[k];\n  }\n\n  for ( const k of Object.keys(data) ) {\n    Vue.set(existing, k, data[k]);\n  }\n\n  return existing;\n}\n\nfunction replaceResource(existing, data, getters) {\n  data = getters.cleanResource(existing, data);\n\n  return replace(existing, data);\n}\n\n/**\n * `load` can be called as part of a loop. to avoid common look ups create them up front and pass as `cachedArgs`\n */\nexport function createLoadArgs(ctx, dataType) {\n  const { getters } = ctx;\n  const type = normalizeType(dataType);\n  const keyField = getters.keyFieldForType(type);\n  const opts = ctx.rootGetters[`type-map/optionsFor`](type);\n\n  return {\n    type, keyField, opts\n  };\n}\n\nexport function load(state, {\n  data, ctx, existing, cachedArgs\n}) {\n  const { getters } = ctx;\n  // Optimisation. This can run once per resource loaded.., so pass in from parent\n  const { type: cachedType, keyField, opts } = cachedArgs || createLoadArgs(ctx, data.type);\n  let type = cachedType;\n\n  const limit = opts?.limit;\n\n  // Inject special fields for indexing schemas\n  if ( type === SCHEMA ) {\n    addSchemaIndexFields(data);\n  }\n\n  const id = data[keyField];\n\n  let cache = registerType(state, type);\n\n  cache.generation++;\n\n  let entry = cache.map.get(id);\n  const inMap = !!entry;\n\n  //\n  // Determine the `entry` that should be in the local map and list cache\n  //\n  if ( existing && !existing.id ) {\n    // A specific proxy instance to use was passed in (for create -> save), use it instead of making a new proxy\n    // `existing` is a classified resource created locally that is most probably not in the store (unless a slow connection means it's added by socket before the API responds)\n    // Note - `existing` has no `id` because the resource was created locally and not supplied by Rancher API\n\n    // Get the latest and greatest version of the resource\n    const latestEntry = replaceResource(existing, data, getters);\n\n    if (inMap) {\n      // There's already an entry in the store, so merge changes into it. The list entry is a reference to the map (and vice versa)\n      entry = replaceResource(entry, latestEntry, getters);\n    } else {\n      // There's no entry, using existing proxy\n      entry = latestEntry;\n    }\n  } else {\n    if (inMap) {\n      // There's already an entry in the store, so merge changes into it. The list entry is a reference to the map (and vice versa)\n      entry = replaceResource(entry, data, getters);\n    } else {\n      // There's no entry, make a new proxy\n      entry = classify(ctx, data);\n    }\n  }\n\n  //\n  // Ensure the `entry` is in both both list and cache\n  // Note - We should be safe assuming the two collections have parity (not in map means not in list)\n  //\n  if (!inMap) {\n    cache.list.push(entry);\n    cache.map.set(id, entry);\n  }\n\n  // If there is a limit to the number of resources we can store for this type then\n  // remove the first one to keep the list size to that limit\n  if (limit && cache.list.length > limit) {\n    const rm = cache.list.shift();\n\n    cache.map.delete(rm.id);\n  }\n\n  if ( data.baseType ) {\n    type = normalizeType(data.baseType);\n    cache = state.types[type];\n    if ( cache ) {\n      addObject(cache.list, entry);\n      cache.map.set(id, entry);\n    }\n  }\n\n  return entry;\n}\n\nexport function forgetType(state, type) {\n  const cache = state.types[type];\n\n  if ( cache ) {\n    cache.haveAll = false;\n    cache.haveSelector = {};\n    cache.haveNamespace = undefined;\n    cache.havePage = undefined;\n    cache.revision = 0;\n    cache.generation = 0;\n    clear(cache.list);\n    cache.map.clear();\n    delete state.types[type];\n\n    garbageCollect.gcResetType(state, type);\n\n    return true;\n  }\n}\n\nexport function resetStore(state, commit) {\n  // eslint-disable-next-line no-console\n  console.log('Reset store: ', state.config.namespace);\n\n  for ( const type of Object.keys(state.types) ) {\n    commit(`${ state.config.namespace }/forgetType`, type);\n  }\n\n  garbageCollect.gcResetStore(state);\n}\n\nexport function remove(state, obj, getters) {\n  if (obj) {\n    let type = normalizeType(obj.type);\n    const keyField = getters[`${ state.config.namespace }/keyFieldForType`](type);\n    const id = obj[keyField];\n\n    let entry = state.types[type];\n\n    if ( entry ) {\n      removeObject(entry.list, obj);\n      entry.map.delete(id);\n    }\n\n    if ( obj.baseType ) {\n      type = normalizeType(obj.baseType);\n      entry = state.types[type];\n\n      if ( entry ) {\n        removeObject(entry.list, obj);\n        entry.map.delete(id);\n      }\n    }\n  }\n}\n\nexport function batchChanges(state, { ctx, batch }) {\n  const batchTypes = Object.keys(batch);\n  const combinedBatch = {};\n\n  batchTypes.forEach((batchType) => {\n    combinedBatch[batchType] = batch[batchType];\n    const typeOption = ctx.rootGetters['type-map/optionsFor'](batchType);\n\n    if (typeOption?.alias?.length > 0) {\n      const alias = typeOption?.alias || [];\n\n      alias.forEach((aliasType) => {\n        combinedBatch[aliasType] = {};\n        for (const [key, value] of Object.entries(batch[batchType])) {\n          combinedBatch[aliasType][key] = {\n            ...value,\n            type: aliasType\n          };\n        }\n      });\n    }\n  });\n\n  const combinedBatchTypes = Object.keys(combinedBatch);\n\n  combinedBatchTypes.forEach((type) => {\n    const normalizedType = normalizeType(type === 'counts' ? COUNT : type);\n    const keyField = keyFieldFor(normalizedType);\n    const typeCache = registerType(state, normalizedType);\n\n    // making a map for every resource's location in the list is gonna ensure we only have to loop through the big list once.\n    const typeCacheIndexMap = {};\n\n    typeCache.list.forEach((resource, index) => {\n      typeCacheIndexMap[resource[keyField]] = index;\n    });\n\n    const removeAtIndexes = [];\n\n    // looping through the batch, executing changes, deferring creates and removes since they change the array length\n    Object.keys(combinedBatch[normalizedType]).forEach((id) => {\n      const index = typeCacheIndexMap[id];\n      const resource = combinedBatch[normalizedType][id];\n\n      // an empty resource passed into batch changes is how we'll signal which ones to delete\n      if (Object.keys(resource).length === 0 && index !== undefined) {\n        typeCache.map.delete(id);\n        removeAtIndexes.push(index);\n      } else if (Object.keys(resource).length === 0) {\n        // No op. We're removing it... but we don't have it in the cache\n      } else {\n        if (normalizedType === SCHEMA) {\n          addSchemaIndexFields(resource);\n        }\n        const classyResource = classify(ctx, resource);\n\n        if (index === undefined) {\n          typeCache.list.push(classyResource);\n          typeCache.map.set(id, classyResource);\n\n          typeCacheIndexMap[classyResource[keyField]] = typeCache.list.length - 1;\n        } else {\n          replaceResource(typeCache.list[index], resource, ctx.getters);\n        }\n      }\n    });\n\n    // looping through the removeAtIndexes, making sure to offset by iteration so the array changing doesn't mess us up\n    removeAtIndexes.sort().forEach((cacheIndex, loopIndex) => {\n      typeCache.list.splice(cacheIndex - loopIndex, 1);\n    });\n\n    const opts = ctx.rootGetters[`type-map/optionsFor`](type);\n    const limit = opts?.limit;\n\n    // If there is a limit to the number of resources we can store for this type then\n    // remove the first one to keep the list size to that limit\n    if (limit && typeCache.list.length > limit) {\n      const rm = typeCache.list.shift();\n\n      typeCache.map.delete(rm.id);\n    }\n\n    typeCache.generation++;\n  });\n}\n\nexport function loadAll(state, {\n  type,\n  data,\n  ctx,\n  skipHaveAll,\n  namespace,\n  revision\n}) {\n  const { getters } = ctx;\n\n  if (!data) {\n    return;\n  }\n\n  const opts = ctx.rootGetters[`type-map/optionsFor`](type);\n  const limit = opts?.limit;\n\n  // If there is a limit, only store the last elements from the list to keep to that limit\n  if (limit) {\n    data = data.slice(-limit);\n  }\n\n  const keyField = getters.keyFieldForType(type);\n  const proxies = data.map((x) => classify(ctx, x));\n  const cache = registerType(state, type);\n\n  clear(cache.list);\n  cache.map.clear();\n  cache.revision = revision || 0;\n  cache.generation++;\n\n  addObjects(cache.list, proxies);\n\n  for ( let i = 0 ; i < proxies.length ; i++ ) {\n    cache.map.set(proxies[i][keyField], proxies[i]);\n  }\n\n  // Allow requester to skip setting that everything has loaded\n  if (!skipHaveAll) {\n    if (namespace) {\n      cache.havePage = false;\n      cache.haveNamespace = namespace;\n      cache.haveAll = false;\n    } else {\n      cache.havePage = false;\n      cache.haveNamespace = false;\n      cache.haveAll = true;\n    }\n  }\n\n  return proxies;\n}\n\n/**\n * Add a set of resources to the store for a given type\n *\n * Don't mark the 'haveAll' field - this is used for incremental loading\n */\nexport function loadAdd(state, { type, data: allLatest, ctx }) {\n  const { getters } = ctx;\n  const keyField = getters.keyFieldForType(type);\n  const cachedArgs = createLoadArgs(ctx, allLatest?.[0]?.type);\n\n  allLatest.forEach((entry) => {\n    const existing = state.types[type].map.get(entry[keyField]);\n\n    load(state, {\n      data: entry, ctx, existing, cachedArgs\n    });\n  });\n}\n\nexport default {\n  registerType,\n  load,\n\n  applyConfig(state, config) {\n    if ( !state.config ) {\n      state.config = {};\n    }\n\n    Object.assign(state.config, config);\n  },\n\n  /**\n   * Load multiple different types of resources\n   */\n  loadMulti(state, { data, ctx }) {\n    // console.log('### Mutation loadMulti', data?.length);\n\n    for ( const entry of data ) {\n      load(state, { data: entry, ctx });\n    }\n  },\n\n  loadSelector(state, {\n    type, entries, ctx, selector, revision\n  }) {\n    const cache = registerType(state, type);\n    const cachedArgs = createLoadArgs(ctx, entries?.[0]?.type);\n\n    for ( const data of entries ) {\n      load(state, {\n        data, ctx, cachedArgs\n      });\n    }\n\n    cache.haveSelector[selector] = true;\n    cache.revision = revision || 0;\n  },\n\n  loadAll,\n\n  /**\n   * Handles changes (add, update, remove) to multiple resources for multiple types\n   */\n  batchChanges,\n\n  loadMerge(state, { type, data: allLatest, ctx }) {\n    const { commit, getters } = ctx;\n    // const allLatest = await dispatch('findAll', { type, opt: { force: true, load, _NONE } });\n    // const allExisting = getters.all({type});\n    const keyField = getters.keyFieldForType(type);\n    const cache = state.types[type];\n    const cachedArgs = createLoadArgs(ctx, allLatest?.[0].type);\n\n    allLatest.forEach((entry) => {\n      const existing = state.types[type].map.get(entry[keyField]);\n\n      load(state, {\n        data: entry, ctx, existing, cachedArgs\n      });\n    });\n    cache.list.forEach((entry) => {\n      if (!allLatest.find((toLoadEntry) => toLoadEntry.id === entry.id)) {\n        commit('remove', entry);\n      }\n    });\n  },\n\n  loadAdd,\n\n  loadPage(state, {\n    type,\n    data,\n    ctx,\n    pagination,\n  }) {\n    if (!data) {\n      return;\n    }\n\n    const keyField = ctx.getters.keyFieldForType(type);\n    const proxies = data.map((x) => classify(ctx, x));\n    const cache = registerType(state, type);\n\n    clear(cache.list);\n    cache.map.clear();\n    cache.generation++;\n\n    addObjects(cache.list, proxies);\n\n    for ( let i = 0 ; i < proxies.length ; i++ ) {\n      cache.map.set(proxies[i][keyField], proxies[i]);\n    }\n\n    // havePage is of type `StorePagination`\n    cache.havePage = pagination;\n    cache.haveNamespace = undefined;\n    cache.haveAll = undefined;\n\n    return proxies;\n  },\n\n  forgetAll(state, { type }) {\n    const cache = registerType(state, type);\n\n    clear(cache.list);\n    cache.map.clear();\n    cache.generation++;\n  },\n\n  setHaveAll(state, { type }) {\n    const cache = registerType(state, type);\n\n    cache.haveAll = true;\n  },\n\n  setHaveNamespace(state, { type, namespace }) {\n    const cache = registerType(state, type);\n\n    cache.haveNamespace = namespace;\n  },\n\n  loadedAll(state, { type }) {\n    const cache = registerType(state, type);\n\n    cache.generation++;\n    cache.haveAll = true;\n  },\n\n  remove(state, obj) {\n    if (obj) {\n      remove(state, obj, this.getters);\n    }\n  },\n\n  reset(state) {\n    resetStore(state, this.commit);\n  },\n\n  forgetType,\n\n  incrementLoadCounter(state, type) {\n    const typeData = state.types[type];\n\n    if (typeData) {\n      typeData.loadCounter++;\n    }\n  },\n\n};\n"],"mappings":"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","ignoreList":[]}]}