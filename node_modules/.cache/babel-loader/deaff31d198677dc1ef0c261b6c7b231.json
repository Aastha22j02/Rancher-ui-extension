{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js??ref--17-0!/home/ubuntu/susecon-2024-ext-demo/node_modules/ts-loader/index.js??ref--17-1!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/projectAndNamespaceFiltering.utils.ts","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/projectAndNamespaceFiltering.utils.ts","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/babel.config.js","mtime":1725268750245},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/ts-loader/index.js","mtime":1725271299135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCB7IE5BTUVTUEFDRV9GSUxURVJfTlNfRlVMTF9QUkVGSVgsIE5BTUVTUEFDRV9GSUxURVJfUF9GVUxMX1BSRUZJWCB9IGZyb20gJ0BzaGVsbC91dGlscy9uYW1lc3BhY2UtZmlsdGVyJzsKaW1wb3J0IHsgZ2V0UGVyZm9ybWFuY2VTZXR0aW5nIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3NldHRpbmdzJzsKdmFyIFByb2plY3RBbmROYW1lc3BhY2VGaWx0ZXJpbmcgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFByb2plY3RBbmROYW1lc3BhY2VGaWx0ZXJpbmcoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUHJvamVjdEFuZE5hbWVzcGFjZUZpbHRlcmluZyk7CiAgfQogIHJldHVybiBfY3JlYXRlQ2xhc3MoUHJvamVjdEFuZE5hbWVzcGFjZUZpbHRlcmluZywgW3sKICAgIGtleTogImlzQXBwbGljYWJsZSIsCiAgICB2YWx1ZToKICAgIC8qKgogICAgICogRG9lcyB0aGUgcmVxdWVzdCBgb3B0YCBkZWZpbml0aW9uIHJlcXVpcmUgcmVzb3VyY2VzIGFyZSBmZXRjaGVkIGZyb20gYSBzcGVjaWZpYyBzZXQgbmFtZXNwYWNlcy9wcm9qZWN0cz8KICAgICAqLwogICAgZnVuY3Rpb24gaXNBcHBsaWNhYmxlKG9wdCkgewogICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShvcHQubmFtZXNwYWNlZCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNFbmFibGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0VuYWJsZWQocm9vdEdldHRlcnMpIHsKICAgICAgdmFyIF9hOwogICAgICB2YXIgY3VycmVudFByb2R1Y3QgPSByb290R2V0dGVyc1snY3VycmVudFByb2R1Y3QnXTsKICAgICAgLy8gT25seSBlbmFibGUgZm9yIHRoZSBjbHVzdGVyIHN0b3JlIGF0IHRoZSBtb21lbnQuIEluIHRoZW9yeSB0aGlzIHNob3VsZCB3b3JrIGluIG1hbmFnZW1lbnQgYXMgd2VsbCwgYXMgdGhleSdyZSBib3RoICdzdGV2ZScgc3RvcmVzCiAgICAgIGlmICgoY3VycmVudFByb2R1Y3QgPT09IG51bGwgfHwgY3VycmVudFByb2R1Y3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGN1cnJlbnRQcm9kdWN0LmluU3RvcmUpICE9PSAnY2x1c3RlcicpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKGN1cnJlbnRQcm9kdWN0ID09PSBudWxsIHx8IGN1cnJlbnRQcm9kdWN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyZW50UHJvZHVjdC5zaG93V29ya3NwYWNlU3dpdGNoZXIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgdmFyIHBlcmZDb25maWcgPSBnZXRQZXJmb3JtYW5jZVNldHRpbmcocm9vdEdldHRlcnMpOwogICAgICBpZiAoISgoX2EgPSBwZXJmQ29uZmlnLmZvcmNlTnNGaWx0ZXJWMikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVuYWJsZWQpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBgb3B0YCByZXF1aXJlcyByZXNvdXJjZXMgZnJvbSBzcGVjaWZpYyBucy9wcm9qZWN0cywgaWYgc28gcmV0dXJuIHRoZSByZXF1aXJlZCBxdWVyeSBwYXJhbSAoeD15KQogICAgICovCiAgfSwgewogICAga2V5OiAiY2hlY2tBbmRDcmVhdGVQYXJhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tBbmRDcmVhdGVQYXJhbShvcHQpIHsKICAgICAgaWYgKCF0aGlzLmlzQXBwbGljYWJsZShvcHQpKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVBhcmFtKG9wdC5uYW1lc3BhY2VkKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVQYXJhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlUGFyYW0obmFtZXNwYWNlRmlsdGVyKSB7CiAgICAgIGlmICghbmFtZXNwYWNlRmlsdGVyIHx8ICFuYW1lc3BhY2VGaWx0ZXIubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CiAgICAgIHZhciBwcm9qZWN0c09yTmFtZXNwYWNlcyA9IG5hbWVzcGFjZUZpbHRlci5tYXAoZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gZi5yZXBsYWNlKE5BTUVTUEFDRV9GSUxURVJfTlNfRlVMTF9QUkVGSVgsICcnKS5yZXBsYWNlKE5BTUVTUEFDRV9GSUxURVJfUF9GVUxMX1BSRUZJWCwgJycpOwogICAgICB9KS5qb2luKCcsJyk7CiAgICAgIHJldHVybiAiIi5jb25jYXQoUHJvamVjdEFuZE5hbWVzcGFjZUZpbHRlcmluZy5wYXJhbSwgIj0iKS5jb25jYXQocHJvamVjdHNPck5hbWVzcGFjZXMpOwogICAgfQogIH1dKTsKfSgpOwpQcm9qZWN0QW5kTmFtZXNwYWNlRmlsdGVyaW5nLnBhcmFtID0gJ3Byb2plY3Rzb3JuYW1lc3BhY2VzJzsKZXhwb3J0IGRlZmF1bHQgbmV3IFByb2plY3RBbmROYW1lc3BhY2VGaWx0ZXJpbmcoKTs="},{"version":3,"names":["NAMESPACE_FILTER_NS_FULL_PREFIX","NAMESPACE_FILTER_P_FULL_PREFIX","getPerformanceSetting","ProjectAndNamespaceFiltering","_classCallCheck","_createClass","key","value","isApplicable","opt","Array","isArray","namespaced","isEnabled","rootGetters","currentProduct","inStore","showWorkspaceSwitcher","perfConfig","_a","forceNsFilterV2","enabled","checkAndCreateParam","createParam","namespaceFilter","length","projectsOrNamespaces","map","f","replace","join","concat","param"],"sources":["/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/projectAndNamespaceFiltering.utils.ts"],"sourcesContent":["import { NAMESPACE_FILTER_NS_FULL_PREFIX, NAMESPACE_FILTER_P_FULL_PREFIX } from '@shell/utils/namespace-filter';\nimport { getPerformanceSetting } from '@shell/utils/settings';\n\ntype Opt = { [key: string]: any, namespaced?: string[]}\n\nclass ProjectAndNamespaceFiltering {\n  static param = 'projectsornamespaces'\n\n  /**\n   * Does the request `opt` definition require resources are fetched from a specific set namespaces/projects?\n   */\n  isApplicable(opt: Opt): boolean {\n    return Array.isArray(opt.namespaced);\n  }\n\n  isEnabled(rootGetters: any): boolean {\n    const currentProduct = rootGetters['currentProduct'];\n\n    // Only enable for the cluster store at the moment. In theory this should work in management as well, as they're both 'steve' stores\n    if (currentProduct?.inStore !== 'cluster') {\n      return false;\n    }\n\n    if (currentProduct?.showWorkspaceSwitcher) {\n      return false;\n    }\n\n    const perfConfig = getPerformanceSetting(rootGetters);\n\n    if (!perfConfig.forceNsFilterV2?.enabled) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Check if `opt` requires resources from specific ns/projects, if so return the required query param (x=y)\n   */\n  checkAndCreateParam(opt: Opt): string {\n    if (!this.isApplicable(opt)) {\n      return '';\n    }\n\n    return this.createParam(opt.namespaced);\n  }\n\n  private createParam(namespaceFilter: string[] | undefined): string {\n    if (!namespaceFilter || !namespaceFilter.length) {\n      return '';\n    }\n\n    const projectsOrNamespaces = namespaceFilter\n      .map((f) => f.replace(NAMESPACE_FILTER_NS_FULL_PREFIX, '')\n        .replace(NAMESPACE_FILTER_P_FULL_PREFIX, ''))\n      .join(',');\n\n    return `${ ProjectAndNamespaceFiltering.param }=${ projectsOrNamespaces }`;\n  }\n}\n\nexport default new ProjectAndNamespaceFiltering();\n"],"mappings":";;;;;;;AAAA,SAASA,+BAA+B,EAAEC,8BAA8B,QAAQ,+BAA+B;AAC/G,SAASC,qBAAqB,QAAQ,uBAAuB;AAAC,IAIxDC,4BAA4B;EAAA,SAAAA,6BAAA;IAAAC,eAAA,OAAAD,4BAAA;EAAA;EAAA,OAAAE,YAAA,CAAAF,4BAAA;IAAAG,GAAA;IAAAC,KAAA;IAGhC;;;IAGA,SAAAC,aAAaC,GAAQ;MACnB,OAAOC,KAAK,CAACC,OAAO,CAACF,GAAG,CAACG,UAAU,CAAC;IACtC;EAAC;IAAAN,GAAA;IAAAC,KAAA,EAED,SAAAM,UAAUC,WAAgB;;MACxB,IAAMC,cAAc,GAAGD,WAAW,CAAC,gBAAgB,CAAC;MAEpD;MACA,IAAI,CAAAC,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEC,OAAO,MAAK,SAAS,EAAE;QACzC,OAAO,KAAK;;MAGd,IAAID,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEE,qBAAqB,EAAE;QACzC,OAAO,KAAK;;MAGd,IAAMC,UAAU,GAAGhB,qBAAqB,CAACY,WAAW,CAAC;MAErD,IAAI,EAAC,CAAAK,EAAA,GAAAD,UAAU,CAACE,eAAe,cAAAD,EAAA,uBAAAA,EAAA,CAAEE,OAAO,GAAE;QACxC,OAAO,KAAK;;MAGd,OAAO,IAAI;IACb;IAEA;;;EAAA;IAAAf,GAAA;IAAAC,KAAA,EAGA,SAAAe,oBAAoBb,GAAQ;MAC1B,IAAI,CAAC,IAAI,CAACD,YAAY,CAACC,GAAG,CAAC,EAAE;QAC3B,OAAO,EAAE;;MAGX,OAAO,IAAI,CAACc,WAAW,CAACd,GAAG,CAACG,UAAU,CAAC;IACzC;EAAC;IAAAN,GAAA;IAAAC,KAAA,EAEO,SAAAgB,YAAYC,eAAqC;MACvD,IAAI,CAACA,eAAe,IAAI,CAACA,eAAe,CAACC,MAAM,EAAE;QAC/C,OAAO,EAAE;;MAGX,IAAMC,oBAAoB,GAAGF,eAAe,CACzCG,GAAG,CAAC,UAACC,CAAC;QAAA,OAAKA,CAAC,CAACC,OAAO,CAAC7B,+BAA+B,EAAE,EAAE,CAAC,CACvD6B,OAAO,CAAC5B,8BAA8B,EAAE,EAAE,CAAC;MAAA,EAAC,CAC9C6B,IAAI,CAAC,GAAG,CAAC;MAEZ,UAAAC,MAAA,CAAW5B,4BAA4B,CAAC6B,KAAM,OAAAD,MAAA,CAAKL,oBAAqB;IAC1E;EAAC;AAAA;AApDMvB,4BAAA,CAAA6B,KAAK,GAAG,sBAAsB;AAuDvC,eAAe,IAAI7B,4BAA4B,EAAE","ignoreList":[]}]}