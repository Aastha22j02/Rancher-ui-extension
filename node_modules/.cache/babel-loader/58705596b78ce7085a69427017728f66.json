{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/auth.js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/auth.js","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/babel.config.js","mtime":1725268750245},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIi9ob21lL3VidW50dS9zdXNlY29uLTIwMjQtZXh0LWRlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yL2luZGV4LmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZW50cmllcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCB7IFBvcHVwLCBwb3B1cFdpbmRvd09wdGlvbnMgfSBmcm9tICdAc2hlbGwvdXRpbHMvd2luZG93JzsKaW1wb3J0IHsgcGFyc2UgYXMgcGFyc2VVcmwsIGFkZFBhcmFtIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3VybCc7CmltcG9ydCB7IEJBQ0tfVE8sIFNQQSwgX0VESVQsIF9GTEFHR0VEIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBNQU5BR0VNRU5UIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IGFsbEhhc2ggfSBmcm9tICdAc2hlbGwvdXRpbHMvcHJvbWlzZSc7CmV4cG9ydCBmdW5jdGlvbiBvcGVuQXV0aFBvcHVwKHVybCwgcHJvdmlkZXIpIHsKICB2YXIgcG9wdXAgPSBuZXcgUG9wdXAoZnVuY3Rpb24gKCkgewogICAgcG9wdXAucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgcG9wdXAucmVzb2x2ZSA9IHJlc29sdmU7CiAgICAgIHBvcHVwLnJlamVjdCA9IHJlamVjdDsKICAgIH0pOwogICAgd2luZG93Lm9uQXV0aFRlc3QgPSBmdW5jdGlvbiAoZXJyb3IsIGNvZGUpIHsKICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgcG9wdXAucmVqZWN0KGVycm9yKTsKICAgICAgfQogICAgICBkZWxldGUgd2luZG93Lm9uQXV0aFRlc3Q7CiAgICAgIHBvcHVwLnJlc29sdmUoY29kZSk7CiAgICB9OwogIH0sIGZ1bmN0aW9uICgpIHsKICAgIHBvcHVwLnJlamVjdChuZXcgRXJyb3IoJ0FjY2VzcyB3YXMgbm90IGF1dGhvcml6ZWQnKSk7CiAgfSk7CiAgcG9wdXAub3Blbih1cmwsICdhdXRoLXRlc3QnLCBwb3B1cFdpbmRvd09wdGlvbnMoKSk7CiAgcmV0dXJuIHBvcHVwLnByb21pc2U7Cn0KZXhwb3J0IGZ1bmN0aW9uIHJldHVyblRvKG9wdCwgdm0pIHsKICB2YXIgX29wdCRyb3V0ZSA9IG9wdC5yb3V0ZSwKICAgIHJvdXRlID0gX29wdCRyb3V0ZSA9PT0gdm9pZCAwID8gIi9hdXRoL3ZlcmlmeSIgOiBfb3B0JHJvdXRlOwogIGlmICh2bS4kcm91dGVyLm9wdGlvbnMgJiYgdm0uJHJvdXRlci5vcHRpb25zLmJhc2UpIHsKICAgIHZhciByb3V0ZXJCYXNlID0gdm0uJHJvdXRlci5vcHRpb25zLmJhc2U7CiAgICBpZiAocm91dGVyQmFzZSAhPT0gJy8nKSB7CiAgICAgIHJvdXRlID0gIiIuY29uY2F0KHJvdXRlckJhc2UucmVwbGFjZSgvXC8rJC8sICcnKSwgIi8iKS5jb25jYXQocm91dGUucmVwbGFjZSgvXlwvKy8sICcnKSk7CiAgICB9CiAgfQogIHZhciByZXR1cm5Ub1VybCA9ICIiLmNvbmNhdCh3aW5kb3cubG9jYXRpb24ub3JpZ2luKS5jb25jYXQocm91dGUpOwogIHZhciBwYXJzZWQgPSBwYXJzZVVybCh3aW5kb3cubG9jYXRpb24uaHJlZik7CiAgaWYgKHBhcnNlZC5xdWVyeS5zcGEgIT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuVG9VcmwgPSBhZGRQYXJhbShyZXR1cm5Ub1VybCwgU1BBLCBfRkxBR0dFRCk7CiAgfQogIGlmIChvcHQuYmFja1RvKSB7CiAgICByZXR1cm5Ub1VybCA9IGFkZFBhcmFtKHJldHVyblRvVXJsLCBCQUNLX1RPLCBvcHQuYmFja1RvKTsKICB9CiAgaWYgKG9wdC5jb25maWcpIHsKICAgIHJldHVyblRvVXJsID0gYWRkUGFyYW0ocmV0dXJuVG9VcmwsICdjb25maWcnLCBvcHQuY29uZmlnKTsKICB9CiAgcmV0dXJuIHJldHVyblRvVXJsOwp9CgovKioNCiAqIERldGVybWluZXMgY29tbW9uIGF1dGggcHJvdmlkZXIgaW5mbyBhcyB0aG9zZSB0aGF0IGFyZSBhdmFpbGFibGUgKG5vbi1sb2NhbCkgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgZW5hYmxlZCBwcm92aWRlcg0KICovCmV4cG9ydCB2YXIgYXV0aFByb3ZpZGVyc0luZm8gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShzdG9yZSkgewogICAgdmFyIHJvd3MsIG5vbkxvY2FsLCBzdXBwb3J0ZWROb25Mb2NhbCwgZW5hYmxlZCwgZW5hYmxlZExvY2F0aW9uOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCJtYW5hZ2VtZW50L2ZpbmRBbGwiLCB7CiAgICAgICAgICAgIHR5cGU6IE1BTkFHRU1FTlQuQVVUSF9DT05GSUcKICAgICAgICAgIH0pOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJvd3MgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgbm9uTG9jYWwgPSByb3dzLmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgICAgICAgICByZXR1cm4geC5uYW1lICE9PSAnbG9jYWwnOwogICAgICAgICAgfSk7IC8vIEdlbmVyaWMgT0lEQyBpcyByZXR1cm5lZCB2aWEgQVBJIGJ1dCBub3Qgc3VwcG9ydGVkIChhbmQgd2lsbCBiZSByZW1vdmVkIG9yIGZpeGVkIGluIGZ1dHVyZSkKICAgICAgICAgIHN1cHBvcnRlZE5vbkxvY2FsID0gbm9uTG9jYWwuZmlsdGVyKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIHJldHVybiB4LmlkICE9PSAnb2lkYyc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGVuYWJsZWQgPSBub25Mb2NhbC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgcmV0dXJuIHguZW5hYmxlZCA9PT0gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgICAgZW5hYmxlZExvY2F0aW9uID0gZW5hYmxlZC5sZW5ndGggPT09IDEgPyB7CiAgICAgICAgICAgIG5hbWU6ICdjLWNsdXN0ZXItYXV0aC1jb25maWctaWQnLAogICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICBpZDogZW5hYmxlZFswXS5pZAogICAgICAgICAgICB9LAogICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgIG1vZGU6IF9FRElUCiAgICAgICAgICAgIH0KICAgICAgICAgIH0gOiBudWxsOwogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICBub25Mb2NhbDogc3VwcG9ydGVkTm9uTG9jYWwsCiAgICAgICAgICAgIGVuYWJsZWRMb2NhdGlvbjogZW5hYmxlZExvY2F0aW9uLAogICAgICAgICAgICBlbmFibGVkOiBlbmFibGVkCiAgICAgICAgICB9KTsKICAgICAgICBjYXNlIDg6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gZnVuY3Rpb24gYXV0aFByb3ZpZGVyc0luZm8oX3gpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwpleHBvcnQgdmFyIGNoZWNrU2NoZW1hc0ZvckZpbmRBbGxIYXNoID0gZnVuY3Rpb24gY2hlY2tTY2hlbWFzRm9yRmluZEFsbEhhc2godHlwZXMsIHN0b3JlKSB7CiAgdmFyIGhhc2ggPSB7fTsKICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHR5cGVzKTsgX2kgPCBfT2JqZWN0JGVudHJpZXMubGVuZ3RoOyBfaSsrKSB7CiAgICB2YXIgX09iamVjdCRlbnRyaWVzJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzW19pXSwgMiksCiAgICAgIGtleSA9IF9PYmplY3QkZW50cmllcyRfaVswXSwKICAgICAgdmFsdWUgPSBfT2JqZWN0JGVudHJpZXMkX2lbMV07CiAgICB2YXIgc2NoZW1hID0gc3RvcmUuZ2V0dGVyc1siIi5jb25jYXQodmFsdWUuaW5TdG9yZVR5cGUsICIvc2NoZW1hRm9yIildKHZhbHVlLnR5cGUpOwoKICAgIC8vIEl0IGNvdWxkIGJlIHRoYXQgdXNlciBoYXMgcGVybWlzc2lvbnMgZm9yIEdFVCBidXQgbm90IGxpc3QKICAgIC8vIGUuZy4gU3RhbmRhcmQgdXNlciB3aXRoIEdpdFJlcG8gcGVybWlzc2lvbnMgdHJ5IHRvIGZldGNoIGxpc3Qgb2YgZmxlZXR3b3Jrc3BhY2VzCiAgICAvLyB1c2VyIGhhcyBhYmlsaXR5IHRvIEdFVCBidXQgbm90IGZsZWV0IHdvcmtzcGFjZXMKICAgIC8vIHNvIG9wdGlvbmFsbHkgZGVmaW5lIGEgZnVuY3Rpb24gdGhhdCByZXF1aXJlIGl0IHRvIHBhc3MgYmVmb3JlIC9maW5kQWxsCiAgICB2YXIgdmFsaWRTY2hlbWEgPSB2YWx1ZS5zY2hlbWFWYWxpZGF0b3IgPyB2YWx1ZS5zY2hlbWFWYWxpZGF0b3Ioc2NoZW1hKSA6ICEhc2NoZW1hOwogICAgaWYgKHZhbGlkU2NoZW1hKSB7CiAgICAgIGhhc2hba2V5XSA9IHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdCh2YWx1ZS5pblN0b3JlVHlwZSwgIi9maW5kQWxsIiksIHsKICAgICAgICB0eXBlOiB2YWx1ZS50eXBlCiAgICAgIH0pOwogICAgfQogIH0KICByZXR1cm4gYWxsSGFzaChoYXNoKTsKfTsKZXhwb3J0IHZhciBjaGVja1Blcm1pc3Npb25zID0gZnVuY3Rpb24gY2hlY2tQZXJtaXNzaW9ucyh0eXBlcywgZ2V0dGVycykgewogIHZhciBoYXNoID0ge307CiAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgIHZhciBfT2JqZWN0JGVudHJpZXMyJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzMltfaTJdLCAyKSwKICAgICAgICBrZXkgPSBfT2JqZWN0JGVudHJpZXMyJF9pWzBdLAogICAgICAgIHZhbHVlID0gX09iamVjdCRlbnRyaWVzMiRfaVsxXTsKICAgICAgdmFyIHNjaGVtYSA9IGdldHRlcnNbJ21hbmFnZW1lbnQvc2NoZW1hRm9yJ10odmFsdWUudHlwZSk7CiAgICAgIGlmICghc2NoZW1hKSB7CiAgICAgICAgaGFzaFtrZXldID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIDA7IC8vIGNvbnRpbnVlCiAgICAgIH0KCiAgICAgIC8vIEl0IGNvdWxkIGJlIHRoYXQgdXNlciBoYXMgcGVybWlzc2lvbnMgZm9yIEdFVCBidXQgbm90IGxpc3QKICAgICAgLy8gZS5nLiBTdGFuZGFyZCB1c2VyIHdpdGggR2l0UmVwbyBwZXJtaXNzaW9ucyB0cnkgdG8gZmV0Y2ggbGlzdCBvZiBmbGVldHdvcmtzcGFjZXMKICAgICAgLy8gdXNlciBoYXMgYWJpbGl0eSB0byBHRVQgYnV0IG5vdCBmbGVldCB3b3Jrc3BhY2VzCiAgICAgIC8vIHNvIG9wdGlvbmFsbHkgZGVmaW5lIGEgZnVuY3Rpb24gdGhhdCByZXF1aXJlIGl0IHRvIHBhc3MgYmVmb3JlIC9maW5kQWxsCiAgICAgIGlmICh2YWx1ZS5zY2hlbWFWYWxpZGF0b3IpIHsKICAgICAgICBoYXNoW2tleV0gPSB2YWx1ZS5zY2hlbWFWYWxpZGF0b3Ioc2NoZW1hKTsKICAgICAgICByZXR1cm4gMDsgLy8gY29udGludWUKICAgICAgfQogICAgICBpZiAodmFsdWUucmVzb3VyY2VNZXRob2RzICYmIHNjaGVtYSkgewogICAgICAgIGhhc2hba2V5XSA9IHZhbHVlLnJlc291cmNlTWV0aG9kcy5ldmVyeShmdW5jdGlvbiAobWV0aG9kKSB7CiAgICAgICAgICByZXR1cm4gKHNjaGVtYS5yZXNvdXJjZU1ldGhvZHMgfHwgW10pLmluY2x1ZGVzKG1ldGhvZCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIDA7IC8vIGNvbnRpbnVlCiAgICAgIH0KICAgICAgaWYgKHZhbHVlLmNvbGxlY3Rpb25NZXRob2RzICYmIHNjaGVtYSkgewogICAgICAgIGhhc2hba2V5XSA9IHZhbHVlLmNvbGxlY3Rpb25NZXRob2RzLmV2ZXJ5KGZ1bmN0aW9uIChtZXRob2QpIHsKICAgICAgICAgIHJldHVybiAoc2NoZW1hLmNvbGxlY3Rpb25NZXRob2RzIHx8IFtdKS5pbmNsdWRlcyhtZXRob2QpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiAwOyAvLyBjb250aW51ZQogICAgICB9CiAgICAgIGhhc2hba2V5XSA9ICEhc2NoZW1hOwogICAgfSwKICAgIF9yZXQ7CiAgZm9yICh2YXIgX2kyID0gMCwgX09iamVjdCRlbnRyaWVzMiA9IE9iamVjdC5lbnRyaWVzKHR5cGVzKTsgX2kyIDwgX09iamVjdCRlbnRyaWVzMi5sZW5ndGg7IF9pMisrKSB7CiAgICBfcmV0ID0gX2xvb3AoKTsKICAgIGlmIChfcmV0ID09PSAwKSBjb250aW51ZTsKICB9CiAgcmV0dXJuIGFsbEhhc2goaGFzaCk7Cn07CmV4cG9ydCB2YXIgY2FuVmlld1Jlc291cmNlID0gZnVuY3Rpb24gY2FuVmlld1Jlc291cmNlKHN0b3JlLCByZXNvdXJjZSkgewogIC8vIE5vdGUgLSBkb24ndCB1c2UgdGhlIGN1cnJlbnQgcHJvZHVjdHMgc3RvcmUuLi4gYmVjYXVzZSBwcm9kdWN0cyBjYW4gb3ZlcnJpZGUgc3RvcmVzIGZvciByZXNvdXJjZXMgd2l0aCBgdHlwZVN0b3JlTWFwYAogIHZhciBpblN0b3JlID0gc3RvcmUuZ2V0dGVyc1snY3VycmVudFN0b3JlJ10ocmVzb3VyY2UpOwogIC8vIFRoZXJlJ3MgYSBjaGFuY2Ugd2UncmUgaW4gYW4gZXh0ZW5zaW9uJ3MgcHJvZHVjdCB3aG8ncyBzdG9yZSBjb3VsZCBiZSBhbnl0aGluZywgc28gY29uZmlybSBzY2hlbWFGb3IgZXhpc3RzCiAgdmFyIHNjaGVtYUZvciA9IHN0b3JlLmdldHRlcnNbIiIuY29uY2F0KGluU3RvcmUsICIvc2NoZW1hRm9yIildOwoKICAvLyBJbiBvcmRlciB0byBjaGVjayBhIHJlc291cmNlIGlzIHZhbGlkIHdlIG5lZWQgdGhlc2UKICBpZiAoIWluU3RvcmUgfHwgIXNjaGVtYUZvcikgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gUmVzb3VyY2UgaXMgdmFsaWQgaWYgYSBzY2hlbWEgZXhpc3RzIGZvciBpdCAoc3RhbmRhcmQgcmVzb3VyY2UsIHNwb29mZWQgcmVzb3VyY2UpIG9yIGl0J3MgYSB2aXJ0dWFsIHJlc291cmNlCiAgdmFyIHZhbGlkUmVzb3VyY2UgPSBzY2hlbWFGb3IocmVzb3VyY2UpIHx8IHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2lzVmlydHVhbCddKHJlc291cmNlKTsKICByZXR1cm4gISF2YWxpZFJlc291cmNlOwp9Ow=="},{"version":3,"names":["Popup","popupWindowOptions","parse","parseUrl","addParam","BACK_TO","SPA","_EDIT","_FLAGGED","MANAGEMENT","allHash","openAuthPopup","url","provider","popup","promise","Promise","resolve","reject","window","onAuthTest","error","code","Error","open","returnTo","opt","vm","_opt$route","route","$router","options","base","routerBase","concat","replace","returnToUrl","location","origin","parsed","href","query","spa","undefined","backTo","config","authProvidersInfo","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","store","rows","nonLocal","supportedNonLocal","enabled","enabledLocation","wrap","_callee$","_context","prev","next","dispatch","type","AUTH_CONFIG","sent","filter","x","name","id","length","params","mode","abrupt","stop","_x","apply","arguments","checkSchemasForFindAllHash","types","hash","_i","_Object$entries","Object","entries","_Object$entries$_i","_slicedToArray","key","value","schema","getters","inStoreType","validSchema","schemaValidator","checkPermissions","_loop","_Object$entries2$_i","_Object$entries2","_i2","resourceMethods","every","method","includes","collectionMethods","_ret","canViewResource","resource","inStore","schemaFor","validResource"],"sources":["/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/auth.js"],"sourcesContent":["import { Popup, popupWindowOptions } from '@shell/utils/window';\r\nimport { parse as parseUrl, addParam } from '@shell/utils/url';\r\nimport { BACK_TO, SPA, _EDIT, _FLAGGED } from '@shell/config/query-params';\r\nimport { MANAGEMENT } from '@shell/config/types';\r\nimport { allHash } from '@shell/utils/promise';\r\n\r\nexport function openAuthPopup(url, provider) {\r\n  const popup = new Popup(() => {\r\n    popup.promise = new Promise((resolve, reject) => {\r\n      popup.resolve = resolve;\r\n      popup.reject = reject;\r\n    });\r\n\r\n    window.onAuthTest = (error, code) => {\r\n      if (error) {\r\n        popup.reject(error);\r\n      }\r\n\r\n      delete window.onAuthTest;\r\n      popup.resolve(code);\r\n    };\r\n  }, () => {\r\n    popup.reject(new Error('Access was not authorized'));\r\n  });\r\n\r\n  popup.open(url, 'auth-test', popupWindowOptions());\r\n\r\n  return popup.promise;\r\n}\r\n\r\nexport function returnTo(opt, vm) {\r\n  let { route = `/auth/verify` } = opt;\r\n\r\n  if ( vm.$router.options && vm.$router.options.base ) {\r\n    const routerBase = vm.$router.options.base;\r\n\r\n    if ( routerBase !== '/' ) {\r\n      route = `${ routerBase.replace(/\\/+$/, '') }/${ route.replace(/^\\/+/, '') }`;\r\n    }\r\n  }\r\n\r\n  let returnToUrl = `${ window.location.origin }${ route }`;\r\n\r\n  const parsed = parseUrl(window.location.href);\r\n\r\n  if ( parsed.query.spa !== undefined ) {\r\n    returnToUrl = addParam(returnToUrl, SPA, _FLAGGED);\r\n  }\r\n\r\n  if ( opt.backTo ) {\r\n    returnToUrl = addParam(returnToUrl, BACK_TO, opt.backTo);\r\n  }\r\n\r\n  if (opt.config) {\r\n    returnToUrl = addParam(returnToUrl, 'config', opt.config);\r\n  }\r\n\r\n  return returnToUrl;\r\n}\r\n\r\n/**\r\n * Determines common auth provider info as those that are available (non-local) and the location of the enabled provider\r\n */\r\nexport const authProvidersInfo = async(store) => {\r\n  const rows = await store.dispatch(`management/findAll`, { type: MANAGEMENT.AUTH_CONFIG });\r\n  const nonLocal = rows.filter((x) => x.name !== 'local');\r\n  // Generic OIDC is returned via API but not supported (and will be removed or fixed in future)\r\n  const supportedNonLocal = nonLocal.filter((x) => x.id !== 'oidc');\r\n  const enabled = nonLocal.filter((x) => x.enabled === true );\r\n\r\n  const enabledLocation = enabled.length === 1 ? {\r\n    name:   'c-cluster-auth-config-id',\r\n    params: { id: enabled[0].id },\r\n    query:  { mode: _EDIT }\r\n  } : null;\r\n\r\n  return {\r\n    nonLocal: supportedNonLocal,\r\n    enabledLocation,\r\n    enabled\r\n  };\r\n};\r\n\r\nexport const checkSchemasForFindAllHash = (types, store) => {\r\n  const hash = {};\r\n\r\n  for (const [key, value] of Object.entries(types)) {\r\n    const schema = store.getters[`${ value.inStoreType }/schemaFor`](value.type);\r\n\r\n    // It could be that user has permissions for GET but not list\r\n    // e.g. Standard user with GitRepo permissions try to fetch list of fleetworkspaces\r\n    // user has ability to GET but not fleet workspaces\r\n    // so optionally define a function that require it to pass before /findAll\r\n    const validSchema = value.schemaValidator ? value.schemaValidator(schema) : !!schema;\r\n\r\n    if (validSchema) {\r\n      hash[key] = store.dispatch(`${ value.inStoreType }/findAll`, { type: value.type } );\r\n    }\r\n  }\r\n\r\n  return allHash(hash);\r\n};\r\n\r\nexport const checkPermissions = (types, getters) => {\r\n  const hash = {};\r\n\r\n  for (const [key, value] of Object.entries(types)) {\r\n    const schema = getters['management/schemaFor'](value.type);\r\n\r\n    if (!schema) {\r\n      hash[key] = false;\r\n\r\n      continue;\r\n    }\r\n\r\n    // It could be that user has permissions for GET but not list\r\n    // e.g. Standard user with GitRepo permissions try to fetch list of fleetworkspaces\r\n    // user has ability to GET but not fleet workspaces\r\n    // so optionally define a function that require it to pass before /findAll\r\n    if (value.schemaValidator) {\r\n      hash[key] = value.schemaValidator(schema);\r\n\r\n      continue;\r\n    }\r\n\r\n    if (value.resourceMethods && schema) {\r\n      hash[key] = value.resourceMethods.every((method) => {\r\n        return (schema.resourceMethods || []).includes(method);\r\n      });\r\n\r\n      continue;\r\n    }\r\n\r\n    if (value.collectionMethods && schema) {\r\n      hash[key] = value.collectionMethods.every((method) => {\r\n        return (schema.collectionMethods || []).includes(method);\r\n      });\r\n\r\n      continue;\r\n    }\r\n\r\n    hash[key] = !!schema;\r\n  }\r\n\r\n  return allHash(hash);\r\n};\r\n\r\nexport const canViewResource = (store, resource) => {\r\n  // Note - don't use the current products store... because products can override stores for resources with `typeStoreMap`\r\n  const inStore = store.getters['currentStore'](resource);\r\n  // There's a chance we're in an extension's product who's store could be anything, so confirm schemaFor exists\r\n  const schemaFor = store.getters[`${ inStore }/schemaFor`];\r\n\r\n  // In order to check a resource is valid we need these\r\n  if (!inStore || !schemaFor) {\r\n    return false;\r\n  }\r\n\r\n  // Resource is valid if a schema exists for it (standard resource, spoofed resource) or it's a virtual resource\r\n  const validResource = schemaFor(resource) || store.getters['type-map/isVirtual'](resource);\r\n\r\n  return !!validResource;\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;AAAA,SAASA,KAAK,EAAEC,kBAAkB,QAAQ,qBAAqB;AAC/D,SAASC,KAAK,IAAIC,QAAQ,EAAEC,QAAQ,QAAQ,kBAAkB;AAC9D,SAASC,OAAO,EAAEC,GAAG,EAAEC,KAAK,EAAEC,QAAQ,QAAQ,4BAA4B;AAC1E,SAASC,UAAU,QAAQ,qBAAqB;AAChD,SAASC,OAAO,QAAQ,sBAAsB;AAE9C,OAAO,SAASC,aAAaA,CAACC,GAAG,EAAEC,QAAQ,EAAE;EAC3C,IAAMC,KAAK,GAAG,IAAId,KAAK,CAAC,YAAM;IAC5Bc,KAAK,CAACC,OAAO,GAAG,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;MAC/CJ,KAAK,CAACG,OAAO,GAAGA,OAAO;MACvBH,KAAK,CAACI,MAAM,GAAGA,MAAM;IACvB,CAAC,CAAC;IAEFC,MAAM,CAACC,UAAU,GAAG,UAACC,KAAK,EAAEC,IAAI,EAAK;MACnC,IAAID,KAAK,EAAE;QACTP,KAAK,CAACI,MAAM,CAACG,KAAK,CAAC;MACrB;MAEA,OAAOF,MAAM,CAACC,UAAU;MACxBN,KAAK,CAACG,OAAO,CAACK,IAAI,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,YAAM;IACPR,KAAK,CAACI,MAAM,CAAC,IAAIK,KAAK,CAAC,2BAA2B,CAAC,CAAC;EACtD,CAAC,CAAC;EAEFT,KAAK,CAACU,IAAI,CAACZ,GAAG,EAAE,WAAW,EAAEX,kBAAkB,CAAC,CAAC,CAAC;EAElD,OAAOa,KAAK,CAACC,OAAO;AACtB;AAEA,OAAO,SAASU,QAAQA,CAACC,GAAG,EAAEC,EAAE,EAAE;EAChC,IAAAC,UAAA,GAAiCF,GAAG,CAA9BG,KAAK;IAALA,KAAK,GAAAD,UAAA,+BAAAA,UAAA;EAEX,IAAKD,EAAE,CAACG,OAAO,CAACC,OAAO,IAAIJ,EAAE,CAACG,OAAO,CAACC,OAAO,CAACC,IAAI,EAAG;IACnD,IAAMC,UAAU,GAAGN,EAAE,CAACG,OAAO,CAACC,OAAO,CAACC,IAAI;IAE1C,IAAKC,UAAU,KAAK,GAAG,EAAG;MACxBJ,KAAK,MAAAK,MAAA,CAAOD,UAAU,CAACE,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,OAAAD,MAAA,CAAML,KAAK,CAACM,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAG;IAC9E;EACF;EAEA,IAAIC,WAAW,MAAAF,MAAA,CAAOf,MAAM,CAACkB,QAAQ,CAACC,MAAM,EAAAJ,MAAA,CAAKL,KAAK,CAAG;EAEzD,IAAMU,MAAM,GAAGpC,QAAQ,CAACgB,MAAM,CAACkB,QAAQ,CAACG,IAAI,CAAC;EAE7C,IAAKD,MAAM,CAACE,KAAK,CAACC,GAAG,KAAKC,SAAS,EAAG;IACpCP,WAAW,GAAGhC,QAAQ,CAACgC,WAAW,EAAE9B,GAAG,EAAEE,QAAQ,CAAC;EACpD;EAEA,IAAKkB,GAAG,CAACkB,MAAM,EAAG;IAChBR,WAAW,GAAGhC,QAAQ,CAACgC,WAAW,EAAE/B,OAAO,EAAEqB,GAAG,CAACkB,MAAM,CAAC;EAC1D;EAEA,IAAIlB,GAAG,CAACmB,MAAM,EAAE;IACdT,WAAW,GAAGhC,QAAQ,CAACgC,WAAW,EAAE,QAAQ,EAAEV,GAAG,CAACmB,MAAM,CAAC;EAC3D;EAEA,OAAOT,WAAW;AACpB;;AAEA;AACA;AACA;AACA,OAAO,IAAMU,iBAAiB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,CAAAC,IAAA,CAAG,SAAAC,QAAMC,KAAK;IAAA,IAAAC,IAAA,EAAAC,QAAA,EAAAC,iBAAA,EAAAC,OAAA,EAAAC,eAAA;IAAA,OAAAR,mBAAA,CAAAS,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OACvBV,KAAK,CAACW,QAAQ,uBAAuB;YAAEC,IAAI,EAAEvD,UAAU,CAACwD;UAAY,CAAC,CAAC;QAAA;UAAnFZ,IAAI,GAAAO,QAAA,CAAAM,IAAA;UACJZ,QAAQ,GAAGD,IAAI,CAACc,MAAM,CAAC,UAACC,CAAC;YAAA,OAAKA,CAAC,CAACC,IAAI,KAAK,OAAO;UAAA,EAAC,EACvD;UACMd,iBAAiB,GAAGD,QAAQ,CAACa,MAAM,CAAC,UAACC,CAAC;YAAA,OAAKA,CAAC,CAACE,EAAE,KAAK,MAAM;UAAA,EAAC;UAC3Dd,OAAO,GAAGF,QAAQ,CAACa,MAAM,CAAC,UAACC,CAAC;YAAA,OAAKA,CAAC,CAACZ,OAAO,KAAK,IAAI;UAAA,CAAC,CAAC;UAErDC,eAAe,GAAGD,OAAO,CAACe,MAAM,KAAK,CAAC,GAAG;YAC7CF,IAAI,EAAI,0BAA0B;YAClCG,MAAM,EAAE;cAAEF,EAAE,EAAEd,OAAO,CAAC,CAAC,CAAC,CAACc;YAAG,CAAC;YAC7B7B,KAAK,EAAG;cAAEgC,IAAI,EAAElE;YAAM;UACxB,CAAC,GAAG,IAAI;UAAA,OAAAqD,QAAA,CAAAc,MAAA,WAED;YACLpB,QAAQ,EAAEC,iBAAiB;YAC3BE,eAAe,EAAfA,eAAe;YACfD,OAAO,EAAPA;UACF,CAAC;QAAA;QAAA;UAAA,OAAAI,QAAA,CAAAe,IAAA;MAAA;IAAA,GAAAxB,OAAA;EAAA,CACF;EAAA,gBAlBYL,iBAAiBA,CAAA8B,EAAA;IAAA,OAAA7B,IAAA,CAAA8B,KAAA,OAAAC,SAAA;EAAA;AAAA,GAkB7B;AAED,OAAO,IAAMC,0BAA0B,GAAG,SAA7BA,0BAA0BA,CAAIC,KAAK,EAAE5B,KAAK,EAAK;EAC1D,IAAM6B,IAAI,GAAG,CAAC,CAAC;EAEf,SAAAC,EAAA,MAAAC,eAAA,GAA2BC,MAAM,CAACC,OAAO,CAACL,KAAK,CAAC,EAAAE,EAAA,GAAAC,eAAA,CAAAZ,MAAA,EAAAW,EAAA,IAAE;IAA7C,IAAAI,kBAAA,GAAAC,cAAA,CAAAJ,eAAA,CAAAD,EAAA;MAAOM,GAAG,GAAAF,kBAAA;MAAEG,KAAK,GAAAH,kBAAA;IACpB,IAAMI,MAAM,GAAGtC,KAAK,CAACuC,OAAO,IAAAzD,MAAA,CAAKuD,KAAK,CAACG,WAAW,gBAAc,CAACH,KAAK,CAACzB,IAAI,CAAC;;IAE5E;IACA;IACA;IACA;IACA,IAAM6B,WAAW,GAAGJ,KAAK,CAACK,eAAe,GAAGL,KAAK,CAACK,eAAe,CAACJ,MAAM,CAAC,GAAG,CAAC,CAACA,MAAM;IAEpF,IAAIG,WAAW,EAAE;MACfZ,IAAI,CAACO,GAAG,CAAC,GAAGpC,KAAK,CAACW,QAAQ,IAAA7B,MAAA,CAAKuD,KAAK,CAACG,WAAW,eAAa;QAAE5B,IAAI,EAAEyB,KAAK,CAACzB;MAAK,CAAE,CAAC;IACrF;EACF;EAEA,OAAOtD,OAAO,CAACuE,IAAI,CAAC;AACtB,CAAC;AAED,OAAO,IAAMc,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAIf,KAAK,EAAEW,OAAO,EAAK;EAClD,IAAMV,IAAI,GAAG,CAAC,CAAC;EAAC,IAAAe,KAAA,YAAAA,MAAA,EAEkC;MAA7C,IAAAC,mBAAA,GAAAV,cAAA,CAAAW,gBAAA,CAAAC,GAAA;QAAOX,GAAG,GAAAS,mBAAA;QAAER,KAAK,GAAAQ,mBAAA;MACpB,IAAMP,MAAM,GAAGC,OAAO,CAAC,sBAAsB,CAAC,CAACF,KAAK,CAACzB,IAAI,CAAC;MAE1D,IAAI,CAAC0B,MAAM,EAAE;QACXT,IAAI,CAACO,GAAG,CAAC,GAAG,KAAK;QAAC;MAGpB;;MAEA;MACA;MACA;MACA;MACA,IAAIC,KAAK,CAACK,eAAe,EAAE;QACzBb,IAAI,CAACO,GAAG,CAAC,GAAGC,KAAK,CAACK,eAAe,CAACJ,MAAM,CAAC;QAAC;MAG5C;MAEA,IAAID,KAAK,CAACW,eAAe,IAAIV,MAAM,EAAE;QACnCT,IAAI,CAACO,GAAG,CAAC,GAAGC,KAAK,CAACW,eAAe,CAACC,KAAK,CAAC,UAACC,MAAM,EAAK;UAClD,OAAO,CAACZ,MAAM,CAACU,eAAe,IAAI,EAAE,EAAEG,QAAQ,CAACD,MAAM,CAAC;QACxD,CAAC,CAAC;QAAC;MAGL;MAEA,IAAIb,KAAK,CAACe,iBAAiB,IAAId,MAAM,EAAE;QACrCT,IAAI,CAACO,GAAG,CAAC,GAAGC,KAAK,CAACe,iBAAiB,CAACH,KAAK,CAAC,UAACC,MAAM,EAAK;UACpD,OAAO,CAACZ,MAAM,CAACc,iBAAiB,IAAI,EAAE,EAAED,QAAQ,CAACD,MAAM,CAAC;QAC1D,CAAC,CAAC;QAAC;MAGL;MAEArB,IAAI,CAACO,GAAG,CAAC,GAAG,CAAC,CAACE,MAAM;IACtB,CAAC;IAAAe,IAAA;EApCD,SAAAN,GAAA,MAAAD,gBAAA,GAA2Bd,MAAM,CAACC,OAAO,CAACL,KAAK,CAAC,EAAAmB,GAAA,GAAAD,gBAAA,CAAA3B,MAAA,EAAA4B,GAAA;IAAAM,IAAA,GAAAT,KAAA;IAAA,IAAAS,IAAA,QAM5C;EAAS;EAgCb,OAAO/F,OAAO,CAACuE,IAAI,CAAC;AACtB,CAAC;AAED,OAAO,IAAMyB,eAAe,GAAG,SAAlBA,eAAeA,CAAItD,KAAK,EAAEuD,QAAQ,EAAK;EAClD;EACA,IAAMC,OAAO,GAAGxD,KAAK,CAACuC,OAAO,CAAC,cAAc,CAAC,CAACgB,QAAQ,CAAC;EACvD;EACA,IAAME,SAAS,GAAGzD,KAAK,CAACuC,OAAO,IAAAzD,MAAA,CAAK0E,OAAO,gBAAc;;EAEzD;EACA,IAAI,CAACA,OAAO,IAAI,CAACC,SAAS,EAAE;IAC1B,OAAO,KAAK;EACd;;EAEA;EACA,IAAMC,aAAa,GAAGD,SAAS,CAACF,QAAQ,CAAC,IAAIvD,KAAK,CAACuC,OAAO,CAAC,oBAAoB,CAAC,CAACgB,QAAQ,CAAC;EAE1F,OAAO,CAAC,CAACG,aAAa;AACxB,CAAC","ignoreList":[]}]}