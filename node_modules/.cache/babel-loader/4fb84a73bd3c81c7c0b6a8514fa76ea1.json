{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js??ref--17-0!/home/ubuntu/suseconf/node_modules/ts-loader/index.js??ref--17-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js","mtime":1725271299135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0IGdjIGZyb20gJy4vZ2MnOwpmdW5jdGlvbiBnZXRSZXNvdXJjZUZyb21Sb3V0ZSh0bykgewogIHZhciBfYSwgX2I7CiAgdmFyIHJlc291cmNlID0gKF9hID0gdG8ucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVzb3VyY2U7CiAgaWYgKCFyZXNvdXJjZSkgewogICAgdmFyIG1hdGNoID0gKF9iID0gdG8ubmFtZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm1hdGNoKC9eYy1jbHVzdGVyLShbXi1dKykvKTsKICAgIGlmIChtYXRjaCkgewogICAgICByZXNvdXJjZSA9IG1hdGNoWzJdOwogICAgfQogIH0KICByZXR1cm4gcmVzb3VyY2U7Cn0KLyoqCiAqIEhhbmRsZSBHQyBvbiByb3V0ZSBjaGFuZ2UgKGdpdmVuIHNldHRpbmdzIHRoaXMgbWlnaHQgYmUgYSBuby1vcCkKICovCnZhciBHYXJiYWdlQ29sbGVjdFJvdXRlQ2hhbmdlZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQpOwogIH0KICByZXR1cm4gX2NyZWF0ZUNsYXNzKEdhcmJhZ2VDb2xsZWN0Um91dGVDaGFuZ2VkLCBbewogICAga2V5OiAiZ2NSb3V0ZUNoYW5nZWQiLAogICAgdmFsdWU6CiAgICAvKioKICAgICAqIEEgbG9nZ2VkIGluIHJvdXRlIGhhcyBjaGFuZ2VkCiAgICAgKiAxKSBUcmFjayB0aGUgdGltZSB0aGlzIG9jY3VycmVkIHRvIGVuc3VyZSBhbnkgcmVzb3VyY2VzIGZldGNoZWQgYWZ0ZXJ3YXJkcyBhcmUgbm90IEdDZAogICAgICogMikgS2ljayBvZmYgYSBHQwogICAgICovCiAgICBmdW5jdGlvbiBnY1JvdXRlQ2hhbmdlZChjdHgsIHRvKSB7CiAgICAgIGdjLmdjVXBkYXRlUm91dGVDaGFuZ2VkKCk7CiAgICAgIC8vIGNvbW1pdChgZ2NSb3V0ZUNoYW5nZWRgKTsKICAgICAgaWYgKCFnYy5nY0VuYWJsZWRTZXR0aW5nKGN0eCkgfHwgIWdjLmdjRW5hYmxlZFJvdXRlKGN0eCkgfHwgdG8ubmFtZSA9PT0gJ2F1dGgtbG9nb3V0JykgewogICAgICAgIC8vIChhdXRoLWxvZ291dCBjb252ZW5pZW5jZSwgbm8gcG9pbnQgR0MnaW5nIGlmIHdlJ3ZlIGp1c3QgbG9zdCBhbGwgdHlwZXMpCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciByZXNvdXJjZSA9IGdldFJlc291cmNlRnJvbVJvdXRlKHRvKTsKICAgICAgdmFyIGlnbm9yZVRZcGVzID0gISFyZXNvdXJjZSA/IF9kZWZpbmVQcm9wZXJ0eSh7fSwgcmVzb3VyY2UsIHRydWUpIDoge307CiAgICAgIGN0eC5kaXNwYXRjaCgnZ2FyYmFnZUNvbGxlY3QnLCBpZ25vcmVUWXBlcyk7IC8vIGdjLmdhcmJhZ2VDb2xsZWN0IGlzIHBlciBzdG9yZSwgc28gZGlzcGF0Y2ggdmlhIGNlbnRyYWwgcG9pbnQKICAgIH0KICB9XSk7Cn0oKTsKdmFyIGdjcmMgPSBuZXcgR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQoKTsKZXhwb3J0IGRlZmF1bHQgZ2NyYzs="},{"version":3,"names":["gc","getResourceFromRoute","to","resource","_a","params","match","_b","name","GarbageCollectRouteChanged","_classCallCheck","_createClass","key","value","gcRouteChanged","ctx","gcUpdateRouteChanged","gcEnabledSetting","gcEnabledRoute","ignoreTYpes","_defineProperty","dispatch","gcrc"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts"],"sourcesContent":["import gc from './gc';\n\nfunction getResourceFromRoute(to: any) {\n  let resource = to.params?.resource;\n\n  if ( !resource ) {\n    const match = to.name?.match(/^c-cluster-([^-]+)/);\n\n    if ( match ) {\n      resource = match[2];\n    }\n  }\n\n  return resource;\n}\n\n/**\n * Handle GC on route change (given settings this might be a no-op)\n */\nclass GarbageCollectRouteChanged {\n  /**\n   * A logged in route has changed\n   * 1) Track the time this occurred to ensure any resources fetched afterwards are not GCd\n   * 2) Kick off a GC\n   */\n  gcRouteChanged(ctx: any, to: any) {\n    gc.gcUpdateRouteChanged();\n    // commit(`gcRouteChanged`);\n\n    if (!gc.gcEnabledSetting(ctx) || !gc.gcEnabledRoute(ctx) || to.name === 'auth-logout') {\n      // (auth-logout convenience, no point GC'ing if we've just lost all types)\n      return;\n    }\n\n    const resource = getResourceFromRoute(to);\n    const ignoreTYpes = !!resource ? { [resource]: true } : {};\n\n    ctx.dispatch('garbageCollect', ignoreTYpes); // gc.garbageCollect is per store, so dispatch via central point\n  }\n}\n\nconst gcrc = new GarbageCollectRouteChanged();\n\nexport default gcrc;\n"],"mappings":";;;;;;AAAA,OAAOA,EAAE,MAAM,MAAM;AAErB,SAASC,oBAAoBA,CAACC,EAAO;;EACnC,IAAIC,QAAQ,GAAG,CAAAC,EAAA,GAAAF,EAAE,CAACG,MAAM,cAAAD,EAAA,uBAAAA,EAAA,CAAED,QAAQ;EAElC,IAAK,CAACA,QAAQ,EAAG;IACf,IAAMG,KAAK,GAAG,CAAAC,EAAA,GAAAL,EAAE,CAACM,IAAI,cAAAD,EAAA,uBAAAA,EAAA,CAAED,KAAK,CAAC,oBAAoB,CAAC;IAElD,IAAKA,KAAK,EAAG;MACXH,QAAQ,GAAGG,KAAK,CAAC,CAAC,CAAC;;;EAIvB,OAAOH,QAAQ;AACjB;AAEA;;;AAAA,IAGMM,0BAA0B;EAAA,SAAAA,2BAAA;IAAAC,eAAA,OAAAD,0BAAA;EAAA;EAAA,OAAAE,YAAA,CAAAF,0BAAA;IAAAG,GAAA;IAAAC,KAAA;IAC9B;;;;;IAKA,SAAAC,cAAcA,CAACC,GAAQ,EAAEb,EAAO;MAC9BF,EAAE,CAACgB,oBAAoB,EAAE;MACzB;MAEA,IAAI,CAAChB,EAAE,CAACiB,gBAAgB,CAACF,GAAG,CAAC,IAAI,CAACf,EAAE,CAACkB,cAAc,CAACH,GAAG,CAAC,IAAIb,EAAE,CAACM,IAAI,KAAK,aAAa,EAAE;QACrF;QACA;;MAGF,IAAML,QAAQ,GAAGF,oBAAoB,CAACC,EAAE,CAAC;MACzC,IAAMiB,WAAW,GAAG,CAAC,CAAChB,QAAQ,GAAAiB,eAAA,KAAMjB,QAAQ,EAAG,IAAI,IAAK,EAAE;MAE1DY,GAAG,CAACM,QAAQ,CAAC,gBAAgB,EAAEF,WAAW,CAAC,CAAC,CAAC;IAC/C;EAAC;AAAA;AAGH,IAAMG,IAAI,GAAG,IAAIb,0BAA0B,EAAE;AAE7C,eAAea,IAAI","ignoreList":[]}]}