{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL2hvbWUvdWJ1bnR1L3N1c2Vjb25mL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuYWRkLWFsbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZGVsZXRlLWFsbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZGlmZmVyZW5jZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuaW50ZXJzZWN0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5pcy1kaXNqb2ludC1mcm9tLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5pcy1zdWJzZXQtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LmlzLXN1cGVyc2V0LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuc3ltbWV0cmljLWRpZmZlcmVuY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LnVuaW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwpmdW5jdGlvbiBvd25LZXlzKGUsIHIpIHsgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpOyByICYmIChvID0gby5maWx0ZXIoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTsgfSkpLCB0LnB1c2guYXBwbHkodCwgbyk7IH0gcmV0dXJuIHQ7IH0KZnVuY3Rpb24gX29iamVjdFNwcmVhZChlKSB7IGZvciAodmFyIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7IHZhciB0ID0gbnVsbCAhPSBhcmd1bWVudHNbcl0gPyBhcmd1bWVudHNbcl0gOiB7fTsgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpOyB9KTsgfSByZXR1cm4gZTsgfQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyByZXNvdXJjZU5hbWVzIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IE1BTkFHRU1FTlQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgU1VCVFlQRV9NQVBQSU5HIH0gZnJvbSAnQHNoZWxsL21vZGVscy9tYW5hZ2VtZW50LmNhdHRsZS5pby5yb2xldGVtcGxhdGUnOwp2YXIgQ0xVU1RFUiA9IFNVQlRZUEVfTUFQUElORy5DTFVTVEVSLmtleTsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB3YXJuaW5nOiAnJywKICAgICAgaW5mbzogJycKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcFN0YXRlKCdhY3Rpb24tbWVudScsIFsndG9SZW1vdmUnXSkpLCBtYXBHZXR0ZXJzKHsKICAgIHQ6ICdpMThuL3QnCiAgfSkpLCB7fSwgewogICAgbmFtZXM6IGZ1bmN0aW9uIG5hbWVzKCkgewogICAgICByZXR1cm4gdGhpcy50b1JlbW92ZS5tYXAoZnVuY3Rpb24gKG9iaikgewogICAgICAgIHJldHVybiBvYmoubmFtZURpc3BsYXk7CiAgICAgIH0pLnNsaWNlKDAsIDUpOwogICAgfSwKICAgIHBsdXNNb3JlOiBmdW5jdGlvbiBwbHVzTW9yZSgpIHsKICAgICAgdmFyIHJlbWFpbmluZyA9IHRoaXMudG9SZW1vdmUubGVuZ3RoIC0gdGhpcy5uYW1lcy5sZW5ndGg7CiAgICAgIHJldHVybiB0aGlzLnQoJ3Byb21wdFJlbW92ZS5hbmRPdGhlcnMnLCB7CiAgICAgICAgY291bnQ6IHJlbWFpbmluZwogICAgICB9KTsKICAgIH0KICB9KSwKICB3YXRjaDogewogICAgdmFsdWU6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXUpIHsKICAgICAgICB0aGlzLmhhbmRsZVJvbGVEZWxldGlvbkNoZWNrKG5ldSwgbmV1WzBdLnR5cGUsIHRoaXMuJHJvdXRlLmhhc2gpOwogICAgICB9LAogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlc291cmNlTmFtZXM6IHJlc291cmNlTmFtZXMsCiAgICBoYW5kbGVSb2xlRGVsZXRpb25DaGVjazogZnVuY3Rpb24gaGFuZGxlUm9sZURlbGV0aW9uQ2hlY2socm9sZXNUb1JlbW92ZSwgcmVzb3VyY2VUeXBlLCBxdWVyeUhhc2gpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzb3VyY2VUb0NoZWNrLCBwcm9wVG9NYXRjaCwgbnVtYmVyT2ZSb2xlc1dpdGhCaW5kcywgdW5pcXVlVXNlcnNXaXRoQmluZHMsIF91c2VycyRkYXRhLCByZXF1ZXN0LCB1c2VycywgdXNlck1hcDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMud2FybmluZyA9ICcnOwogICAgICAgICAgICAgIG51bWJlck9mUm9sZXNXaXRoQmluZHMgPSAwOwogICAgICAgICAgICAgIHVuaXF1ZVVzZXJzV2l0aEJpbmRzID0gbmV3IFNldCgpOwogICAgICAgICAgICAgIF90aGlzLmluZm8gPSBfdGhpcy50KCdyYmFjLmdsb2JhbFJvbGVzLndhaXRpbmcnLCB7CiAgICAgICAgICAgICAgICBjb3VudDogcm9sZXNUb1JlbW92ZS5sZW5ndGgKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IHJlc291cmNlVHlwZTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gX2NvbnRleHQudDAgPT09IE1BTkFHRU1FTlQuR0xPQkFMX1JPTEUgPyA3IDogMTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICByZXNvdXJjZVRvQ2hlY2sgPSBNQU5BR0VNRU5ULkdMT0JBTF9ST0xFX0JJTkRJTkc7CiAgICAgICAgICAgICAgcHJvcFRvTWF0Y2ggPSAnZ2xvYmFsUm9sZU5hbWUnOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoImJyZWFrIiwgMTMpOwogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGlmIChxdWVyeUhhc2guaW5jbHVkZXMoQ0xVU1RFUikpIHsKICAgICAgICAgICAgICAgIHJlc291cmNlVG9DaGVjayA9IE1BTkFHRU1FTlQuQ0xVU1RFUl9ST0xFX1RFTVBMQVRFX0JJTkRJTkc7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlc291cmNlVG9DaGVjayA9IE1BTkFHRU1FTlQuUFJPSkVDVF9ST0xFX1RFTVBMQVRFX0JJTkRJTkc7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHByb3BUb01hdGNoID0gJ3JvbGVUZW1wbGF0ZU5hbWUnOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoImJyZWFrIiwgMTMpOwogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMzsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9yZXF1ZXN0JywgewogICAgICAgICAgICAgICAgdXJsOiAiL3YxLyIuY29uY2F0KHJlc291cmNlVG9DaGVjayksCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIHJlcXVlc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxOTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L3JlcXVlc3QnLCB7CiAgICAgICAgICAgICAgICB1cmw6ICIvdjEvIi5jb25jYXQoTUFOQUdFTUVOVC5VU0VSKSwKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgdXNlcnMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIHVzZXJNYXAgPSAoX3VzZXJzJGRhdGEgPSB1c2Vycy5kYXRhKSA9PT0gbnVsbCB8fCBfdXNlcnMkZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3VzZXJzJGRhdGEucmVkdWNlKGZ1bmN0aW9uIChtYXAsIHVzZXIpIHsKICAgICAgICAgICAgICAgIGlmICh1c2VyLnVzZXJuYW1lKSB7CiAgICAgICAgICAgICAgICAgIG1hcFt1c2VyLmlkXSA9IHVzZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbWFwOwogICAgICAgICAgICAgIH0sIHt9KTsKICAgICAgICAgICAgICBpZiAocmVxdWVzdC5kYXRhICYmIHJlcXVlc3QuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHJvbGVzVG9SZW1vdmUuZm9yRWFjaChmdW5jdGlvbiAodG9SZW1vdmUpIHsKICAgICAgICAgICAgICAgICAgdmFyIHVzZWRSb2xlcyA9IHJlcXVlc3QuZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVtwcm9wVG9NYXRjaF0gPT09IHRvUmVtb3ZlLmlkOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgaWYgKHVzZWRSb2xlcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlVXNlcnMgPSBfdG9Db25zdW1hYmxlQXJyYXkobmV3IFNldCh1c2VkUm9sZXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS51c2VyTmFtZTsKICAgICAgICAgICAgICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyTWFwW3VzZXJdOwogICAgICAgICAgICAgICAgICAgIH0pKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVuaXF1ZVVzZXJzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgbnVtYmVyT2ZSb2xlc1dpdGhCaW5kcysrOwogICAgICAgICAgICAgICAgICAgICAgdW5pcXVlVXNlcnMuZm9yRWFjaChmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5pcXVlVXNlcnNXaXRoQmluZHMuYWRkKHVzZXIpOwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChudW1iZXJPZlJvbGVzV2l0aEJpbmRzICYmIHVuaXF1ZVVzZXJzV2l0aEJpbmRzLnNpemUpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuaW5mbyA9ICcnOwogICAgICAgICAgICAgICAgICBfdGhpcy53YXJuaW5nID0gX3RoaXMudCgncmJhYy5nbG9iYWxSb2xlcy51c2Vyc0JvdW5kJywgewogICAgICAgICAgICAgICAgICAgIGNvdW50OiB1bmlxdWVVc2Vyc1dpdGhCaW5kcy5zaXplCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuaW5mbyA9IF90aGlzLnQoJ3JiYWMuZ2xvYmFsUm9sZXMubm90Qm91bmQnLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3RoaXMuaW5mbyA9IF90aGlzLnQoJ3JiYWMuZ2xvYmFsUm9sZXMubm90Qm91bmQnLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyNDsKICAgICAgICAgICAgICBfY29udGV4dC50MSA9IF9jb250ZXh0WyJjYXRjaCJdKDEzKTsKICAgICAgICAgICAgICBfdGhpcy5pbmZvID0gX3RoaXMudCgncmJhYy5nbG9iYWxSb2xlcy51bmFibGVUb0NoZWNrJyk7CiAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEzLCAyNF1dKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["mapState","mapGetters","resourceNames","MANAGEMENT","SUBTYPE_MAPPING","CLUSTER","key","data","warning","info","computed","_objectSpread","t","names","toRemove","map","obj","nameDisplay","slice","plusMore","remaining","length","count","watch","value","handler","neu","handleRoleDeletionCheck","type","$route","hash","immediate","methods","rolesToRemove","resourceType","queryHash","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resourceToCheck","propToMatch","numberOfRolesWithBinds","uniqueUsersWithBinds","_users$data","request","users","userMap","wrap","_callee$","_context","prev","next","Set","t0","GLOBAL_ROLE","GLOBAL_ROLE_BINDING","abrupt","includes","CLUSTER_ROLE_TEMPLATE_BINDING","PROJECT_ROLE_TEMPLATE_BINDING","$store","dispatch","url","concat","method","root","sent","USER","reduce","user","username","id","forEach","usedRoles","filter","item","uniqueUsers","_toConsumableArray","userName","add","size","t1","stop"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js"],"sourcesContent":["import { mapState, mapGetters } from 'vuex';\nimport { resourceNames } from '@shell/utils/string';\nimport { MANAGEMENT } from '@shell/config/types';\nimport { SUBTYPE_MAPPING } from '@shell/models/management.cattle.io.roletemplate';\nconst CLUSTER = SUBTYPE_MAPPING.CLUSTER.key;\n\nexport default {\n  data() {\n    return {\n      warning: '',\n      info:    '',\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n  watch: {\n    value: {\n      handler(neu) {\n        this.handleRoleDeletionCheck(neu, neu[0].type, this.$route.hash);\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    resourceNames,\n    async handleRoleDeletionCheck(rolesToRemove, resourceType, queryHash) {\n      this.warning = '';\n      let resourceToCheck;\n      let propToMatch;\n      let numberOfRolesWithBinds = 0;\n      const uniqueUsersWithBinds = new Set();\n\n      this.info = this.t('rbac.globalRoles.waiting', { count: rolesToRemove.length });\n\n      switch (resourceType) {\n      case MANAGEMENT.GLOBAL_ROLE:\n        resourceToCheck = MANAGEMENT.GLOBAL_ROLE_BINDING;\n        propToMatch = 'globalRoleName';\n        break;\n      default:\n        if (queryHash.includes(CLUSTER)) {\n          resourceToCheck = MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING;\n        } else {\n          resourceToCheck = MANAGEMENT.PROJECT_ROLE_TEMPLATE_BINDING;\n        }\n        propToMatch = 'roleTemplateName';\n        break;\n      }\n\n      try {\n        const request = await this.$store.dispatch('management/request', {\n          url:    `/v1/${ resourceToCheck }`,\n          method: 'get',\n        }, { root: true });\n\n        // We need to fetch the users here in order to get an accurate count when selecting global roles.\n        const users = await this.$store.dispatch('management/request', {\n          url:    `/v1/${ MANAGEMENT.USER }`,\n          method: 'get',\n        }, { root: true });\n\n        const userMap = users.data?.reduce((map, user) => {\n          if ( user.username ) {\n            map[user.id] = user;\n          }\n\n          return map;\n        }, {});\n\n        if (request.data && request.data.length) {\n          rolesToRemove.forEach((toRemove) => {\n            const usedRoles = request.data.filter((item) => item[propToMatch] === toRemove.id);\n\n            if (usedRoles.length) {\n              const uniqueUsers = [...new Set(usedRoles.map((item) => item.userName).filter((user) => userMap[user]))];\n\n              if (uniqueUsers.length) {\n                numberOfRolesWithBinds++;\n                uniqueUsers.forEach((user) => uniqueUsersWithBinds.add(user));\n              }\n            }\n          });\n\n          if (numberOfRolesWithBinds && uniqueUsersWithBinds.size) {\n            this.info = '';\n            this.warning = this.t('rbac.globalRoles.usersBound', { count: uniqueUsersWithBinds.size });\n          } else {\n            this.info = this.t('rbac.globalRoles.notBound', null, true);\n          }\n        } else {\n          this.info = this.t('rbac.globalRoles.notBound', null, true);\n        }\n      } catch (e) {\n        this.info = this.t('rbac.globalRoles.unableToCheck');\n      }\n    },\n  },\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,QAAQ,EAAEC,UAAU,QAAQ,MAAM;AAC3C,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,UAAU,QAAQ,qBAAqB;AAChD,SAASC,eAAe,QAAQ,iDAAiD;AACjF,IAAMC,OAAO,GAAGD,eAAe,CAACC,OAAO,CAACC,GAAG;AAE3C,eAAe;EACbC,IAAI,WAAJA,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,OAAO,EAAE,EAAE;MACXC,IAAI,EAAK;IACX,CAAC;EACH,CAAC;EAEDC,QAAQ,EAAAC,aAAA,CAAAA,aAAA,CAAAA,aAAA,KACHX,QAAQ,CAAC,aAAa,EAAE,CAAC,UAAU,CAAC,CAAC,GACrCC,UAAU,CAAC;IAAEW,CAAC,EAAE;EAAS,CAAC,CAAC;IAE9BC,KAAK,WAALA,KAAKA,CAAA,EAAG;MACN,OAAO,IAAI,CAACC,QAAQ,CAACC,GAAG,CAAC,UAACC,GAAG;QAAA,OAAKA,GAAG,CAACC,WAAW;MAAA,EAAC,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;IAChE,CAAC;IAEDC,QAAQ,WAARA,QAAQA,CAAA,EAAG;MACT,IAAMC,SAAS,GAAG,IAAI,CAACN,QAAQ,CAACO,MAAM,GAAG,IAAI,CAACR,KAAK,CAACQ,MAAM;MAE1D,OAAO,IAAI,CAACT,CAAC,CAAC,wBAAwB,EAAE;QAAEU,KAAK,EAAEF;MAAU,CAAC,CAAC;IAC/D;EAAC,EACF;EACDG,KAAK,EAAE;IACLC,KAAK,EAAE;MACLC,OAAO,WAAPA,OAAOA,CAACC,GAAG,EAAE;QACX,IAAI,CAACC,uBAAuB,CAACD,GAAG,EAAEA,GAAG,CAAC,CAAC,CAAC,CAACE,IAAI,EAAE,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC;MAClE,CAAC;MACDC,SAAS,EAAE;IACb;EACF,CAAC;EACDC,OAAO,EAAE;IACP9B,aAAa,EAAbA,aAAa;IACPyB,uBAAuB,WAAvBA,uBAAuBA,CAACM,aAAa,EAAEC,YAAY,EAAEC,SAAS,EAAE;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,eAAA,EAAAC,WAAA,EAAAC,sBAAA,EAAAC,oBAAA,EAAAC,WAAA,EAAAC,OAAA,EAAAC,KAAA,EAAAC,OAAA;QAAA,OAAAV,mBAAA,CAAAW,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACpEjB,KAAI,CAAC5B,OAAO,GAAG,EAAE;cAGbmC,sBAAsB,GAAG,CAAC;cACxBC,oBAAoB,GAAG,IAAIU,GAAG,CAAC,CAAC;cAEtClB,KAAI,CAAC3B,IAAI,GAAG2B,KAAI,CAACxB,CAAC,CAAC,0BAA0B,EAAE;gBAAEU,KAAK,EAAEW,aAAa,CAACZ;cAAO,CAAC,CAAC;cAAC8B,QAAA,CAAAI,EAAA,GAExErB,YAAY;cAAAiB,QAAA,CAAAE,IAAA,GAAAF,QAAA,CAAAI,EAAA,KACfpD,UAAU,CAACqD,WAAW;cAAA;YAAA;cACzBf,eAAe,GAAGtC,UAAU,CAACsD,mBAAmB;cAChDf,WAAW,GAAG,gBAAgB;cAAC,OAAAS,QAAA,CAAAO,MAAA;YAAA;cAG/B,IAAIvB,SAAS,CAACwB,QAAQ,CAACtD,OAAO,CAAC,EAAE;gBAC/BoC,eAAe,GAAGtC,UAAU,CAACyD,6BAA6B;cAC5D,CAAC,MAAM;gBACLnB,eAAe,GAAGtC,UAAU,CAAC0D,6BAA6B;cAC5D;cACAnB,WAAW,GAAG,kBAAkB;cAAC,OAAAS,QAAA,CAAAO,MAAA;YAAA;cAAAP,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAKXjB,KAAI,CAAC0B,MAAM,CAACC,QAAQ,CAAC,oBAAoB,EAAE;gBAC/DC,GAAG,SAAAC,MAAA,CAAaxB,eAAe,CAAG;gBAClCyB,MAAM,EAAE;cACV,CAAC,EAAE;gBAAEC,IAAI,EAAE;cAAK,CAAC,CAAC;YAAA;cAHZrB,OAAO,GAAAK,QAAA,CAAAiB,IAAA;cAAAjB,QAAA,CAAAE,IAAA;cAAA,OAMOjB,KAAI,CAAC0B,MAAM,CAACC,QAAQ,CAAC,oBAAoB,EAAE;gBAC7DC,GAAG,SAAAC,MAAA,CAAa9D,UAAU,CAACkE,IAAI,CAAG;gBAClCH,MAAM,EAAE;cACV,CAAC,EAAE;gBAAEC,IAAI,EAAE;cAAK,CAAC,CAAC;YAAA;cAHZpB,KAAK,GAAAI,QAAA,CAAAiB,IAAA;cAKLpB,OAAO,IAAAH,WAAA,GAAGE,KAAK,CAACxC,IAAI,cAAAsC,WAAA,uBAAVA,WAAA,CAAYyB,MAAM,CAAC,UAACvD,GAAG,EAAEwD,IAAI,EAAK;gBAChD,IAAKA,IAAI,CAACC,QAAQ,EAAG;kBACnBzD,GAAG,CAACwD,IAAI,CAACE,EAAE,CAAC,GAAGF,IAAI;gBACrB;gBAEA,OAAOxD,GAAG;cACZ,CAAC,EAAE,CAAC,CAAC,CAAC;cAEN,IAAI+B,OAAO,CAACvC,IAAI,IAAIuC,OAAO,CAACvC,IAAI,CAACc,MAAM,EAAE;gBACvCY,aAAa,CAACyC,OAAO,CAAC,UAAC5D,QAAQ,EAAK;kBAClC,IAAM6D,SAAS,GAAG7B,OAAO,CAACvC,IAAI,CAACqE,MAAM,CAAC,UAACC,IAAI;oBAAA,OAAKA,IAAI,CAACnC,WAAW,CAAC,KAAK5B,QAAQ,CAAC2D,EAAE;kBAAA,EAAC;kBAElF,IAAIE,SAAS,CAACtD,MAAM,EAAE;oBACpB,IAAMyD,WAAW,GAAAC,kBAAA,CAAO,IAAIzB,GAAG,CAACqB,SAAS,CAAC5D,GAAG,CAAC,UAAC8D,IAAI;sBAAA,OAAKA,IAAI,CAACG,QAAQ;oBAAA,EAAC,CAACJ,MAAM,CAAC,UAACL,IAAI;sBAAA,OAAKvB,OAAO,CAACuB,IAAI,CAAC;oBAAA,EAAC,CAAC,CAAC;oBAExG,IAAIO,WAAW,CAACzD,MAAM,EAAE;sBACtBsB,sBAAsB,EAAE;sBACxBmC,WAAW,CAACJ,OAAO,CAAC,UAACH,IAAI;wBAAA,OAAK3B,oBAAoB,CAACqC,GAAG,CAACV,IAAI,CAAC;sBAAA,EAAC;oBAC/D;kBACF;gBACF,CAAC,CAAC;gBAEF,IAAI5B,sBAAsB,IAAIC,oBAAoB,CAACsC,IAAI,EAAE;kBACvD9C,KAAI,CAAC3B,IAAI,GAAG,EAAE;kBACd2B,KAAI,CAAC5B,OAAO,GAAG4B,KAAI,CAACxB,CAAC,CAAC,6BAA6B,EAAE;oBAAEU,KAAK,EAAEsB,oBAAoB,CAACsC;kBAAK,CAAC,CAAC;gBAC5F,CAAC,MAAM;kBACL9C,KAAI,CAAC3B,IAAI,GAAG2B,KAAI,CAACxB,CAAC,CAAC,2BAA2B,EAAE,IAAI,EAAE,IAAI,CAAC;gBAC7D;cACF,CAAC,MAAM;gBACLwB,KAAI,CAAC3B,IAAI,GAAG2B,KAAI,CAACxB,CAAC,CAAC,2BAA2B,EAAE,IAAI,EAAE,IAAI,CAAC;cAC7D;cAACuC,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAgC,EAAA,GAAAhC,QAAA;cAEDf,KAAI,CAAC3B,IAAI,GAAG2B,KAAI,CAACxB,CAAC,CAAC,gCAAgC,CAAC;YAAC;YAAA;cAAA,OAAAuC,QAAA,CAAAiC,IAAA;UAAA;QAAA,GAAA5C,OAAA;MAAA;IAEzD;EACF;AACF,CAAC","ignoreList":[]}]}