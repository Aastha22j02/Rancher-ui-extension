{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js??ref--17-0!/home/ubuntu/suseconf/node_modules/ts-loader/index.js??ref--17-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js","mtime":1725271299135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL2hvbWUvdWJ1bnR1L3N1c2Vjb25mL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHQpKSA6IG93bktleXMoT2JqZWN0KHQpKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTsgfSk7IH0gcmV0dXJuIGU7IH0KaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKLyogZXNsaW50LWRpc2FibGUgamVzdC9uby1ob29rcyAqLwppbXBvcnQgeyBtb3VudCB9IGZyb20gJ0B2dWUvdGVzdC11dGlscyc7CmltcG9ydCB7IF9FRElUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgb2lkYyBmcm9tICdAc2hlbGwvZWRpdC9hdXRoL29pZGMudnVlJzsKamVzdC5tb2NrKCdAc2hlbGwvdXRpbHMvY2xpcGJvYXJkJywgZnVuY3Rpb24gKCkgewogIHJldHVybiB7CiAgICBjb3B5VGV4dFRvQ2xpcGJvYXJkOiBqZXN0LmZuKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7fSk7CiAgICB9KQogIH07Cn0pOwp2YXIgdmFsaWRDbGllbnRJZCA9ICdyYW5jaGVyb2lkYyc7CnZhciB2YWxpZENsaWVudFNlY3JldCA9ICdUT2tVeGcwUDY3bTFVWFdOa0pMSERQa1VaRklLT1dTcSc7CnZhciB2YWxpZFVybCA9ICdodHRwczovL2xvY2FsaG9zdDo4MDgwJzsKdmFyIHZhbGlkUmVhbG0gPSAncmFuY2hlcnJlYWxtJzsKdmFyIHZhbGlkUmFuY2hlclVybCA9ICdodHRwczovL2xvY2FsaG9zdC92ZXJpZnktYXV0aCc7CnZhciB2YWxpZElzc3VlciA9ICdodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL3JhbmNoZXJyZWFsbSc7CnZhciB2YWxpZEF1dGhFbmRwb2ludCA9ICdodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL3JhbmNoZXJyZWFsbS9wcm90b2NvbC9vcGVuaWQtY29ubmVjdC9hdXRoJzsKdmFyIHZhbGlkU2NvcGUgPSAnb3BlbmlkIHByb2ZpbGUgZW1haWwnOwp2YXIgbW9ja01vZGVsID0gewogIGVuYWJsZWQ6IGZhbHNlLAogIGlkOiAnZ2VuZXJpY29pZGMnLAogIHJhbmNoZXJVcmw6IHZhbGlkUmFuY2hlclVybCwKICBpc3N1ZXI6IHZhbGlkSXNzdWVyLAogIGF1dGhFbmRwb2ludDogdmFsaWRBdXRoRW5kcG9pbnQsCiAgc2NvcGU6IHZhbGlkU2NvcGUsCiAgY2xpZW50SWQ6IHZhbGlkQ2xpZW50SWQsCiAgY2xpZW50U2VjcmV0OiB2YWxpZENsaWVudFNlY3JldCwKICB0eXBlOiAnZ2VuZXJpY09JRENDb25maWcnCn07CnZhciBtb2NrZWRBdXRoQ29uZmlnTWl4aW4gPSB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzRW5hYmxpbmc6IGZhbHNlLAogICAgICBlZGl0Q29uZmlnOiBmYWxzZSwKICAgICAgbW9kZWw6IF9vYmplY3RTcHJlYWQoe30sIG1vY2tNb2RlbCksCiAgICAgIHNlcnZlclNldHRpbmc6IG51bGwsCiAgICAgIGVycm9yczogW10sCiAgICAgIG9yaWdpbmFsTW9kZWw6IG51bGwsCiAgICAgIHByaW5jaXBhbHM6IFtdLAogICAgICBhdXRoQ29uZmlnTmFtZTogJ29pZGMnCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIG1ldGhvZHM6IHt9Cn07CmRlc2NyaWJlKCdvaWRjLnZ1ZScsIGZ1bmN0aW9uICgpIHsKICB2YXIgd3JhcHBlcjsKICB2YXIgcmVxdWlyZWRTZXR1cCA9IGZ1bmN0aW9uIHJlcXVpcmVkU2V0dXAoKSB7CiAgICByZXR1cm4gewogICAgICBtaXhpbnM6IFttb2NrZWRBdXRoQ29uZmlnTWl4aW5dLAogICAgICBtb2NrczogewogICAgICAgICRmZXRjaFN0YXRlOiB7CiAgICAgICAgICBwZW5kaW5nOiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgJHN0b3JlOiB7CiAgICAgICAgICBnZXR0ZXJzOiB7CiAgICAgICAgICAgIGN1cnJlbnRTdG9yZTogZnVuY3Rpb24gY3VycmVudFN0b3JlKCkgewogICAgICAgICAgICAgIHJldHVybiAnY3VycmVudF9zdG9yZSc7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdjdXJyZW50X3N0b3JlL3NjaGVtYUZvcic6IGplc3QuZm4oKSwKICAgICAgICAgICAgJ2N1cnJlbnRfc3RvcmUvYWxsJzogamVzdC5mbigpLAogICAgICAgICAgICAnaTE4bi90JzogZnVuY3Rpb24gaTE4bl90KHZhbCkgewogICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdpMThuL2V4aXN0cyc6IGplc3QuZm4oKQogICAgICAgICAgfSwKICAgICAgICAgIGRpc3BhdGNoOiBqZXN0LmZuKCkKICAgICAgICB9LAogICAgICAgICRyb3V0ZTogewogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgQVM6ICcnCiAgICAgICAgICB9LAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGlkOiAnb2ljZCcKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICRyb3V0ZXI6IHsKICAgICAgICAgIGFwcGx5UXVlcnk6IGplc3QuZm4oKQogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJvcHNEYXRhOiB7CiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIGFwcGxpY2F0aW9uU2VjcmV0OiAnJwogICAgICAgIH0sCiAgICAgICAgbW9kZTogX0VESVQKICAgICAgfQogICAgfTsKICB9OwogIGJlZm9yZUVhY2goZnVuY3Rpb24gKCkgewogICAgd3JhcHBlciA9IG1vdW50KG9pZGMsIF9vYmplY3RTcHJlYWQoe30sIHJlcXVpcmVkU2V0dXAoKSkpOwogIH0pOwogIGFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgICB3cmFwcGVyLmRlc3Ryb3koKTsKICB9KTsKICBpdCgnaGF2ZSAiQ3JlYXRlIiBidXR0b24gZW5hYmxlZCB3aGVuIHByb3ZpZGVyIGlzIGVuYWJsZWQgYW5kIG5vdCBlZGl0aW5nIGNvbmZpZycsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICB2YXIgc2F2ZUJ1dHRvbjsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB3cmFwcGVyLnNldERhdGEoewogICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZWRpdENvbmZpZzogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICByZXR1cm4gd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzYXZlQnV0dG9uID0gd3JhcHBlci5maW5kKCdbZGF0YS10ZXN0aWQ9ImZvcm0tc2F2ZSJdJykuZWxlbWVudDsKICAgICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgICAgICBjYXNlIDU6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKSk7CiAgaXQoJ2hhdmUgIkNyZWF0ZSIgYnV0dG9uIGRpc2FibGVkIHdoZW4gcHJvdmlkZXIgaXMgZGlzYWJsZWQgYW5kIGVkaXRpbmcgY29uZmlnIGJlZm9yZSBmaWVsZHMgYXJlIGZpbGxlZCBpbicsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgdmFyIHNhdmVCdXR0b247CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHdyYXBwZXIuc2V0RGF0YSh7CiAgICAgICAgICAgIG1vZGVsOiB7fSwKICAgICAgICAgICAgZWRpdENvbmZpZzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICByZXR1cm4gd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzYXZlQnV0dG9uID0gd3JhcHBlci5maW5kKCdbZGF0YS10ZXN0aWQ9ImZvcm0tc2F2ZSJdJykuZWxlbWVudDsKICAgICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKHRydWUpOwogICAgICAgIGNhc2UgNToKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSkpOwogIGl0KCdoYXZlICJDcmVhdGUiIGJ1dHRvbiBkaXNhYmxlZCB3aGVuIHByb3ZpZGVyIGlzIGRpc2FibGVkIGFuZCBlZGl0aW5nIGNvbmZpZyBhZnRlciByZXF1aXJlZCBmaWVsZHMgYW5kIHNjb3BlIGlzIG1pc3Npbmcgb3BlbmlkJywgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICB2YXIgc2F2ZUJ1dHRvbjsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgd3JhcHBlci5zZXREYXRhKHsKICAgICAgICAgICAgb2lkY1VybHM6IHsKICAgICAgICAgICAgICB1cmw6IHZhbGlkVXJsLAogICAgICAgICAgICAgIHJlYWxtOiB2YWxpZFJlYWxtCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgcmV0dXJuIHdyYXBwZXIudm0uJG5leHRUaWNrKCk7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgc2F2ZUJ1dHRvbiA9IHdyYXBwZXIuZmluZCgnW2RhdGEtdGVzdGlkPSJmb3JtLXNhdmUiXScpLmVsZW1lbnQ7CiAgICAgICAgICBleHBlY3Qoc2F2ZUJ1dHRvbi5kaXNhYmxlZCkudG9CZSh0cnVlKTsKICAgICAgICBjYXNlIDU6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlMyk7CiAgfSkpKTsKICBpdCgnaGF2ZSAiQ3JlYXRlIiBidXR0b24gZW5hYmxlZCB3aGVuIGN1c3RvbUVuZHBvaW50IGlzIGRpc2FibGVkIGFuZCByZXF1aXJlZCBmaWVsZHMgYXJlIGZpbGxlZCBpbicsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgdmFyIHNhdmVCdXR0b247CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHdyYXBwZXIuc2V0RGF0YSh7CiAgICAgICAgICAgIG9pZGNVcmxzOiB7CiAgICAgICAgICAgICAgdXJsOiB2YWxpZFVybCwKICAgICAgICAgICAgICByZWFsbTogdmFsaWRSZWFsbQogICAgICAgICAgICB9LAogICAgICAgICAgICBvaWRjU2NvcGU6IHZhbGlkU2NvcGUuc3BsaXQoJyAnKQogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICByZXR1cm4gd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzYXZlQnV0dG9uID0gd3JhcHBlci5maW5kKCdbZGF0YS10ZXN0aWQ9ImZvcm0tc2F2ZSJdJykuZWxlbWVudDsKICAgICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgICAgICBjYXNlIDU6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlNCk7CiAgfSkpKTsKICBpdCgnaGF2ZSAiQ3JlYXRlIiBidXR0b24gZW5hYmxlZCB3aGVuIGN1c3RvbUVuZHBvaW50IGlzIGVuYWJsZWQgYW5kIHJlcXVpcmVkIGZpZWxkcyBhcmUgZmlsbGVkIGluJywgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICB2YXIgc2F2ZUJ1dHRvbjsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgd3JhcHBlci5zZXREYXRhKHsKICAgICAgICAgICAgY3VzdG9tRW5kcG9pbnQ6IHsKICAgICAgICAgICAgICB2YWx1ZTogdHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICBvaWRjU2NvcGU6IHZhbGlkU2NvcGUuc3BsaXQoJyAnKQogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICByZXR1cm4gd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzYXZlQnV0dG9uID0gd3JhcHBlci5maW5kKCdbZGF0YS10ZXN0aWQ9ImZvcm0tc2F2ZSJdJykuZWxlbWVudDsKICAgICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgICAgICBjYXNlIDU6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlNSk7CiAgfSkpKTsKICBpdCgndXBkYXRlcyBpc3N1ZXIgZW5kcG9pbnQgd2hlbiBvaWRjVXJscy51cmwgYW5kIG9pZGNVcmxzLnJlYWxtIGNoYW5nZXMnLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgd3JhcHBlci5zZXREYXRhKHsKICAgICAgICAgICAgb2lkY1VybHM6IHsKICAgICAgICAgICAgICB1cmw6IHZhbGlkVXJsCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgcmV0dXJuIHdyYXBwZXIudm0uJG5leHRUaWNrKCk7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgZXhwZWN0KHdyYXBwZXIudm0ubW9kZWwuaXNzdWVyKS50b0JlKCIiLmNvbmNhdCh2YWxpZFVybCwgIi9yZWFsbXMvIikpOwogICAgICAgICAgd3JhcHBlci5zZXREYXRhKHsKICAgICAgICAgICAgb2lkY1VybHM6IHsKICAgICAgICAgICAgICByZWFsbTogdmFsaWRSZWFsbQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNzsKICAgICAgICAgIHJldHVybiB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGNhc2UgNzoKICAgICAgICAgIGV4cGVjdCh3cmFwcGVyLnZtLm1vZGVsLmlzc3VlcikudG9CZSgiIi5jb25jYXQodmFsaWRVcmwsICIvcmVhbG1zLyIpLmNvbmNhdCh2YWxpZFJlYWxtKSk7CiAgICAgICAgY2FzZSA4OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgfQogICAgfSwgX2NhbGxlZTYpOwogIH0pKSk7Cn0pOw=="},{"version":3,"names":["mount","_EDIT","oidc","jest","mock","copyTextToClipboard","fn","Promise","resolve","validClientId","validClientSecret","validUrl","validRealm","validRancherUrl","validIssuer","validAuthEndpoint","validScope","mockModel","enabled","id","rancherUrl","issuer","authEndpoint","scope","clientId","clientSecret","type","mockedAuthConfigMixin","data","isEnabling","editConfig","model","_objectSpread","serverSetting","errors","originalModel","principals","authConfigName","computed","methods","describe","wrapper","requiredSetup","mixins","mocks","$fetchState","pending","$store","getters","currentStore","i18n_t","val","dispatch","$route","query","AS","params","$router","applyQuery","propsData","value","applicationSecret","mode","beforeEach","afterEach","destroy","it","_asyncToGenerator","_regeneratorRuntime","mark","_callee","saveButton","wrap","_callee$","_context","prev","next","setData","vm","$nextTick","find","element","expect","disabled","toBe","stop","_callee2","_callee2$","_context2","_callee3","_callee3$","_context3","oidcUrls","url","realm","_callee4","_callee4$","_context4","oidcScope","split","_callee5","_callee5$","_context5","customEndpoint","_callee6","_callee6$","_context6","concat"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts"],"sourcesContent":["/* eslint-disable jest/no-hooks */\nimport { mount } from '@vue/test-utils';\nimport { _EDIT } from '@shell/config/query-params';\n\nimport oidc from '@shell/edit/auth/oidc.vue';\n\njest.mock('@shell/utils/clipboard', () => {\n  return { copyTextToClipboard: jest.fn(() => Promise.resolve({})) };\n});\n\nconst validClientId = 'rancheroidc';\nconst validClientSecret = 'TOkUxg0P67m1UXWNkJLHDPkUZFIKOWSq';\nconst validUrl = 'https://localhost:8080';\nconst validRealm = 'rancherrealm';\nconst validRancherUrl = 'https://localhost/verify-auth';\nconst validIssuer = 'http://localhost:8080/realms/rancherrealm';\nconst validAuthEndpoint = 'http://localhost:8080/realms/rancherrealm/protocol/openid-connect/auth';\nconst validScope = 'openid profile email';\n\nconst mockModel = {\n  enabled:      false,\n  id:           'genericoidc',\n  rancherUrl:   validRancherUrl,\n  issuer:       validIssuer,\n  authEndpoint: validAuthEndpoint,\n  scope:        validScope,\n  clientId:     validClientId,\n  clientSecret: validClientSecret,\n  type:         'genericOIDCConfig',\n};\n\nconst mockedAuthConfigMixin = {\n  data() {\n    return {\n      isEnabling:     false,\n      editConfig:     false,\n      model:          { ...mockModel },\n      serverSetting:  null,\n      errors:         [],\n      originalModel:  null,\n      principals:     [],\n      authConfigName: 'oidc',\n    };\n  },\n  computed: {},\n  methods:  {}\n};\n\ndescribe('oidc.vue', () => {\n  let wrapper: any;\n  const requiredSetup = () => ({\n    mixins: [mockedAuthConfigMixin],\n    mocks:  {\n      $fetchState: { pending: false },\n      $store:      {\n        getters: {\n          currentStore:              () => 'current_store',\n          'current_store/schemaFor': jest.fn(),\n          'current_store/all':       jest.fn(),\n          'i18n/t':                  (val: string) => val,\n          'i18n/exists':             jest.fn(),\n        },\n        dispatch: jest.fn()\n      },\n      $route:  { query: { AS: '' }, params: { id: 'oicd' } },\n      $router: { applyQuery: jest.fn() },\n    },\n    propsData: {\n      value: { applicationSecret: '' },\n      mode:  _EDIT,\n    },\n  });\n\n  beforeEach(() => {\n    wrapper = mount(oidc, { ...requiredSetup() });\n  });\n  afterEach(() => {\n    wrapper.destroy();\n  });\n\n  it('have \"Create\" button enabled when provider is enabled and not editing config', async() => {\n    wrapper.setData({ model: { enabled: true }, editConfig: false });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('have \"Create\" button disabled when provider is disabled and editing config before fields are filled in', async() => {\n    wrapper.setData({ model: {}, editConfig: true });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(true);\n  });\n\n  it('have \"Create\" button disabled when provider is disabled and editing config after required fields and scope is missing openid', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl, realm: validRealm } });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(true);\n  });\n\n  it('have \"Create\" button enabled when customEndpoint is disabled and required fields are filled in', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl, realm: validRealm }, oidcScope: validScope.split(' ') });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('have \"Create\" button enabled when customEndpoint is enabled and required fields are filled in', async() => {\n    wrapper.setData({ customEndpoint: { value: true }, oidcScope: validScope.split(' ') });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('updates issuer endpoint when oidcUrls.url and oidcUrls.realm changes', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl } });\n    await wrapper.vm.$nextTick();\n\n    expect(wrapper.vm.model.issuer).toBe(`${ validUrl }/realms/`);\n\n    wrapper.setData({ oidcUrls: { realm: validRealm } });\n    await wrapper.vm.$nextTick();\n\n    expect(wrapper.vm.model.issuer).toBe(`${ validUrl }/realms/${ validRealm }`);\n  });\n});\n"],"mappings":"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","ignoreList":[]}]}