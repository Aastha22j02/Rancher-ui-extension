{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/models/cis.cattle.io.clusterscanreport.js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/models/cis.cattle.io.clusterscanreport.js","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5jb25zdHJ1Y3QuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmZ1bmN0aW9uIF9jYWxsU3VwZXIodCwgbywgZSkgeyByZXR1cm4gbyA9IF9nZXRQcm90b3R5cGVPZihvKSwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odCwgX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpID8gUmVmbGVjdC5jb25zdHJ1Y3QobywgZSB8fCBbXSwgX2dldFByb3RvdHlwZU9mKHQpLmNvbnN0cnVjdG9yKSA6IG8uYXBwbHkodCwgZSkpOyB9CmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IHRyeSB7IHZhciB0ID0gIUJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgfSBjYXRjaCAodCkge30gcmV0dXJuIChfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgcmV0dXJuICEhdDsgfSkoKTsgfQppbXBvcnQgeyBjb21wYXJlIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3NvcnQnOwppbXBvcnQgU3RldmVNb2RlbCBmcm9tICdAc2hlbGwvcGx1Z2lucy9zdGV2ZS9zdGV2ZS1jbGFzcyc7CnZhciBDSVNSZXBvcnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGV2ZU1vZGVsKSB7CiAgZnVuY3Rpb24gQ0lTUmVwb3J0KCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENJU1JlcG9ydCk7CiAgICByZXR1cm4gX2NhbGxTdXBlcih0aGlzLCBDSVNSZXBvcnQsIGFyZ3VtZW50cyk7CiAgfQogIF9pbmhlcml0cyhDSVNSZXBvcnQsIF9TdGV2ZU1vZGVsKTsKICByZXR1cm4gX2NyZWF0ZUNsYXNzKENJU1JlcG9ydCwgW3sKICAgIGtleTogImFnZ3JlZ2F0ZWRUZXN0cyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIGpzb24gPSB0aGlzLnBhcnNlZFJlcG9ydDsKICAgICAgdmFyIHJlc3VsdHMgPSBqc29uID09PSBudWxsIHx8IGpzb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGpzb24ucmVzdWx0czsKICAgICAgdmFyIGZsYXR0ZW5lZCA9IHJlc3VsdHMgPyByZXN1bHRzLnJlZHVjZShmdW5jdGlvbiAoYWxsLCBlYWNoKSB7CiAgICAgICAgaWYgKGVhY2guY2hlY2tzKSB7CiAgICAgICAgICBhbGwucHVzaC5hcHBseShhbGwsIF90b0NvbnN1bWFibGVBcnJheShlYWNoLmNoZWNrcykpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWxsOwogICAgICB9LCBbXSkgOiBudWxsOwogICAgICB2YXIgc29ydGFibGVJZCA9IGZ1bmN0aW9uIHNvcnRhYmxlSWQoaWQpIHsKICAgICAgICByZXR1cm4gKGlkIHx8ICcnKS5zcGxpdCgnLicpLm1hcChmdW5jdGlvbiAobikgewogICAgICAgICAgcmV0dXJuICtuICsgMTAwMDsKICAgICAgICB9KS5qb2luKCcuJyk7CiAgICAgIH07CiAgICAgIHZhciBzb3J0YWJsZVN0YXRlID0gZnVuY3Rpb24gc29ydGFibGVTdGF0ZShzdGF0ZSkgewogICAgICAgIHZhciBTT1JUX09SREVSID0gewogICAgICAgICAgb3RoZXI6IDcsCiAgICAgICAgICBub3RBcHBsaWNhYmxlOiA2LAogICAgICAgICAgc2tpcDogNSwKICAgICAgICAgIHBhc3M6IDQsCiAgICAgICAgICB3YXJuOiAzLAogICAgICAgICAgbWl4ZWQ6IDIsCiAgICAgICAgICBmYWlsOiAxCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KFNPUlRfT1JERVJbc3RhdGVdIHx8IFNPUlRfT1JERVJbJ290aGVyJ10sICIgIikuY29uY2F0KHN0YXRlKTsKICAgICAgfTsKICAgICAgdmFyIHNvcnRlZCA9IGZsYXR0ZW5lZC5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICB2YXIgc3RhdGVTb3J0ID0gY29tcGFyZShzb3J0YWJsZVN0YXRlKGEuc3RhdGUpLCBzb3J0YWJsZVN0YXRlKGIuc3RhdGUpKTsKICAgICAgICB2YXIgaWRTb3J0ID0gY29tcGFyZShzb3J0YWJsZUlkKGEuaWQpLCBzb3J0YWJsZUlkKGIuaWQpKTsKICAgICAgICBpZiAoc3RhdGVTb3J0KSB7CiAgICAgICAgICByZXR1cm4gc3RhdGVTb3J0OwogICAgICAgIH0KICAgICAgICByZXR1cm4gaWRTb3J0OwogICAgICB9KTsKICAgICAgcmV0dXJuIHNvcnRlZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJub2RlcyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyc2VkUmVwb3J0ID8gdGhpcy5wYXJzZWRSZXBvcnQubm9kZXMgOiB7fTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXJzZWRSZXBvcnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIF90aGlzJHNwZWM7CiAgICAgICAgdmFyIGpzb24gPSAoX3RoaXMkc3BlYyA9IHRoaXMuc3BlYykgPT09IG51bGwgfHwgX3RoaXMkc3BlYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3BlYy5yZXBvcnRKU09OOwogICAgICAgIHZhciBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb24pOwogICAgICAgIHJldHVybiBwYXJzZWQ7CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH1dKTsKfShTdGV2ZU1vZGVsKTsKZXhwb3J0IHsgQ0lTUmVwb3J0IGFzIGRlZmF1bHQgfTs="},{"version":3,"names":["compare","SteveModel","CISReport","_SteveModel","_classCallCheck","_callSuper","arguments","_inherits","_createClass","key","get","json","parsedReport","results","flattened","reduce","all","each","checks","push","apply","_toConsumableArray","sortableId","id","split","map","n","join","sortableState","state","SORT_ORDER","other","notApplicable","skip","pass","warn","mixed","fail","concat","sorted","slice","sort","a","b","stateSort","idSort","nodes","_this$spec","spec","reportJSON","parsed","JSON","parse","e","default"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/models/cis.cattle.io.clusterscanreport.js"],"sourcesContent":["import { compare } from '@shell/utils/sort';\nimport SteveModel from '@shell/plugins/steve/steve-class';\n\nexport default class CISReport extends SteveModel {\n  get aggregatedTests() {\n    const json = this.parsedReport;\n    const results = json?.results;\n\n    const flattened = results ? results.reduce((all, each) => {\n      if (each.checks) {\n        all.push(...each.checks);\n      }\n\n      return all;\n    }, []) : null;\n\n    const sortableId = (id) => (id || '').split('.').map((n) => +n + 1000).join('.');\n    const sortableState = (state) => {\n      const SORT_ORDER = {\n        other:         7,\n        notApplicable: 6,\n        skip:          5,\n        pass:          4,\n        warn:          3,\n        mixed:         2,\n        fail:          1,\n      };\n\n      return `${ SORT_ORDER[state] || SORT_ORDER['other'] } ${ state }`;\n    };\n\n    const sorted = flattened.slice().sort((a, b) => {\n      const stateSort = compare(sortableState(a.state), sortableState(b.state));\n      const idSort = compare(sortableId(a.id), sortableId(b.id));\n\n      if (stateSort) {\n        return stateSort;\n      }\n\n      return idSort;\n    });\n\n    return sorted;\n  }\n\n  get nodes() {\n    return this.parsedReport ? this.parsedReport.nodes : {};\n  }\n\n  get parsedReport() {\n    try {\n      const json = this.spec?.reportJSON;\n\n      const parsed = JSON.parse(json);\n\n      return parsed;\n    } catch (e) {\n    }\n\n    return null;\n  }\n}\n"],"mappings":"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","ignoreList":[]}]}