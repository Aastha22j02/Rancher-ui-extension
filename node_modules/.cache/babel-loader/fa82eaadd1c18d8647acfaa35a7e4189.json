{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/gatekeeper/util.js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/gatekeeper/util.js","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/babel.config.js","mtime":1725268750245},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tICIvaG9tZS91YnVudHUvc3VzZWNvbi0yMDI0LWV4dC1kZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvci9pbmRleC5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnVuc2NvcGFibGVzLmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgeyBHQVRFS0VFUEVSLCBTQ0hFTUEgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKZXhwb3J0IGZ1bmN0aW9uIGZpbmRBbGxDb25zdHJhaW50cyhfeCkgewogIHJldHVybiBfZmluZEFsbENvbnN0cmFpbnRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KZnVuY3Rpb24gX2ZpbmRBbGxDb25zdHJhaW50cygpIHsKICBfZmluZEFsbENvbnN0cmFpbnRzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShzdG9yZSkgewogICAgdmFyIGNvbnN0cmFpbnRUeXBlcywgbmVzdGVkQ29uc3RyYWludHM7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICByZXR1cm4gZmluZEFsbENvbnN0cmFpbnRUeXBlcyhzdG9yZSk7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgY29uc3RyYWludFR5cGVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgIG5lc3RlZENvbnN0cmFpbnRzID0gY29uc3RyYWludFR5cGVzLm1hcChmdW5jdGlvbiAoY3QpIHsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmRBbGwnLCB7CiAgICAgICAgICAgICAgdHlwZTogY3QsCiAgICAgICAgICAgICAgb3B0OiB7CiAgICAgICAgICAgICAgICBmb3JjZTogdHJ1ZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKG5lc3RlZENvbnN0cmFpbnRzKTsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dC5zZW50LmZsYXQoKSk7CiAgICAgICAgY2FzZSA3OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9maW5kQWxsQ29uc3RyYWludHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQpleHBvcnQgZnVuY3Rpb24gZmluZEFsbENvbnN0cmFpbnRUeXBlcyhzdG9yZSkgewogIHZhciBzY2hlbWFzID0gc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9hbGwnXShTQ0hFTUEpOwogIHJldHVybiBmaW5kQ29uc3RyYWludFR5cGVzKHNjaGVtYXMpOwp9CmV4cG9ydCBmdW5jdGlvbiBmaW5kQWxsVGVtcGxhdGVzKHN0b3JlKSB7CiAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmRBbGwnLCB7CiAgICB0eXBlOiBHQVRFS0VFUEVSLkNPTlNUUkFJTlRfVEVNUExBVEUKICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gZmluZFRlbXBsYXRlVHlwZShzY2hlbWFzKSB7CiAgLy8gQFRPRE8gdGhpcyB3aWxsIGp1c3QgYmUgYSByZWd1bGFyIHNpbmdsZSB0eXBlIG5vdyB0aGF0IHRoZSBzZXJ2ZXIgZmlsdGVycyB0byBwcmVmZXJyZWQgdmVyc2lvbgogIC8vIHNvIHlvdSBjYW4ganVzdCBhZGQgdGVtcGxhdGVzLmdhdGVrZWVwZXIuc2guY29uc3RyYWludHRlbXBsYXRlIGFzIGEgY29uc3RhbnQgaW4gdHlwZXMuanMKICB2YXIgdGVtcGxhdGUgPSBzY2hlbWFzLmZpbmQoZnVuY3Rpb24gKHNjaGVtYSkgewogICAgdmFyIF9zY2hlbWEkYXR0cmlidXRlcywgX3NjaGVtYSRhdHRyaWJ1dGVzMjsKICAgIHJldHVybiAoc2NoZW1hID09PSBudWxsIHx8IHNjaGVtYSA9PT0gdm9pZCAwIHx8IChfc2NoZW1hJGF0dHJpYnV0ZXMgPSBzY2hlbWEuYXR0cmlidXRlcykgPT09IG51bGwgfHwgX3NjaGVtYSRhdHRyaWJ1dGVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2NoZW1hJGF0dHJpYnV0ZXMuZ3JvdXApID09PSAndGVtcGxhdGVzLmdhdGVrZWVwZXIuc2gnICYmIChzY2hlbWEgPT09IG51bGwgfHwgc2NoZW1hID09PSB2b2lkIDAgfHwgKF9zY2hlbWEkYXR0cmlidXRlczIgPSBzY2hlbWEuYXR0cmlidXRlcykgPT09IG51bGwgfHwgX3NjaGVtYSRhdHRyaWJ1dGVzMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3NjaGVtYSRhdHRyaWJ1dGVzMi5raW5kKSA9PT0gJ0NvbnN0cmFpbnRUZW1wbGF0ZSc7CiAgfSk7CiAgcmV0dXJuIHRlbXBsYXRlID09PSBudWxsIHx8IHRlbXBsYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZW1wbGF0ZS5pZDsKfQpmdW5jdGlvbiBmaW5kQ29uc3RyYWludFR5cGVzKHNjaGVtYXMpIHsKICByZXR1cm4gc2NoZW1hcy5maWx0ZXIoZnVuY3Rpb24gKHNjaGVtYSkgewogICAgdmFyIF9zY2hlbWEkYXR0cmlidXRlczM7CiAgICByZXR1cm4gKHNjaGVtYSA9PT0gbnVsbCB8fCBzY2hlbWEgPT09IHZvaWQgMCB8fCAoX3NjaGVtYSRhdHRyaWJ1dGVzMyA9IHNjaGVtYS5hdHRyaWJ1dGVzKSA9PT0gbnVsbCB8fCBfc2NoZW1hJGF0dHJpYnV0ZXMzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2NoZW1hJGF0dHJpYnV0ZXMzLmdyb3VwKSA9PT0gJ2NvbnN0cmFpbnRzLmdhdGVrZWVwZXIuc2gnOwogIH0pLm1hcChmdW5jdGlvbiAoc2NoZW1hKSB7CiAgICByZXR1cm4gc2NoZW1hLmlkOwogIH0pOwp9"},{"version":3,"names":["GATEKEEPER","SCHEMA","findAllConstraints","_x","_findAllConstraints","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","store","constraintTypes","nestedConstraints","wrap","_callee$","_context","prev","next","findAllConstraintTypes","sent","map","ct","dispatch","type","opt","force","Promise","all","abrupt","flat","stop","schemas","getters","findConstraintTypes","findAllTemplates","CONSTRAINT_TEMPLATE","findTemplateType","template","find","schema","_schema$attributes","_schema$attributes2","attributes","group","kind","id","filter","_schema$attributes3"],"sources":["/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/utils/gatekeeper/util.js"],"sourcesContent":["import { GATEKEEPER, SCHEMA } from '@shell/config/types';\n\nexport async function findAllConstraints(store) {\n  const constraintTypes = await findAllConstraintTypes(store);\n  const nestedConstraints = constraintTypes.map((ct) => store.dispatch('cluster/findAll', { type: ct, opt: { force: true } }));\n\n  return (await Promise.all(nestedConstraints)).flat();\n}\n\nexport function findAllConstraintTypes(store) {\n  const schemas = store.getters['cluster/all'](SCHEMA);\n\n  return findConstraintTypes(schemas);\n}\n\nexport function findAllTemplates(store) {\n  return store.dispatch('cluster/findAll', { type: GATEKEEPER.CONSTRAINT_TEMPLATE });\n}\n\nexport function findTemplateType(schemas) {\n  // @TODO this will just be a regular single type now that the server filters to preferred version\n  // so you can just add templates.gatekeeper.sh.constrainttemplate as a constant in types.js\n  const template = schemas.find((schema) => {\n    return schema?.attributes?.group === 'templates.gatekeeper.sh' &&\n        schema?.attributes?.kind === 'ConstraintTemplate';\n  });\n\n  return template?.id;\n}\n\nfunction findConstraintTypes(schemas) {\n  return schemas\n    .filter((schema) => schema?.attributes?.group === 'constraints.gatekeeper.sh')\n    .map((schema) => schema.id);\n}\n"],"mappings":";;;;;;;;;;;;;AAAA,SAASA,UAAU,EAAEC,MAAM,QAAQ,qBAAqB;AAExD,gBAAsBC,kBAAkBA,CAAAC,EAAA;EAAA,OAAAC,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAKvC,SAAAF,oBAAA;EAAAA,mBAAA,GAAAG,iBAAA,eAAAC,mBAAA,CAAAC,IAAA,CALM,SAAAC,QAAkCC,KAAK;IAAA,IAAAC,eAAA,EAAAC,iBAAA;IAAA,OAAAL,mBAAA,CAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OACdC,sBAAsB,CAACR,KAAK,CAAC;QAAA;UAArDC,eAAe,GAAAI,QAAA,CAAAI,IAAA;UACfP,iBAAiB,GAAGD,eAAe,CAACS,GAAG,CAAC,UAACC,EAAE;YAAA,OAAKX,KAAK,CAACY,QAAQ,CAAC,iBAAiB,EAAE;cAAEC,IAAI,EAAEF,EAAE;cAAEG,GAAG,EAAE;gBAAEC,KAAK,EAAE;cAAK;YAAE,CAAC,CAAC;UAAA,EAAC;UAAAV,QAAA,CAAAE,IAAA;UAAA,OAE9GS,OAAO,CAACC,GAAG,CAACf,iBAAiB,CAAC;QAAA;UAAA,OAAAG,QAAA,CAAAa,MAAA,WAAAb,QAAA,CAAAI,IAAA,CAAEU,IAAI;QAAA;QAAA;UAAA,OAAAd,QAAA,CAAAe,IAAA;MAAA;IAAA,GAAArB,OAAA;EAAA,CACnD;EAAA,OAAAN,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAED,OAAO,SAASa,sBAAsBA,CAACR,KAAK,EAAE;EAC5C,IAAMqB,OAAO,GAAGrB,KAAK,CAACsB,OAAO,CAAC,aAAa,CAAC,CAAChC,MAAM,CAAC;EAEpD,OAAOiC,mBAAmB,CAACF,OAAO,CAAC;AACrC;AAEA,OAAO,SAASG,gBAAgBA,CAACxB,KAAK,EAAE;EACtC,OAAOA,KAAK,CAACY,QAAQ,CAAC,iBAAiB,EAAE;IAAEC,IAAI,EAAExB,UAAU,CAACoC;EAAoB,CAAC,CAAC;AACpF;AAEA,OAAO,SAASC,gBAAgBA,CAACL,OAAO,EAAE;EACxC;EACA;EACA,IAAMM,QAAQ,GAAGN,OAAO,CAACO,IAAI,CAAC,UAACC,MAAM,EAAK;IAAA,IAAAC,kBAAA,EAAAC,mBAAA;IACxC,OAAO,CAAAF,MAAM,aAANA,MAAM,gBAAAC,kBAAA,GAAND,MAAM,CAAEG,UAAU,cAAAF,kBAAA,uBAAlBA,kBAAA,CAAoBG,KAAK,MAAK,yBAAyB,IAC1D,CAAAJ,MAAM,aAANA,MAAM,gBAAAE,mBAAA,GAANF,MAAM,CAAEG,UAAU,cAAAD,mBAAA,uBAAlBA,mBAAA,CAAoBG,IAAI,MAAK,oBAAoB;EACvD,CAAC,CAAC;EAEF,OAAOP,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEQ,EAAE;AACrB;AAEA,SAASZ,mBAAmBA,CAACF,OAAO,EAAE;EACpC,OAAOA,OAAO,CACXe,MAAM,CAAC,UAACP,MAAM;IAAA,IAAAQ,mBAAA;IAAA,OAAK,CAAAR,MAAM,aAANA,MAAM,gBAAAQ,mBAAA,GAANR,MAAM,CAAEG,UAAU,cAAAK,mBAAA,uBAAlBA,mBAAA,CAAoBJ,KAAK,MAAK,2BAA2B;EAAA,EAAC,CAC7EvB,GAAG,CAAC,UAACmB,MAAM;IAAA,OAAKA,MAAM,CAACM,EAAE;EAAA,EAAC;AAC/B","ignoreList":[]}]}