{"remainingRequest":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js??ref--16-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/workload/mixins/workload.js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/workload/mixins/workload.js","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/babel.config.js","mtime":1725343995893},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmZ1bmN0aW9uIG93bktleXMoZSwgcikgeyB2YXIgdCA9IE9iamVjdC5rZXlzKGUpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7IHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlOyB9KSksIHQucHVzaC5hcHBseSh0LCBvKTsgfSByZXR1cm4gdDsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBfZGVmaW5lUHJvcGVydHkoZSwgciwgdFtyXSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIi9ob21lL3VidW50dS9zdXNlY29uZi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3IvaW5kZXguanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuaXMtaW50ZWdlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgb21pdEJ5IGZyb20gJ2xvZGFzaC9vbWl0QnknOwppbXBvcnQgeyBjbGVhblVwIH0gZnJvbSAnQHNoZWxsL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IENPTkZJR19NQVAsIFNFQ1JFVCwgV09SS0xPQURfVFlQRVMsIE5PREUsIFNFUlZJQ0UsIFBWQywgU0VSVklDRV9BQ0NPVU5ULCBDQVBJLCBQT0QsIExJU1RfV09SS0xPQURfVFlQRVMsIEhDSSB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsKaW1wb3J0IFJlc291cmNlTWFuYWdlciBmcm9tICdAc2hlbGwvbWl4aW5zL3Jlc291cmNlLW1hbmFnZXInOwppbXBvcnQgTGFiZWxlZFNlbGVjdCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0xhYmVsZWRTZWxlY3QnOwppbXBvcnQgeyBMYWJlbGVkSW5wdXQgfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0xhYmVsZWRJbnB1dCc7CmltcG9ydCBTZXJ2aWNlTmFtZVNlbGVjdCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1NlcnZpY2VOYW1lU2VsZWN0JzsKaW1wb3J0IEhlYWx0aENoZWNrIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vSGVhbHRoQ2hlY2snOwppbXBvcnQgU2VjdXJpdHkgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9TZWN1cml0eSc7CmltcG9ydCBVcGdyYWRpbmcgZnJvbSAnQHNoZWxsL2VkaXQvd29ya2xvYWQvVXBncmFkaW5nJzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCBOZXR3b3JraW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTmV0d29ya2luZyc7CmltcG9ydCBWb2x1bWVDbGFpbVRlbXBsYXRlIGZyb20gJ0BzaGVsbC9lZGl0L3dvcmtsb2FkL1ZvbHVtZUNsYWltVGVtcGxhdGUnOwppbXBvcnQgSm9iIGZyb20gJ0BzaGVsbC9lZGl0L3dvcmtsb2FkL0pvYic7CmltcG9ydCB7IF9FRElULCBfQ1JFQVRFLCBfVklFVywgX0NMT05FIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgV29ya2xvYWRQb3J0cyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1dvcmtsb2FkUG9ydHMnOwppbXBvcnQgQ29udGFpbmVyUmVzb3VyY2VMaW1pdCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Db250YWluZXJSZXNvdXJjZUxpbWl0JzsKaW1wb3J0IEtleVZhbHVlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vS2V5VmFsdWUnOwppbXBvcnQgVGFiYmVkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZCc7CmltcG9ydCBOb2RlU2NoZWR1bGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL05vZGVTY2hlZHVsaW5nJzsKaW1wb3J0IFBvZEFmZmluaXR5IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vUG9kQWZmaW5pdHknOwppbXBvcnQgVG9sZXJhdGlvbnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9Ub2xlcmF0aW9ucyc7CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCBDb21tYW5kIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vQ29tbWFuZCc7CmltcG9ydCBMaWZlY3ljbGVIb29rcyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0xpZmVjeWNsZUhvb2tzJzsKaW1wb3J0IFN0b3JhZ2UgZnJvbSAnQHNoZWxsL2VkaXQvd29ya2xvYWQvc3RvcmFnZSc7CmltcG9ydCBDb250YWluZXJNb3VudFBhdGhzIGZyb20gJ0BzaGVsbC9lZGl0L3dvcmtsb2FkL3N0b3JhZ2UvQ29udGFpbmVyTW91bnRQYXRocy52dWUnOwppbXBvcnQgTGFiZWxzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxzJzsKaW1wb3J0IHsgUmFkaW9Hcm91cCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vUmFkaW8nOwppbXBvcnQgeyBVSV9NQU5BR0VEIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyByZW1vdmVPYmplY3QgfSBmcm9tICdAc2hlbGwvdXRpbHMvYXJyYXknOwppbXBvcnQgeyBCRUZPUkVfU0FWRV9IT09LUyB9IGZyb20gJ0BzaGVsbC9taXhpbnMvY2hpbGQtaG9vayc7CmltcG9ydCBOYW1lTnNEZXNjcmlwdGlvbiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL05hbWVOc0Rlc2NyaXB0aW9uJzsKaW1wb3J0IGZvcm1SdWxlc0dlbmVyYXRvciBmcm9tICdAc2hlbGwvdXRpbHMvdmFsaWRhdG9ycy9mb3JtUnVsZXMnOwppbXBvcnQgeyBUWVBFUyBhcyBTRUNSRVRfVFlQRVMgfSBmcm9tICdAc2hlbGwvbW9kZWxzL3NlY3JldCc7CmltcG9ydCB7IGRlZmF1bHRDb250YWluZXIgfSBmcm9tICdAc2hlbGwvbW9kZWxzL3dvcmtsb2FkJzsKaW1wb3J0IHsgYWxsSGFzaCB9IGZyb20gJ0BzaGVsbC91dGlscy9wcm9taXNlJzsKdmFyIFRBQl9XRUlHSFRfTUFQID0gewogIGdlbmVyYWw6IDk5LAogIGhlYWx0aENoZWNrOiA5OCwKICBsYWJlbHM6IDk3LAogIG5ldHdvcmtpbmc6IDk2LAogIG5vZGVTY2hlZHVsaW5nOiA5NSwKICBwb2RTY2hlZHVsaW5nOiA5NCwKICByZXNvdXJjZXM6IDkzLAogIHVwZ3JhZGluZzogOTIsCiAgc2VjdXJpdHlDb250ZXh0OiA5MSwKICBzdG9yYWdlOiA5MCwKICB2b2x1bWVDbGFpbVRlbXBsYXRlczogODkKfTsKdmFyIEdQVV9LRVkgPSAnbnZpZGlhLmNvbS9ncHUnOwp2YXIgSURfS0VZID0gU3ltYm9sKCdjb250YWluZXItaWQnKTsKdmFyIHNlcmlhbE1ha2VyID0gZnVuY3Rpb24gKCkgewogIHZhciBwcmVmaXggPSAnJzsKICB2YXIgc2VxID0gMDsKICByZXR1cm4gewogICAgc2V0UHJlZml4OiBmdW5jdGlvbiBzZXRQcmVmaXgocCkgewogICAgICBwcmVmaXggPSBwOwogICAgfSwKICAgIHNldFNlcTogZnVuY3Rpb24gc2V0U2VxKHMpIHsKICAgICAgc2VxID0gczsKICAgIH0sCiAgICBnZW5TeW06IGZ1bmN0aW9uIGdlblN5bSgpIHsKICAgICAgdmFyIHJlc3VsdCA9IHByZWZpeCArIHNlcTsKICAgICAgc2VxICs9IDE7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgfTsKfSgpOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NydVdvcmtsb2FkJywKICBjb21wb25lbnRzOiB7CiAgICBDb250YWluZXJSZXNvdXJjZUxpbWl0OiBDb250YWluZXJSZXNvdXJjZUxpbWl0LAogICAgQ29tbWFuZDogQ29tbWFuZCwKICAgIENydVJlc291cmNlOiBDcnVSZXNvdXJjZSwKICAgIEhlYWx0aENoZWNrOiBIZWFsdGhDaGVjaywKICAgIEpvYjogSm9iLAogICAgS2V5VmFsdWU6IEtleVZhbHVlLAogICAgTGFiZWxlZElucHV0OiBMYWJlbGVkSW5wdXQsCiAgICBMYWJlbGVkU2VsZWN0OiBMYWJlbGVkU2VsZWN0LAogICAgTGFiZWxzOiBMYWJlbHMsCiAgICBMaWZlY3ljbGVIb29rczogTGlmZWN5Y2xlSG9va3MsCiAgICBMb2FkaW5nOiBMb2FkaW5nLAogICAgTmFtZU5zRGVzY3JpcHRpb246IE5hbWVOc0Rlc2NyaXB0aW9uLAogICAgTmV0d29ya2luZzogTmV0d29ya2luZywKICAgIE5vZGVTY2hlZHVsaW5nOiBOb2RlU2NoZWR1bGluZywKICAgIFBvZEFmZmluaXR5OiBQb2RBZmZpbml0eSwKICAgIFJhZGlvR3JvdXA6IFJhZGlvR3JvdXAsCiAgICBTZWN1cml0eTogU2VjdXJpdHksCiAgICBTZXJ2aWNlTmFtZVNlbGVjdDogU2VydmljZU5hbWVTZWxlY3QsCiAgICBTdG9yYWdlOiBTdG9yYWdlLAogICAgVGFiOiBUYWIsCiAgICBUYWJiZWQ6IFRhYmJlZCwKICAgIFRvbGVyYXRpb25zOiBUb2xlcmF0aW9ucywKICAgIFVwZ3JhZGluZzogVXBncmFkaW5nLAogICAgVm9sdW1lQ2xhaW1UZW1wbGF0ZTogVm9sdW1lQ2xhaW1UZW1wbGF0ZSwKICAgIFdvcmtsb2FkUG9ydHM6IFdvcmtsb2FkUG9ydHMsCiAgICBDb250YWluZXJNb3VudFBhdGhzOiBDb250YWluZXJNb3VudFBhdGhzCiAgfSwKICBtaXhpbnM6IFtDcmVhdGVFZGl0VmlldywgUmVzb3VyY2VNYW5hZ2VyXSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY3JlYXRlJwogICAgfSwKICAgIGNyZWF0ZU9wdGlvbjogewogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCh0ZXh0KSB7CiAgICAgICAgaWYgKHRleHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG1ldGFkYXRhOiB7CiAgICAgICAgICAgICAgbmFtZTogdGV4dAogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgdHlwZTogRnVuY3Rpb24KICAgIH0KICB9LAogIGZldGNoOiBmdW5jdGlvbiBmZXRjaCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgZmV0Y2hlczsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIC8vIFRPRE8gU2hvdWxkIHJlbW92ZSB0aGVzZSBsaW5lcwogICAgICAgICAgICAvLyA/IFRoZSByZXN1bHRzIGFyZW4ndCBzdG9yZWQsIHNvIGRvbid0IGtub3cgd2h5IHdlIGZldGNoPwogICAgICAgICAgICAvLyBVc2VyIG1pZ2h0IG5vdCBoYXZlIGFjY2VzcyB0byB0aGVzZSByZXNvdXJjZXMgLSBzbyBjaGVjayBiZWZvcmUgdHJ5aW5nIHRvIGZldGNoCiAgICAgICAgICAgIGZldGNoZXMgPSB7fTsKICAgICAgICAgICAgaWYgKF90aGlzLiRzdG9yZS5nZXR0ZXJzWyJtYW5hZ2VtZW50L2Nhbkxpc3QiXShDQVBJLlJBTkNIRVJfQ0xVU1RFUikpIHsKICAgICAgICAgICAgICBmZXRjaGVzLnJhbmNoZXJDbHVzdGVycyA9IF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgewogICAgICAgICAgICAgICAgdHlwZTogQ0FQSS5SQU5DSEVSX0NMVVNURVIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3RoaXMuJHN0b3JlLmdldHRlcnNbIm1hbmFnZW1lbnQvY2FuTGlzdCJdKEhDSS5IQVJWRVNURVJfQ09ORklHKSkgewogICAgICAgICAgICAgIGZldGNoZXMuaGFydmVzdGVyQ29uZmlncyA9IF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgewogICAgICAgICAgICAgICAgdHlwZTogSENJLkhBUlZFU1RFUl9DT05GSUcKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIGFsbEhhc2goZmV0Y2hlcyk7CiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIC8vIGRvbid0IGJsb2NrIFVJIGZvciB0aGVzZSByZXNvdXJjZXMKICAgICAgICAgICAgX3RoaXMucmVzb3VyY2VNYW5hZ2VyRmV0Y2hTZWNvbmRhcnlSZXNvdXJjZXMoX3RoaXMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy52YWx1ZS5nZXRTZXJ2aWNlc093bmVkKCk7CiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIF90aGlzLnNlcnZpY2VzT3duZWQgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgdmFyIF9zcGVjJHRlbXBsYXRlLCBfdGhpcyR2YWx1ZSwgX3BvZFRlbXBsYXRlU3BlYyRzZWN1OwogICAgc2VyaWFsTWFrZXIuc2V0UHJlZml4KCdjb250YWluZXItJyk7CiAgICBzZXJpYWxNYWtlci5zZXRTZXEoMCk7CiAgICB2YXIgdHlwZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5yZXNvdXJjZTsKICAgIHZhciBjcmVhdGVTaWRlY2FyID0gISF0aGlzLiRyb3V0ZS5xdWVyeS5zaWRlY2FyOwogICAgaWYgKHR5cGUgPT09ICd3b3JrbG9hZCcpIHsKICAgICAgdHlwZSA9IG51bGw7CiAgICB9CiAgICBpZiAoIXRoaXMudmFsdWUuc3BlYykgewogICAgICB0aGlzLnZhbHVlLnNwZWMgPSB7fTsKICAgICAgaWYgKHRoaXMudmFsdWUudHlwZSA9PT0gUE9EKSB7CiAgICAgICAgdmFyIHBvZENvbnRhaW5lcnMgPSBbewogICAgICAgICAgaW1hZ2VQdWxsUG9saWN5OiAnQWx3YXlzJywKICAgICAgICAgIG5hbWU6ICJjb250YWluZXItMCIKICAgICAgICB9XTsKICAgICAgICB2YXIgbWV0YWRhdGEgPSBfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnZhbHVlLm1ldGFkYXRhKTsKICAgICAgICB2YXIgcG9kU3BlYyA9IHsKICAgICAgICAgIHRlbXBsYXRlOiB7CiAgICAgICAgICAgIHNwZWM6IHsKICAgICAgICAgICAgICBjb250YWluZXJzOiBwb2RDb250YWluZXJzLAogICAgICAgICAgICAgIGluaXRDb250YWluZXJzOiBbXQogICAgICAgICAgICB9LAogICAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGEKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAnc3BlYycsIHBvZFNwZWMpOwogICAgICB9CiAgICB9CgogICAgLy8gRURJVCB2aWV3IGZvciBQT0QKICAgIC8vIFRyYW5zZm9ybSBpdCBmcm9tIFBPRCB3b3JsZCB0byB3b3JrbG9hZAogICAgaWYgKCh0aGlzLm1vZGUgPT09IF9FRElUIHx8IHRoaXMubW9kZSA9PT0gX1ZJRVcgfHwgdGhpcy5yZWFsTW9kZSA9PT0gX0NMT05FKSAmJiB0aGlzLnZhbHVlLnR5cGUgPT09ICdwb2QnKSB7CiAgICAgIHZhciBfcG9kU3BlYyA9IF9vYmplY3RTcHJlYWQoe30sIHRoaXMudmFsdWUuc3BlYyk7CiAgICAgIHZhciBfbWV0YWRhdGEgPSBfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnZhbHVlLm1ldGFkYXRhKTsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuc3BlYywgJ3RlbXBsYXRlJywgewogICAgICAgIHNwZWM6IF9wb2RTcGVjLAogICAgICAgIG1ldGFkYXRhOiBfbWV0YWRhdGEKICAgICAgfSk7CiAgICB9CiAgICB2YXIgc3BlYyA9IHRoaXMudmFsdWUuc3BlYzsKICAgIHZhciBwb2RUZW1wbGF0ZVNwZWMgPSB0eXBlID09PSBXT1JLTE9BRF9UWVBFUy5DUk9OX0pPQiA/IHNwZWMuam9iVGVtcGxhdGUuc3BlYy50ZW1wbGF0ZS5zcGVjIDogc3BlYyA9PT0gbnVsbCB8fCBzcGVjID09PSB2b2lkIDAgfHwgKF9zcGVjJHRlbXBsYXRlID0gc3BlYy50ZW1wbGF0ZSkgPT09IG51bGwgfHwgX3NwZWMkdGVtcGxhdGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zcGVjJHRlbXBsYXRlLnNwZWM7CiAgICB2YXIgY29udGFpbmVycyA9IHBvZFRlbXBsYXRlU3BlYy5jb250YWluZXJzIHx8IFtdOwogICAgdmFyIGNvbnRhaW5lcjsKICAgIGlmICh0aGlzLm1vZGUgPT09IF9WSUVXICYmIHRoaXMudmFsdWUudHlwZSA9PT0gJ3BvZCcpIHsKICAgICAgcG9kVGVtcGxhdGVTcGVjID0gc3BlYzsKICAgIH0KICAgIGlmICh0aGlzLm1vZGUgPT09IF9DUkVBVEUgfHwgdGhpcy5tb2RlID09PSBfVklFVyB8fCB0aGlzLnJlYWxNb2RlID09PSBfQ0xPTkUgfHwgIWNyZWF0ZVNpZGVjYXIgJiYgIXRoaXMudmFsdWUuaGFzU2lkZWNhcnMgLy8gaGFzU2lkZUNhcnMgPSBjb250YWluZXJzLmxlbmd0aCA+IDEgfHwgaW5pdENvbnRhaW5lcnMubGVuZ3RoOwogICAgKSB7CiAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lcnNbMF07CiAgICB9IGVsc2UgewogICAgICAvLyBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgYXJlIG5vIGNvbnRhaW5lcnMuCiAgICAgIGlmICghcG9kVGVtcGxhdGVTcGVjLmluaXRDb250YWluZXJzKSB7CiAgICAgICAgcG9kVGVtcGxhdGVTcGVjLmluaXRDb250YWluZXJzID0gW107CiAgICAgIH0KICAgICAgdmFyIGFsbENvbnRhaW5lcnMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHBvZFRlbXBsYXRlU3BlYy5pbml0Q29udGFpbmVycyksIF90b0NvbnN1bWFibGVBcnJheShwb2RUZW1wbGF0ZVNwZWMuY29udGFpbmVycykpOwogICAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuaW5pdCkgewogICAgICAgIHBvZFRlbXBsYXRlU3BlYy5pbml0Q29udGFpbmVycy5wdXNoKHsKICAgICAgICAgIGltYWdlUHVsbFBvbGljeTogJ0Fsd2F5cycsCiAgICAgICAgICBuYW1lOiAiY29udGFpbmVyLSIuY29uY2F0KGFsbENvbnRhaW5lcnMubGVuZ3RoKSwKICAgICAgICAgIF9pbml0OiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgY29udGFpbmVycyA9IHBvZFRlbXBsYXRlU3BlYy5pbml0Q29udGFpbmVyczsKICAgICAgfQogICAgICBpZiAoY3JlYXRlU2lkZWNhciB8fCB0aGlzLnZhbHVlLnR5cGUgPT09ICdwb2QnKSB7CiAgICAgICAgY29udGFpbmVyID0gewogICAgICAgICAgaW1hZ2VQdWxsUG9saWN5OiAnQWx3YXlzJywKICAgICAgICAgIG5hbWU6ICJjb250YWluZXItIi5jb25jYXQoYWxsQ29udGFpbmVycy5sZW5ndGgpLAogICAgICAgICAgX2luaXQ6IGZhbHNlCiAgICAgICAgfTsKICAgICAgICBjb250YWluZXJzLnB1c2goY29udGFpbmVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250YWluZXIgPSBjb250YWluZXJzWzBdOwogICAgICB9CiAgICB9CiAgICB0aGlzLnNlbGVjdENvbnRhaW5lcihjb250YWluZXIpOwogICAgaWYgKHRoaXMucmVhbE1vZGUgPT09IF9DTE9ORSAmJiB0aGlzLnZhbHVlLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLkpPQikgewogICAgICB0aGlzLmNsZWFuVXBDbG9uZWRKb2JEYXRhKCk7CiAgICB9CiAgICByZXR1cm4gewogICAgICBzZWNvbmRhcnlSZXNvdXJjZURhdGE6IHRoaXMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhQ29uZmlnKCksCiAgICAgIG5hbWVzcGFjZWRDb25maWdNYXBzOiBbXSwKICAgICAgYWxsTm9kZXM6IG51bGwsCiAgICAgIGFsbE5vZGVPYmplY3RzOiBbXSwKICAgICAgbmFtZXNwYWNlZFNlY3JldHM6IFtdLAogICAgICBpbWFnZVB1bGxOYW1lc3BhY2VkU2VjcmV0czogW10sCiAgICAgIGFsbFNlcnZpY2VzOiBbXSwKICAgICAgaGVhZGxlc3NTZXJ2aWNlczogW10sCiAgICAgIG5hbWU6ICgoX3RoaXMkdmFsdWUgPSB0aGlzLnZhbHVlKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZSA9PT0gdm9pZCAwIHx8IChfdGhpcyR2YWx1ZSA9IF90aGlzJHZhbHVlLm1ldGFkYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkdmFsdWUubmFtZSkgfHwgbnVsbCwKICAgICAgcHZjczogW10sCiAgICAgIG5hbWVzcGFjZWRTZXJ2aWNlTmFtZXM6IFtdLAogICAgICBzaG93VGFiczogZmFsc2UsCiAgICAgIHB1bGxQb2xpY3lPcHRpb25zOiBbJ0Fsd2F5cycsICdJZk5vdFByZXNlbnQnLCAnTmV2ZXInXSwKICAgICAgc3BlYzogc3BlYywKICAgICAgdHlwZTogdHlwZSwKICAgICAgc2VydmljZXNPd25lZDogW10sCiAgICAgIHNlcnZpY2VzVG9SZW1vdmU6IFtdLAogICAgICBwb3J0c0ZvclNlcnZpY2VzOiBbXSwKICAgICAgY29udGFpbmVyOiBjb250YWluZXIsCiAgICAgIGNvbnRhaW5lckNoYW5nZTogMCwKICAgICAgdGFiQ2hhbmdlOiAwLAogICAgICBwb2RGc0dyb3VwOiAoX3BvZFRlbXBsYXRlU3BlYyRzZWN1ID0gcG9kVGVtcGxhdGVTcGVjLnNlY3VyaXR5Q29udGV4dCkgPT09IG51bGwgfHwgX3BvZFRlbXBsYXRlU3BlYyRzZWN1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcG9kVGVtcGxhdGVTcGVjJHNlY3UuZnNHcm91cCwKICAgICAgc2F2ZVB2Y0hvb2tOYW1lOiAnc2F2ZVB2Y0hvb2snLAogICAgICB0YWJXZWlnaHRNYXA6IFRBQl9XRUlHSFRfTUFQLAogICAgICBmdkZvcm1SdWxlU2V0czogW3sKICAgICAgICBwYXRoOiAnaW1hZ2UnLAogICAgICAgIHJvb3RPYmplY3Q6IHRoaXMuY29udGFpbmVyLAogICAgICAgIHJ1bGVzOiBbJ3JlcXVpcmVkJ10sCiAgICAgICAgdHJhbnNsYXRpb25LZXk6ICd3b3JrbG9hZC5jb250YWluZXIuaW1hZ2UnCiAgICAgIH1dLAogICAgICBmdlJlcG9ydGVkVmFsaWRhdGlvblBhdGhzOiBbJ3NwZWMnXSwKICAgICAgaXNOYW1lc3BhY2VOZXc6IGZhbHNlLAogICAgICBpZEtleTogSURfS0VZCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pKSwge30sIHsKICAgIHRhYkVycm9yczogZnVuY3Rpb24gdGFiRXJyb3JzKCkgewogICAgICB2YXIgX3RoaXMkZnZHZXRQYXRoRXJyb3JzOwogICAgICByZXR1cm4gewogICAgICAgIGdlbmVyYWw6ICgoX3RoaXMkZnZHZXRQYXRoRXJyb3JzID0gdGhpcy5mdkdldFBhdGhFcnJvcnMoWydpbWFnZSddKSkgPT09IG51bGwgfHwgX3RoaXMkZnZHZXRQYXRoRXJyb3JzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRmdkdldFBhdGhFcnJvcnMubGVuZ3RoKSA+IDAKICAgICAgfTsKICAgIH0sCiAgICBkZWZhdWx0VGFiOiBmdW5jdGlvbiBkZWZhdWx0VGFiKCkgewogICAgICBpZiAoISF0aGlzLiRyb3V0ZS5xdWVyeS5zaWRlY2FyIHx8IHRoaXMuJHJvdXRlLnF1ZXJ5LmluaXQgfHwgdGhpcy5tb2RlID09PSBfQ1JFQVRFKSB7CiAgICAgICAgdmFyIF9jb250YWluZXIkbmFtZTsKICAgICAgICB2YXIgY29udGFpbmVyID0gdGhpcy5hbGxDb250YWluZXJzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiBjLl9fYWN0aXZlOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiAoX2NvbnRhaW5lciRuYW1lID0gY29udGFpbmVyID09PSBudWxsIHx8IGNvbnRhaW5lciA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29udGFpbmVyLm5hbWUpICE9PSBudWxsICYmIF9jb250YWluZXIkbmFtZSAhPT0gdm9pZCAwID8gX2NvbnRhaW5lciRuYW1lIDogJ2NvbnRhaW5lci0wJzsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5hbGxDb250YWluZXJzLmxlbmd0aCA/IHRoaXMuYWxsQ29udGFpbmVyc1swXVt0aGlzLmlkS2V5XSA6ICcnOwogICAgfSwKICAgIGlzRWRpdDogZnVuY3Rpb24gaXNFZGl0KCkgewogICAgICByZXR1cm4gdGhpcy5tb2RlID09PSBfRURJVDsKICAgIH0sCiAgICBpc0pvYjogZnVuY3Rpb24gaXNKb2IoKSB7CiAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLkpPQiB8fCB0aGlzLmlzQ3JvbkpvYjsKICAgIH0sCiAgICBpc0Nyb25Kb2I6IGZ1bmN0aW9uIGlzQ3JvbkpvYigpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gV09SS0xPQURfVFlQRVMuQ1JPTl9KT0I7CiAgICB9LAogICAgaXNSZXBsaWNhYmxlOiBmdW5jdGlvbiBpc1JlcGxpY2FibGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLkRFUExPWU1FTlQgfHwgdGhpcy50eXBlID09PSBXT1JLTE9BRF9UWVBFUy5SRVBMSUNBX1NFVCB8fCB0aGlzLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLlJFUExJQ0FUSU9OX0NPTlRST0xMRVIgfHwgdGhpcy50eXBlID09PSBXT1JLTE9BRF9UWVBFUy5TVEFURUZVTF9TRVQ7CiAgICB9LAogICAgaXNEZXBsb3ltZW50OiBmdW5jdGlvbiBpc0RlcGxveW1lbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLkRFUExPWU1FTlQ7CiAgICB9LAogICAgaXNQb2Q6IGZ1bmN0aW9uIGlzUG9kKCkgewogICAgICByZXR1cm4gdGhpcy52YWx1ZS50eXBlID09PSBQT0Q7CiAgICB9LAogICAgaXNTdGF0ZWZ1bFNldDogZnVuY3Rpb24gaXNTdGF0ZWZ1bFNldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gV09SS0xPQURfVFlQRVMuU1RBVEVGVUxfU0VUOwogICAgfSwKICAgIC8vIGlmIHRoaXMgaXMgYSBjcm9uam9iLCBncmFiIHBvZCBzcGVjIGZyb20gd2l0aGluIGpvYiB0ZW1wbGF0ZSBzcGVjCiAgICBwb2RUZW1wbGF0ZVNwZWM6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzJHNwZWM7CiAgICAgICAgcmV0dXJuIHRoaXMuaXNDcm9uSm9iID8gdGhpcy5zcGVjLmpvYlRlbXBsYXRlLnNwZWMudGVtcGxhdGUuc3BlYyA6IChfdGhpcyRzcGVjID0gdGhpcy5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjID09PSB2b2lkIDAgfHwgKF90aGlzJHNwZWMgPSBfdGhpcyRzcGVjLnRlbXBsYXRlKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjLnNwZWM7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ldSkgewogICAgICAgIGlmICh0aGlzLmlzQ3JvbkpvYikgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5zcGVjLnRlbXBsYXRlLCAnc3BlYycsIG5ldSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLnNwZWMudGVtcGxhdGUsICdzcGVjJywgbmV1KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwb2RMYWJlbHM6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgaWYgKHRoaXMuaXNDcm9uSm9iKSB7CiAgICAgICAgICBpZiAoIXRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5tZXRhZGF0YSkgewogICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5zcGVjLmpvYlRlbXBsYXRlLCAnbWV0YWRhdGEnLCB7CiAgICAgICAgICAgICAgbGFiZWxzOiB7fQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB0aGlzLnNwZWMuam9iVGVtcGxhdGUubWV0YWRhdGEubGFiZWxzOwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMuc3BlYy50ZW1wbGF0ZS5tZXRhZGF0YSkgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy50ZW1wbGF0ZSwgJ21ldGFkYXRhJywgewogICAgICAgICAgICBsYWJlbHM6IHt9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy50ZW1wbGF0ZS5tZXRhZGF0YS5sYWJlbHM7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ldSkgewogICAgICAgIGlmICh0aGlzLmlzQ3JvbkpvYikgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5tZXRhZGF0YSwgJ2xhYmVscycsIG5ldSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLnNwZWMudGVtcGxhdGUubWV0YWRhdGEsICdsYWJlbHMnLCBuZXUpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHBvZEFubm90YXRpb25zOiB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIGlmICh0aGlzLmlzQ3JvbkpvYikgewogICAgICAgICAgaWYgKCF0aGlzLnNwZWMuam9iVGVtcGxhdGUubWV0YWRhdGEpIHsKICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy5qb2JUZW1wbGF0ZSwgJ21ldGFkYXRhJywgewogICAgICAgICAgICAgIGFubm90YXRpb25zOiB7fQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB0aGlzLnNwZWMuam9iVGVtcGxhdGUubWV0YWRhdGEuYW5ub3RhdGlvbnM7CiAgICAgICAgfQogICAgICAgIGlmICghdGhpcy5zcGVjLnRlbXBsYXRlLm1ldGFkYXRhKSB7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5zcGVjLnRlbXBsYXRlLCAnbWV0YWRhdGEnLCB7CiAgICAgICAgICAgIGFubm90YXRpb25zOiB7fQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnNwZWMudGVtcGxhdGUubWV0YWRhdGEuYW5ub3RhdGlvbnM7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ldSkgewogICAgICAgIGlmICh0aGlzLmlzQ3JvbkpvYikgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5tZXRhZGF0YSwgJ2Fubm90YXRpb25zJywgbmV1KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuc3BlYy50ZW1wbGF0ZS5tZXRhZGF0YSwgJ2Fubm90YXRpb25zJywgbmV1KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhbGxDb250YWluZXJzOiBmdW5jdGlvbiBhbGxDb250YWluZXJzKCkgewogICAgICB2YXIgX3RoaXMkcG9kVGVtcGxhdGVTcGVjLAogICAgICAgIF90aGlzJHBvZFRlbXBsYXRlU3BlYzIsCiAgICAgICAgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIGNvbnRhaW5lcnMgPSAoKF90aGlzJHBvZFRlbXBsYXRlU3BlYyA9IHRoaXMucG9kVGVtcGxhdGVTcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRwb2RUZW1wbGF0ZVNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHBvZFRlbXBsYXRlU3BlYy5jb250YWluZXJzKSB8fCBbXTsKICAgICAgdmFyIGluaXRDb250YWluZXJzID0gKChfdGhpcyRwb2RUZW1wbGF0ZVNwZWMyID0gdGhpcy5wb2RUZW1wbGF0ZVNwZWMpID09PSBudWxsIHx8IF90aGlzJHBvZFRlbXBsYXRlU3BlYzIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHBvZFRlbXBsYXRlU3BlYzIuaW5pdENvbnRhaW5lcnMpIHx8IFtdOwogICAgICB2YXIga2V5ID0gdGhpcy5pZEtleTsKICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoY29udGFpbmVycy5tYXAoZnVuY3Rpb24gKGVhY2gpIHsKICAgICAgICBlYWNoLl9pbml0ID0gZmFsc2U7CiAgICAgICAgaWYgKCFlYWNoW2tleV0pIHsKICAgICAgICAgIGVhY2hba2V5XSA9IHNlcmlhbE1ha2VyLmdlblN5bSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWFjaDsKICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkoaW5pdENvbnRhaW5lcnMubWFwKGZ1bmN0aW9uIChlYWNoKSB7CiAgICAgICAgZWFjaC5faW5pdCA9IHRydWU7CiAgICAgICAgaWYgKCFlYWNoW2tleV0pIHsKICAgICAgICAgIGVhY2hba2V5XSA9IHNlcmlhbE1ha2VyLmdlblN5bSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWFjaDsKICAgICAgfSkpKS5tYXAoZnVuY3Rpb24gKGNvbnRhaW5lcikgewogICAgICAgIHZhciBjb250YWluZXJJbWFnZVJ1bGUgPSBmb3JtUnVsZXNHZW5lcmF0b3IoX3RoaXMyLiRzdG9yZS5nZXR0ZXJzWydpMThuL3QnXSwgewogICAgICAgICAgbmFtZTogY29udGFpbmVyLm5hbWUKICAgICAgICB9KS5jb250YWluZXJJbWFnZTsKICAgICAgICBjb250YWluZXIuZXJyb3IgPSBjb250YWluZXJJbWFnZVJ1bGUoY29udGFpbmVyKTsKICAgICAgICByZXR1cm4gY29udGFpbmVyOwogICAgICB9KTsKICAgIH0sCiAgICBmbGF0UmVzb3VyY2VzOiB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfcmVmID0gdGhpcy5jb250YWluZXIucmVzb3VyY2VzIHx8IHt9LAogICAgICAgICAgX3JlZiRsaW1pdHMgPSBfcmVmLmxpbWl0cywKICAgICAgICAgIGxpbWl0cyA9IF9yZWYkbGltaXRzID09PSB2b2lkIDAgPyB7fSA6IF9yZWYkbGltaXRzLAogICAgICAgICAgX3JlZiRyZXF1ZXN0cyA9IF9yZWYucmVxdWVzdHMsCiAgICAgICAgICByZXF1ZXN0cyA9IF9yZWYkcmVxdWVzdHMgPT09IHZvaWQgMCA/IHt9IDogX3JlZiRyZXF1ZXN0czsKICAgICAgICB2YXIgbGltaXRzQ3B1ID0gbGltaXRzLmNwdSwKICAgICAgICAgIGxpbWl0c01lbW9yeSA9IGxpbWl0cy5tZW1vcnksCiAgICAgICAgICBsaW1pdHNHcHUgPSBsaW1pdHNbR1BVX0tFWV07CiAgICAgICAgdmFyIHJlcXVlc3RzQ3B1ID0gcmVxdWVzdHMuY3B1LAogICAgICAgICAgcmVxdWVzdHNNZW1vcnkgPSByZXF1ZXN0cy5tZW1vcnk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGxpbWl0c0NwdTogbGltaXRzQ3B1LAogICAgICAgICAgbGltaXRzTWVtb3J5OiBsaW1pdHNNZW1vcnksCiAgICAgICAgICByZXF1ZXN0c0NwdTogcmVxdWVzdHNDcHUsCiAgICAgICAgICByZXF1ZXN0c01lbW9yeTogcmVxdWVzdHNNZW1vcnksCiAgICAgICAgICBsaW1pdHNHcHU6IGxpbWl0c0dwdQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ldSkgewogICAgICAgIHZhciBsaW1pdHNDcHUgPSBuZXUubGltaXRzQ3B1LAogICAgICAgICAgbGltaXRzTWVtb3J5ID0gbmV1LmxpbWl0c01lbW9yeSwKICAgICAgICAgIHJlcXVlc3RzQ3B1ID0gbmV1LnJlcXVlc3RzQ3B1LAogICAgICAgICAgcmVxdWVzdHNNZW1vcnkgPSBuZXUucmVxdWVzdHNNZW1vcnksCiAgICAgICAgICBsaW1pdHNHcHUgPSBuZXUubGltaXRzR3B1OwogICAgICAgIHZhciBvdXQgPSB7CiAgICAgICAgICByZXF1ZXN0czogewogICAgICAgICAgICBjcHU6IHJlcXVlc3RzQ3B1LAogICAgICAgICAgICBtZW1vcnk6IHJlcXVlc3RzTWVtb3J5CiAgICAgICAgICB9LAogICAgICAgICAgbGltaXRzOiBfZGVmaW5lUHJvcGVydHkoewogICAgICAgICAgICBjcHU6IGxpbWl0c0NwdSwKICAgICAgICAgICAgbWVtb3J5OiBsaW1pdHNNZW1vcnkKICAgICAgICAgIH0sIEdQVV9LRVksIGxpbWl0c0dwdSkKICAgICAgICB9OwogICAgICAgIHRoaXMuJHNldCh0aGlzLmNvbnRhaW5lciwgJ3Jlc291cmNlcycsIGNsZWFuVXAob3V0KSk7CiAgICAgIH0KICAgIH0sCiAgICBoZWFsdGhDaGVjazogewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgX3RoaXMkY29udGFpbmVyID0gdGhpcy5jb250YWluZXIsCiAgICAgICAgICByZWFkaW5lc3NQcm9iZSA9IF90aGlzJGNvbnRhaW5lci5yZWFkaW5lc3NQcm9iZSwKICAgICAgICAgIGxpdmVuZXNzUHJvYmUgPSBfdGhpcyRjb250YWluZXIubGl2ZW5lc3NQcm9iZSwKICAgICAgICAgIHN0YXJ0dXBQcm9iZSA9IF90aGlzJGNvbnRhaW5lci5zdGFydHVwUHJvYmU7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHJlYWRpbmVzc1Byb2JlOiByZWFkaW5lc3NQcm9iZSwKICAgICAgICAgIGxpdmVuZXNzUHJvYmU6IGxpdmVuZXNzUHJvYmUsCiAgICAgICAgICBzdGFydHVwUHJvYmU6IHN0YXJ0dXBQcm9iZQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KG5ldSkgewogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250YWluZXIsIG5ldSk7CiAgICAgIH0KICAgIH0sCiAgICBpbWFnZVB1bGxTZWNyZXRzOiB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIGlmICghdGhpcy5wb2RUZW1wbGF0ZVNwZWMuaW1hZ2VQdWxsU2VjcmV0cykgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMucG9kVGVtcGxhdGVTcGVjLCAnaW1hZ2VQdWxsU2VjcmV0cycsIFtdKTsKICAgICAgICB9CiAgICAgICAgdmFyIGltYWdlUHVsbFNlY3JldHMgPSB0aGlzLnBvZFRlbXBsYXRlU3BlYy5pbWFnZVB1bGxTZWNyZXRzOwogICAgICAgIHJldHVybiBpbWFnZVB1bGxTZWNyZXRzLm1hcChmdW5jdGlvbiAoZWFjaCkgewogICAgICAgICAgcmV0dXJuIGVhY2gubmFtZTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobmV1KSB7CiAgICAgICAgdGhpcy5wb2RUZW1wbGF0ZVNwZWMuaW1hZ2VQdWxsU2VjcmV0cyA9IG5ldS5tYXAoZnVuY3Rpb24gKHNlY3JldCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbmFtZTogc2VjcmV0CiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2NoZW1hOiBmdW5jdGlvbiBzY2hlbWEoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL3NjaGVtYUZvciddKHRoaXMudHlwZSk7CiAgICB9LAogICAgLy8gYXJyYXkgb2YgaWQsIGxhYmVsLCBkZXNjcmlwdGlvbiwgaW5pdGlhbHMgZm9yIHR5cGUgc2VsZWN0aW9uIHN0ZXAKICAgIHdvcmtsb2FkU3ViVHlwZXM6IGZ1bmN0aW9uIHdvcmtsb2FkU3ViVHlwZXMoKSB7CiAgICAgIHZhciB3b3JrbG9hZFR5cGVzID0gb21pdEJ5KExJU1RfV09SS0xPQURfVFlQRVMsIGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgcmV0dXJuIHR5cGUgPT09IFdPUktMT0FEX1RZUEVTLlJFUExJQ0FfU0VUIHx8IHR5cGUgPT09IFdPUktMT0FEX1RZUEVTLlJFUExJQ0FUSU9OX0NPTlRST0xMRVI7CiAgICAgIH0pOwogICAgICB2YXIgb3V0ID0gW107CiAgICAgIGZvciAodmFyIHByb3AgaW4gd29ya2xvYWRUeXBlcykgewogICAgICAgIHZhciB0eXBlID0gd29ya2xvYWRUeXBlc1twcm9wXTsKICAgICAgICB2YXIgc3VidHlwZSA9IHsKICAgICAgICAgIGlkOiB0eXBlLAogICAgICAgICAgZGVzY3JpcHRpb246ICJ3b3JrbG9hZC50eXBlRGVzY3JpcHRpb25zLiciLmNvbmNhdCh0eXBlLCAiJyIpLAogICAgICAgICAgLy8gaTE4bi11c2VzIHdvcmtsb2FkLnR5cGVEZXNjcmlwdGlvbnMuKgogICAgICAgICAgbGFiZWw6IHRoaXMubmFtZURpc3BsYXlGb3IodHlwZSksCiAgICAgICAgICBiYW5uZXJBYmJydjogdGhpcy5pbml0aWFsRGlzcGxheUZvcih0eXBlKQogICAgICAgIH07CiAgICAgICAgb3V0LnB1c2goc3VidHlwZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG91dDsKICAgIH0sCiAgICBjb250YWluZXJPcHRpb25zOiBmdW5jdGlvbiBjb250YWluZXJPcHRpb25zKCkgewogICAgICB2YXIgb3V0ID0gX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuYWxsQ29udGFpbmVycyk7CiAgICAgIGlmICghdGhpcy5pc1ZpZXcpIHsKICAgICAgICBvdXQucHVzaCh7CiAgICAgICAgICBuYW1lOiAnQWRkIENvbnRhaW5lcicsCiAgICAgICAgICBfX2FkZDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgfSwgbWFwR2V0dGVycyh7CiAgICB0OiAnaTE4bi90JwogIH0pKSwKICB3YXRjaDogewogICAgJ3ZhbHVlLm1ldGFkYXRhLm5hbWVzcGFjZSc6IGZ1bmN0aW9uIHZhbHVlTWV0YWRhdGFOYW1lc3BhY2UobmV1KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghX3RoaXMzLmlzTmFtZXNwYWNlTmV3KSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX3RoaXMzLnNlY29uZGFyeVJlc291cmNlRGF0YS5uYW1lc3BhY2UgPSBuZXU7CiAgICAgICAgICAgICAgLy8gRmV0Y2ggcmVzb3VyY2VzIHRoYXQgYXJlIG5hbWVzcGFjZSBzcGVjaWZpYywgd2UgZG9uJ3QgbmVlZCB0byByZS1mZXRjaCBub24tbmFtZXNwYWNlZCByZXNvdXJjZXMgb24gbmFtZXNwYWNlIGNoYW5nZQogICAgICAgICAgICAgIF90aGlzMy5yZXNvdXJjZU1hbmFnZXJGZXRjaFNlY29uZGFyeVJlc291cmNlcyhfdGhpczMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhLCB0cnVlKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy52YWx1ZS5nZXRTZXJ2aWNlc093bmVkKCk7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfdGhpczMuc2VydmljZXNPd25lZCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBpc05hbWVzcGFjZU5ldzogZnVuY3Rpb24gaXNOYW1lc3BhY2VOZXcobmV1LCBvbGQpIHsKICAgICAgaWYgKCFvbGQgJiYgbmV1KSB7CiAgICAgICAgLy8gQXMgdGhlIG5hbWVzcGFjZSBpcyBuZXcgYW55IHJlc291cmNlIHRoYXQncyBiZWVuIGZldGNoZWQgd2l0aCBhIG5hbWVzcGFjZSBpcyBub3cgaW52YWxpZAogICAgICAgIHRoaXMucmVzb3VyY2VNYW5hZ2VyQ2xlYXJTZWNvbmRhcnlSZXNvdXJjZXModGhpcy5zZWNvbmRhcnlSZXNvdXJjZURhdGEsIHRydWUpOwogICAgICB9CiAgICB9LAogICAgdHlwZTogZnVuY3Rpb24gdHlwZShuZXUsIG9sZCkgewogICAgICB2YXIgX3RoaXMkc3BlYzIsIF90aGlzJHNwZWMzOwogICAgICB2YXIgdGVtcGxhdGUgPSBvbGQgPT09IFdPUktMT0FEX1RZUEVTLkNST05fSk9CID8gKF90aGlzJHNwZWMyID0gdGhpcy5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjMiA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjMiA9IF90aGlzJHNwZWMyLmpvYlRlbXBsYXRlKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjMiA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjMiA9IF90aGlzJHNwZWMyLnNwZWMpID09PSBudWxsIHx8IF90aGlzJHNwZWMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjMi50ZW1wbGF0ZSA6IChfdGhpcyRzcGVjMyA9IHRoaXMuc3BlYykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHNwZWMzLnRlbXBsYXRlOwogICAgICBpZiAoIXRlbXBsYXRlLnNwZWMpIHsKICAgICAgICB0ZW1wbGF0ZS5zcGVjID0ge307CiAgICAgIH0KICAgICAgdmFyIHJlc3RhcnRQb2xpY3k7CiAgICAgIGlmICh0aGlzLmlzSm9iIHx8IHRoaXMuaXNDcm9uSm9iKSB7CiAgICAgICAgcmVzdGFydFBvbGljeSA9ICdOZXZlcic7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdGFydFBvbGljeSA9ICdBbHdheXMnOwogICAgICB9CiAgICAgIHRoaXMuJHNldCh0ZW1wbGF0ZS5zcGVjLCAncmVzdGFydFBvbGljeScsIHJlc3RhcnRQb2xpY3kpOwogICAgICBpZiAoIXRoaXMuaXNSZXBsaWNhYmxlKSB7CiAgICAgICAgZGVsZXRlIHRoaXMuc3BlYy5yZXBsaWNhczsKICAgICAgfQogICAgICBpZiAob2xkID09PSBXT1JLTE9BRF9UWVBFUy5DUk9OX0pPQikgewogICAgICAgIHRoaXMuJHNldCh0aGlzLnNwZWMsICd0ZW1wbGF0ZScsIF9vYmplY3RTcHJlYWQoe30sIHRlbXBsYXRlKSk7CiAgICAgICAgZGVsZXRlIHRoaXMuc3BlYy5qb2JUZW1wbGF0ZTsKICAgICAgICBkZWxldGUgdGhpcy5zcGVjLnNjaGVkdWxlOwogICAgICB9IGVsc2UgaWYgKG5ldSA9PT0gV09SS0xPQURfVFlQRVMuQ1JPTl9KT0IpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5zcGVjLCAnam9iVGVtcGxhdGUnLCB7CiAgICAgICAgICBzcGVjOiB7CiAgICAgICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHNldCh0aGlzLnNwZWMsICdzY2hlZHVsZScsICcwICogKiAqIConKTsKICAgICAgICBkZWxldGUgdGhpcy5zcGVjLnRlbXBsYXRlOwogICAgICB9CiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAndHlwZScsIG5ldSk7CiAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLmFwaVZlcnNpb247CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5yZWdpc3RlckJlZm9yZUhvb2sodGhpcy5zYXZlV29ya2xvYWQsICd3aWxsU2F2ZVdvcmtsb2FkJyk7CiAgICB0aGlzLnJlZ2lzdGVyQmVmb3JlSG9vayh0aGlzLmdldFBvcnRzLCAnZ2V0UG9ydHMnKTsKICAgIHRoaXMucmVnaXN0ZXJBZnRlckhvb2sodGhpcy5zYXZlU2VydmljZSwgJ3NhdmVTZXJ2aWNlJyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZWNvbmRhcnlSZXNvdXJjZURhdGFDb25maWc6IGZ1bmN0aW9uIHNlY29uZGFyeVJlc291cmNlRGF0YUNvbmZpZygpIHsKICAgICAgdmFyIF90aGlzJHZhbHVlMjsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lc3BhY2U6ICgoX3RoaXMkdmFsdWUyID0gdGhpcy52YWx1ZSkgPT09IG51bGwgfHwgX3RoaXMkdmFsdWUyID09PSB2b2lkIDAgfHwgKF90aGlzJHZhbHVlMiA9IF90aGlzJHZhbHVlMi5tZXRhZGF0YSkgPT09IG51bGwgfHwgX3RoaXMkdmFsdWUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR2YWx1ZTIubmFtZXNwYWNlKSB8fCBudWxsLAogICAgICAgIGRhdGE6IF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KHt9LCBDT05GSUdfTUFQLCB7CiAgICAgICAgICBhcHBseVRvOiBbewogICAgICAgICAgICB2YXI6ICduYW1lc3BhY2VkQ29uZmlnTWFwcycKICAgICAgICAgIH1dCiAgICAgICAgfSksIFBWQywgewogICAgICAgICAgYXBwbHlUbzogW3sKICAgICAgICAgICAgdmFyOiAncHZjcycKICAgICAgICAgIH1dCiAgICAgICAgfSksIFNFUlZJQ0VfQUNDT1VOVCwgewogICAgICAgICAgYXBwbHlUbzogW3sKICAgICAgICAgICAgdmFyOiAnbmFtZXNwYWNlZFNlcnZpY2VOYW1lcycKICAgICAgICAgIH1dCiAgICAgICAgfSksIFNFQ1JFVCwgewogICAgICAgICAgYXBwbHlUbzogW3sKICAgICAgICAgICAgdmFyOiAnbmFtZXNwYWNlZFNlY3JldHMnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHZhcjogJ2ltYWdlUHVsbE5hbWVzcGFjZWRTZWNyZXRzJywKICAgICAgICAgICAgcGFyc2luZ0Z1bmM6IGZ1bmN0aW9uIHBhcnNpbmdGdW5jKGRhdGEpIHsKICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKHNlY3JldCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNlY3JldC5fdHlwZSA9PT0gU0VDUkVUX1RZUEVTLkRPQ0tFUiB8fCBzZWNyZXQuX3R5cGUgPT09IFNFQ1JFVF9UWVBFUy5ET0NLRVJfSlNPTjsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfV0KICAgICAgICB9KSwgTk9ERSwgewogICAgICAgICAgYXBwbHlUbzogW3sKICAgICAgICAgICAgdmFyOiAnYWxsTm9kZU9iamVjdHMnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHZhcjogJ2FsbE5vZGVzJywKICAgICAgICAgICAgcGFyc2luZ0Z1bmM6IGZ1bmN0aW9uIHBhcnNpbmdGdW5jKGRhdGEpIHsKICAgICAgICAgICAgICByZXR1cm4gZGF0YS5tYXAoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmlkOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9XQogICAgICAgIH0pLCBTRVJWSUNFLCB7CiAgICAgICAgICBhcHBseVRvOiBbewogICAgICAgICAgICB2YXI6ICdhbGxTZXJ2aWNlcycKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgdmFyOiAnaGVhZGxlc3NTZXJ2aWNlcycsCiAgICAgICAgICAgIHBhcnNpbmdGdW5jOiBmdW5jdGlvbiBwYXJzaW5nRnVuYyhkYXRhKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChzZXJ2aWNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZS5zcGVjLmNsdXN0ZXJJUCA9PT0gJ05vbmUnOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9XQogICAgICAgIH0pCiAgICAgIH07CiAgICB9LAogICAgYWRkQ29udGFpbmVyQnRuOiBmdW5jdGlvbiBhZGRDb250YWluZXJCdG4oKSB7CiAgICAgIHRoaXMuc2VsZWN0Q29udGFpbmVyKHsKICAgICAgICBuYW1lOiAnQWRkIENvbnRhaW5lcicsCiAgICAgICAgX19hZGQ6IHRydWUKICAgICAgfSk7CiAgICB9LAogICAgbmFtZURpc3BsYXlGb3I6IGZ1bmN0aW9uIG5hbWVEaXNwbGF5Rm9yKHR5cGUpIHsKICAgICAgdmFyIHNjaGVtYSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvc2NoZW1hRm9yJ10odHlwZSk7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9sYWJlbEZvciddKHNjaGVtYSkgfHwgJyc7CiAgICB9LAogICAgLy8gVE9ETyBiZXR0ZXIgaW1hZ2VzIGZvciB3b3JrbG9hZCB0eXBlcz8KICAgIC8vIHNob3cgaW5pdGlhbHMgb2Ygd29ya2xvYWQgdHlwZSBpbiBibHVlIGNpcmNsZXMgZm9yIG5vdwogICAgaW5pdGlhbERpc3BsYXlGb3I6IGZ1bmN0aW9uIGluaXRpYWxEaXNwbGF5Rm9yKHR5cGUpIHsKICAgICAgdmFyIHR5cGVEaXNwbGF5ID0gdGhpcy5uYW1lRGlzcGxheUZvcih0eXBlKTsKICAgICAgcmV0dXJuIHR5cGVEaXNwbGF5LnNwbGl0KCcnKS5maWx0ZXIoZnVuY3Rpb24gKGxldHRlcikgewogICAgICAgIHJldHVybiBsZXR0ZXIubWF0Y2goL1tBLVpdLyk7CiAgICAgIH0pLmpvaW4oJycpOwogICAgfSwKICAgIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKCkgewogICAgICB0aGlzLmRvbmUoKTsKICAgIH0sCiAgICBnZXRQb3J0czogZnVuY3Rpb24gZ2V0UG9ydHMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgcG9ydHM7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC52YWx1ZS5nZXRQb3J0c1dpdGhTZXJ2aWNlVHlwZSgpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgaWYgKF9jb250ZXh0My50MCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IFtdOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgcG9ydHMgPSBfY29udGV4dDMudDA7CiAgICAgICAgICAgICAgX3RoaXM0LnBvcnRzRm9yU2VydmljZXMgPSBwb3J0czsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2F2ZVNlcnZpY2U6IGZ1bmN0aW9uIHNhdmVTZXJ2aWNlKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIF9yZWYyLCBfcmVmMiR0b1NhdmUsIHRvU2F2ZSwgX3JlZjIkdG9SZW1vdmUsIHRvUmVtb3ZlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWYgKF90aGlzNS4kc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9zY2hlbWFGb3InXShTRVJWSUNFKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LnZhbHVlLnNlcnZpY2VzRnJvbUNvbnRhaW5lclBvcnRzKF90aGlzNS5tb2RlLCBfdGhpczUucG9ydHNGb3JTZXJ2aWNlcyk7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICBpZiAoX2NvbnRleHQ0LnQwKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0ge307CiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfcmVmMiA9IF9jb250ZXh0NC50MDsKICAgICAgICAgICAgICBfcmVmMiR0b1NhdmUgPSBfcmVmMi50b1NhdmU7CiAgICAgICAgICAgICAgdG9TYXZlID0gX3JlZjIkdG9TYXZlID09PSB2b2lkIDAgPyBbXSA6IF9yZWYyJHRvU2F2ZTsKICAgICAgICAgICAgICBfcmVmMiR0b1JlbW92ZSA9IF9yZWYyLnRvUmVtb3ZlOwogICAgICAgICAgICAgIHRvUmVtb3ZlID0gX3JlZjIkdG9SZW1vdmUgPT09IHZvaWQgMCA/IFtdIDogX3JlZjIkdG9SZW1vdmU7CiAgICAgICAgICAgICAgX3RoaXM1LnNlcnZpY2VzT3duZWQgPSB0b1NhdmU7CiAgICAgICAgICAgICAgX3RoaXM1LnNlcnZpY2VzVG9SZW1vdmUgPSB0b1JlbW92ZTsKICAgICAgICAgICAgICBpZiAoISghdG9TYXZlLmxlbmd0aCAmJiAhdG9SZW1vdmUubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIik7CiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UuYWxsKFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkodG9TYXZlLm1hcChmdW5jdGlvbiAoc3ZjKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3ZjLnNhdmUoKTsKICAgICAgICAgICAgICB9KSksIF90b0NvbnN1bWFibGVBcnJheSh0b1JlbW92ZS5tYXAoZnVuY3Rpb24gKHN2YykgewogICAgICAgICAgICAgICAgdmFyIF9zdmMkbWV0YWRhdGE7CiAgICAgICAgICAgICAgICB2YXIgdWkgPSBzdmMgPT09IG51bGwgfHwgc3ZjID09PSB2b2lkIDAgfHwgKF9zdmMkbWV0YWRhdGEgPSBzdmMubWV0YWRhdGEpID09PSBudWxsIHx8IF9zdmMkbWV0YWRhdGEgPT09IHZvaWQgMCB8fCAoX3N2YyRtZXRhZGF0YSA9IF9zdmMkbWV0YWRhdGEuYW5ub3RhdGlvbnMpID09PSBudWxsIHx8IF9zdmMkbWV0YWRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdmMkbWV0YWRhdGFbVUlfTUFOQUdFRF07CiAgICAgICAgICAgICAgICBpZiAodWkpIHsKICAgICAgICAgICAgICAgICAgc3ZjLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pKSkpKTsKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNhdmVXb3JrbG9hZDogZnVuY3Rpb24gc2F2ZVdvcmtsb2FkKCkgewogICAgICB2YXIgX3RlbXBsYXRlLCBfdGVtcGxhdGUyLCBfdGVtcGxhdGUzOwogICAgICBpZiAodGhpcy50eXBlICE9PSBXT1JLTE9BRF9UWVBFUy5KT0IgJiYgdGhpcy50eXBlICE9PSBXT1JLTE9BRF9UWVBFUy5DUk9OX0pPQiAmJiAodGhpcy5tb2RlID09PSBfQ1JFQVRFIHx8IHRoaXMucmVhbE1vZGUgPT09IF9DTE9ORSkpIHsKICAgICAgICB0aGlzLnNwZWMuc2VsZWN0b3IgPSB7CiAgICAgICAgICBtYXRjaExhYmVsczogdGhpcy52YWx1ZS53b3JrbG9hZFNlbGVjdG9yCiAgICAgICAgfTsKICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMudmFsdWUubWV0YWRhdGEubGFiZWxzLCB0aGlzLnZhbHVlLndvcmtsb2FkU2VsZWN0b3IpOwogICAgICB9CiAgICAgIHZhciB0ZW1wbGF0ZTsKICAgICAgaWYgKHRoaXMudHlwZSA9PT0gV09SS0xPQURfVFlQRVMuQ1JPTl9KT0IpIHsKICAgICAgICB0ZW1wbGF0ZSA9IHRoaXMuc3BlYy5qb2JUZW1wbGF0ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZW1wbGF0ZSA9IHRoaXMuc3BlYy50ZW1wbGF0ZTsKICAgICAgfQoKICAgICAgLy8gV09SS0xPQURTCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IFdPUktMT0FEX1RZUEVTLkpPQiAmJiB0aGlzLnR5cGUgIT09IFdPUktMT0FEX1RZUEVTLkNST05fSk9CICYmICh0aGlzLm1vZGUgPT09IF9DUkVBVEUgfHwgdGhpcy5yZWFsTW9kZSA9PT0gX0NMT05FKSkgewogICAgICAgIGlmICghdGVtcGxhdGUubWV0YWRhdGEpIHsKICAgICAgICAgIHRlbXBsYXRlLm1ldGFkYXRhID0gewogICAgICAgICAgICBsYWJlbHM6IHRoaXMudmFsdWUud29ya2xvYWRTZWxlY3RvcgogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wbGF0ZS5tZXRhZGF0YS5sYWJlbHMsIHRoaXMudmFsdWUud29ya2xvYWRTZWxlY3Rvcik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0ZW1wbGF0ZS5zcGVjLmNvbnRhaW5lcnMgJiYgdGVtcGxhdGUuc3BlYy5jb250YWluZXJzWzBdKSB7CiAgICAgICAgdmFyIF90ZW1wbGF0ZSRzcGVjJGNvbnRhaTsKICAgICAgICB2YXIgY29udGFpbmVyUmVzb3VyY2VzID0gdGVtcGxhdGUuc3BlYy5jb250YWluZXJzWzBdLnJlc291cmNlczsKICAgICAgICB2YXIgbnZpZGlhR3B1TGltaXQgPSAoX3RlbXBsYXRlJHNwZWMkY29udGFpID0gdGVtcGxhdGUuc3BlYy5jb250YWluZXJzWzBdLnJlc291cmNlcykgPT09IG51bGwgfHwgX3RlbXBsYXRlJHNwZWMkY29udGFpID09PSB2b2lkIDAgfHwgKF90ZW1wbGF0ZSRzcGVjJGNvbnRhaSA9IF90ZW1wbGF0ZSRzcGVjJGNvbnRhaS5saW1pdHMpID09PSBudWxsIHx8IF90ZW1wbGF0ZSRzcGVjJGNvbnRhaSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RlbXBsYXRlJHNwZWMkY29udGFpW0dQVV9LRVldOwoKICAgICAgICAvLyBUaG91Z2ggbm90IHJlcXVpcmVkLCByZXF1ZXN0cyBhcmUgYWxzbyBzZXQgdG8gbWlycm9yIHRoZSBlbWJlciB1aQogICAgICAgIGlmIChudmlkaWFHcHVMaW1pdCA+IDApIHsKICAgICAgICAgIGNvbnRhaW5lclJlc291cmNlcy5yZXF1ZXN0cyA9IGNvbnRhaW5lclJlc291cmNlcy5yZXF1ZXN0cyB8fCB7fTsKICAgICAgICAgIGNvbnRhaW5lclJlc291cmNlcy5yZXF1ZXN0c1tHUFVfS0VZXSA9IG52aWRpYUdwdUxpbWl0OwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMubnZpZGlhSXNWYWxpZChudmlkaWFHcHVMaW1pdCkpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRlbGV0ZSBjb250YWluZXJSZXNvdXJjZXMucmVxdWVzdHNbR1BVX0tFWV07CiAgICAgICAgICAgIGRlbGV0ZSBjb250YWluZXJSZXNvdXJjZXMubGltaXRzW0dQVV9LRVldOwogICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoY29udGFpbmVyUmVzb3VyY2VzLmxpbWl0cykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgZGVsZXRlIGNvbnRhaW5lclJlc291cmNlcy5saW1pdHM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGNvbnRhaW5lclJlc291cmNlcy5yZXF1ZXN0cykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgZGVsZXRlIGNvbnRhaW5lclJlc291cmNlcy5yZXF1ZXN0czsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoY29udGFpbmVyUmVzb3VyY2VzKS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICBkZWxldGUgdGVtcGxhdGUuc3BlYy5jb250YWluZXJzWzBdLnJlc291cmNlczsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoX3VudXNlZCkge30KICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIG5vZGVBZmZpbml0eSA9ICgoX3RlbXBsYXRlID0gdGVtcGxhdGUpID09PSBudWxsIHx8IF90ZW1wbGF0ZSA9PT0gdm9pZCAwIHx8IChfdGVtcGxhdGUgPSBfdGVtcGxhdGUuc3BlYykgPT09IG51bGwgfHwgX3RlbXBsYXRlID09PSB2b2lkIDAgfHwgKF90ZW1wbGF0ZSA9IF90ZW1wbGF0ZS5hZmZpbml0eSkgPT09IG51bGwgfHwgX3RlbXBsYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVtcGxhdGUubm9kZUFmZmluaXR5KSB8fCB7fTsKICAgICAgdmFyIHBvZEFmZmluaXR5ID0gKChfdGVtcGxhdGUyID0gdGVtcGxhdGUpID09PSBudWxsIHx8IF90ZW1wbGF0ZTIgPT09IHZvaWQgMCB8fCAoX3RlbXBsYXRlMiA9IF90ZW1wbGF0ZTIuc3BlYykgPT09IG51bGwgfHwgX3RlbXBsYXRlMiA9PT0gdm9pZCAwIHx8IChfdGVtcGxhdGUyID0gX3RlbXBsYXRlMi5hZmZpbml0eSkgPT09IG51bGwgfHwgX3RlbXBsYXRlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RlbXBsYXRlMi5wb2RBZmZpbml0eSkgfHwge307CiAgICAgIHZhciBwb2RBbnRpQWZmaW5pdHkgPSAoKF90ZW1wbGF0ZTMgPSB0ZW1wbGF0ZSkgPT09IG51bGwgfHwgX3RlbXBsYXRlMyA9PT0gdm9pZCAwIHx8IChfdGVtcGxhdGUzID0gX3RlbXBsYXRlMy5zcGVjKSA9PT0gbnVsbCB8fCBfdGVtcGxhdGUzID09PSB2b2lkIDAgfHwgKF90ZW1wbGF0ZTMgPSBfdGVtcGxhdGUzLmFmZmluaXR5KSA9PT0gbnVsbCB8fCBfdGVtcGxhdGUzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVtcGxhdGUzLnBvZEFudGlBZmZpbml0eSkgfHwge307CiAgICAgIHRoaXMuZml4Tm9kZUFmZmluaXR5KG5vZGVBZmZpbml0eSk7CiAgICAgIHRoaXMuZml4UG9kQWZmaW5pdHkocG9kQWZmaW5pdHkpOwoKICAgICAgLy8gVGhlIGZpZWxkcyBhcmUgYmVpbmcgcmVtb3ZlZCBiZWNhdXNlIHRoZXkgYXJlIG5vdCBhbGxvd2VkIHRvIGJlIGVkaXRhYmJsZQogICAgICBpZiAodGhpcy5tb2RlID09PSBfRURJVCkgewogICAgICAgIHZhciBfdGVtcGxhdGU0LCBfdGVtcGxhdGU1LCBfdGVtcGxhdGU2LCBfdGVtcGxhdGU3OwogICAgICAgIGlmICgoX3RlbXBsYXRlNCA9IHRlbXBsYXRlKSAhPT0gbnVsbCAmJiBfdGVtcGxhdGU0ICE9PSB2b2lkIDAgJiYgKF90ZW1wbGF0ZTQgPSBfdGVtcGxhdGU0LnNwZWMpICE9PSBudWxsICYmIF90ZW1wbGF0ZTQgIT09IHZvaWQgMCAmJiBfdGVtcGxhdGU0LmFmZmluaXR5ICYmIE9iamVjdC5rZXlzKChfdGVtcGxhdGU1ID0gdGVtcGxhdGUpID09PSBudWxsIHx8IF90ZW1wbGF0ZTUgPT09IHZvaWQgMCB8fCAoX3RlbXBsYXRlNSA9IF90ZW1wbGF0ZTUuc3BlYykgPT09IG51bGwgfHwgX3RlbXBsYXRlNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RlbXBsYXRlNS5hZmZpbml0eSkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBkZWxldGUgdGVtcGxhdGUuc3BlYy5hZmZpbml0eTsKICAgICAgICB9CgogICAgICAgIC8vIFJlbW92aW5nIGBhZmZpbml0eWAgZml4ZXMgdGhlIGlzc3VlIHdpdGggc2V0dGluZyB0aGUgYGltYWdlUHVsbFNlY3JldHNgCiAgICAgICAgLy8gSG93ZXZlciwgdGhpcyBmaWVsZCBzaG91bGQgbm90IGJlIHNldC4gVGhlcmVmb3JlIHRoaXMgaXMgZXhwbGljaXRseSByZW1vdmVkLgogICAgICAgIGlmICgoX3RlbXBsYXRlNiA9IHRlbXBsYXRlKSAhPT0gbnVsbCAmJiBfdGVtcGxhdGU2ICE9PSB2b2lkIDAgJiYgKF90ZW1wbGF0ZTYgPSBfdGVtcGxhdGU2LnNwZWMpICE9PSBudWxsICYmIF90ZW1wbGF0ZTYgIT09IHZvaWQgMCAmJiBfdGVtcGxhdGU2LmltYWdlUHVsbFNlY3JldHMgJiYgKChfdGVtcGxhdGU3ID0gdGVtcGxhdGUpID09PSBudWxsIHx8IF90ZW1wbGF0ZTcgPT09IHZvaWQgMCB8fCAoX3RlbXBsYXRlNyA9IF90ZW1wbGF0ZTcuc3BlYykgPT09IG51bGwgfHwgX3RlbXBsYXRlNyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RlbXBsYXRlNy5pbWFnZVB1bGxTZWNyZXRzLmxlbmd0aCkgPT09IDApIHsKICAgICAgICAgIGRlbGV0ZSB0ZW1wbGF0ZS5zcGVjLmltYWdlUHVsbFNlY3JldHM7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuZml4UG9kQWZmaW5pdHkocG9kQW50aUFmZmluaXR5KTsKICAgICAgdGhpcy5maXhQb2RTZWN1cml0eUNvbnRleHQodGhpcy5wb2RUZW1wbGF0ZVNwZWMpOwogICAgICB0ZW1wbGF0ZS5tZXRhZGF0YS5uYW1lc3BhY2UgPSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWVzcGFjZTsKCiAgICAgIC8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBoYXMgY2hhbmdlZCB0aGUgbmFtZSBvZiB0aGUgd29ya2xvYWQKICAgICAgLy8gT25seSBkbyB0aGlzIGZvciBjbG9uZS4gTm90IGFsbG93ZWQgZm9yIGVkaXQKICAgICAgaWYgKHRoaXMucmVhbE1vZGUgPT09IF9DTE9ORSkgewogICAgICAgIHRlbXBsYXRlLm1ldGFkYXRhLm5hbWUgPSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWU7CiAgICAgICAgdGVtcGxhdGUubWV0YWRhdGEuZGVzY3JpcHRpb24gPSB0aGlzLnZhbHVlLm1ldGFkYXRhLmRlc2NyaXB0aW9uOwogICAgICB9CgogICAgICAvLyBkZWxldGUgdGhpcy52YWx1ZS5raW5kOwogICAgICBpZiAodGhpcy5jb250YWluZXIgJiYgIXRoaXMuY29udGFpbmVyLm5hbWUpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5jb250YWluZXIsICduYW1lJywgdGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lKTsKICAgICAgfQogICAgICB2YXIgcG9ydHMgPSB0aGlzLnZhbHVlLmNvbnRhaW5lcnMucmVkdWNlKGZ1bmN0aW9uICh0b3RhbCwgZWFjaCkgewogICAgICAgIHZhciBjb250YWluZXJQb3J0cyA9IGVhY2gucG9ydHMgfHwgW107CiAgICAgICAgdG90YWwucHVzaC5hcHBseSh0b3RhbCwgX3RvQ29uc3VtYWJsZUFycmF5KGNvbnRhaW5lclBvcnRzLmZpbHRlcihmdW5jdGlvbiAocG9ydCkgewogICAgICAgICAgcmV0dXJuIHBvcnQuX3NlcnZpY2VUeXBlICYmIHBvcnQuX3NlcnZpY2VUeXBlICE9PSAnJzsKICAgICAgICB9KSkpOwogICAgICAgIHJldHVybiB0b3RhbDsKICAgICAgfSwgW10pOwoKICAgICAgLy8gcG9ydHMgY29udGFpbiBpbmZvIHVzZWQgdG8gY3JlYXRlIHNlcnZpY2VzIGFmdGVyIHNhdmluZwogICAgICB0aGlzLnBvcnRzRm9yU2VydmljZXMgPSBwb3J0czsKICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLnZhbHVlLCB7CiAgICAgICAgc3BlYzogdGhpcy5zcGVjCiAgICAgIH0pOwogICAgfSwKICAgIC8vIG5vZGUgYW5kIHBvZCBhZmZpbml0eSBhcmUgZm9ybWF0dGVkIGluY29ycmVjdGx5IGZyb20gQVBJOyBmaXggYmVmb3JlIHNhdmluZwogICAgZml4Tm9kZUFmZmluaXR5OiBmdW5jdGlvbiBmaXhOb2RlQWZmaW5pdHkobm9kZUFmZmluaXR5KSB7CiAgICAgIHZhciBwcmVmZXJyZWREdXJpbmdTY2hlZHVsaW5nSWdub3JlZER1cmluZ0V4ZWN1dGlvbiA9IG5vZGVBZmZpbml0eS5wcmVmZXJyZWREdXJpbmdTY2hlZHVsaW5nSWdub3JlZER1cmluZ0V4ZWN1dGlvbiB8fCBbXTsKICAgICAgdmFyIHJlcXVpcmVkRHVyaW5nU2NoZWR1bGluZ0lnbm9yZWREdXJpbmdFeGVjdXRpb24gPSBub2RlQWZmaW5pdHkucmVxdWlyZWREdXJpbmdTY2hlZHVsaW5nSWdub3JlZER1cmluZ0V4ZWN1dGlvbiB8fCB7fTsKICAgICAgcHJlZmVycmVkRHVyaW5nU2NoZWR1bGluZ0lnbm9yZWREdXJpbmdFeGVjdXRpb24uZm9yRWFjaChmdW5jdGlvbiAodGVybSkgewogICAgICAgIHZhciBfdGVybSRwcmVmZXJlbmNlOwogICAgICAgIHZhciBtYXRjaEV4cHJlc3Npb25zID0gKHRlcm0gPT09IG51bGwgfHwgdGVybSA9PT0gdm9pZCAwIHx8IChfdGVybSRwcmVmZXJlbmNlID0gdGVybS5wcmVmZXJlbmNlKSA9PT0gbnVsbCB8fCBfdGVybSRwcmVmZXJlbmNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVybSRwcmVmZXJlbmNlLm1hdGNoRXhwcmVzc2lvbnMpIHx8IFtdOwogICAgICAgIG1hdGNoRXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAoZXhwcmVzc2lvbikgewogICAgICAgICAgaWYgKGV4cHJlc3Npb24udmFsdWVzKSB7CiAgICAgICAgICAgIGV4cHJlc3Npb24udmFsdWVzID0gdHlwZW9mIGV4cHJlc3Npb24udmFsdWVzID09PSAnc3RyaW5nJyA/IFtleHByZXNzaW9uLnZhbHVlc10gOiBfdG9Db25zdW1hYmxlQXJyYXkoZXhwcmVzc2lvbi52YWx1ZXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgKHJlcXVpcmVkRHVyaW5nU2NoZWR1bGluZ0lnbm9yZWREdXJpbmdFeGVjdXRpb24ubm9kZVNlbGVjdG9yVGVybXMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKHRlcm0pIHsKICAgICAgICB2YXIgbWF0Y2hFeHByZXNzaW9ucyA9IHRlcm0ubWF0Y2hFeHByZXNzaW9ucyB8fCBbXTsKICAgICAgICBtYXRjaEV4cHJlc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKGV4cHJlc3Npb24pIHsKICAgICAgICAgIGlmIChleHByZXNzaW9uLnZhbHVlcykgewogICAgICAgICAgICBleHByZXNzaW9uLnZhbHVlcyA9IHR5cGVvZiBleHByZXNzaW9uLnZhbHVlcyA9PT0gJ3N0cmluZycgPyBbZXhwcmVzc2lvbi52YWx1ZXNdIDogX3RvQ29uc3VtYWJsZUFycmF5KGV4cHJlc3Npb24udmFsdWVzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZml4UG9kQWZmaW5pdHk6IGZ1bmN0aW9uIGZpeFBvZEFmZmluaXR5KHBvZEFmZmluaXR5KSB7CiAgICAgIHZhciBwcmVmZXJyZWREdXJpbmdTY2hlZHVsaW5nSWdub3JlZER1cmluZ0V4ZWN1dGlvbiA9IHBvZEFmZmluaXR5LnByZWZlcnJlZER1cmluZ1NjaGVkdWxpbmdJZ25vcmVkRHVyaW5nRXhlY3V0aW9uIHx8IFtdOwogICAgICB2YXIgcmVxdWlyZWREdXJpbmdTY2hlZHVsaW5nSWdub3JlZER1cmluZ0V4ZWN1dGlvbiA9IHBvZEFmZmluaXR5LnJlcXVpcmVkRHVyaW5nU2NoZWR1bGluZ0lnbm9yZWREdXJpbmdFeGVjdXRpb24gfHwgW107CiAgICAgIHByZWZlcnJlZER1cmluZ1NjaGVkdWxpbmdJZ25vcmVkRHVyaW5nRXhlY3V0aW9uLmZvckVhY2goZnVuY3Rpb24gKHRlcm0pIHsKICAgICAgICB2YXIgX3Rlcm0kcG9kQWZmaW5pdHlUZXJtOwogICAgICAgIHZhciBtYXRjaEV4cHJlc3Npb25zID0gKHRlcm0gPT09IG51bGwgfHwgdGVybSA9PT0gdm9pZCAwIHx8IChfdGVybSRwb2RBZmZpbml0eVRlcm0gPSB0ZXJtLnBvZEFmZmluaXR5VGVybSkgPT09IG51bGwgfHwgX3Rlcm0kcG9kQWZmaW5pdHlUZXJtID09PSB2b2lkIDAgfHwgKF90ZXJtJHBvZEFmZmluaXR5VGVybSA9IF90ZXJtJHBvZEFmZmluaXR5VGVybS5sYWJlbFNlbGVjdG9yKSA9PT0gbnVsbCB8fCBfdGVybSRwb2RBZmZpbml0eVRlcm0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90ZXJtJHBvZEFmZmluaXR5VGVybS5tYXRjaEV4cHJlc3Npb25zKSB8fCBbXTsKICAgICAgICBtYXRjaEV4cHJlc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKGV4cHJlc3Npb24pIHsKICAgICAgICAgIGlmIChleHByZXNzaW9uLnZhbHVlcykgewogICAgICAgICAgICBleHByZXNzaW9uLnZhbHVlcyA9IHR5cGVvZiBleHByZXNzaW9uLnZhbHVlcyA9PT0gJ3N0cmluZycgPyBbZXhwcmVzc2lvbi52YWx1ZXNdIDogX3RvQ29uc3VtYWJsZUFycmF5KGV4cHJlc3Npb24udmFsdWVzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHJlcXVpcmVkRHVyaW5nU2NoZWR1bGluZ0lnbm9yZWREdXJpbmdFeGVjdXRpb24uZm9yRWFjaChmdW5jdGlvbiAodGVybSkgewogICAgICAgIHZhciBfdGVybSRsYWJlbFNlbGVjdG9yOwogICAgICAgIHZhciBtYXRjaEV4cHJlc3Npb25zID0gKHRlcm0gPT09IG51bGwgfHwgdGVybSA9PT0gdm9pZCAwIHx8IChfdGVybSRsYWJlbFNlbGVjdG9yID0gdGVybS5sYWJlbFNlbGVjdG9yKSA9PT0gbnVsbCB8fCBfdGVybSRsYWJlbFNlbGVjdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVybSRsYWJlbFNlbGVjdG9yLm1hdGNoRXhwcmVzc2lvbnMpIHx8IFtdOwogICAgICAgIG1hdGNoRXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAoZXhwcmVzc2lvbikgewogICAgICAgICAgaWYgKGV4cHJlc3Npb24udmFsdWVzKSB7CiAgICAgICAgICAgIGV4cHJlc3Npb24udmFsdWVzID0gdHlwZW9mIGV4cHJlc3Npb24udmFsdWVzID09PSAnc3RyaW5nJyA/IFtleHByZXNzaW9uLnZhbHVlc10gOiBfdG9Db25zdW1hYmxlQXJyYXkoZXhwcmVzc2lvbi52YWx1ZXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIHBvZEFmZmluaXR5OwogICAgfSwKICAgIGZpeFBvZFNlY3VyaXR5Q29udGV4dDogZnVuY3Rpb24gZml4UG9kU2VjdXJpdHlDb250ZXh0KHBvZFRlbXBTcGVjKSB7CiAgICAgIGlmICh0aGlzLnBvZEZzR3JvdXApIHsKICAgICAgICBwb2RUZW1wU3BlYy5zZWN1cml0eUNvbnRleHQgPSBwb2RUZW1wU3BlYy5zZWN1cml0eUNvbnRleHQgfHwge307CiAgICAgICAgcG9kVGVtcFNwZWMuc2VjdXJpdHlDb250ZXh0LmZzR3JvdXAgPSB0aGlzLnBvZEZzR3JvdXA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF9wb2RUZW1wU3BlYyRzZWN1cml0eTsKICAgICAgICBpZiAoKF9wb2RUZW1wU3BlYyRzZWN1cml0eSA9IHBvZFRlbXBTcGVjLnNlY3VyaXR5Q29udGV4dCkgIT09IG51bGwgJiYgX3BvZFRlbXBTcGVjJHNlY3VyaXR5ICE9PSB2b2lkIDAgJiYgX3BvZFRlbXBTcGVjJHNlY3VyaXR5LmZzR3JvdXApIHsKICAgICAgICAgIGRlbGV0ZSBwb2RUZW1wU3BlYy5zZWN1cml0eUNvbnRleHQuZnNHcm91cDsKICAgICAgICB9CiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHBvZFRlbXBTcGVjLnNlY3VyaXR5Q29udGV4dCB8fCB7fSkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBkZWxldGUgcG9kVGVtcFNwZWMuc2VjdXJpdHlDb250ZXh0OwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNlbGVjdFR5cGU6IGZ1bmN0aW9uIHNlbGVjdFR5cGUodHlwZSkgewogICAgICBpZiAoIXRoaXMudHlwZSAmJiB0eXBlKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoewogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIHJlc291cmNlOiB0eXBlCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50eXBlID0gdHlwZTsKICAgICAgfQogICAgfSwKICAgIHNlbGVjdENvbnRhaW5lcjogZnVuY3Rpb24gc2VsZWN0Q29udGFpbmVyKGNvbnRhaW5lcikgewogICAgICBpZiAoY29udGFpbmVyLl9fYWRkKSB7CiAgICAgICAgdGhpcy5hZGRDb250YWluZXIoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgKHRoaXMuYWxsQ29udGFpbmVycyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbiAoY29udGFpbmVyKSB7CiAgICAgICAgaWYgKGNvbnRhaW5lci5fX2FjdGl2ZSkgewogICAgICAgICAgZGVsZXRlIGNvbnRhaW5lci5fX2FjdGl2ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBjb250YWluZXIuX19hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjsKICAgICAgdGhpcy5jb250YWluZXJDaGFuZ2UrKzsKICAgIH0sCiAgICBhZGRDb250YWluZXI6IGZ1bmN0aW9uIGFkZENvbnRhaW5lcigpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHZhciBuYW1lTnVtYmVyID0gdGhpcy5hbGxDb250YWluZXJzLmxlbmd0aDsKICAgICAgdmFyIGFsbE5hbWVzID0gdGhpcy5hbGxDb250YWluZXJzLnJlZHVjZShmdW5jdGlvbiAobmFtZXMsIGVhY2gpIHsKICAgICAgICBuYW1lcy5wdXNoKGVhY2gubmFtZSk7CiAgICAgICAgcmV0dXJuIG5hbWVzOwogICAgICB9LCBbXSk7CiAgICAgIHdoaWxlIChhbGxOYW1lcy5pbmNsdWRlcygiY29udGFpbmVyLSIuY29uY2F0KG5hbWVOdW1iZXIpKSkgewogICAgICAgIG5hbWVOdW1iZXIrKzsKICAgICAgfQogICAgICB2YXIgY29udGFpbmVyID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkZWZhdWx0Q29udGFpbmVyKSwge30sIHsKICAgICAgICBuYW1lOiAiY29udGFpbmVyLSIuY29uY2F0KG5hbWVOdW1iZXIpLAogICAgICAgIGFjdGl2ZTogdHJ1ZQogICAgICB9KTsKICAgICAgdGhpcy5wb2RUZW1wbGF0ZVNwZWMuY29udGFpbmVycy5wdXNoKGNvbnRhaW5lcik7CiAgICAgIHRoaXMuc2VsZWN0Q29udGFpbmVyKGNvbnRhaW5lcik7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3RoaXM2JCRyZWZzJGNvbnRhaW5lOwogICAgICAgIChfdGhpczYkJHJlZnMkY29udGFpbmUgPSBfdGhpczYuJHJlZnMuY29udGFpbmVyc1RhYmJlZCkgPT09IG51bGwgfHwgX3RoaXM2JCRyZWZzJGNvbnRhaW5lID09PSB2b2lkIDAgfHwgX3RoaXM2JCRyZWZzJGNvbnRhaW5lLnNlbGVjdChjb250YWluZXIubmFtZSk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbW92ZUNvbnRhaW5lcjogZnVuY3Rpb24gcmVtb3ZlQ29udGFpbmVyKGNvbnRhaW5lcikgewogICAgICBpZiAoY29udGFpbmVyLl9pbml0KSB7CiAgICAgICAgcmVtb3ZlT2JqZWN0KHRoaXMucG9kVGVtcGxhdGVTcGVjLmluaXRDb250YWluZXJzLCBjb250YWluZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlbW92ZU9iamVjdCh0aGlzLnBvZFRlbXBsYXRlU3BlYy5jb250YWluZXJzLCBjb250YWluZXIpOwogICAgICB9CiAgICAgIHRoaXMuc2VsZWN0Q29udGFpbmVyKHRoaXMuYWxsQ29udGFpbmVyc1swXSk7CiAgICB9LAogICAgdXBkYXRlSW5pdENvbnRhaW5lcjogZnVuY3Rpb24gdXBkYXRlSW5pdENvbnRhaW5lcihuZXUsIGNvbnRhaW5lcikgewogICAgICB2YXIgX3RoaXMkcG9kVGVtcGxhdGVTcGVjMzsKICAgICAgaWYgKCFjb250YWluZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGNvbnRhaW5lcnMgPSB0aGlzLnBvZFRlbXBsYXRlU3BlYy5jb250YWluZXJzOwogICAgICB2YXIgaW5pdENvbnRhaW5lcnMgPSAoX3RoaXMkcG9kVGVtcGxhdGVTcGVjMyA9IHRoaXMucG9kVGVtcGxhdGVTcGVjLmluaXRDb250YWluZXJzKSAhPT0gbnVsbCAmJiBfdGhpcyRwb2RUZW1wbGF0ZVNwZWMzICE9PSB2b2lkIDAgPyBfdGhpcyRwb2RUZW1wbGF0ZVNwZWMzIDogW107CiAgICAgIGlmIChuZXUpIHsKICAgICAgICB0aGlzLnBvZFRlbXBsYXRlU3BlYy5pbml0Q29udGFpbmVycyA9IGluaXRDb250YWluZXJzOwogICAgICAgIGNvbnRhaW5lci5faW5pdCA9IHRydWU7CiAgICAgICAgaWYgKCFpbml0Q29udGFpbmVycy5pbmNsdWRlcyhjb250YWluZXIpKSB7CiAgICAgICAgICBpbml0Q29udGFpbmVycy5wdXNoKGNvbnRhaW5lcik7CiAgICAgICAgfQogICAgICAgIHJlbW92ZU9iamVjdChjb250YWluZXJzLCBjb250YWluZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRhaW5lci5faW5pdCA9IGZhbHNlOwogICAgICAgIHJlbW92ZU9iamVjdChpbml0Q29udGFpbmVycywgY29udGFpbmVyKTsKICAgICAgICBpZiAoIWNvbnRhaW5lcnMuaW5jbHVkZXMoY29udGFpbmVyKSkgewogICAgICAgICAgY29udGFpbmVycy5wdXNoKGNvbnRhaW5lcik7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2xlYXJQdmNGb3JtU3RhdGU6IGZ1bmN0aW9uIGNsZWFyUHZjRm9ybVN0YXRlKGhvb2tOYW1lKSB7CiAgICAgIC8vIE9uIHRoZSBgY2xvc2VQdmNGb3JtYCBldmVudCwgcmVtb3ZlIHRoZQogICAgICAvLyBiZWZvcmUgc2F2ZSBob29rIHRvIHByZXZlbnQgdGhlIFBWQyBmcm9tCiAgICAgIC8vIGJlaW5nIGNyZWF0ZWQuIFVzZSB0aGUgUFZDJ3MgdW5pcXVlIElEIHRvIGRpc3Rpbmd1aXNoCiAgICAgIC8vIGJldHdlZW4gaG9va3MgZm9yIGRpZmZlcmVudCBQVkNzLgogICAgICBpZiAodGhpc1tCRUZPUkVfU0FWRV9IT09LU10pIHsKICAgICAgICB0aGlzLnVucmVnaXN0ZXJCZWZvcmVTYXZlSG9vayhob29rTmFtZSk7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVTZXJ2aWNlQWNjb3VudDogZnVuY3Rpb24gdXBkYXRlU2VydmljZUFjY291bnQobmV1KSB7CiAgICAgIGlmIChuZXUpIHsKICAgICAgICB0aGlzLnBvZFRlbXBsYXRlU3BlYy5zZXJ2aWNlQWNjb3VudCA9IG5ldTsKICAgICAgICB0aGlzLnBvZFRlbXBsYXRlU3BlYy5zZXJ2aWNlQWNjb3VudE5hbWUgPSBuZXU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gTm90ZSAtIGJvdGggaGF2ZSB0byBiZSByZW1vdmVkIGluIG9yZGVyIGZvciByZW1vdmFsIHRvIHdvcmsKICAgICAgICBkZWxldGUgdGhpcy5wb2RUZW1wbGF0ZVNwZWMuc2VydmljZUFjY291bnQ7CiAgICAgICAgZGVsZXRlIHRoaXMucG9kVGVtcGxhdGVTcGVjLnNlcnZpY2VBY2NvdW50TmFtZTsKICAgICAgfQogICAgfSwKICAgIG52aWRpYUlzVmFsaWQ6IGZ1bmN0aW9uIG52aWRpYUlzVmFsaWQobnZpZGlhR3B1TGltaXQpIHsKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHBhcnNlSW50KG52aWRpYUdwdUxpbWl0KSkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKG52aWRpYUdwdUxpbWl0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKG52aWRpYUdwdUxpbWl0IDwgMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgLy8KICAgIH0sCiAgICBjbGVhblVwQ2xvbmVkSm9iRGF0YTogZnVuY3Rpb24gY2xlYW5VcENsb25lZEpvYkRhdGEoKSB7CiAgICAgIHZhciBfdGhpcyR2YWx1ZTMsIF90aGlzJHZhbHVlNCwgX3RoaXMkdmFsdWU1LCBfdGhpcyR2YWx1ZTY7CiAgICAgIHZhciBhbm5vdGF0aW9ucyA9IChfdGhpcyR2YWx1ZTMgPSB0aGlzLnZhbHVlKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZTMgPT09IHZvaWQgMCB8fCAoX3RoaXMkdmFsdWUzID0gX3RoaXMkdmFsdWUzLm1ldGFkYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZTMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHZhbHVlMy5hbm5vdGF0aW9uczsKICAgICAgaWYgKGFubm90YXRpb25zKSB7CiAgICAgICAgdGhpcy4kZGVsZXRlKGFubm90YXRpb25zLCAnYmF0Y2gua3ViZXJuZXRlcy5pby9qb2ItdHJhY2tpbmcnKTsKICAgICAgfQogICAgICB2YXIgbGFiZWxzID0gKF90aGlzJHZhbHVlNCA9IHRoaXMudmFsdWUpID09PSBudWxsIHx8IF90aGlzJHZhbHVlNCA9PT0gdm9pZCAwIHx8IChfdGhpcyR2YWx1ZTQgPSBfdGhpcyR2YWx1ZTQubWV0YWRhdGEpID09PSBudWxsIHx8IF90aGlzJHZhbHVlNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkdmFsdWU0LmxhYmVsczsKICAgICAgaWYgKGxhYmVscykgewogICAgICAgIHRoaXMuJGRlbGV0ZShsYWJlbHMsICdiYXRjaC5rdWJlcm5ldGVzLmlvL2NvbnRyb2xsZXItdWlkJyk7CiAgICAgICAgdGhpcy4kZGVsZXRlKGxhYmVscywgJ2JhdGNoLmt1YmVybmV0ZXMuaW8vam9iLW5hbWUnKTsKICAgICAgICB0aGlzLiRkZWxldGUobGFiZWxzLCAnY29udHJvbGxlci11aWQnKTsKICAgICAgICB0aGlzLiRkZWxldGUobGFiZWxzLCAnam9iLW5hbWUnKTsKICAgICAgfQogICAgICB2YXIgbWF0Y2hMYWJlbHMgPSAoX3RoaXMkdmFsdWU1ID0gdGhpcy52YWx1ZSkgPT09IG51bGwgfHwgX3RoaXMkdmFsdWU1ID09PSB2b2lkIDAgfHwgKF90aGlzJHZhbHVlNSA9IF90aGlzJHZhbHVlNS5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZTUgPT09IHZvaWQgMCB8fCAoX3RoaXMkdmFsdWU1ID0gX3RoaXMkdmFsdWU1LnNlbGVjdG9yKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZTUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHZhbHVlNS5tYXRjaExhYmVsczsKICAgICAgaWYgKG1hdGNoTGFiZWxzKSB7CiAgICAgICAgdGhpcy4kZGVsZXRlKG1hdGNoTGFiZWxzLCAnYmF0Y2gua3ViZXJuZXRlcy5pby9jb250cm9sbGVyLXVpZCcpOwogICAgICB9CiAgICAgIHZhciB0ZW1wbGF0ZUxhYmVscyA9IChfdGhpcyR2YWx1ZTYgPSB0aGlzLnZhbHVlKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZTYgPT09IHZvaWQgMCB8fCAoX3RoaXMkdmFsdWU2ID0gX3RoaXMkdmFsdWU2LnNwZWMpID09PSBudWxsIHx8IF90aGlzJHZhbHVlNiA9PT0gdm9pZCAwIHx8IChfdGhpcyR2YWx1ZTYgPSBfdGhpcyR2YWx1ZTYudGVtcGxhdGUpID09PSBudWxsIHx8IF90aGlzJHZhbHVlNiA9PT0gdm9pZCAwIHx8IChfdGhpcyR2YWx1ZTYgPSBfdGhpcyR2YWx1ZTYubWV0YWRhdGEpID09PSBudWxsIHx8IF90aGlzJHZhbHVlNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkdmFsdWU2LmxhYmVsczsKICAgICAgaWYgKHRlbXBsYXRlTGFiZWxzKSB7CiAgICAgICAgdGhpcy4kZGVsZXRlKHRlbXBsYXRlTGFiZWxzLCAnYmF0Y2gua3ViZXJuZXRlcy5pby9jb250cm9sbGVyLXVpZCcpOwogICAgICAgIHRoaXMuJGRlbGV0ZSh0ZW1wbGF0ZUxhYmVscywgJ2JhdGNoLmt1YmVybmV0ZXMuaW8vam9iLW5hbWUnKTsKICAgICAgICB0aGlzLiRkZWxldGUodGVtcGxhdGVMYWJlbHMsICdjb250cm9sbGVyLXVpZCcpOwogICAgICAgIHRoaXMuJGRlbGV0ZSh0ZW1wbGF0ZUxhYmVscywgJ2pvYi1uYW1lJyk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["mapGetters","omitBy","cleanUp","CONFIG_MAP","SECRET","WORKLOAD_TYPES","NODE","SERVICE","PVC","SERVICE_ACCOUNT","CAPI","POD","LIST_WORKLOAD_TYPES","HCI","Tab","CreateEditView","ResourceManager","LabeledSelect","LabeledInput","ServiceNameSelect","HealthCheck","Security","Upgrading","Loading","Networking","VolumeClaimTemplate","Job","_EDIT","_CREATE","_VIEW","_CLONE","WorkloadPorts","ContainerResourceLimit","KeyValue","Tabbed","NodeScheduling","PodAffinity","Tolerations","CruResource","Command","LifecycleHooks","Storage","ContainerMountPaths","Labels","RadioGroup","UI_MANAGED","removeObject","BEFORE_SAVE_HOOKS","NameNsDescription","formRulesGenerator","TYPES","SECRET_TYPES","defaultContainer","allHash","TAB_WEIGHT_MAP","general","healthCheck","labels","networking","nodeScheduling","podScheduling","resources","upgrading","securityContext","storage","volumeClaimTemplates","GPU_KEY","ID_KEY","Symbol","serialMaker","prefix","seq","setPrefix","p","setSeq","s","genSym","result","name","components","mixins","props","value","type","Object","required","mode","String","default","createOption","text","metadata","Function","fetch","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","fetches","wrap","_callee$","_context","prev","next","$store","getters","RANCHER_CLUSTER","rancherClusters","dispatch","HARVESTER_CONFIG","harvesterConfigs","resourceManagerFetchSecondaryResources","secondaryResourceData","getServicesOwned","servicesOwned","sent","stop","data","_spec$template","_this$value","_podTemplateSpec$secu","$route","params","resource","createSidecar","query","sidecar","spec","podContainers","imagePullPolicy","_objectSpread","podSpec","template","containers","initContainers","$set","realMode","podTemplateSpec","CRON_JOB","jobTemplate","container","hasSidecars","allContainers","concat","_toConsumableArray","init","push","length","_init","selectContainer","JOB","cleanUpClonedJobData","secondaryResourceDataConfig","namespacedConfigMaps","allNodes","allNodeObjects","namespacedSecrets","imagePullNamespacedSecrets","allServices","headlessServices","pvcs","namespacedServiceNames","showTabs","pullPolicyOptions","servicesToRemove","portsForServices","containerChange","tabChange","podFsGroup","fsGroup","savePvcHookName","tabWeightMap","fvFormRuleSets","path","rootObject","rules","translationKey","fvReportedValidationPaths","isNamespaceNew","idKey","computed","tabErrors","_this$fvGetPathErrors","fvGetPathErrors","defaultTab","_container$name","find","c","__active","isEdit","isJob","isCronJob","isReplicable","DEPLOYMENT","REPLICA_SET","REPLICATION_CONTROLLER","STATEFUL_SET","isDeployment","isPod","isStatefulSet","get","_this$spec","set","neu","podLabels","podAnnotations","annotations","_this$podTemplateSpec","_this$podTemplateSpec2","_this2","key","map","each","containerImageRule","containerImage","error","flatResources","_ref","_ref$limits","limits","_ref$requests","requests","limitsCpu","cpu","limitsMemory","memory","limitsGpu","requestsCpu","requestsMemory","out","_defineProperty","_this$container","readinessProbe","livenessProbe","startupProbe","assign","imagePullSecrets","secret","schema","workloadSubTypes","workloadTypes","prop","subtype","id","description","label","nameDisplayFor","bannerAbbrv","initialDisplayFor","containerOptions","isView","__add","t","watch","valueMetadataNamespace","_this3","_callee2","_callee2$","_context2","abrupt","namespace","old","resourceManagerClearSecondaryResources","_this$spec2","_this$spec3","restartPolicy","replicas","schedule","apiVersion","created","registerBeforeHook","saveWorkload","getPorts","registerAfterHook","saveService","methods","_this$value2","applyTo","var","parsingFunc","filter","_type","DOCKER","DOCKER_JSON","node","service","clusterIP","addContainerBtn","typeDisplay","split","letter","match","join","cancel","done","_this4","_callee3","ports","_callee3$","_context3","getPortsWithServiceType","t0","_this5","_callee4","_ref2","_ref2$toSave","toSave","_ref2$toRemove","toRemove","_callee4$","_context4","servicesFromContainerPorts","Promise","all","svc","save","_svc$metadata","ui","remove","_template","_template2","_template3","selector","matchLabels","workloadSelector","_template$spec$contai","containerResources","nvidiaGpuLimit","nvidiaIsValid","keys","_unused","nodeAffinity","affinity","podAffinity","podAntiAffinity","fixNodeAffinity","fixPodAffinity","_template4","_template5","_template6","_template7","fixPodSecurityContext","reduce","total","containerPorts","apply","port","_serviceType","preferredDuringSchedulingIgnoredDuringExecution","requiredDuringSchedulingIgnoredDuringExecution","forEach","term","_term$preference","matchExpressions","preference","expression","values","nodeSelectorTerms","_term$podAffinityTerm","podAffinityTerm","labelSelector","_term$labelSelector","podTempSpec","_podTempSpec$security","selectType","$router","replace","addContainer","_this6","nameNumber","allNames","names","includes","active","$nextTick","_this6$$refs$containe","$refs","containersTabbed","select","removeContainer","updateInitContainer","_this$podTemplateSpec3","clearPvcFormState","hookName","unregisterBeforeSaveHook","updateServiceAccount","serviceAccount","serviceAccountName","Number","isInteger","parseInt","undefined","_this$value3","_this$value4","_this$value5","_this$value6","$delete","templateLabels"],"sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/workload/mixins/workload.js"],"sourcesContent":["import { mapGetters } from 'vuex';\nimport omitBy from 'lodash/omitBy';\nimport { cleanUp } from '@shell/utils/object';\nimport {\n  CONFIG_MAP,\n  SECRET,\n  WORKLOAD_TYPES,\n  NODE,\n  SERVICE,\n  PVC,\n  SERVICE_ACCOUNT,\n  CAPI,\n  POD,\n  LIST_WORKLOAD_TYPES,\n  HCI,\n} from '@shell/config/types';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport ResourceManager from '@shell/mixins/resource-manager';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport ServiceNameSelect from '@shell/components/form/ServiceNameSelect';\nimport HealthCheck from '@shell/components/form/HealthCheck';\nimport Security from '@shell/components/form/Security';\nimport Upgrading from '@shell/edit/workload/Upgrading';\nimport Loading from '@shell/components/Loading';\nimport Networking from '@shell/components/form/Networking';\nimport VolumeClaimTemplate from '@shell/edit/workload/VolumeClaimTemplate';\nimport Job from '@shell/edit/workload/Job';\nimport { _EDIT, _CREATE, _VIEW, _CLONE } from '@shell/config/query-params';\nimport WorkloadPorts from '@shell/components/form/WorkloadPorts';\nimport ContainerResourceLimit from '@shell/components/ContainerResourceLimit';\nimport KeyValue from '@shell/components/form/KeyValue';\nimport Tabbed from '@shell/components/Tabbed';\n\nimport NodeScheduling from '@shell/components/form/NodeScheduling';\nimport PodAffinity from '@shell/components/form/PodAffinity';\nimport Tolerations from '@shell/components/form/Tolerations';\nimport CruResource from '@shell/components/CruResource';\nimport Command from '@shell/components/form/Command';\nimport LifecycleHooks from '@shell/components/form/LifecycleHooks';\nimport Storage from '@shell/edit/workload/storage';\nimport ContainerMountPaths from '@shell/edit/workload/storage/ContainerMountPaths.vue';\nimport Labels from '@shell/components/form/Labels';\nimport { RadioGroup } from '@components/Form/Radio';\nimport { UI_MANAGED } from '@shell/config/labels-annotations';\nimport { removeObject } from '@shell/utils/array';\nimport { BEFORE_SAVE_HOOKS } from '@shell/mixins/child-hook';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport formRulesGenerator from '@shell/utils/validators/formRules';\nimport { TYPES as SECRET_TYPES } from '@shell/models/secret';\nimport { defaultContainer } from '@shell/models/workload';\nimport { allHash } from '@shell/utils/promise';\n\nconst TAB_WEIGHT_MAP = {\n  general:              99,\n  healthCheck:          98,\n  labels:               97,\n  networking:           96,\n  nodeScheduling:       95,\n  podScheduling:        94,\n  resources:            93,\n  upgrading:            92,\n  securityContext:      91,\n  storage:              90,\n  volumeClaimTemplates: 89,\n};\n\nconst GPU_KEY = 'nvidia.com/gpu';\nconst ID_KEY = Symbol('container-id');\n\nconst serialMaker = function() {\n  let prefix = '';\n  let seq = 0;\n\n  return {\n    setPrefix(p) {\n      prefix = p;\n    },\n    setSeq(s) {\n      seq = s;\n    },\n    genSym() {\n      const result = prefix + seq;\n\n      seq += 1;\n\n      return result;\n    }\n  };\n}();\n\nexport default {\n  name:       'CruWorkload',\n  components: {\n    ContainerResourceLimit,\n    Command,\n    CruResource,\n    HealthCheck,\n    Job,\n    KeyValue,\n    LabeledInput,\n    LabeledSelect,\n    Labels,\n    LifecycleHooks,\n    Loading,\n    NameNsDescription,\n    Networking,\n    NodeScheduling,\n    PodAffinity,\n    RadioGroup,\n    Security,\n    ServiceNameSelect,\n    Storage,\n    Tab,\n    Tabbed,\n    Tolerations,\n    Upgrading,\n    VolumeClaimTemplate,\n    WorkloadPorts,\n    ContainerMountPaths\n  },\n\n  mixins: [CreateEditView, ResourceManager],\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    mode: {\n      type:    String,\n      default: 'create',\n    },\n\n    createOption: {\n      default: (text) => {\n        if (text) {\n          return { metadata: { name: text } };\n        }\n      },\n      type: Function\n    },\n  },\n\n  async fetch() {\n    // TODO Should remove these lines\n    // ? The results aren't stored, so don't know why we fetch?\n\n    // User might not have access to these resources - so check before trying to fetch\n    const fetches = {};\n\n    if (this.$store.getters[`management/canList`](CAPI.RANCHER_CLUSTER)) {\n      fetches.rancherClusters = this.$store.dispatch('management/findAll', { type: CAPI.RANCHER_CLUSTER });\n    }\n\n    if (this.$store.getters[`management/canList`](HCI.HARVESTER_CONFIG)) {\n      fetches.harvesterConfigs = this.$store.dispatch('management/findAll', { type: HCI.HARVESTER_CONFIG });\n    }\n\n    await allHash(fetches);\n\n    // don't block UI for these resources\n    this.resourceManagerFetchSecondaryResources(this.secondaryResourceData);\n    this.servicesOwned = await this.value.getServicesOwned();\n  },\n\n  data() {\n    serialMaker.setPrefix('container-');\n    serialMaker.setSeq(0);\n    let type = this.$route.params.resource;\n    const createSidecar = !!this.$route.query.sidecar;\n\n    if (type === 'workload') {\n      type = null;\n    }\n\n    if (!this.value.spec) {\n      this.value.spec = {};\n      if (this.value.type === POD) {\n        const podContainers = [{\n          imagePullPolicy: 'Always',\n          name:            `container-0`,\n        }];\n\n        const metadata = { ...this.value.metadata };\n\n        const podSpec = { template: { spec: { containers: podContainers, initContainers: [] }, metadata } };\n\n        this.$set(this.value, 'spec', podSpec);\n      }\n    }\n\n    // EDIT view for POD\n    // Transform it from POD world to workload\n    if ((this.mode === _EDIT || this.mode === _VIEW || this.realMode === _CLONE ) && this.value.type === 'pod') {\n      const podSpec = { ...this.value.spec };\n      const metadata = { ...this.value.metadata };\n\n      this.$set(this.value.spec, 'template', { spec: podSpec, metadata });\n    }\n\n    const spec = this.value.spec;\n    let podTemplateSpec = type === WORKLOAD_TYPES.CRON_JOB ? spec.jobTemplate.spec.template.spec : spec?.template?.spec;\n\n    let containers = podTemplateSpec.containers || [];\n    let container;\n\n    if (this.mode === _VIEW && this.value.type === 'pod' ) {\n      podTemplateSpec = spec;\n    }\n\n    if (\n      this.mode === _CREATE ||\n      this.mode === _VIEW ||\n      this.realMode === _CLONE ||\n      (!createSidecar && !this.value.hasSidecars) // hasSideCars = containers.length > 1 || initContainers.length;\n    ) {\n      container = containers[0];\n    } else {\n      // This means that there are no containers.\n      if (!podTemplateSpec.initContainers) {\n        podTemplateSpec.initContainers = [];\n      }\n      const allContainers = [\n        ...podTemplateSpec.initContainers,\n        ...podTemplateSpec.containers,\n      ];\n\n      if (this.$route.query.init) {\n        podTemplateSpec.initContainers.push({\n          imagePullPolicy: 'Always',\n          name:            `container-${ allContainers.length }`,\n          _init:           true,\n        });\n\n        containers = podTemplateSpec.initContainers;\n      }\n      if (createSidecar || this.value.type === 'pod') {\n        container = {\n          imagePullPolicy: 'Always',\n          name:            `container-${ allContainers.length }`,\n          _init:           false,\n        };\n\n        containers.push(container);\n      } else {\n        container = containers[0];\n      }\n    }\n\n    this.selectContainer(container);\n    if (this.realMode === _CLONE && this.value.type === WORKLOAD_TYPES.JOB) {\n      this.cleanUpClonedJobData();\n    }\n\n    return {\n      secondaryResourceData:      this.secondaryResourceDataConfig(),\n      namespacedConfigMaps:       [],\n      allNodes:                   null,\n      allNodeObjects:             [],\n      namespacedSecrets:          [],\n      imagePullNamespacedSecrets: [],\n      allServices:                [],\n      headlessServices:           [],\n      name:                       this.value?.metadata?.name || null,\n      pvcs:                       [],\n      namespacedServiceNames:     [],\n      showTabs:                   false,\n      pullPolicyOptions:          ['Always', 'IfNotPresent', 'Never'],\n      spec,\n      type,\n      servicesOwned:              [],\n      servicesToRemove:           [],\n      portsForServices:           [],\n      container,\n      containerChange:            0,\n      tabChange:                  0,\n      podFsGroup:                 podTemplateSpec.securityContext?.fsGroup,\n      savePvcHookName:            'savePvcHook',\n      tabWeightMap:               TAB_WEIGHT_MAP,\n      fvFormRuleSets:             [{\n        path: 'image', rootObject: this.container, rules: ['required'], translationKey: 'workload.container.image'\n      }],\n      fvReportedValidationPaths: ['spec'],\n      isNamespaceNew:            false,\n      idKey:                     ID_KEY\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    tabErrors() {\n      return { general: this.fvGetPathErrors(['image'])?.length > 0 };\n    },\n\n    defaultTab() {\n      if (!!this.$route.query.sidecar || this.$route.query.init || this.mode === _CREATE) {\n        const container = this.allContainers.find((c) => c.__active);\n\n        return container?.name ?? 'container-0';\n      }\n\n      return this.allContainers.length ? this.allContainers[0][this.idKey] : '';\n    },\n\n    isEdit() {\n      return this.mode === _EDIT;\n    },\n\n    isJob() {\n      return this.type === WORKLOAD_TYPES.JOB || this.isCronJob;\n    },\n\n    isCronJob() {\n      return this.type === WORKLOAD_TYPES.CRON_JOB;\n    },\n\n    isReplicable() {\n      return (\n        this.type === WORKLOAD_TYPES.DEPLOYMENT ||\n        this.type === WORKLOAD_TYPES.REPLICA_SET ||\n        this.type === WORKLOAD_TYPES.REPLICATION_CONTROLLER ||\n        this.type === WORKLOAD_TYPES.STATEFUL_SET\n      );\n    },\n\n    isDeployment() {\n      return this.type === WORKLOAD_TYPES.DEPLOYMENT;\n    },\n\n    isPod() {\n      return this.value.type === POD;\n    },\n\n    isStatefulSet() {\n      return this.type === WORKLOAD_TYPES.STATEFUL_SET;\n    },\n\n    // if this is a cronjob, grab pod spec from within job template spec\n    podTemplateSpec: {\n      get() {\n        return this.isCronJob ? this.spec.jobTemplate.spec.template.spec : this.spec?.template?.spec;\n      },\n      set(neu) {\n        if (this.isCronJob) {\n          this.$set(this.spec.jobTemplate.spec.template, 'spec', neu);\n        } else {\n          this.$set(this.spec.template, 'spec', neu);\n        }\n      },\n    },\n\n    podLabels: {\n      get() {\n        if (this.isCronJob) {\n          if (!this.spec.jobTemplate.metadata) {\n            this.$set(this.spec.jobTemplate, 'metadata', { labels: {} });\n          }\n\n          return this.spec.jobTemplate.metadata.labels;\n        }\n\n        if (!this.spec.template.metadata) {\n          this.$set(this.spec.template, 'metadata', { labels: {} });\n        }\n\n        return this.spec.template.metadata.labels;\n      },\n      set(neu) {\n        if (this.isCronJob) {\n          this.$set(this.spec.jobTemplate.metadata, 'labels', neu);\n        } else {\n          this.$set(this.spec.template.metadata, 'labels', neu);\n        }\n      },\n    },\n\n    podAnnotations: {\n      get() {\n        if (this.isCronJob) {\n          if (!this.spec.jobTemplate.metadata) {\n            this.$set(this.spec.jobTemplate, 'metadata', { annotations: {} });\n          }\n\n          return this.spec.jobTemplate.metadata.annotations;\n        }\n        if (!this.spec.template.metadata) {\n          this.$set(this.spec.template, 'metadata', { annotations: {} });\n        }\n\n        return this.spec.template.metadata.annotations;\n      },\n      set(neu) {\n        if (this.isCronJob) {\n          this.$set(this.spec.jobTemplate.metadata, 'annotations', neu);\n        } else {\n          this.$set(this.spec.template.metadata, 'annotations', neu);\n        }\n      },\n    },\n\n    allContainers() {\n      const containers = this.podTemplateSpec?.containers || [];\n      const initContainers = this.podTemplateSpec?.initContainers || [];\n      const key = this.idKey;\n\n      return [\n        ...containers.map((each) => {\n          each._init = false;\n          if (!each[key]) {\n            each[key] = serialMaker.genSym();\n          }\n\n          return each;\n        }),\n        ...initContainers.map((each) => {\n          each._init = true;\n          if (!each[key]) {\n            each[key] = serialMaker.genSym();\n          }\n\n          return each;\n        }),\n      ].map((container) => {\n        const containerImageRule = formRulesGenerator(this.$store.getters['i18n/t'], { name: container.name }).containerImage;\n\n        container.error = containerImageRule(container);\n\n        return container;\n      });\n    },\n\n    flatResources: {\n      get() {\n        const { limits = {}, requests = {} } = this.container.resources || {};\n        const {\n          cpu: limitsCpu,\n          memory: limitsMemory,\n          [GPU_KEY]: limitsGpu,\n        } = limits;\n        const { cpu: requestsCpu, memory: requestsMemory } = requests;\n\n        return {\n          limitsCpu,\n          limitsMemory,\n          requestsCpu,\n          requestsMemory,\n          limitsGpu,\n        };\n      },\n      set(neu) {\n        const {\n          limitsCpu,\n          limitsMemory,\n          requestsCpu,\n          requestsMemory,\n          limitsGpu,\n        } = neu;\n\n        const out = {\n          requests: {\n            cpu:    requestsCpu,\n            memory: requestsMemory,\n          },\n          limits: {\n            cpu:       limitsCpu,\n            memory:    limitsMemory,\n            [GPU_KEY]: limitsGpu,\n          },\n        };\n\n        this.$set(this.container, 'resources', cleanUp(out));\n      },\n    },\n\n    healthCheck: {\n      get() {\n        const { readinessProbe, livenessProbe, startupProbe } = this.container;\n\n        return {\n          readinessProbe,\n          livenessProbe,\n          startupProbe,\n        };\n      },\n      set(neu) {\n        Object.assign(this.container, neu);\n      },\n    },\n\n    imagePullSecrets: {\n      get() {\n        if (!this.podTemplateSpec.imagePullSecrets) {\n          this.$set(this.podTemplateSpec, 'imagePullSecrets', []);\n        }\n\n        const { imagePullSecrets } = this.podTemplateSpec;\n\n        return imagePullSecrets.map((each) => each.name);\n      },\n      set(neu) {\n        this.podTemplateSpec.imagePullSecrets = neu.map((secret) => {\n          return { name: secret };\n        });\n      },\n    },\n\n    schema() {\n      return this.$store.getters['cluster/schemaFor'](this.type);\n    },\n\n    // array of id, label, description, initials for type selection step\n    workloadSubTypes() {\n      const workloadTypes = omitBy(LIST_WORKLOAD_TYPES, (type) => {\n        return (\n          type === WORKLOAD_TYPES.REPLICA_SET ||\n          type === WORKLOAD_TYPES.REPLICATION_CONTROLLER\n        );\n      });\n\n      const out = [];\n\n      for (const prop in workloadTypes) {\n        const type = workloadTypes[prop];\n        const subtype = {\n          id:          type,\n          description: `workload.typeDescriptions.'${ type }'`, // i18n-uses workload.typeDescriptions.*\n          label:       this.nameDisplayFor(type),\n          bannerAbbrv: this.initialDisplayFor(type),\n        };\n\n        out.push(subtype);\n      }\n\n      return out;\n    },\n\n    containerOptions() {\n      const out = [...this.allContainers];\n\n      if (!this.isView) {\n        out.push({ name: 'Add Container', __add: true });\n      }\n\n      return out;\n    },\n\n    ...mapGetters({ t: 'i18n/t' }),\n  },\n\n  watch: {\n    async 'value.metadata.namespace'(neu) {\n      if (this.isNamespaceNew) {\n        // we don't need to re-fetch namespace specific (or non-namespace specific) resources when the namespace hasn't been created yet\n        return;\n      }\n      this.secondaryResourceData.namespace = neu;\n      // Fetch resources that are namespace specific, we don't need to re-fetch non-namespaced resources on namespace change\n      this.resourceManagerFetchSecondaryResources(this.secondaryResourceData, true);\n\n      this.servicesOwned = await this.value.getServicesOwned();\n    },\n\n    isNamespaceNew(neu, old) {\n      if (!old && neu) {\n        // As the namespace is new any resource that's been fetched with a namespace is now invalid\n        this.resourceManagerClearSecondaryResources(this.secondaryResourceData, true);\n      }\n    },\n\n    type(neu, old) {\n      const template =\n        old === WORKLOAD_TYPES.CRON_JOB ? this.spec?.jobTemplate?.spec?.template : this.spec?.template;\n\n      if (!template.spec) {\n        template.spec = {};\n      }\n\n      let restartPolicy;\n\n      if (this.isJob || this.isCronJob) {\n        restartPolicy = 'Never';\n      } else {\n        restartPolicy = 'Always';\n      }\n\n      this.$set(template.spec, 'restartPolicy', restartPolicy);\n\n      if (!this.isReplicable) {\n        delete this.spec.replicas;\n      }\n\n      if (old === WORKLOAD_TYPES.CRON_JOB) {\n        this.$set(this.spec, 'template', { ...template });\n        delete this.spec.jobTemplate;\n        delete this.spec.schedule;\n      } else if (neu === WORKLOAD_TYPES.CRON_JOB) {\n        this.$set(this.spec, 'jobTemplate', { spec: { template } });\n        this.$set(this.spec, 'schedule', '0 * * * *');\n        delete this.spec.template;\n      }\n\n      this.$set(this.value, 'type', neu);\n      delete this.value.apiVersion;\n    },\n  },\n\n  created() {\n    this.registerBeforeHook(this.saveWorkload, 'willSaveWorkload');\n    this.registerBeforeHook(this.getPorts, 'getPorts');\n\n    this.registerAfterHook(this.saveService, 'saveService');\n  },\n\n  methods: {\n    secondaryResourceDataConfig() {\n      return {\n        namespace: this.value?.metadata?.namespace || null,\n        data:      {\n          [CONFIG_MAP]:      { applyTo: [{ var: 'namespacedConfigMaps' }] },\n          [PVC]:             { applyTo: [{ var: 'pvcs' }] },\n          [SERVICE_ACCOUNT]: { applyTo: [{ var: 'namespacedServiceNames' }] },\n          [SECRET]:          {\n            applyTo: [\n              { var: 'namespacedSecrets' },\n              {\n                var:         'imagePullNamespacedSecrets',\n                parsingFunc: (data) => {\n                  return data.filter((secret) => (secret._type === SECRET_TYPES.DOCKER || secret._type === SECRET_TYPES.DOCKER_JSON));\n                }\n              }\n            ]\n          },\n          [NODE]: {\n            applyTo: [\n              { var: 'allNodeObjects' },\n              {\n                var:         'allNodes',\n                parsingFunc: (data) => {\n                  return data.map((node) => node.id);\n                }\n              }\n            ]\n          },\n          [SERVICE]: {\n            applyTo: [\n              { var: 'allServices' },\n              {\n                var:         'headlessServices',\n                parsingFunc: (data) => {\n                  return data.filter((service) => service.spec.clusterIP === 'None');\n                }\n              }\n            ]\n          },\n        }\n      };\n    },\n    addContainerBtn() {\n      this.selectContainer({ name: 'Add Container', __add: true });\n    },\n    nameDisplayFor(type) {\n      const schema = this.$store.getters['cluster/schemaFor'](type);\n\n      return this.$store.getters['type-map/labelFor'](schema) || '';\n    },\n\n    // TODO better images for workload types?\n    // show initials of workload type in blue circles for now\n    initialDisplayFor(type) {\n      const typeDisplay = this.nameDisplayFor(type);\n\n      return typeDisplay\n        .split('')\n        .filter((letter) => letter.match(/[A-Z]/))\n        .join('');\n    },\n\n    cancel() {\n      this.done();\n    },\n\n    async getPorts() {\n      const ports = (await this.value.getPortsWithServiceType()) || [];\n\n      this.portsForServices = ports;\n    },\n\n    async saveService() {\n      // If we can't access services then just return - the UI should only allow ports without service creation\n      if (!this.$store.getters['cluster/schemaFor'](SERVICE)) {\n        return;\n      }\n\n      const { toSave = [], toRemove = [] } =\n        (await this.value.servicesFromContainerPorts(\n          this.mode,\n          this.portsForServices\n        )) || {};\n\n      this.servicesOwned = toSave;\n      this.servicesToRemove = toRemove;\n\n      if (!toSave.length && !toRemove.length) {\n        return;\n      }\n\n      return Promise.all([\n        ...toSave.map((svc) => svc.save()),\n        ...toRemove.map((svc) => {\n          const ui = svc?.metadata?.annotations?.[UI_MANAGED];\n\n          if (ui) {\n            svc.remove();\n          }\n        }),\n      ]);\n    },\n\n    saveWorkload() {\n      if (\n        this.type !== WORKLOAD_TYPES.JOB &&\n        this.type !== WORKLOAD_TYPES.CRON_JOB &&\n        (this.mode === _CREATE || this.realMode === _CLONE)\n      ) {\n        this.spec.selector = { matchLabels: this.value.workloadSelector };\n        Object.assign(this.value.metadata.labels, this.value.workloadSelector);\n      }\n\n      let template;\n\n      if (this.type === WORKLOAD_TYPES.CRON_JOB) {\n        template = this.spec.jobTemplate;\n      } else {\n        template = this.spec.template;\n      }\n\n      // WORKLOADS\n      if (\n        this.type !== WORKLOAD_TYPES.JOB &&\n        this.type !== WORKLOAD_TYPES.CRON_JOB &&\n        (this.mode === _CREATE || this.realMode === _CLONE)\n      ) {\n        if (!template.metadata) {\n          template.metadata = { labels: this.value.workloadSelector };\n        } else {\n          Object.assign(template.metadata.labels, this.value.workloadSelector);\n        }\n      }\n\n      if (template.spec.containers && template.spec.containers[0]) {\n        const containerResources = template.spec.containers[0].resources;\n        const nvidiaGpuLimit =\n          template.spec.containers[0].resources?.limits?.[GPU_KEY];\n\n        // Though not required, requests are also set to mirror the ember ui\n        if (nvidiaGpuLimit > 0) {\n          containerResources.requests = containerResources.requests || {};\n          containerResources.requests[GPU_KEY] = nvidiaGpuLimit;\n        }\n\n        if (!this.nvidiaIsValid(nvidiaGpuLimit)) {\n          try {\n            delete containerResources.requests[GPU_KEY];\n            delete containerResources.limits[GPU_KEY];\n\n            if (Object.keys(containerResources.limits).length === 0) {\n              delete containerResources.limits;\n            }\n            if (Object.keys(containerResources.requests).length === 0) {\n              delete containerResources.requests;\n            }\n            if (Object.keys(containerResources).length === 0) {\n              delete template.spec.containers[0].resources;\n            }\n          } catch {}\n        }\n      }\n\n      const nodeAffinity = template?.spec?.affinity?.nodeAffinity || {};\n      const podAffinity = template?.spec?.affinity?.podAffinity || {};\n      const podAntiAffinity = template?.spec?.affinity?.podAntiAffinity || {};\n\n      this.fixNodeAffinity(nodeAffinity);\n      this.fixPodAffinity(podAffinity);\n\n      // The fields are being removed because they are not allowed to be editabble\n      if (this.mode === _EDIT) {\n        if (template?.spec?.affinity && Object.keys(template?.spec?.affinity).length === 0) {\n          delete template.spec.affinity;\n        }\n\n        // Removing `affinity` fixes the issue with setting the `imagePullSecrets`\n        // However, this field should not be set. Therefore this is explicitly removed.\n        if (template?.spec?.imagePullSecrets && template?.spec?.imagePullSecrets.length === 0) {\n          delete template.spec.imagePullSecrets;\n        }\n      }\n\n      this.fixPodAffinity(podAntiAffinity);\n      this.fixPodSecurityContext(this.podTemplateSpec);\n\n      template.metadata.namespace = this.value.metadata.namespace;\n\n      // Handle the case where the user has changed the name of the workload\n      // Only do this for clone. Not allowed for edit\n      if (this.realMode === _CLONE) {\n        template.metadata.name = this.value.metadata.name;\n        template.metadata.description = this.value.metadata.description;\n      }\n\n      // delete this.value.kind;\n      if (this.container && !this.container.name) {\n        this.$set(this.container, 'name', this.value.metadata.name);\n      }\n\n      const ports = this.value.containers.reduce((total, each) => {\n        const containerPorts = each.ports || [];\n\n        total.push(\n          ...containerPorts.filter(\n            (port) => port._serviceType && port._serviceType !== ''\n          )\n        );\n\n        return total;\n      }, []);\n\n      // ports contain info used to create services after saving\n      this.portsForServices = ports;\n      Object.assign(this.value, { spec: this.spec });\n    },\n\n    // node and pod affinity are formatted incorrectly from API; fix before saving\n    fixNodeAffinity(nodeAffinity) {\n      const preferredDuringSchedulingIgnoredDuringExecution =\n        nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution || [];\n      const requiredDuringSchedulingIgnoredDuringExecution =\n        nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution || {};\n\n      preferredDuringSchedulingIgnoredDuringExecution.forEach((term) => {\n        const matchExpressions = term?.preference?.matchExpressions || [];\n\n        matchExpressions.forEach((expression) => {\n          if (expression.values) {\n            expression.values =\n              typeof expression.values === 'string' ? [expression.values] : [...expression.values];\n          }\n        });\n      });\n\n      (\n        requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms || []\n      ).forEach((term) => {\n        const matchExpressions = term.matchExpressions || [];\n\n        matchExpressions.forEach((expression) => {\n          if (expression.values) {\n            expression.values =\n              typeof expression.values === 'string' ? [expression.values] : [...expression.values];\n          }\n        });\n      });\n    },\n\n    fixPodAffinity(podAffinity) {\n      const preferredDuringSchedulingIgnoredDuringExecution =\n        podAffinity.preferredDuringSchedulingIgnoredDuringExecution || [];\n      const requiredDuringSchedulingIgnoredDuringExecution =\n        podAffinity.requiredDuringSchedulingIgnoredDuringExecution || [];\n\n      preferredDuringSchedulingIgnoredDuringExecution.forEach((term) => {\n        const matchExpressions =\n          term?.podAffinityTerm?.labelSelector?.matchExpressions || [];\n\n        matchExpressions.forEach((expression) => {\n          if (expression.values) {\n            expression.values =\n              typeof expression.values === 'string' ? [expression.values] : [...expression.values];\n          }\n        });\n      });\n\n      requiredDuringSchedulingIgnoredDuringExecution.forEach((term) => {\n        const matchExpressions = term?.labelSelector?.matchExpressions || [];\n\n        matchExpressions.forEach((expression) => {\n          if (expression.values) {\n            expression.values =\n              typeof expression.values === 'string' ? [expression.values] : [...expression.values];\n          }\n        });\n      });\n\n      return podAffinity;\n    },\n\n    fixPodSecurityContext(podTempSpec) {\n      if (this.podFsGroup) {\n        podTempSpec.securityContext = podTempSpec.securityContext || {};\n        podTempSpec.securityContext.fsGroup = this.podFsGroup;\n      } else {\n        if (podTempSpec.securityContext?.fsGroup) {\n          delete podTempSpec.securityContext.fsGroup;\n        }\n        if (Object.keys(podTempSpec.securityContext || {}).length === 0) {\n          delete podTempSpec.securityContext;\n        }\n      }\n    },\n\n    selectType(type) {\n      if (!this.type && type) {\n        this.$router.replace({ params: { resource: type } });\n      } else {\n        this.type = type;\n      }\n    },\n\n    selectContainer(container) {\n      if (container.__add) {\n        this.addContainer();\n\n        return;\n      }\n      (this.allContainers || []).forEach((container) => {\n        if (container.__active) {\n          delete container.__active;\n        }\n      });\n      container.__active = true;\n      this.container = container;\n      this.containerChange++;\n    },\n\n    addContainer() {\n      let nameNumber = this.allContainers.length;\n      const allNames = this.allContainers.reduce((names, each) => {\n        names.push(each.name);\n\n        return names;\n      }, []);\n\n      while (allNames.includes(`container-${ nameNumber }`)) {\n        nameNumber++;\n      }\n      const container = {\n        ...defaultContainer,\n        name:   `container-${ nameNumber }`,\n        active: true\n      };\n\n      this.podTemplateSpec.containers.push(container);\n      this.selectContainer(container);\n      this.$nextTick(() => {\n        this.$refs.containersTabbed?.select(container.name);\n      });\n    },\n\n    removeContainer(container) {\n      if (container._init) {\n        removeObject(this.podTemplateSpec.initContainers, container);\n      } else {\n        removeObject(this.podTemplateSpec.containers, container);\n      }\n      this.selectContainer(this.allContainers[0]);\n    },\n\n    updateInitContainer(neu, container) {\n      if (!container) {\n        return;\n      }\n      const containers = this.podTemplateSpec.containers;\n      const initContainers = this.podTemplateSpec.initContainers ?? [];\n\n      if (neu) {\n        this.podTemplateSpec.initContainers = initContainers;\n        container._init = true;\n        if (!initContainers.includes(container)) {\n          initContainers.push(container);\n        }\n        removeObject(containers, container);\n      } else {\n        container._init = false;\n        removeObject(initContainers, container);\n        if (!containers.includes(container)) {\n          containers.push(container);\n        }\n      }\n    },\n    clearPvcFormState(hookName) {\n      // On the `closePvcForm` event, remove the\n      // before save hook to prevent the PVC from\n      // being created. Use the PVC's unique ID to distinguish\n      // between hooks for different PVCs.\n      if (this[BEFORE_SAVE_HOOKS]) {\n        this.unregisterBeforeSaveHook(hookName);\n      }\n    },\n\n    updateServiceAccount(neu) {\n      if (neu) {\n        this.podTemplateSpec.serviceAccount = neu;\n        this.podTemplateSpec.serviceAccountName = neu;\n      } else {\n        // Note - both have to be removed in order for removal to work\n        delete this.podTemplateSpec.serviceAccount;\n        delete this.podTemplateSpec.serviceAccountName;\n      }\n    },\n    nvidiaIsValid(nvidiaGpuLimit) {\n      if ( !Number.isInteger(parseInt(nvidiaGpuLimit)) ) {\n        return false;\n      }\n      if (nvidiaGpuLimit === undefined) {\n        return false;\n      }\n      if (nvidiaGpuLimit < 1) {\n        return false;\n      } else {\n        return true;\n      }\n\n      //\n    },\n\n    cleanUpClonedJobData() {\n      const annotations = this.value?.metadata?.annotations;\n\n      if (annotations) {\n        this.$delete(annotations, 'batch.kubernetes.io/job-tracking');\n      }\n      const labels = this.value?.metadata?.labels;\n\n      if (labels) {\n        this.$delete(labels, 'batch.kubernetes.io/controller-uid');\n        this.$delete(labels, 'batch.kubernetes.io/job-name');\n        this.$delete(labels, 'controller-uid');\n        this.$delete(labels, 'job-name');\n      }\n\n      const matchLabels = this.value?.spec?.selector?.matchLabels;\n\n      if (matchLabels) {\n        this.$delete(matchLabels, 'batch.kubernetes.io/controller-uid');\n      }\n      const templateLabels = this.value?.spec?.template?.metadata?.labels;\n\n      if (templateLabels) {\n        this.$delete(templateLabels, 'batch.kubernetes.io/controller-uid');\n        this.$delete(templateLabels, 'batch.kubernetes.io/job-name');\n        this.$delete(templateLabels, 'controller-uid');\n        this.$delete(templateLabels, 'job-name');\n      }\n    }\n  },\n};\n"],"mappings":"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","ignoreList":[]}]}