{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/components/form/SelectOrCreateAuthSecret.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/components/form/SelectOrCreateAuthSecret.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IF9FRElUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBMYWJlbGVkSW5wdXQgfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0xhYmVsZWRJbnB1dCc7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IEFVVEhfVFlQRSwgTk9STUFOLCBTRUNSRVQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgU0VDUkVUX1RZUEVTIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9zZWNyZXQnOwppbXBvcnQgeyBiYXNlNjRFbmNvZGUgfSBmcm9tICdAc2hlbGwvdXRpbHMvY3J5cHRvJzsKaW1wb3J0IHsgYWRkT2JqZWN0cywgaW5zZXJ0QXQgfSBmcm9tICdAc2hlbGwvdXRpbHMvYXJyYXknOwppbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvc29ydCc7CmltcG9ydCB7CiAgRmlsdGVyQXJncywKICBQYWdpbmF0aW9uRmlsdGVyRmllbGQsCiAgUGFnaW5hdGlvblBhcmFtRmlsdGVyLAp9IGZyb20gJ0BzaGVsbC90eXBlcy9zdG9yZS9wYWdpbmF0aW9uLnR5cGVzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2VsZWN0T3JDcmVhdGVBdXRoU2VjcmV0JywKCiAgY29tcG9uZW50czogewogICAgTGFiZWxlZElucHV0LAogICAgTGFiZWxlZFNlbGVjdCwKICB9LAoKICBwcm9wczogewogICAgbW9kZTogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IF9FRElULAogICAgfSwKCiAgICBwcmVTZWxlY3Q6IHsKICAgICAgdHlwZTogICAgT2JqZWN0LAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKCiAgICB2YWx1ZTogewogICAgICB0eXBlOiAgICBbU3RyaW5nLCBPYmplY3RdLAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKCiAgICBpblN0b3JlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2NsdXN0ZXInLAogICAgfSwKCiAgICBsYWJlbEtleTogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdzZWxlY3RPckNyZWF0ZUF1dGhTZWNyZXQubGFiZWwnLAogICAgfSwKCiAgICBuYW1lc3BhY2U6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIC8qKgogICAgICogTGltaXQgdGhlIHNlbGVjdGlvbiBvZiBhbiBleGlzdGluZyBzZWNyZXQgdG8gdGhlIG5hbWVzcGFjZSBwcm92aWRlZAogICAgICovCiAgICBsaW1pdFRvTmFtZXNwYWNlOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICB9LAoKICAgIGdlbmVyYXRlTmFtZTogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdhdXRoLScsCiAgICB9LAoKICAgIGFsbG93Tm9uZTogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlLAogICAgfSwKCiAgICBhbGxvd1NzaDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlLAogICAgfSwKCiAgICBhbGxvd0Jhc2ljOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICB9LAoKICAgIGFsbG93UzM6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICB9LAoKICAgIGFsbG93UmtlOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgfSwKCiAgICByZWdpc3RlckJlZm9yZUhvb2s6IHsKICAgICAgdHlwZTogICAgIEZ1bmN0aW9uLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgaG9va05hbWU6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAncmVnaXN0ZXJBdXRoU2VjcmV0JwogICAgfSwKCiAgICBhcHBlbmRVbmlxdWVJZFRvSG9vazogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKCiAgICBob29rUHJpb3JpdHk6IHsKICAgICAgdHlwZTogICAgTnVtYmVyLAogICAgICBkZWZhdWx0OiA5OSwKICAgIH0sCgogICAgdmVydGljYWw6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICB9LAoKICAgIC8qKgogICAgICogVGhpcyBjb21wb25lbnQgaXMgdXNlZCBpbiBNdWx0aVN0ZXAgUHJpb2Nlc3MKICAgICAqIFNvIHdoZW4gdXNlciBjbGljayB0aHJvdWdoIHRvIGZpbmFsIHN0ZXAgYW5kIHN1Ym1pdCB0aGUgZm9ybQogICAgICogVGhpcyBjb21wb25lbnQgZ2V0IHJlY3JlYXRlZCB0aGVyZWZvcmUgcmVnaXN0ZXIgYGRvQ3JlYXRlYCBhcyBhIGhvb2sgZWFjaCB0aW1lCiAgICAgKiBBbHNvLCB0aGUgcGFyZW50IHN0ZXAgY29tcG9uZW50IGlzIG5vdCBhd2FyZSB0aGF0IGNyZWRlbnRpYWwgaXMgY3JlYXRlZAogICAgICoKICAgICAqIFRoaXMgcHJvcGVydHkgaXMgaW1wbGVtZW50IHRvIHByZXZlbnQgdGhpcyBpc3N1ZSBhbmQgZGVsZWdhdGUgaXQgdG8gcGFyZW50IGNvbXBvbmVudC4KICAgICAqLwogICAgZGVsZWdhdGVDcmVhdGVUb1BhcmVudDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZSwKICAgIH0sCgogICAgLyoqCiAgICAgKiBTZXQgdG8gZmFsc2UgdG8gbWFrZSBhIGZyZXNoIGh0dHAgcmVxdWVzdCB0byBzZWNyZXRzIGV2ZXJ5IHRpbWUuIFRoaXMgY2FuIGJlIHVzZWQgd2hlbiBzZWNyZXRzIGhhdmUgYWxyZWFkeSBiZWVuIHVzZWQgZm9yCiAgICAgKiBhbm90aGVyIHB1cnBvc2Ugb24gdGhlIHNhbWUgcGFnZQogICAgICoKICAgICAqIFNldCB0byB0cnVlIHRvIGNhY2hlIHRoZSByZXNwb25zZQogICAgICovCiAgICBjYWNoZVNlY3JldHM6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICB9LAogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgaWYgKCAodGhpcy5hbGxvd1NzaCB8fCB0aGlzLmFsbG93QmFzaWMgfHwgdGhpcy5hbGxvd1JrZSkgJiYgdGhpcy4kc3RvcmUuZ2V0dGVyc1tgJHsgdGhpcy5pblN0b3JlIH0vc2NoZW1hRm9yYF0oU0VDUkVUKSApIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7IHRoaXMuaW5TdG9yZSB9L3BhZ2luYXRpb25FbmFibGVkYF0oU0VDUkVUKSkgewogICAgICAgIC8vIEZpbHRlciByZXN1bHRzIHZpYSBhcGkgKGJlY2F1c2Ugd2Ugc2hvdWxkbid0IGJlIGZldGNoaW5nIHRoZW0gYWxsLi4uKQogICAgICAgIHRoaXMuZmlsdGVyZWRTZWNyZXRzID0gYXdhaXQgdGhpcy5maWx0ZXJTZWNyZXRzQnlBcGkoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDYW5ub3QgeWV0IGZpbHRlciB2aWEgYXBpLCBzbyBmZXRjaCBhbGwgYW5kIGZpbHRlciBsYXRlciBvbgogICAgICAgIHRoaXMuYWxsU2VjcmV0cyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKAogICAgICAgICAgYCR7IHRoaXMuaW5TdG9yZSB9L2ZpbmRBbGxgLAogICAgICAgICAgeyB0eXBlOiBTRUNSRVQgfQogICAgICAgICk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIHRoaXMuYWxsb3dTMyAmJiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL2Nhbkxpc3QnXShOT1JNQU4uQ0xPVURfQ1JFREVOVElBTCkgKSB7CiAgICAgIC8vIEF2b2lkIGFuIGFzeW5jIGNhbGwgYW5kIGxvYWRpbmcgc2NyZWVuIGlmIGFscmVhZHkgbG9hZGVkIGJ5IHNvbWVvbmUgZWxzZQogICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVyc1sncmFuY2hlci9oYXZlQWxsJ10oTk9STUFOLkNMT1VEX0NSRURFTlRJQUwpKSB7CiAgICAgICAgdGhpcy5hbGxDbG91ZENyZWRzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sncmFuY2hlci9hbGwnXShOT1JNQU4uQ0xPVURfQ1JFREVOVElBTCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hbGxDbG91ZENyZWRzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JhbmNoZXIvZmluZEFsbCcsIHsgdHlwZTogTk9STUFOLkNMT1VEX0NSRURFTlRJQUwgfSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYWxsQ2xvdWRDcmVkcyA9IFtdOwogICAgfQoKICAgIGxldCBzZWxlY3RlZCA9IHRoaXMucHJlU2VsZWN0Py5zZWxlY3RlZCB8fCBBVVRIX1RZUEUuX05PTkU7CgogICAgaWYgKCAhdGhpcy52YWx1ZSApIHsKICAgICAgdGhpcy5wdWJsaWNLZXkgPSB0aGlzLnByZVNlbGVjdD8ucHVibGljS2V5IHx8ICcnOwogICAgICB0aGlzLnByaXZhdGVLZXkgPSB0aGlzLnByZVNlbGVjdD8ucHJpdmF0ZUtleSB8fCAnJzsKICAgIH0KCiAgICBpZiAoIHRoaXMudmFsdWUgKSB7CiAgICAgIGlmICggdHlwZW9mIHRoaXMudmFsdWUgPT09ICdvYmplY3QnICkgewogICAgICAgIHNlbGVjdGVkID0gYCR7IHRoaXMudmFsdWUubmFtZXNwYWNlIH0vJHsgdGhpcy52YWx1ZS5uYW1lIH1gOwogICAgICB9IGVsc2UgaWYgKCB0aGlzLnZhbHVlLmluY2x1ZGVzKCcvJykgfHwgdGhpcy52YWx1ZS5pbmNsdWRlcygnOicpICkgewogICAgICAgIHNlbGVjdGVkID0gdGhpcy52YWx1ZTsKICAgICAgfSBlbHNlIGlmICggdGhpcy5uYW1lc3BhY2UgKSB7CiAgICAgICAgc2VsZWN0ZWQgPSBgJHsgdGhpcy5uYW1lc3BhY2UgfS8keyB0aGlzLnZhbHVlIH1gOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGVjdGVkID0gdGhpcy52YWx1ZTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuc2VsZWN0ZWQgPSBzZWxlY3RlZDsKCiAgICB0aGlzLnVwZGF0ZSgpOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhbGxDbG91ZENyZWRzOiBbXSwKCiAgICAgIGFsbFNlY3JldHM6ICAgICAgbnVsbCwKICAgICAgZmlsdGVyZWRTZWNyZXRzOiBudWxsLAoKICAgICAgc2VsZWN0ZWQ6IG51bGwsCgogICAgICBmaWx0ZXJCeU5hbWVzcGFjZTogdGhpcy5uYW1lc3BhY2UgJiYgdGhpcy5saW1pdFRvTmFtZXNwYWNlLAoKICAgICAgcHVibGljS2V5OiAgJycsCiAgICAgIHByaXZhdGVLZXk6ICcnLAogICAgICB1bmlxdWVJZDogICBuZXcgRGF0ZSgpLmdldFRpbWUoKSwgLy8gQWxsb3dzIGZvcm0gc3RhdGUgdG8gYmUgaW5kaXZpZHVhbGx5IHRyYWNrZWQgaWYgdGhlIGZvcm0gaXMgaW4gYSBsaXN0CgogICAgICBTU0g6ICAgQVVUSF9UWVBFLl9TU0gsCiAgICAgIEJBU0lDOiBBVVRIX1RZUEUuX0JBU0lDLAogICAgICBTMzogICAgQVVUSF9UWVBFLl9TMywKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHNlY3JldFR5cGVzKCkgewogICAgICBjb25zdCB0eXBlcyA9IFtdOwoKICAgICAgaWYgKCB0aGlzLmFsbG93U3NoICkgewogICAgICAgIHR5cGVzLnB1c2goU0VDUkVUX1RZUEVTLlNTSCk7CiAgICAgIH0KCiAgICAgIGlmICggdGhpcy5hbGxvd0Jhc2ljICkgewogICAgICAgIHR5cGVzLnB1c2goU0VDUkVUX1RZUEVTLkJBU0lDKTsKICAgICAgfQoKICAgICAgaWYgKCB0aGlzLmFsbG93UmtlICkgewogICAgICAgIHR5cGVzLnB1c2goU0VDUkVUX1RZUEVTLlJLRV9BVVRIX0NPTkZJRyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0eXBlczsKICAgIH0sCgogICAgLyoqCiAgICAgKiBGaXRsZXIgc2VjcmV0cyBnaXZlbiB0aGVpciBuYW1lc3BhY2UgYW5kIHJlcXVpcmVkIHNlY3JldCB0eXBlCiAgICAgKgogICAgICogQ29udmVydCBzZWNyZXRzIHRvIGxpc3Qgb2Ygb3B0aW9ucyBhbmQgc3VwbGVtZW50IHdpdGggY3VzdG9tIGVudHJpZXMKICAgICAqLwogICAgb3B0aW9ucygpIHsKICAgICAgbGV0IGZpbHRlcmVkU2VjcmV0cyA9IFtdOwoKICAgICAgaWYgKHRoaXMuYWxsU2VjcmV0cykgewogICAgICAgIC8vIEZpdGxlciBzZWNyZXRzIGdpdmVuIHRoZWlyIG5hbWVzcGFjZSBhbmQgcmVxdWlyZWQgc2VjcmV0IHR5cGUKICAgICAgICBmaWx0ZXJlZFNlY3JldHMgPSB0aGlzLmFsbFNlY3JldHMKICAgICAgICAgIC5maWx0ZXIoKHgpID0+IHRoaXMuZmlsdGVyQnlOYW1lc3BhY2UgPyB4Lm1ldGFkYXRhLm5hbWVzcGFjZSA9PT0gdGhpcy5uYW1lc3BhY2UgOiB0cnVlCiAgICAgICAgICApCiAgICAgICAgICAuZmlsdGVyKCh4KSA9PiB7CiAgICAgICAgICAgIC8vIE11c3QgbWF0Y2ggb25lIG9mIHRoZSByZXF1aXJlZCB0eXBlcwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgdGhpcy5zZWNyZXRUeXBlcy5sZW5ndGggJiYKICAgICAgICAgICAgICAhdGhpcy5zZWNyZXRUeXBlcy5pbmNsdWRlcyh4Ll90eXBlKQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5maWx0ZXJlZFNlY3JldHMpIHsKICAgICAgICBmaWx0ZXJlZFNlY3JldHMgPSB0aGlzLmZpbHRlcmVkU2VjcmV0czsKICAgICAgfQoKICAgICAgbGV0IG91dCA9IGZpbHRlcmVkU2VjcmV0cy5tYXAoKHgpID0+IHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBkYXRhUHJldmlldywgc3ViVHlwZURpc3BsYXksIG1ldGFkYXRhLCBpZAogICAgICAgIH0gPSB4OwoKICAgICAgICBjb25zdCBsYWJlbCA9CiAgICAgICAgICBzdWJUeXBlRGlzcGxheSAmJiBkYXRhUHJldmlldyA/IGAkeyBtZXRhZGF0YS5uYW1lIH0gKCR7IHN1YlR5cGVEaXNwbGF5IH06ICR7IGRhdGFQcmV2aWV3IH0pYCA6IGAkeyBtZXRhZGF0YS5uYW1lIH0gKCR7IHN1YlR5cGVEaXNwbGF5IH0pYDsKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGxhYmVsLAogICAgICAgICAgZ3JvdXA6IG1ldGFkYXRhLm5hbWVzcGFjZSwKICAgICAgICAgIHZhbHVlOiBpZCwKICAgICAgICB9OwogICAgICB9KTsKCiAgICAgIGlmICh0aGlzLmFsbG93UzMpIHsKICAgICAgICBjb25zdCBtb3JlID0gdGhpcy5hbGxDbG91ZENyZWRzCiAgICAgICAgICAuZmlsdGVyKCh4KSA9PiBbJ2F3cycsICdzMyddLmluY2x1ZGVzKHgucHJvdmlkZXIpKQogICAgICAgICAgLm1hcCgoeCkgPT4gewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGxhYmVsOiBgJHsgeC5uYW1lRGlzcGxheSB9ICgkeyB4LnByb3ZpZGVyRGlzcGxheSB9KWAsCiAgICAgICAgICAgICAgZ3JvdXA6ICdDbG91ZCBDcmVkZW50aWFscycsCiAgICAgICAgICAgICAgdmFsdWU6IHguaWQsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKCiAgICAgICAgYWRkT2JqZWN0cyhvdXQsIG1vcmUpOwogICAgICB9CgogICAgICBpZiAoICF0aGlzLmxpbWl0VG9OYW1lc3BhY2UgKSB7CiAgICAgICAgb3V0ID0gc29ydEJ5KG91dCwgJ2dyb3VwJyk7CiAgICAgICAgaWYgKCBvdXQubGVuZ3RoICkgewogICAgICAgICAgbGV0IGxhc3RHcm91cCA9ICcnOwoKICAgICAgICAgIGZvciAoIGxldCBpID0gMCA7IGkgPCBvdXQubGVuZ3RoIDsgaSsrICkgewogICAgICAgICAgICBpZiAoIG91dFtpXS5ncm91cCAhPT0gbGFzdEdyb3VwICkgewogICAgICAgICAgICAgIGxhc3RHcm91cCA9IG91dFtpXS5ncm91cDsKCiAgICAgICAgICAgICAgaW5zZXJ0QXQob3V0LCBpLCB7CiAgICAgICAgICAgICAgICBraW5kOiAgICAgJ3RpdGxlJywKICAgICAgICAgICAgICAgIGxhYmVsOiAgICB0aGlzLnQoJ3NlbGVjdE9yQ3JlYXRlQXV0aFNlY3JldC5uYW1lc3BhY2VHcm91cCcsIHsgbmFtZTogbGFzdEdyb3VwIH0pLAogICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCBvdXQubGVuZ3RoICkgewogICAgICAgIG91dC51bnNoaWZ0KHsKICAgICAgICAgIGtpbmQ6ICAgICAndGl0bGUnLAogICAgICAgICAgbGFiZWw6ICAgIHRoaXMudCgnc2VsZWN0T3JDcmVhdGVBdXRoU2VjcmV0LmNob29zZUV4aXN0aW5nJyksCiAgICAgICAgICBkaXNhYmxlZDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmICggdGhpcy5hbGxvd05vbmUgKSB7CiAgICAgICAgb3V0LnVuc2hpZnQoewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnZ2VuZXJpYy5ub25lJyksCiAgICAgICAgICB2YWx1ZTogQVVUSF9UWVBFLl9OT05FLAogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAodGhpcy5hbGxvd1NzaCB8fCB0aGlzLmFsbG93UzMgfHwgdGhpcy5hbGxvd0Jhc2ljKSB7CiAgICAgICAgb3V0LnVuc2hpZnQoewogICAgICAgICAgbGFiZWw6ICAgICdkaXZpZGVyJywKICAgICAgICAgIGRpc2FibGVkOiB0cnVlLAogICAgICAgICAga2luZDogICAgICdkaXZpZGVyJwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoIHRoaXMuYWxsb3dTc2ggKSB7CiAgICAgICAgb3V0LnVuc2hpZnQoewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnc2VsZWN0T3JDcmVhdGVBdXRoU2VjcmV0LmNyZWF0ZVNzaCcpLAogICAgICAgICAgdmFsdWU6IEFVVEhfVFlQRS5fU1NILAogICAgICAgICAga2luZDogICdoaWdobGlnaHRlZCcKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKCB0aGlzLmFsbG93UzMgKSB7CiAgICAgICAgb3V0LnVuc2hpZnQoewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnc2VsZWN0T3JDcmVhdGVBdXRoU2VjcmV0LmNyZWF0ZVMzJyksCiAgICAgICAgICB2YWx1ZTogQVVUSF9UWVBFLl9TMywKICAgICAgICAgIGtpbmQ6ICAnaGlnaGxpZ2h0ZWQnCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICggdGhpcy5hbGxvd0Jhc2ljICkgewogICAgICAgIG91dC51bnNoaWZ0KHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3NlbGVjdE9yQ3JlYXRlQXV0aFNlY3JldC5jcmVhdGVCYXNpYycpLAogICAgICAgICAgdmFsdWU6IEFVVEhfVFlQRS5fQkFTSUMsCiAgICAgICAgICBraW5kOiAgJ2hpZ2hsaWdodGVkJwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBmaXJzdENvbCgpIHsKICAgICAgaWYgKCB0aGlzLnZlcnRpY2FsICkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgaWYgKCB0aGlzLnNlbGVjdGVkID09PSBBVVRIX1RZUEUuX1NTSCB8fCB0aGlzLnNlbGVjdGVkID09PSBBVVRIX1RZUEUuX0JBU0lDIHx8IHRoaXMuc2VsZWN0ZWQgPT09IEFVVEhfVFlQRS5fUzMgKSB7CiAgICAgICAgcmV0dXJuICdjb2wgc3Bhbi00JzsKICAgICAgfQoKICAgICAgcmV0dXJuICdjb2wgc3Bhbi02JzsKICAgIH0sCgogICAgbW9yZUNvbHMoKSB7CiAgICAgIGlmICggdGhpcy52ZXJ0aWNhbCApIHsKICAgICAgICByZXR1cm4gJ210LTIwJzsKICAgICAgfQoKICAgICAgcmV0dXJuICdjb2wgc3Bhbi00JzsKICAgIH0KICB9LAoKICB3YXRjaDogewogICAgc2VsZWN0ZWQ6ICAgJ3VwZGF0ZScsCiAgICBwdWJsaWNLZXk6ICAndXBkYXRlS2V5VmFsJywKICAgIHByaXZhdGVLZXk6ICd1cGRhdGVLZXlWYWwnLAoKICAgIGFzeW5jIG5hbWVzcGFjZShucykgewogICAgICBpZiAobnMgJiYgIXRoaXMuc2VsZWN0ZWQuc3RhcnRzV2l0aChgJHsgbnMgfS9gKSkgewogICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBBVVRIX1RZUEUuX05PTkU7CiAgICAgIH0KCiAgICAgIC8vIGlmIG5zIGhhcyBjaGFuZ2VkIGFuZCB3ZSdyZSBmaWx0ZXJpbmcgYnkgYXBpLi4uIHdlIG5lZWQgdG8gcmUtZmV0Y2ggZW50cmllcwogICAgICBpZiAodGhpcy5maWx0ZXJlZFNlY3JldHMgJiYgdGhpcy5maWx0ZXJCeU5hbWVzcGFjZSkgewogICAgICAgIHRoaXMuZmlsdGVyZWRTZWNyZXRzID0gYXdhaXQgdGhpcy5maWx0ZXJTZWNyZXRzQnlBcGkoKTsKICAgICAgfQogICAgfSwKICB9LAoKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMucmVnaXN0ZXJCZWZvcmVIb29rKSB7CiAgICAgIGNvbnN0IGhvb2tOYW1lID0gdGhpcy5hcHBlbmRVbmlxdWVJZFRvSG9vayA/IHRoaXMuaG9va05hbWUgKyB0aGlzLnVuaXF1ZUlkIDogdGhpcy5ob29rTmFtZTsKCiAgICAgIGlmICghdGhpcy5kZWxlZ2F0ZUNyZWF0ZVRvUGFyZW50KSB7CiAgICAgICAgdGhpcy5yZWdpc3RlckJlZm9yZUhvb2sodGhpcy5kb0NyZWF0ZSwgaG9va05hbWUsIHRoaXMuaG9va1ByaW9yaXR5KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdCZWZvcmUgSG9vayBpcyBtaXNzaW5nJyk7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgYXN5bmMgZmlsdGVyU2VjcmV0c0J5QXBpKCkgewogICAgICBjb25zdCBmaW5kUGFnZUFyZ3MgPSB7CiAgICAgICAgLy8gT2YgdHlwZSBBY3Rpb25GaW5kUGFnZUFyZ3MKICAgICAgICBuYW1lc3BhY2VkOiB0aGlzLmZpbHRlckJ5TmFtZXNwYWNlID8gdGhpcy5uYW1lc3BhY2UgOiAnJywKICAgICAgICBwYWdpbmF0aW9uOiBuZXcgRmlsdGVyQXJncyh7CiAgICAgICAgICBmaWx0ZXJzOiBbCiAgICAgICAgICAgIFBhZ2luYXRpb25QYXJhbUZpbHRlci5jcmVhdGVNdWx0aXBsZUZpZWxkcygKICAgICAgICAgICAgICB0aGlzLnNlY3JldFR5cGVzLm1hcCgKICAgICAgICAgICAgICAgICh0KSA9PiBuZXcgUGFnaW5hdGlvbkZpbHRlckZpZWxkKHsKICAgICAgICAgICAgICAgICAgZmllbGQ6ICdtZXRhZGF0YS5maWVsZHMuMScsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICksCiAgICAgICAgICBdLAogICAgICAgIH0pLAogICAgICB9OwoKICAgICAgaWYgKHRoaXMuY2FjaGVTZWNyZXRzKSB7CiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGAkeyB0aGlzLmluU3RvcmUgfS9maW5kUGFnZWAsIHsKICAgICAgICAgIHR5cGU6IFNFQ1JFVCwKICAgICAgICAgIG9wdDogIGZpbmRQYWdlQXJncywKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgY29uc3QgdXJsID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1tgJHsgdGhpcy5pblN0b3JlIH0vdXJsRm9yYF0oCiAgICAgICAgU0VDUkVULAogICAgICAgIG51bGwsCiAgICAgICAgZmluZFBhZ2VBcmdzCiAgICAgICk7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGBjbHVzdGVyL3JlcXVlc3RgLCB7IHVybCB9KTsKCiAgICAgIHJldHVybiByZXM/LmRhdGEgfHwgW107CiAgICB9LAoKICAgIHVwZGF0ZUtleVZhbCgpIHsKICAgICAgaWYgKCAhW0FVVEhfVFlQRS5fU1NILCBBVVRIX1RZUEUuX0JBU0lDLCBBVVRIX1RZUEUuX1MzXS5pbmNsdWRlcyh0aGlzLnNlbGVjdGVkKSApIHsKICAgICAgICB0aGlzLnByaXZhdGVLZXkgPSAnJzsKICAgICAgICB0aGlzLnB1YmxpY0tleSA9ICcnOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdpbnB1dGF1dGh2YWwnLCB7CiAgICAgICAgc2VsZWN0ZWQ6ICAgdGhpcy5zZWxlY3RlZCwKICAgICAgICBwcml2YXRlS2V5OiB0aGlzLnByaXZhdGVLZXksCiAgICAgICAgcHVibGljS2V5OiAgdGhpcy5wdWJsaWNLZXkKICAgICAgfSk7CiAgICB9LAoKICAgIHVwZGF0ZSgpIHsKICAgICAgaWYgKCAoIXRoaXMuc2VsZWN0ZWQgfHwgW0FVVEhfVFlQRS5fU1NILCBBVVRIX1RZUEUuX0JBU0lDLCBBVVRIX1RZUEUuX1MzLCBBVVRIX1RZUEUuX05PTkVdLmluY2x1ZGVzKHRoaXMuc2VsZWN0ZWQpKSkgewogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgbnVsbCk7CiAgICAgIH0gZWxzZSBpZiAoIHRoaXMuc2VsZWN0ZWQuaW5jbHVkZXMoJzonKSApIHsKICAgICAgICAvLyBDbG91ZCBjcmVkcwogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdGhpcy5zZWxlY3RlZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgc3BsaXQgPSB0aGlzLnNlbGVjdGVkLnNwbGl0KCcvJyk7CgogICAgICAgIGlmICggdGhpcy5saW1pdFRvTmFtZXNwYWNlICkgewogICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBzcGxpdFsxXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IG91dCA9IHsKICAgICAgICAgICAgbmFtZXNwYWNlOiBzcGxpdFswXSwKICAgICAgICAgICAgbmFtZTogICAgICBzcGxpdFsxXQogICAgICAgICAgfTsKCiAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG91dCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUtleVZhbCgpOwogICAgfSwKCiAgICBhc3luYyBkb0NyZWF0ZSgpIHsKICAgICAgaWYgKCAhW0FVVEhfVFlQRS5fU1NILCBBVVRIX1RZUEUuX0JBU0lDLCBBVVRIX1RZUEUuX1MzXS5pbmNsdWRlcyh0aGlzLnNlbGVjdGVkKSB8fCB0aGlzLmRlbGVnYXRlQ3JlYXRlVG9QYXJlbnQgKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBsZXQgc2VjcmV0OwoKICAgICAgaWYgKCB0aGlzLnNlbGVjdGVkID09PSBBVVRIX1RZUEUuX1MzICkgewogICAgICAgIHNlY3JldCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGByYW5jaGVyL2NyZWF0ZWAsIHsKICAgICAgICAgIHR5cGU6ICAgICAgICAgICAgICAgTk9STUFOLkNMT1VEX0NSRURFTlRJQUwsCiAgICAgICAgICBzM2NyZWRlbnRpYWxDb25maWc6IHsKICAgICAgICAgICAgYWNjZXNzS2V5OiB0aGlzLnB1YmxpY0tleSwKICAgICAgICAgICAgc2VjcmV0S2V5OiB0aGlzLnByaXZhdGVLZXksCiAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHNlY3JldCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGAkeyB0aGlzLmluU3RvcmUgfS9jcmVhdGVgLCB7CiAgICAgICAgICB0eXBlOiAgICAgU0VDUkVULAogICAgICAgICAgbWV0YWRhdGE6IHsKICAgICAgICAgICAgbmFtZXNwYWNlOiAgICB0aGlzLm5hbWVzcGFjZSwKICAgICAgICAgICAgZ2VuZXJhdGVOYW1lOiB0aGlzLmdlbmVyYXRlTmFtZQogICAgICAgICAgfSwKICAgICAgICB9KTsKCiAgICAgICAgbGV0IHR5cGUsIHB1YmxpY0ZpZWxkLCBwcml2YXRlRmllbGQ7CgogICAgICAgIHN3aXRjaCAoIHRoaXMuc2VsZWN0ZWQgKSB7CiAgICAgICAgY2FzZSBBVVRIX1RZUEUuX1NTSDoKICAgICAgICAgIHR5cGUgPSBTRUNSRVRfVFlQRVMuU1NIOwogICAgICAgICAgcHVibGljRmllbGQgPSAnc3NoLXB1YmxpY2tleSc7CiAgICAgICAgICBwcml2YXRlRmllbGQgPSAnc3NoLXByaXZhdGVrZXknOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBBVVRIX1RZUEUuX0JBU0lDOgogICAgICAgICAgdHlwZSA9IFNFQ1JFVF9UWVBFUy5CQVNJQzsKICAgICAgICAgIHB1YmxpY0ZpZWxkID0gJ3VzZXJuYW1lJzsKICAgICAgICAgIHByaXZhdGVGaWVsZCA9ICdwYXNzd29yZCc7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIHR5cGUnKTsKICAgICAgICB9CgogICAgICAgIHNlY3JldC5fdHlwZSA9IHR5cGU7CiAgICAgICAgc2VjcmV0LmRhdGEgPSB7CiAgICAgICAgICBbcHVibGljRmllbGRdOiAgYmFzZTY0RW5jb2RlKHRoaXMucHVibGljS2V5KSwKICAgICAgICAgIFtwcml2YXRlRmllbGRdOiBiYXNlNjRFbmNvZGUodGhpcy5wcml2YXRlS2V5KSwKICAgICAgICB9OwogICAgICB9CgogICAgICBhd2FpdCBzZWNyZXQuc2F2ZSgpOwoKICAgICAgYXdhaXQgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzZWNyZXQuaWQ7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHNlY3JldDsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["SelectOrCreateAuthSecret.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"SelectOrCreateAuthSecret.vue","sourceRoot":"node_modules/@rancher/shell/components/form","sourcesContent":["<script>\nimport { _EDIT } from '@shell/config/query-params';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { AUTH_TYPE, NORMAN, SECRET } from '@shell/config/types';\nimport { SECRET_TYPES } from '@shell/config/secret';\nimport { base64Encode } from '@shell/utils/crypto';\nimport { addObjects, insertAt } from '@shell/utils/array';\nimport { sortBy } from '@shell/utils/sort';\nimport {\n  FilterArgs,\n  PaginationFilterField,\n  PaginationParamFilter,\n} from '@shell/types/store/pagination.types';\n\nexport default {\n  name: 'SelectOrCreateAuthSecret',\n\n  components: {\n    LabeledInput,\n    LabeledSelect,\n  },\n\n  props: {\n    mode: {\n      type:    String,\n      default: _EDIT,\n    },\n\n    preSelect: {\n      type:    Object,\n      default: null,\n    },\n\n    value: {\n      type:    [String, Object],\n      default: null,\n    },\n\n    inStore: {\n      type:    String,\n      default: 'cluster',\n    },\n\n    labelKey: {\n      type:    String,\n      default: 'selectOrCreateAuthSecret.label',\n    },\n\n    namespace: {\n      type:     String,\n      required: true,\n    },\n\n    /**\n     * Limit the selection of an existing secret to the namespace provided\n     */\n    limitToNamespace: {\n      type:    Boolean,\n      default: true,\n    },\n\n    generateName: {\n      type:    String,\n      default: 'auth-',\n    },\n\n    allowNone: {\n      type:    Boolean,\n      default: true,\n    },\n\n    allowSsh: {\n      type:    Boolean,\n      default: true,\n    },\n\n    allowBasic: {\n      type:    Boolean,\n      default: true,\n    },\n\n    allowS3: {\n      type:    Boolean,\n      default: false,\n    },\n\n    allowRke: {\n      type:    Boolean,\n      default: false,\n    },\n\n    registerBeforeHook: {\n      type:     Function,\n      required: true,\n    },\n\n    hookName: {\n      type:    String,\n      default: 'registerAuthSecret'\n    },\n\n    appendUniqueIdToHook: {\n      type:    Boolean,\n      default: false\n    },\n\n    hookPriority: {\n      type:    Number,\n      default: 99,\n    },\n\n    vertical: {\n      type:    Boolean,\n      default: false,\n    },\n\n    /**\n     * This component is used in MultiStep Priocess\n     * So when user click through to final step and submit the form\n     * This component get recreated therefore register `doCreate` as a hook each time\n     * Also, the parent step component is not aware that credential is created\n     *\n     * This property is implement to prevent this issue and delegate it to parent component.\n     */\n    delegateCreateToParent: {\n      type:    Boolean,\n      default: false,\n    },\n\n    /**\n     * Set to false to make a fresh http request to secrets every time. This can be used when secrets have already been used for\n     * another purpose on the same page\n     *\n     * Set to true to cache the response\n     */\n    cacheSecrets: {\n      type:    Boolean,\n      default: false,\n    },\n  },\n\n  async fetch() {\n    if ( (this.allowSsh || this.allowBasic || this.allowRke) && this.$store.getters[`${ this.inStore }/schemaFor`](SECRET) ) {\n      if (this.$store.getters[`${ this.inStore }/paginationEnabled`](SECRET)) {\n        // Filter results via api (because we shouldn't be fetching them all...)\n        this.filteredSecrets = await this.filterSecretsByApi();\n      } else {\n        // Cannot yet filter via api, so fetch all and filter later on\n        this.allSecrets = await this.$store.dispatch(\n          `${ this.inStore }/findAll`,\n          { type: SECRET }\n        );\n      }\n    }\n\n    if ( this.allowS3 && this.$store.getters['rancher/canList'](NORMAN.CLOUD_CREDENTIAL) ) {\n      // Avoid an async call and loading screen if already loaded by someone else\n      if (this.$store.getters['rancher/haveAll'](NORMAN.CLOUD_CREDENTIAL)) {\n        this.allCloudCreds = this.$store.getters['rancher/all'](NORMAN.CLOUD_CREDENTIAL);\n      } else {\n        this.allCloudCreds = await this.$store.dispatch('rancher/findAll', { type: NORMAN.CLOUD_CREDENTIAL });\n      }\n    } else {\n      this.allCloudCreds = [];\n    }\n\n    let selected = this.preSelect?.selected || AUTH_TYPE._NONE;\n\n    if ( !this.value ) {\n      this.publicKey = this.preSelect?.publicKey || '';\n      this.privateKey = this.preSelect?.privateKey || '';\n    }\n\n    if ( this.value ) {\n      if ( typeof this.value === 'object' ) {\n        selected = `${ this.value.namespace }/${ this.value.name }`;\n      } else if ( this.value.includes('/') || this.value.includes(':') ) {\n        selected = this.value;\n      } else if ( this.namespace ) {\n        selected = `${ this.namespace }/${ this.value }`;\n      } else {\n        selected = this.value;\n      }\n    }\n\n    this.selected = selected;\n\n    this.update();\n  },\n\n  data() {\n    return {\n      allCloudCreds: [],\n\n      allSecrets:      null,\n      filteredSecrets: null,\n\n      selected: null,\n\n      filterByNamespace: this.namespace && this.limitToNamespace,\n\n      publicKey:  '',\n      privateKey: '',\n      uniqueId:   new Date().getTime(), // Allows form state to be individually tracked if the form is in a list\n\n      SSH:   AUTH_TYPE._SSH,\n      BASIC: AUTH_TYPE._BASIC,\n      S3:    AUTH_TYPE._S3,\n    };\n  },\n\n  computed: {\n    secretTypes() {\n      const types = [];\n\n      if ( this.allowSsh ) {\n        types.push(SECRET_TYPES.SSH);\n      }\n\n      if ( this.allowBasic ) {\n        types.push(SECRET_TYPES.BASIC);\n      }\n\n      if ( this.allowRke ) {\n        types.push(SECRET_TYPES.RKE_AUTH_CONFIG);\n      }\n\n      return types;\n    },\n\n    /**\n     * Fitler secrets given their namespace and required secret type\n     *\n     * Convert secrets to list of options and suplement with custom entries\n     */\n    options() {\n      let filteredSecrets = [];\n\n      if (this.allSecrets) {\n        // Fitler secrets given their namespace and required secret type\n        filteredSecrets = this.allSecrets\n          .filter((x) => this.filterByNamespace ? x.metadata.namespace === this.namespace : true\n          )\n          .filter((x) => {\n            // Must match one of the required types\n            if (\n              this.secretTypes.length &&\n              !this.secretTypes.includes(x._type)\n            ) {\n              return false;\n            }\n\n            return true;\n          });\n      } else if (this.filteredSecrets) {\n        filteredSecrets = this.filteredSecrets;\n      }\n\n      let out = filteredSecrets.map((x) => {\n        const {\n          dataPreview, subTypeDisplay, metadata, id\n        } = x;\n\n        const label =\n          subTypeDisplay && dataPreview ? `${ metadata.name } (${ subTypeDisplay }: ${ dataPreview })` : `${ metadata.name } (${ subTypeDisplay })`;\n\n        return {\n          label,\n          group: metadata.namespace,\n          value: id,\n        };\n      });\n\n      if (this.allowS3) {\n        const more = this.allCloudCreds\n          .filter((x) => ['aws', 's3'].includes(x.provider))\n          .map((x) => {\n            return {\n              label: `${ x.nameDisplay } (${ x.providerDisplay })`,\n              group: 'Cloud Credentials',\n              value: x.id,\n            };\n          });\n\n        addObjects(out, more);\n      }\n\n      if ( !this.limitToNamespace ) {\n        out = sortBy(out, 'group');\n        if ( out.length ) {\n          let lastGroup = '';\n\n          for ( let i = 0 ; i < out.length ; i++ ) {\n            if ( out[i].group !== lastGroup ) {\n              lastGroup = out[i].group;\n\n              insertAt(out, i, {\n                kind:     'title',\n                label:    this.t('selectOrCreateAuthSecret.namespaceGroup', { name: lastGroup }),\n                disabled: true,\n              });\n\n              i++;\n            }\n          }\n        }\n      }\n\n      if ( out.length ) {\n        out.unshift({\n          kind:     'title',\n          label:    this.t('selectOrCreateAuthSecret.chooseExisting'),\n          disabled: true\n        });\n      }\n      if ( this.allowNone ) {\n        out.unshift({\n          label: this.t('generic.none'),\n          value: AUTH_TYPE._NONE,\n        });\n      }\n\n      if (this.allowSsh || this.allowS3 || this.allowBasic) {\n        out.unshift({\n          label:    'divider',\n          disabled: true,\n          kind:     'divider'\n        });\n      }\n\n      if ( this.allowSsh ) {\n        out.unshift({\n          label: this.t('selectOrCreateAuthSecret.createSsh'),\n          value: AUTH_TYPE._SSH,\n          kind:  'highlighted'\n        });\n      }\n\n      if ( this.allowS3 ) {\n        out.unshift({\n          label: this.t('selectOrCreateAuthSecret.createS3'),\n          value: AUTH_TYPE._S3,\n          kind:  'highlighted'\n        });\n      }\n\n      if ( this.allowBasic ) {\n        out.unshift({\n          label: this.t('selectOrCreateAuthSecret.createBasic'),\n          value: AUTH_TYPE._BASIC,\n          kind:  'highlighted'\n        });\n      }\n\n      return out;\n    },\n\n    firstCol() {\n      if ( this.vertical ) {\n        return '';\n      }\n\n      if ( this.selected === AUTH_TYPE._SSH || this.selected === AUTH_TYPE._BASIC || this.selected === AUTH_TYPE._S3 ) {\n        return 'col span-4';\n      }\n\n      return 'col span-6';\n    },\n\n    moreCols() {\n      if ( this.vertical ) {\n        return 'mt-20';\n      }\n\n      return 'col span-4';\n    }\n  },\n\n  watch: {\n    selected:   'update',\n    publicKey:  'updateKeyVal',\n    privateKey: 'updateKeyVal',\n\n    async namespace(ns) {\n      if (ns && !this.selected.startsWith(`${ ns }/`)) {\n        this.selected = AUTH_TYPE._NONE;\n      }\n\n      // if ns has changed and we're filtering by api... we need to re-fetch entries\n      if (this.filteredSecrets && this.filterByNamespace) {\n        this.filteredSecrets = await this.filterSecretsByApi();\n      }\n    },\n  },\n\n  created() {\n    if (this.registerBeforeHook) {\n      const hookName = this.appendUniqueIdToHook ? this.hookName + this.uniqueId : this.hookName;\n\n      if (!this.delegateCreateToParent) {\n        this.registerBeforeHook(this.doCreate, hookName, this.hookPriority);\n      }\n    } else {\n      throw new Error('Before Hook is missing');\n    }\n  },\n\n  methods: {\n    async filterSecretsByApi() {\n      const findPageArgs = {\n        // Of type ActionFindPageArgs\n        namespaced: this.filterByNamespace ? this.namespace : '',\n        pagination: new FilterArgs({\n          filters: [\n            PaginationParamFilter.createMultipleFields(\n              this.secretTypes.map(\n                (t) => new PaginationFilterField({\n                  field: 'metadata.fields.1',\n                  value: t,\n                })\n              )\n            ),\n          ],\n        }),\n      };\n\n      if (this.cacheSecrets) {\n        return await this.$store.dispatch(`${ this.inStore }/findPage`, {\n          type: SECRET,\n          opt:  findPageArgs,\n        });\n      }\n\n      const url = this.$store.getters[`${ this.inStore }/urlFor`](\n        SECRET,\n        null,\n        findPageArgs\n      );\n      const res = await this.$store.dispatch(`cluster/request`, { url });\n\n      return res?.data || [];\n    },\n\n    updateKeyVal() {\n      if ( ![AUTH_TYPE._SSH, AUTH_TYPE._BASIC, AUTH_TYPE._S3].includes(this.selected) ) {\n        this.privateKey = '';\n        this.publicKey = '';\n      }\n\n      this.$emit('inputauthval', {\n        selected:   this.selected,\n        privateKey: this.privateKey,\n        publicKey:  this.publicKey\n      });\n    },\n\n    update() {\n      if ( (!this.selected || [AUTH_TYPE._SSH, AUTH_TYPE._BASIC, AUTH_TYPE._S3, AUTH_TYPE._NONE].includes(this.selected))) {\n        this.$emit('input', null);\n      } else if ( this.selected.includes(':') ) {\n        // Cloud creds\n        this.$emit('input', this.selected);\n      } else {\n        const split = this.selected.split('/');\n\n        if ( this.limitToNamespace ) {\n          this.$emit('input', split[1]);\n        } else {\n          const out = {\n            namespace: split[0],\n            name:      split[1]\n          };\n\n          this.$emit('input', out);\n        }\n      }\n\n      this.updateKeyVal();\n    },\n\n    async doCreate() {\n      if ( ![AUTH_TYPE._SSH, AUTH_TYPE._BASIC, AUTH_TYPE._S3].includes(this.selected) || this.delegateCreateToParent ) {\n        return;\n      }\n\n      let secret;\n\n      if ( this.selected === AUTH_TYPE._S3 ) {\n        secret = await this.$store.dispatch(`rancher/create`, {\n          type:               NORMAN.CLOUD_CREDENTIAL,\n          s3credentialConfig: {\n            accessKey: this.publicKey,\n            secretKey: this.privateKey,\n          },\n        });\n      } else {\n        secret = await this.$store.dispatch(`${ this.inStore }/create`, {\n          type:     SECRET,\n          metadata: {\n            namespace:    this.namespace,\n            generateName: this.generateName\n          },\n        });\n\n        let type, publicField, privateField;\n\n        switch ( this.selected ) {\n        case AUTH_TYPE._SSH:\n          type = SECRET_TYPES.SSH;\n          publicField = 'ssh-publickey';\n          privateField = 'ssh-privatekey';\n          break;\n        case AUTH_TYPE._BASIC:\n          type = SECRET_TYPES.BASIC;\n          publicField = 'username';\n          privateField = 'password';\n          break;\n        default:\n          throw new Error('Unknown type');\n        }\n\n        secret._type = type;\n        secret.data = {\n          [publicField]:  base64Encode(this.publicKey),\n          [privateField]: base64Encode(this.privateKey),\n        };\n      }\n\n      await secret.save();\n\n      await this.$nextTick(() => {\n        this.selected = secret.id;\n      });\n\n      return secret;\n    },\n  },\n};\n</script>\n\n<template>\n  <div\n    class=\"select-or-create-auth-secret\"\n  >\n    <div\n      class=\"mt-20\"\n      :class=\"{'row': !vertical}\"\n    >\n      <div :class=\"firstCol\">\n        <LabeledSelect\n          v-model=\"selected\"\n          data-testid=\"auth-secret-select\"\n          :mode=\"mode\"\n          :label-key=\"labelKey\"\n          :loading=\"$fetchState.pending\"\n          :options=\"options\"\n          :selectable=\"option => !option.disabled\"\n        />\n      </div>\n      <template v-if=\"selected === SSH\">\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"publicKey\"\n            data-testid=\"auth-secret-ssh-public-key\"\n            :mode=\"mode\"\n            type=\"multiline\"\n            label-key=\"selectOrCreateAuthSecret.ssh.publicKey\"\n          />\n        </div>\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"privateKey\"\n            data-testid=\"auth-secret-ssh-private-key\"\n            :mode=\"mode\"\n            type=\"multiline\"\n            label-key=\"selectOrCreateAuthSecret.ssh.privateKey\"\n          />\n        </div>\n      </template>\n      <template v-else-if=\"selected === BASIC\">\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"publicKey\"\n            data-testid=\"auth-secret-basic-username\"\n            :mode=\"mode\"\n            label-key=\"selectOrCreateAuthSecret.basic.username\"\n          />\n        </div>\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"privateKey\"\n            data-testid=\"auth-secret-basic-password\"\n            :mode=\"mode\"\n            type=\"password\"\n            label-key=\"selectOrCreateAuthSecret.basic.password\"\n          />\n        </div>\n      </template>\n      <template v-else-if=\"selected === S3\">\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"publicKey\"\n            data-testid=\"auth-secret-s3-public-key\"\n            :mode=\"mode\"\n            label-key=\"selectOrCreateAuthSecret.s3.accessKey\"\n          />\n        </div>\n        <div :class=\"moreCols\">\n          <LabeledInput\n            v-model=\"privateKey\"\n            data-testid=\"auth-secret-s3-private-key\"\n            :mode=\"mode\"\n            type=\"password\"\n            label-key=\"selectOrCreateAuthSecret.s3.secretKey\"\n          />\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.select-or-create-auth-secret div.labeled-select {\n  min-height: $input-height;\n}\n</style>\n"]}]}