{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/pages/c/_cluster/explorer/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/pages/c/_cluster/explorer/index.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBEYXNoYm9hcmRNZXRyaWNzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0Rhc2hib2FyZE1ldHJpY3MnOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCB7CiAgQ0FQSSwKICBFTkRQT0lOVFMsCiAgRVZFTlQsCiAgTkFNRVNQQUNFLAogIElOR1JFU1MsCiAgTUFOQUdFTUVOVCwKICBNRVRSSUMsCiAgTk9ERSwKICBTRVJWSUNFLAogIFBWLAogIFdPUktMT0FEX1RZUEVTLAogIENPVU5ULAogIENBVEFMT0csCiAgU0VDUkVUCn0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IE5PREVfQVJDSElURUNUVVJFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBzZXRQcm9taXNlUmVzdWx0IH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwppbXBvcnQgQWxlcnRUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9BbGVydFRhYmxlJzsKaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsKaW1wb3J0IHsgcGFyc2VTaSwgY3JlYXRlTWVtb3J5VmFsdWVzIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3VuaXRzJzsKaW1wb3J0IHsKICBOQU1FLAogIFJPTEVTLAogIFNUQVRFLAp9IGZyb20gJ0BzaGVsbC9jb25maWcvdGFibGUtaGVhZGVycyc7CgppbXBvcnQgeyBtb25pdG9yaW5nU3RhdHVzLCBjYW5WaWV3R3JhZmFuYUxpbmsgfSBmcm9tICdAc2hlbGwvdXRpbHMvbW9uaXRvcmluZyc7CmltcG9ydCBUYWJiZWQgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkJzsKaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiJzsKaW1wb3J0IHsgYWxsRGFzaGJvYXJkc0V4aXN0IH0gZnJvbSAnQHNoZWxsL3V0aWxzL2dyYWZhbmEnOwppbXBvcnQgRXRjZEluZm9CYW5uZXIgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvRXRjZEluZm9CYW5uZXInOwppbXBvcnQgbWV0cmljUG9sbGVyIGZyb20gJ0BzaGVsbC9taXhpbnMvbWV0cmljLXBvbGxlcic7CmltcG9ydCBSZXNvdXJjZVN1bW1hcnksIHsgcmVzb3VyY2VDb3VudHMgfSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9SZXNvdXJjZVN1bW1hcnknOwppbXBvcnQgSGFyZHdhcmVSZXNvdXJjZUdhdWdlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0hhcmR3YXJlUmVzb3VyY2VHYXVnZSc7CmltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdAc2hlbGwvdXRpbHMvb2JqZWN0JzsKaW1wb3J0IENvbmZpZ0JhZGdlIGZyb20gJy4vQ29uZmlnQmFkZ2UnOwppbXBvcnQgRXZlbnRzVGFibGUgZnJvbSAnLi9FdmVudHNUYWJsZSc7CmltcG9ydCB7IGZldGNoQ2x1c3RlclJlc291cmNlcyB9IGZyb20gJy4vZXhwbG9yZXItdXRpbHMnOwppbXBvcnQgU2ltcGxlQm94IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1NpbXBsZUJveCc7CmltcG9ydCB7IEV4dGVuc2lvblBvaW50LCBDYXJkTG9jYXRpb24gfSBmcm9tICdAc2hlbGwvY29yZS90eXBlcyc7CmltcG9ydCB7IGdldEFwcGxpY2FibGVFeHRlbnNpb25FbmhhbmNlbWVudHMgfSBmcm9tICdAc2hlbGwvY29yZS9wbHVnaW4taGVscGVycyc7CmltcG9ydCBDZXJ0aWZpY2F0ZXMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvQ2VydGlmaWNhdGVzJzsKaW1wb3J0IHsgTkFNRSBhcyBFWFBMT1JFUiB9IGZyb20gJ0BzaGVsbC9jb25maWcvcHJvZHVjdC9leHBsb3Jlcic7CmltcG9ydCBUYWJUaXRsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJUaXRsZSc7CmltcG9ydCB7IFNUQVRFU19FTlVNIH0gZnJvbSAnQHNoZWxsL3BsdWdpbnMvZGFzaGJvYXJkLXN0b3JlL3Jlc291cmNlLWNsYXNzJzsKaW1wb3J0IGNhcGl0YWxpemUgZnJvbSAnbG9kYXNoL2NhcGl0YWxpemUnOwoKZXhwb3J0IGNvbnN0IFJFU09VUkNFUyA9IFtOQU1FU1BBQ0UsIElOR1JFU1MsIFBWLCBXT1JLTE9BRF9UWVBFUy5ERVBMT1lNRU5ULCBXT1JLTE9BRF9UWVBFUy5TVEFURUZVTF9TRVQsIFdPUktMT0FEX1RZUEVTLkpPQiwgV09SS0xPQURfVFlQRVMuREFFTU9OX1NFVCwgU0VSVklDRV07Cgpjb25zdCBDTFVTVEVSX01FVFJJQ1NfREVUQUlMX1VSTCA9ICcvYXBpL3YxL25hbWVzcGFjZXMvY2F0dGxlLW1vbml0b3Jpbmctc3lzdGVtL3NlcnZpY2VzL2h0dHA6cmFuY2hlci1tb25pdG9yaW5nLWdyYWZhbmE6ODAvcHJveHkvZC9yYW5jaGVyLWNsdXN0ZXItbm9kZXMtMS9yYW5jaGVyLWNsdXN0ZXItbm9kZXM/b3JnSWQ9MSc7CmNvbnN0IENMVVNURVJfTUVUUklDU19TVU1NQVJZX1VSTCA9ICcvYXBpL3YxL25hbWVzcGFjZXMvY2F0dGxlLW1vbml0b3Jpbmctc3lzdGVtL3NlcnZpY2VzL2h0dHA6cmFuY2hlci1tb25pdG9yaW5nLWdyYWZhbmE6ODAvcHJveHkvZC9yYW5jaGVyLWNsdXN0ZXItMS9yYW5jaGVyLWNsdXN0ZXI/b3JnSWQ9MSc7CmNvbnN0IEs4U19NRVRSSUNTX0RFVEFJTF9VUkwgPSAnL2FwaS92MS9uYW1lc3BhY2VzL2NhdHRsZS1tb25pdG9yaW5nLXN5c3RlbS9zZXJ2aWNlcy9odHRwOnJhbmNoZXItbW9uaXRvcmluZy1ncmFmYW5hOjgwL3Byb3h5L2QvcmFuY2hlci1rOHMtY29tcG9uZW50cy1ub2Rlcy0xL3JhbmNoZXIta3ViZXJuZXRlcy1jb21wb25lbnRzLW5vZGVzP29yZ0lkPTEnOwpjb25zdCBLOFNfTUVUUklDU19TVU1NQVJZX1VSTCA9ICcvYXBpL3YxL25hbWVzcGFjZXMvY2F0dGxlLW1vbml0b3Jpbmctc3lzdGVtL3NlcnZpY2VzL2h0dHA6cmFuY2hlci1tb25pdG9yaW5nLWdyYWZhbmE6ODAvcHJveHkvZC9yYW5jaGVyLWs4cy1jb21wb25lbnRzLTEvcmFuY2hlci1rdWJlcm5ldGVzLWNvbXBvbmVudHM/b3JnSWQ9MSc7CmNvbnN0IEVUQ0RfTUVUUklDU19ERVRBSUxfVVJMID0gJy9hcGkvdjEvbmFtZXNwYWNlcy9jYXR0bGUtbW9uaXRvcmluZy1zeXN0ZW0vc2VydmljZXMvaHR0cDpyYW5jaGVyLW1vbml0b3JpbmctZ3JhZmFuYTo4MC9wcm94eS9kL3JhbmNoZXItZXRjZC1ub2Rlcy0xL3JhbmNoZXItZXRjZC1ub2Rlcz9vcmdJZD0xJzsKY29uc3QgRVRDRF9NRVRSSUNTX1NVTU1BUllfVVJMID0gJy9hcGkvdjEvbmFtZXNwYWNlcy9jYXR0bGUtbW9uaXRvcmluZy1zeXN0ZW0vc2VydmljZXMvaHR0cDpyYW5jaGVyLW1vbml0b3JpbmctZ3JhZmFuYTo4MC9wcm94eS9kL3JhbmNoZXItZXRjZC0xL3JhbmNoZXItZXRjZD9vcmdJZD0xJzsKCmNvbnN0IENMVVNURVJfQ09NUE9ORU5UUyA9IFsKICAnZXRjZCcsCiAgJ3NjaGVkdWxlcicsCiAgJ2NvbnRyb2xsZXItbWFuYWdlcicsCl07CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NsdXN0ZXJFeHBsb3JlckluZGV4UGFnZScsCgogIGNvbXBvbmVudHM6IHsKICAgIEV0Y2RJbmZvQmFubmVyLAogICAgRGFzaGJvYXJkTWV0cmljcywKICAgIEhhcmR3YXJlUmVzb3VyY2VHYXVnZSwKICAgIFJlc291cmNlU3VtbWFyeSwKICAgIFRhYiwKICAgIFRhYmJlZCwKICAgIEFsZXJ0VGFibGUsCiAgICBCYW5uZXIsCiAgICBDb25maWdCYWRnZSwKICAgIEV2ZW50c1RhYmxlLAogICAgU2ltcGxlQm94LAogICAgQ2VydGlmaWNhdGVzLAogICAgVGFiVGl0bGUKICB9LAoKICBtaXhpbnM6IFttZXRyaWNQb2xsZXJdLAoKICBmZXRjaCgpIHsKICAgIGZldGNoQ2x1c3RlclJlc291cmNlcyh0aGlzLiRzdG9yZSwgTk9ERSk7CgogICAgaWYgKHRoaXMuY3VycmVudENsdXN0ZXIpIHsKICAgICAgc2V0UHJvbWlzZVJlc3VsdCgKICAgICAgICBhbGxEYXNoYm9hcmRzRXhpc3QodGhpcy4kc3RvcmUsIHRoaXMuY3VycmVudENsdXN0ZXIuaWQsIFtDTFVTVEVSX01FVFJJQ1NfREVUQUlMX1VSTCwgQ0xVU1RFUl9NRVRSSUNTX1NVTU1BUllfVVJMXSksCiAgICAgICAgdGhpcywKICAgICAgICAnc2hvd0NsdXN0ZXJNZXRyaWNzJywKICAgICAgICBgRGV0ZXJtaW5lIGNsdXN0ZXIgbWV0cmljc2AKICAgICAgKTsKICAgICAgc2V0UHJvbWlzZVJlc3VsdCgKICAgICAgICBhbGxEYXNoYm9hcmRzRXhpc3QodGhpcy4kc3RvcmUsIHRoaXMuY3VycmVudENsdXN0ZXIuaWQsIFtLOFNfTUVUUklDU19ERVRBSUxfVVJMLCBLOFNfTUVUUklDU19TVU1NQVJZX1VSTF0pLAogICAgICAgIHRoaXMsCiAgICAgICAgJ3Nob3dLOHNNZXRyaWNzJywKICAgICAgICBgRGV0ZXJtaW5lIGs4cyBtZXRyaWNzYAogICAgICApOwogICAgICBzZXRQcm9taXNlUmVzdWx0KAogICAgICAgIGFsbERhc2hib2FyZHNFeGlzdCh0aGlzLiRzdG9yZSwgdGhpcy5jdXJyZW50Q2x1c3Rlci5pZCwgW0VUQ0RfTUVUUklDU19ERVRBSUxfVVJMLCBFVENEX01FVFJJQ1NfU1VNTUFSWV9VUkxdKSwKICAgICAgICB0aGlzLAogICAgICAgICdzaG93RXRjZE1ldHJpY3MnLAogICAgICAgIGBEZXRlcm1pbmUgZXRjZCBtZXRyaWNzYAogICAgICApOwoKICAgICAgLy8gSXQncyBub3QgZW5vdWdoIHRvIGNoZWNrIHRoYXQgdGhlIGdyYWZhbmEgbGlua3MgYXJlIHdvcmtpbmcgZm9yIHRoZSBjdXJyZW50IHVzZXI7IGVtYmVkZGVkIGNsdXN0ZXItbGV2ZWwgZGFzaGJvYXJkcyBzaG91bGQgb25seSBiZSBzaG93biBpZiB0aGUgdXNlciBjYW4gdmlldyB0aGUgZ3JhZmFuYSBlbmRwb2ludAogICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmFuY2hlci9kYXNoYm9hcmQvaXNzdWVzLzk3OTIKICAgICAgc2V0UHJvbWlzZVJlc3VsdChjYW5WaWV3R3JhZmFuYUxpbmsodGhpcy4kc3RvcmUpLCB0aGlzLCAnY2FuVmlld01ldHJpY3MnLCAnRGV0ZXJtaW5lIEdyYWZhbmEgUGVybWlzc2lvbicpOwoKICAgICAgaWYgKHRoaXMuY3VycmVudENsdXN0ZXIuaXNMb2NhbCAmJiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKE1BTkFHRU1FTlQuTk9ERSkpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULk5PREUgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY2FuVmlld0FnZW50cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvY2FuTGlzdCddKFdPUktMT0FEX1RZUEVTLkRFUExPWU1FTlQpICYmIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvY2FuTGlzdCddKFdPUktMT0FEX1RZUEVTLlNUQVRFRlVMX1NFVCk7CgogICAgICBpZiAodGhpcy5jYW5WaWV3QWdlbnRzKSB7CiAgICAgICAgdGhpcy5sb2FkQWdlbnRzKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgY29uc3QgY2x1c3RlckNvdW50cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbYGNsdXN0ZXIvYWxsYF0oQ09VTlQpOwogICAgY29uc3Qgbm9kZUhlYWRlcnMgPSBbCiAgICAgIFNUQVRFLAogICAgICBOQU1FLAogICAgICBST0xFUywKICAgIF07CgogICAgcmV0dXJuIHsKICAgICAgbm9kZUhlYWRlcnMsCiAgICAgIGNvbnN0cmFpbnRzOiAgICAgICAgW10sCiAgICAgIGNhdHRsZURlcGxveW1lbnQ6ICAgJ2xvYWRpbmcnLAogICAgICBmbGVldERlcGxveW1lbnQ6ICAgICdsb2FkaW5nJywKICAgICAgZmxlZXRTdGF0ZWZ1bFNldDogICAnbG9hZGluZycsCiAgICAgIGNhblZpZXdBZ2VudHM6ICAgICAgZmFsc2UsCiAgICAgIGRpc2Nvbm5lY3RlZDogICAgICAgZmFsc2UsCiAgICAgIGV2ZW50czogICAgICAgICAgICAgW10sCiAgICAgIG5vZGVNZXRyaWNzOiAgICAgICAgW10sCiAgICAgIHNob3dDbHVzdGVyTWV0cmljczogZmFsc2UsCiAgICAgIHNob3dLOHNNZXRyaWNzOiAgICAgZmFsc2UsCiAgICAgIHNob3dFdGNkTWV0cmljczogICAgZmFsc2UsCiAgICAgIGNhblZpZXdNZXRyaWNzOiAgICAgZmFsc2UsCiAgICAgIENMVVNURVJfTUVUUklDU19ERVRBSUxfVVJMLAogICAgICBDTFVTVEVSX01FVFJJQ1NfU1VNTUFSWV9VUkwsCiAgICAgIEs4U19NRVRSSUNTX0RFVEFJTF9VUkwsCiAgICAgIEs4U19NRVRSSUNTX1NVTU1BUllfVVJMLAogICAgICBFVENEX01FVFJJQ1NfREVUQUlMX1VSTCwKICAgICAgRVRDRF9NRVRSSUNTX1NVTU1BUllfVVJMLAogICAgICBTVEFURVNfRU5VTSwKICAgICAgY2x1c3RlckNvdW50cywKICAgICAgc2VsZWN0ZWRUYWI6ICAgICAgICAnY2x1c3Rlci1ldmVudHMnLAogICAgICBleHRlbnNpb25DYXJkczogICAgIGdldEFwcGxpY2FibGVFeHRlbnNpb25FbmhhbmNlbWVudHModGhpcywgRXh0ZW5zaW9uUG9pbnQuQ0FSRCwgQ2FyZExvY2F0aW9uLkNMVVNURVJfREFTSEJPQVJEX0NBUkQsIHRoaXMuJHJvdXRlKSwKICAgIH07CiAgfSwKCiAgYmVmb3JlRGVzdHJveSgpIHsKICAgIC8vIFJlbW92ZSB0aGUgZGF0YSBhbmQgc3RvcCB3YXRjaGluZyByZXNvdXJjZXMgdGhhdCB3ZXJlIGZldGNoZWQgaW4gdGhpcyBwYWdlCiAgICAvLyBFdmVudHMgaW4gcGFydGljdWxhciBjYW4gbGVhZCB0byBjaGFuZ2UgbWVzc2FnZXMgaGF2aW5nIHRvIGJlIHByb2Nlc3NlZCB3aGVuIHdlIGFyZSBubyBsb25nZXIgaW50ZXJlc3RlZCBpbiBldmVudHMKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZvcmdldFR5cGUnLCBFVkVOVCk7CiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9mb3JnZXRUeXBlJywgTk9ERSk7CiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9mb3JnZXRUeXBlJywgRU5EUE9JTlRTKTsgLy8gVXNlZCBieSBBbGVydFRhYmxlIHRvIGdldCBhbGVydHMgd2hlbiB2MiBtb25pdG9yaW5nIGlzIGluc3RhbGxlZAogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZm9yZ2V0VHlwZScsIE1FVFJJQy5OT0RFKTsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZvcmdldFR5cGUnLCBNQU5BR0VNRU5ULk5PREUpOwogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZm9yZ2V0VHlwZScsIFdPUktMT0FEX1RZUEVTLkRFUExPWU1FTlQpOwoKICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoWydjdXJyZW50Q2x1c3RlciddKSwKICAgIC4uLm1vbml0b3JpbmdTdGF0dXMoKSwKCiAgICBub2RlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvYWxsJ10oTk9ERSk7CiAgICB9LAoKICAgIG1nbXROb2RlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oTUFOQUdFTUVOVC5DTFVTVEVSKTsKICAgIH0sCgogICAgc2hvd0NsdXN0ZXJUb29scygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvY2FuTGlzdCddKENBVEFMT0cuQ0xVU1RFUl9SRVBPKSAmJgogICAgICB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL2Nhbkxpc3QnXShDQVRBTE9HLkFQUCk7CiAgICB9LAoKICAgIGRpc3BsYXlQcm92aWRlcigpIHsKICAgICAgY29uc3Qgb3RoZXIgPSAnb3RoZXInOwoKICAgICAgbGV0IHByb3ZpZGVyID0gdGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3RhdHVzPy5wcm92aWRlciB8fCBvdGhlcjsKCiAgICAgIGlmIChwcm92aWRlciA9PT0gJ3JrZS53aW5kb3dzJykgewogICAgICAgIHByb3ZpZGVyID0gJ3JrZVdpbmRvd3MnOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuJHN0b3JlLmdldHRlcnNbJ2kxOG4vZXhpc3RzJ10oYGNsdXN0ZXIucHJvdmlkZXIuJHsgcHJvdmlkZXIgfWApKSB7CiAgICAgICAgcHJvdmlkZXIgPSAnb3RoZXInOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy50KGBjbHVzdGVyLnByb3ZpZGVyLiR7IHByb3ZpZGVyIH1gKTsKICAgIH0sCgogICAgbm9kZXNBcmNoaXRlY3R1cmUoKSB7CiAgICAgIGNvbnN0IG9iaiA9IHt9OwoKICAgICAgdGhpcy5ub2Rlcz8uZm9yRWFjaCgobm9kZSkgPT4gewogICAgICAgIGlmICghbm9kZS5tZXRhZGF0YT8uc3RhdGU/LnRyYW5zaXRpb25pbmcpIHsKICAgICAgICAgIGNvbnN0IGFyY2hpdGVjdHVyZSA9IG5vZGUubGFiZWxzPy5bTk9ERV9BUkNISVRFQ1RVUkVdOwoKICAgICAgICAgIGNvbnN0IGtleSA9IGFyY2hpdGVjdHVyZSA/IGNhcGl0YWxpemUoYXJjaGl0ZWN0dXJlKSA6IHRoaXMudCgnY2x1c3Rlci5hcmNoaXRlY3R1cmUubGFiZWwudW5rbm93bicpOwoKICAgICAgICAgIG9ialtrZXldID0gKG9ialtrZXldIHx8IDApICsgMTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0sCgogICAgYXJjaGl0ZWN0dXJlKCkgewogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5ub2Rlc0FyY2hpdGVjdHVyZSk7CgogICAgICBzd2l0Y2ggKGtleXMubGVuZ3RoKSB7CiAgICAgIGNhc2UgMDoKICAgICAgICByZXR1cm4geyBsYWJlbDogdGhpcy50KCdnZW5lcmljLnByb3Zpc2lvbmluZycpIH07CiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4geyBsYWJlbDoga2V5c1swXSB9OwogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsYWJlbDogICB0aGlzLnQoJ2NsdXN0ZXIuYXJjaGl0ZWN0dXJlLmxhYmVsLm1peGVkJyksCiAgICAgICAgICB0b29sdGlwOiBrZXlzLnJlZHVjZSgoYWNjLCBrKSA9PiBgJHsgYWNjIH0keyBrIH06ICR7IHRoaXMubm9kZXNBcmNoaXRlY3R1cmVba10gfTxicj5gLCAnJykKICAgICAgICB9OwogICAgICB9CiAgICB9LAoKICAgIGlzSGFydmVzdGVyQ2x1c3RlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudENsdXN0ZXI/LmlzSGFydmVzdGVyOwogICAgfSwKCiAgICBpc1JLRSgpIHsKICAgICAgcmV0dXJuIFsncmtlJywgJ3JrZS53aW5kb3dzJywgJ3JrZTInLCAncmtlMi53aW5kb3dzJ10uaW5jbHVkZXMoKHRoaXMuY3VycmVudENsdXN0ZXIuc3RhdHVzLnByb3ZpZGVyIHx8ICcnKS50b0xvd2VyQ2FzZSgpKTsKICAgIH0sCgogICAgYWNjZXNzaWJsZVJlc291cmNlcygpIHsKICAgICAgLy8gVGhpcyBpcyBhIGxpc3Qgb2YgSURzIGZvciBhbGxvd2VkIHJlc291cmNlcyBjb3VudHMuCiAgICAgIGNvbnN0IGRlZmF1bHRBbGxvd2VkUmVzb3VyY2VzID0gT2JqZWN0LmtleXModGhpcy5jbHVzdGVyQ291bnRzPy5bMF0/LmNvdW50cyB8fCB7fSkuZmlsdGVyKCh0eXBlSWQpID0+IHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndHlwZS1tYXAvaXNJZ25vcmVkJ10oeyBpZDogdHlwZUlkIH0pOwogICAgICB9KTsKCiAgICAgIC8vIE1lcmdlIHdpdGggUkVTT1VSQ0VTIGxpc3QKICAgICAgY29uc3QgYWxsb3dlZFJlc291cmNlcyA9IFsuLi5uZXcgU2V0KFsuLi5kZWZhdWx0QWxsb3dlZFJlc291cmNlcywgLi4uUkVTT1VSQ0VTXSldOwoKICAgICAgcmV0dXJuIGFsbG93ZWRSZXNvdXJjZXMuZmlsdGVyKChyZXNvdXJjZSkgPT4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9zY2hlbWFGb3InXShyZXNvdXJjZSkpOwogICAgfSwKCiAgICBjbHVzdGVyU2VydmljZXMoKSB7CiAgICAgIGNvbnN0IHNlcnZpY2VzID0gW107CgogICAgICBDTFVTVEVSX0NPTVBPTkVOVFMuZm9yRWFjaCgoY3MpID0+IHsKICAgICAgICBzZXJ2aWNlcy5wdXNoKHsKICAgICAgICAgIG5hbWU6ICAgICBjcywKICAgICAgICAgIHN0YXR1czogICB0aGlzLmdldENvbXBvbmVudFN0YXR1cyhjcyksCiAgICAgICAgICBsYWJlbEtleTogYGNsdXN0ZXJJbmRleFBhZ2Uuc2VjdGlvbnMuY29tcG9uZW50U3RhdHVzLiR7IGNzIH1gLAogICAgICAgIH0pOwogICAgICB9KTsKCiAgICAgIGlmICh0aGlzLmNhblZpZXdBZ2VudHMpIHsKICAgICAgICBpZiAoIXRoaXMuY3VycmVudENsdXN0ZXIuaXNMb2NhbCkgewogICAgICAgICAgc2VydmljZXMucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICAgICAnY2F0dGxlJywKICAgICAgICAgICAgc3RhdHVzOiAgIHRoaXMuY2F0dGxlU3RhdHVzLAogICAgICAgICAgICBsYWJlbEtleTogJ2NsdXN0ZXJJbmRleFBhZ2Uuc2VjdGlvbnMuY29tcG9uZW50U3RhdHVzLmNhdHRsZScsCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHNlcnZpY2VzLnB1c2goewogICAgICAgICAgbmFtZTogICAgICdmbGVldCcsCiAgICAgICAgICBzdGF0dXM6ICAgdGhpcy5mbGVldFN0YXR1cywKICAgICAgICAgIGxhYmVsS2V5OiAnY2x1c3RlckluZGV4UGFnZS5zZWN0aW9ucy5jb21wb25lbnRTdGF0dXMuZmxlZXQnLAogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gc2VydmljZXM7CiAgICB9LAoKICAgIGNhdHRsZVN0YXR1cygpIHsKICAgICAgY29uc3QgcmVzb3VyY2UgPSB0aGlzLmNhdHRsZURlcGxveW1lbnQ7CgogICAgICBpZiAocmVzb3VyY2UgPT09ICdsb2FkaW5nJykgewogICAgICAgIHJldHVybiBTVEFURVNfRU5VTS5JTl9QUk9HUkVTUzsKICAgICAgfQoKICAgICAgaWYgKCFyZXNvdXJjZSB8fCB0aGlzLmRpc2Nvbm5lY3RlZCB8fCByZXNvdXJjZS5zdGF0dXMuY29uZGl0aW9ucz8uZmluZCgoYykgPT4gYy5zdGF0dXMgIT09ICdUcnVlJykgfHwgcmVzb3VyY2UubWV0YWRhdGEuc3RhdGU/LmVycm9yKSB7CiAgICAgICAgcmV0dXJuIFNUQVRFU19FTlVNLlVOSEVBTFRIWTsKICAgICAgfQoKICAgICAgaWYgKHJlc291cmNlLnNwZWMucmVwbGljYXMgIT09IHJlc291cmNlLnN0YXR1cy5yZWFkeVJlcGxpY2FzIHx8IHJlc291cmNlLnN0YXR1cy51bmF2YWlsYWJsZVJlcGxpY2FzID4gMCkgewogICAgICAgIHJldHVybiBTVEFURVNfRU5VTS5XQVJOSU5HOwogICAgICB9CgogICAgICByZXR1cm4gU1RBVEVTX0VOVU0uSEVBTFRIWTsKICAgIH0sCgogICAgZmxlZXRTdGF0dXMoKSB7CiAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMuY3VycmVudENsdXN0ZXIuaXNMb2NhbCA/IFsKICAgICAgICAvKioKICAgICAgICAgKiAnZmxlZXRTdGF0ZWZ1bFNldCcgY291bGQgdGFrZSBhIHdoaWxlIHRvIGJlIGNyZWF0ZWQgYnkgcmFuY2hlci4KICAgICAgICAgKiBEdXJpbmcgdGhhdCBzdGFydHVwIHBlcmlvZCwgb25seSAnZmxlZXREZXBsb3ltZW50JyB3aWxsIGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBmbGVldCBhZ2VudCBzdGF0dXMuCiAgICAgICAgICovCiAgICAgICAgLi4uKHRoaXMuZmxlZXRTdGF0ZWZ1bFNldCA/IFt0aGlzLmZsZWV0U3RhdGVmdWxTZXQsIHRoaXMuZmxlZXREZXBsb3ltZW50XSA6IFt0aGlzLmZsZWV0RGVwbG95bWVudF0pLAogICAgICBdIDogWwogICAgICAgIHRoaXMuZmxlZXRTdGF0ZWZ1bFNldAogICAgICBdOwoKICAgICAgaWYgKHJlc291cmNlcy5maW5kKChyKSA9PiByID09PSAnbG9hZGluZycpKSB7CiAgICAgICAgcmV0dXJuIFNUQVRFU19FTlVNLklOX1BST0dSRVNTOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHJlc291cmNlcykgewogICAgICAgIGlmICghcmVzb3VyY2UgfHwgcmVzb3VyY2Uuc3RhdHVzLmNvbmRpdGlvbnM/LmZpbmQoKGMpID0+IGMuc3RhdHVzICE9PSAnVHJ1ZScpIHx8IHJlc291cmNlLm1ldGFkYXRhLnN0YXRlPy5lcnJvcikgewogICAgICAgICAgcmV0dXJuIFNUQVRFU19FTlVNLlVOSEVBTFRIWTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzb3VyY2VzKSB7CiAgICAgICAgaWYgKHJlc291cmNlLnNwZWMucmVwbGljYXMgIT09IHJlc291cmNlLnN0YXR1cy5yZWFkeVJlcGxpY2FzIHx8IHJlc291cmNlLnN0YXR1cy51bmF2YWlsYWJsZVJlcGxpY2FzID4gMCkgewogICAgICAgICAgcmV0dXJuIFNUQVRFU19FTlVNLldBUk5JTkc7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gU1RBVEVTX0VOVU0uSEVBTFRIWTsKICAgIH0sCgogICAgdG90YWxDb3VudEdhdWdlSW5wdXQoKSB7CiAgICAgIGNvbnN0IHRvdGFsSW5wdXQgPSB7CiAgICAgICAgbmFtZTogICAgICAgICB0aGlzLnQoJ2NsdXN0ZXJJbmRleFBhZ2UucmVzb3VyY2VHYXVnZS50b3RhbFJlc291cmNlcycpLAogICAgICAgIHRvdGFsOiAgICAgICAgMCwKICAgICAgICB1c2VmdWw6ICAgICAgIDAsCiAgICAgICAgd2FybmluZ0NvdW50OiAwLAogICAgICAgIGVycm9yQ291bnQ6ICAgMAogICAgICB9OwoKICAgICAgdGhpcy5hY2Nlc3NpYmxlUmVzb3VyY2VzLmZvckVhY2goKHJlc291cmNlKSA9PiB7CiAgICAgICAgY29uc3QgY291bnRzID0gcmVzb3VyY2VDb3VudHModGhpcy4kc3RvcmUsIHJlc291cmNlKTsKCiAgICAgICAgT2JqZWN0LmVudHJpZXMoY291bnRzKS5mb3JFYWNoKChlbnRyeSkgPT4gewogICAgICAgICAgdG90YWxJbnB1dFtlbnRyeVswXV0gKz0gZW50cnlbMV07CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHRvdGFsSW5wdXQ7CiAgICB9LAoKICAgIGhhc1N0YXRzKCkgewogICAgICByZXR1cm4gdGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3RhdHVzPy5hbGxvY2F0YWJsZSAmJiB0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LnJlcXVlc3RlZDsKICAgIH0sCgogICAgY3B1UmVzZXJ2ZWQoKSB7CiAgICAgIGNvbnN0IHRvdGFsID0gcGFyc2VTaSh0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LmFsbG9jYXRhYmxlPy5jcHUpOwoKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3RhbCwKICAgICAgICB1c2VmdWw6IHBhcnNlU2kodGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3RhdHVzPy5yZXF1ZXN0ZWQ/LmNwdSksCiAgICAgICAgdW5pdHM6ICB0aGlzLnQoJ2NsdXN0ZXJJbmRleFBhZ2UuaGFyZHdhcmVSZXNvdXJjZUdhdWdlLnVuaXRzLmNvcmVzJywgeyBjb3VudDogdG90YWwgfSkKICAgICAgfTsKICAgIH0sCgogICAgcG9kc1VzZWQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG90YWw6ICBwYXJzZVNpKHRoaXMuY3VycmVudENsdXN0ZXI/LnN0YXR1cz8uYWxsb2NhdGFibGU/LnBvZHMgfHwgJzAnKSwKICAgICAgICB1c2VmdWw6IHBhcnNlU2kodGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3RhdHVzPy5yZXF1ZXN0ZWQ/LnBvZHMgfHwgJzAnKSwKICAgICAgfTsKICAgIH0sCgogICAgcmFtUmVzZXJ2ZWQoKSB7CiAgICAgIHJldHVybiBjcmVhdGVNZW1vcnlWYWx1ZXModGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3RhdHVzPy5hbGxvY2F0YWJsZT8ubWVtb3J5LCB0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LnJlcXVlc3RlZD8ubWVtb3J5KTsKICAgIH0sCgogICAgbWV0cmljQWdncmVnYXRpb25zKCkgewogICAgICBsZXQgY2hlY2tOb2RlcyA9IHRoaXMubm9kZXM7CgogICAgICAvLyBTcGVjaWFsIGNhc2UgbG9jYWwgY2x1c3RlcgogICAgICBpZiAodGhpcy5jdXJyZW50Q2x1c3Rlci5pc0xvY2FsKSB7CiAgICAgICAgY29uc3Qgbm9kZU5hbWVzID0gdGhpcy5ub2Rlcy5yZWR1Y2UoKGFjYywgbikgPT4gewogICAgICAgICAgYWNjW24uaWRdID0gbjsKCiAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0sIHt9KTsKCiAgICAgICAgY2hlY2tOb2RlcyA9IHRoaXMubWdtdE5vZGVzLmZpbHRlcigobikgPT4gewogICAgICAgICAgY29uc3Qgbm9kZU5hbWUgPSBuLm1ldGFkYXRhPy5sYWJlbHM/LlsnbWFuYWdlbWVudC5jYXR0bGUuaW8vbm9kZW5hbWUnXSB8fCBuLmlkOwoKICAgICAgICAgIHJldHVybiAhIW5vZGVOYW1lc1tub2RlTmFtZV07CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHNvbWVOb25Xb3JrZXJSb2xlcyA9IGNoZWNrTm9kZXMuc29tZSgobm9kZSkgPT4gbm9kZS5oYXNBUm9sZSAmJiAhbm9kZS5pc1dvcmtlcik7CiAgICAgIGNvbnN0IG1ldHJpY3MgPSB0aGlzLm5vZGVNZXRyaWNzLmZpbHRlcigobm9kZU1ldHJpY3MpID0+IHsKICAgICAgICBjb25zdCBub2RlID0gdGhpcy5ub2Rlcy5maW5kKChuZCkgPT4gbmQuaWQgPT09IG5vZGVNZXRyaWNzLmlkKTsKCiAgICAgICAgcmV0dXJuIG5vZGUgJiYgKCFzb21lTm9uV29ya2VyUm9sZXMgfHwgbm9kZS5pc1dvcmtlcik7CiAgICAgIH0pOwogICAgICBjb25zdCBpbml0aWFsQWdncmVnYXRpb24gPSB7CiAgICAgICAgY3B1OiAgICAwLAogICAgICAgIG1lbW9yeTogMAogICAgICB9OwoKICAgICAgaWYgKGlzRW1wdHkobWV0cmljcykpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIG1ldHJpY3MucmVkdWNlKChhZ2csIG1ldHJpYykgPT4gewogICAgICAgIGFnZy5jcHUgKz0gcGFyc2VTaShtZXRyaWMudXNhZ2UuY3B1KTsKICAgICAgICBhZ2cubWVtb3J5ICs9IHBhcnNlU2kobWV0cmljLnVzYWdlLm1lbW9yeSk7CgogICAgICAgIHJldHVybiBhZ2c7CiAgICAgIH0sIGluaXRpYWxBZ2dyZWdhdGlvbik7CiAgICB9LAoKICAgIGNwdVVzZWQoKSB7CiAgICAgIGNvbnN0IHRvdGFsID0gcGFyc2VTaSh0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LmNhcGFjaXR5Py5jcHUpOwoKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3RhbCwKICAgICAgICB1c2VmdWw6IHRoaXMubWV0cmljQWdncmVnYXRpb25zPy5jcHUsCiAgICAgICAgdW5pdHM6ICB0aGlzLnQoJ2NsdXN0ZXJJbmRleFBhZ2UuaGFyZHdhcmVSZXNvdXJjZUdhdWdlLnVuaXRzLmNvcmVzJywgeyBjb3VudDogdG90YWwgfSkKICAgICAgfTsKICAgIH0sCgogICAgcmFtVXNlZCgpIHsKICAgICAgcmV0dXJuIGNyZWF0ZU1lbW9yeVZhbHVlcyh0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LmNhcGFjaXR5Py5tZW1vcnksIHRoaXMubWV0cmljQWdncmVnYXRpb25zPy5tZW1vcnkpOwogICAgfSwKCiAgICBoYXNNb25pdG9yaW5nKCkgewogICAgICByZXR1cm4gISF0aGlzLmNsdXN0ZXJDb3VudHM/LlswXT8uY291bnRzPy5bQ0FUQUxPRy5BUFBdPy5uYW1lc3BhY2VzPy5bJ2NhdHRsZS1tb25pdG9yaW5nLXN5c3RlbSddOwogICAgfSwKCiAgICBjYW5BY2Nlc3NOb2RlcygpIHsKICAgICAgcmV0dXJuICEhdGhpcy5jbHVzdGVyQ291bnRzPy5bMF0/LmNvdW50cz8uW05PREVdOwogICAgfSwKCiAgICBjYW5BY2Nlc3NEZXBsb3ltZW50cygpIHsKICAgICAgcmV0dXJuICEhdGhpcy5jbHVzdGVyQ291bnRzPy5bMF0/LmNvdW50cz8uW1dPUktMT0FEX1RZUEVTLkRFUExPWU1FTlRdOwogICAgfSwKCiAgICBoYXNNZXRyaWNzVGFicygpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FuVmlld01ldHJpY3MgJiYgKCB0aGlzLnNob3dDbHVzdGVyTWV0cmljcyB8fCB0aGlzLnNob3dLOHNNZXRyaWNzIHx8IHRoaXMuc2hvd0V0Y2RNZXRyaWNzKTsKICAgIH0sCgogICAgaGFzQmFkZ2UoKSB7CiAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudENsdXN0ZXI/LmJhZGdlOwogICAgfSwKCiAgICBoYXNEZXNjcmlwdGlvbigpIHsKICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50Q2x1c3Rlcj8uc3BlYz8uZGVzY3JpcHRpb247CiAgICB9LAoKICAgIGFsbEV2ZW50c0xpbmsoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogICAnYy1jbHVzdGVyLXByb2R1Y3QtcmVzb3VyY2UnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgcHJvZHVjdDogIEVYUExPUkVSLAogICAgICAgICAgcmVzb3VyY2U6IEVWRU5ULAogICAgICAgIH0KICAgICAgfTsKICAgIH0sCgogICAgYWxsU2VjcmV0c0xpbmsoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogICAnYy1jbHVzdGVyLXByb2R1Y3QtcmVzb3VyY2UnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgcHJvZHVjdDogIEVYUExPUkVSLAogICAgICAgICAgcmVzb3VyY2U6IFNFQ1JFVCwKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgbG9hZEFnZW50cygpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudENsdXN0ZXIuaXNMb2NhbCkgewogICAgICAgIHRoaXMuc2V0QWdlbnRSZXNvdXJjZSgnZmxlZXREZXBsb3ltZW50JywgV09SS0xPQURfVFlQRVMuREVQTE9ZTUVOVCwgJ2NhdHRsZS1mbGVldC1zeXN0ZW0vZmxlZXQtY29udHJvbGxlcicpOwogICAgICAgIHRoaXMuc2V0QWdlbnRSZXNvdXJjZSgnZmxlZXRTdGF0ZWZ1bFNldCcsIFdPUktMT0FEX1RZUEVTLlNUQVRFRlVMX1NFVCwgJ2NhdHRsZS1mbGVldC1sb2NhbC1zeXN0ZW0vZmxlZXQtYWdlbnQnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldEFnZW50UmVzb3VyY2UoJ2ZsZWV0U3RhdGVmdWxTZXQnLCBXT1JLTE9BRF9UWVBFUy5TVEFURUZVTF9TRVQsICdjYXR0bGUtZmxlZXQtc3lzdGVtL2ZsZWV0LWFnZW50Jyk7CiAgICAgICAgdGhpcy5zZXRBZ2VudFJlc291cmNlKCdjYXR0bGVEZXBsb3ltZW50JywgV09SS0xPQURfVFlQRVMuREVQTE9ZTUVOVCwgJ2NhdHRsZS1zeXN0ZW0vY2F0dGxlLWNsdXN0ZXItYWdlbnQnKTsKCiAgICAgICAgLy8gU2NhbGluZyBVcC9Eb3duIGNhdHRsZSBkZXBsb3ltZW50IGNhdXNlcyB3ZWIgc29ja2V0cyBkaXNjb25uZWN0aW9uOwogICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZCA9ICEhdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9pbkVycm9yJ10oeyB0eXBlOiBOT0RFIH0pOwogICAgICAgIH0sIDEwMDApOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIHNldEFnZW50UmVzb3VyY2UoYWdlbnQsIHR5cGUsIGlkKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpc1thZ2VudF0gPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kJywgeyB0eXBlLCBpZCB9KTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpc1thZ2VudF0gPSBudWxsOwogICAgICB9CiAgICB9LAoKICAgIGdldENvbXBvbmVudFN0YXR1cyhmaWVsZCkgewogICAgICBjb25zdCBtYXRjaGluZyA9ICh0aGlzLmN1cnJlbnRDbHVzdGVyPy5zdGF0dXM/LmNvbXBvbmVudFN0YXR1c2VzIHx8IFtdKS5maWx0ZXIoKHMpID0+IHMubmFtZS5zdGFydHNXaXRoKGZpZWxkKSk7CgogICAgICAvLyBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIGNvbXBvbmVudCBzdGF0dXMsIGl0J3MgImhlYWx0aHkiCiAgICAgIGlmICggIW1hdGNoaW5nLmxlbmd0aCApIHsKICAgICAgICByZXR1cm4gU1RBVEVTX0VOVU0uSEVBTFRIWTsKICAgICAgfQoKICAgICAgY29uc3QgY291bnQgPSBtYXRjaGluZy5yZWR1Y2UoKGFjYywgc3RhdHVzKSA9PiB7CiAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHN0YXR1cy5jb25kaXRpb25zLmZpbmQoKGMpID0+IGMuc3RhdHVzICE9PSAnVHJ1ZScpOwoKICAgICAgICByZXR1cm4gIWNvbmRpdGlvbnMgPyBhY2MgOiBhY2MgKyAxOwogICAgICB9LCAwKTsKCiAgICAgIGlmIChjb3VudCA+IDApIHsKICAgICAgICByZXR1cm4gU1RBVEVTX0VOVU0uVU5IRUFMVEhZOwogICAgICB9CgogICAgICByZXR1cm4gU1RBVEVTX0VOVU0uSEVBTFRIWTsKICAgIH0sCgogICAgc2hvd0FjdGlvbnMoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnYWN0aW9uLW1lbnUvc2hvdycsIHsKICAgICAgICByZXNvdXJjZXM6IHRoaXMuY3VycmVudENsdXN0ZXIsCiAgICAgICAgZWxlbTogICAgICB0aGlzLiRyZWZzWydjbHVzdGVyLWFjdGlvbnMnXSwKICAgICAgfSk7CiAgICB9LAoKICAgIC8vIFVzZWQgYnkgbWV0cmljLXBvbGxlciBtaXhpbgogICAgYXN5bmMgbG9hZE1ldHJpY3MoKSB7CiAgICAgIHRoaXMubm9kZU1ldHJpY3MgPSBhd2FpdCBmZXRjaENsdXN0ZXJSZXNvdXJjZXModGhpcy4kc3RvcmUsIE1FVFJJQy5OT0RFLCB7IGZvcmNlOiB0cnVlIH0gKTsKICAgIH0sCgogICAgLy8gRXZlbnRzL0FsZXJ0cyB0YWIgY2hhbmdlZAogICAgdGFiQ2hhbmdlKG5ldSkgewogICAgICB0aGlzLnNlbGVjdGVkVGFiID0gbmV1Py5zZWxlY3RlZE5hbWU7CiAgICB9LAoKICAgIGFzeW5jIGdvVG9IYXJ2ZXN0ZXJDbHVzdGVyKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHByb3ZDbHVzdGVycyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IENBUEkuUkFOQ0hFUl9DTFVTVEVSIH0pOwogICAgICAgIGNvbnN0IHByb3ZDbHVzdGVyID0gcHJvdkNsdXN0ZXJzLmZpbmQoKHApID0+IHAubWdtdC5pZCA9PT0gdGhpcy5jdXJyZW50Q2x1c3Rlci5pZCk7CgogICAgICAgIGF3YWl0IHByb3ZDbHVzdGVyLmdvVG9IYXJ2ZXN0ZXJDbHVzdGVyKCk7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/explorer","sourcesContent":["<script>\nimport DashboardMetrics from '@shell/components/DashboardMetrics';\nimport { mapGetters } from 'vuex';\nimport {\n  CAPI,\n  ENDPOINTS,\n  EVENT,\n  NAMESPACE,\n  INGRESS,\n  MANAGEMENT,\n  METRIC,\n  NODE,\n  SERVICE,\n  PV,\n  WORKLOAD_TYPES,\n  COUNT,\n  CATALOG,\n  SECRET\n} from '@shell/config/types';\nimport { NODE_ARCHITECTURE } from '@shell/config/labels-annotations';\nimport { setPromiseResult } from '@shell/utils/promise';\nimport AlertTable from '@shell/components/AlertTable';\nimport { Banner } from '@components/Banner';\nimport { parseSi, createMemoryValues } from '@shell/utils/units';\nimport {\n  NAME,\n  ROLES,\n  STATE,\n} from '@shell/config/table-headers';\n\nimport { monitoringStatus, canViewGrafanaLink } from '@shell/utils/monitoring';\nimport Tabbed from '@shell/components/Tabbed';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport { allDashboardsExist } from '@shell/utils/grafana';\nimport EtcdInfoBanner from '@shell/components/EtcdInfoBanner';\nimport metricPoller from '@shell/mixins/metric-poller';\nimport ResourceSummary, { resourceCounts } from '@shell/components/ResourceSummary';\nimport HardwareResourceGauge from '@shell/components/HardwareResourceGauge';\nimport { isEmpty } from '@shell/utils/object';\nimport ConfigBadge from './ConfigBadge';\nimport EventsTable from './EventsTable';\nimport { fetchClusterResources } from './explorer-utils';\nimport SimpleBox from '@shell/components/SimpleBox';\nimport { ExtensionPoint, CardLocation } from '@shell/core/types';\nimport { getApplicableExtensionEnhancements } from '@shell/core/plugin-helpers';\nimport Certificates from '@shell/components/Certificates';\nimport { NAME as EXPLORER } from '@shell/config/product/explorer';\nimport TabTitle from '@shell/components/TabTitle';\nimport { STATES_ENUM } from '@shell/plugins/dashboard-store/resource-class';\nimport capitalize from 'lodash/capitalize';\n\nexport const RESOURCES = [NAMESPACE, INGRESS, PV, WORKLOAD_TYPES.DEPLOYMENT, WORKLOAD_TYPES.STATEFUL_SET, WORKLOAD_TYPES.JOB, WORKLOAD_TYPES.DAEMON_SET, SERVICE];\n\nconst CLUSTER_METRICS_DETAIL_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-cluster-nodes-1/rancher-cluster-nodes?orgId=1';\nconst CLUSTER_METRICS_SUMMARY_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-cluster-1/rancher-cluster?orgId=1';\nconst K8S_METRICS_DETAIL_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-k8s-components-nodes-1/rancher-kubernetes-components-nodes?orgId=1';\nconst K8S_METRICS_SUMMARY_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-k8s-components-1/rancher-kubernetes-components?orgId=1';\nconst ETCD_METRICS_DETAIL_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-etcd-nodes-1/rancher-etcd-nodes?orgId=1';\nconst ETCD_METRICS_SUMMARY_URL = '/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/d/rancher-etcd-1/rancher-etcd?orgId=1';\n\nconst CLUSTER_COMPONENTS = [\n  'etcd',\n  'scheduler',\n  'controller-manager',\n];\n\nexport default {\n  name: 'ClusterExplorerIndexPage',\n\n  components: {\n    EtcdInfoBanner,\n    DashboardMetrics,\n    HardwareResourceGauge,\n    ResourceSummary,\n    Tab,\n    Tabbed,\n    AlertTable,\n    Banner,\n    ConfigBadge,\n    EventsTable,\n    SimpleBox,\n    Certificates,\n    TabTitle\n  },\n\n  mixins: [metricPoller],\n\n  fetch() {\n    fetchClusterResources(this.$store, NODE);\n\n    if (this.currentCluster) {\n      setPromiseResult(\n        allDashboardsExist(this.$store, this.currentCluster.id, [CLUSTER_METRICS_DETAIL_URL, CLUSTER_METRICS_SUMMARY_URL]),\n        this,\n        'showClusterMetrics',\n        `Determine cluster metrics`\n      );\n      setPromiseResult(\n        allDashboardsExist(this.$store, this.currentCluster.id, [K8S_METRICS_DETAIL_URL, K8S_METRICS_SUMMARY_URL]),\n        this,\n        'showK8sMetrics',\n        `Determine k8s metrics`\n      );\n      setPromiseResult(\n        allDashboardsExist(this.$store, this.currentCluster.id, [ETCD_METRICS_DETAIL_URL, ETCD_METRICS_SUMMARY_URL]),\n        this,\n        'showEtcdMetrics',\n        `Determine etcd metrics`\n      );\n\n      // It's not enough to check that the grafana links are working for the current user; embedded cluster-level dashboards should only be shown if the user can view the grafana endpoint\n      // https://github.com/rancher/dashboard/issues/9792\n      setPromiseResult(canViewGrafanaLink(this.$store), this, 'canViewMetrics', 'Determine Grafana Permission');\n\n      if (this.currentCluster.isLocal && this.$store.getters['management/schemaFor'](MANAGEMENT.NODE)) {\n        this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE });\n      }\n\n      this.canViewAgents = this.$store.getters['cluster/canList'](WORKLOAD_TYPES.DEPLOYMENT) && this.$store.getters['cluster/canList'](WORKLOAD_TYPES.STATEFUL_SET);\n\n      if (this.canViewAgents) {\n        this.loadAgents();\n      }\n    }\n  },\n\n  data() {\n    const clusterCounts = this.$store.getters[`cluster/all`](COUNT);\n    const nodeHeaders = [\n      STATE,\n      NAME,\n      ROLES,\n    ];\n\n    return {\n      nodeHeaders,\n      constraints:        [],\n      cattleDeployment:   'loading',\n      fleetDeployment:    'loading',\n      fleetStatefulSet:   'loading',\n      canViewAgents:      false,\n      disconnected:       false,\n      events:             [],\n      nodeMetrics:        [],\n      showClusterMetrics: false,\n      showK8sMetrics:     false,\n      showEtcdMetrics:    false,\n      canViewMetrics:     false,\n      CLUSTER_METRICS_DETAIL_URL,\n      CLUSTER_METRICS_SUMMARY_URL,\n      K8S_METRICS_DETAIL_URL,\n      K8S_METRICS_SUMMARY_URL,\n      ETCD_METRICS_DETAIL_URL,\n      ETCD_METRICS_SUMMARY_URL,\n      STATES_ENUM,\n      clusterCounts,\n      selectedTab:        'cluster-events',\n      extensionCards:     getApplicableExtensionEnhancements(this, ExtensionPoint.CARD, CardLocation.CLUSTER_DASHBOARD_CARD, this.$route),\n    };\n  },\n\n  beforeDestroy() {\n    // Remove the data and stop watching resources that were fetched in this page\n    // Events in particular can lead to change messages having to be processed when we are no longer interested in events\n    this.$store.dispatch('cluster/forgetType', EVENT);\n    this.$store.dispatch('cluster/forgetType', NODE);\n    this.$store.dispatch('cluster/forgetType', ENDPOINTS); // Used by AlertTable to get alerts when v2 monitoring is installed\n    this.$store.dispatch('cluster/forgetType', METRIC.NODE);\n    this.$store.dispatch('cluster/forgetType', MANAGEMENT.NODE);\n    this.$store.dispatch('cluster/forgetType', WORKLOAD_TYPES.DEPLOYMENT);\n\n    clearInterval(this.interval);\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    ...monitoringStatus(),\n\n    nodes() {\n      return this.$store.getters['cluster/all'](NODE);\n    },\n\n    mgmtNodes() {\n      return this.$store.getters['management/all'](MANAGEMENT.CLUSTER);\n    },\n\n    showClusterTools() {\n      return this.$store.getters['cluster/canList'](CATALOG.CLUSTER_REPO) &&\n      this.$store.getters['cluster/canList'](CATALOG.APP);\n    },\n\n    displayProvider() {\n      const other = 'other';\n\n      let provider = this.currentCluster?.status?.provider || other;\n\n      if (provider === 'rke.windows') {\n        provider = 'rkeWindows';\n      }\n\n      if (!this.$store.getters['i18n/exists'](`cluster.provider.${ provider }`)) {\n        provider = 'other';\n      }\n\n      return this.t(`cluster.provider.${ provider }`);\n    },\n\n    nodesArchitecture() {\n      const obj = {};\n\n      this.nodes?.forEach((node) => {\n        if (!node.metadata?.state?.transitioning) {\n          const architecture = node.labels?.[NODE_ARCHITECTURE];\n\n          const key = architecture ? capitalize(architecture) : this.t('cluster.architecture.label.unknown');\n\n          obj[key] = (obj[key] || 0) + 1;\n        }\n      });\n\n      return obj;\n    },\n\n    architecture() {\n      const keys = Object.keys(this.nodesArchitecture);\n\n      switch (keys.length) {\n      case 0:\n        return { label: this.t('generic.provisioning') };\n      case 1:\n        return { label: keys[0] };\n      default:\n        return {\n          label:   this.t('cluster.architecture.label.mixed'),\n          tooltip: keys.reduce((acc, k) => `${ acc }${ k }: ${ this.nodesArchitecture[k] }<br>`, '')\n        };\n      }\n    },\n\n    isHarvesterCluster() {\n      return this.currentCluster?.isHarvester;\n    },\n\n    isRKE() {\n      return ['rke', 'rke.windows', 'rke2', 'rke2.windows'].includes((this.currentCluster.status.provider || '').toLowerCase());\n    },\n\n    accessibleResources() {\n      // This is a list of IDs for allowed resources counts.\n      const defaultAllowedResources = Object.keys(this.clusterCounts?.[0]?.counts || {}).filter((typeId) => {\n        return this.$store.getters['type-map/isIgnored']({ id: typeId });\n      });\n\n      // Merge with RESOURCES list\n      const allowedResources = [...new Set([...defaultAllowedResources, ...RESOURCES])];\n\n      return allowedResources.filter((resource) => this.$store.getters['cluster/schemaFor'](resource));\n    },\n\n    clusterServices() {\n      const services = [];\n\n      CLUSTER_COMPONENTS.forEach((cs) => {\n        services.push({\n          name:     cs,\n          status:   this.getComponentStatus(cs),\n          labelKey: `clusterIndexPage.sections.componentStatus.${ cs }`,\n        });\n      });\n\n      if (this.canViewAgents) {\n        if (!this.currentCluster.isLocal) {\n          services.push({\n            name:     'cattle',\n            status:   this.cattleStatus,\n            labelKey: 'clusterIndexPage.sections.componentStatus.cattle',\n          });\n        }\n\n        services.push({\n          name:     'fleet',\n          status:   this.fleetStatus,\n          labelKey: 'clusterIndexPage.sections.componentStatus.fleet',\n        });\n      }\n\n      return services;\n    },\n\n    cattleStatus() {\n      const resource = this.cattleDeployment;\n\n      if (resource === 'loading') {\n        return STATES_ENUM.IN_PROGRESS;\n      }\n\n      if (!resource || this.disconnected || resource.status.conditions?.find((c) => c.status !== 'True') || resource.metadata.state?.error) {\n        return STATES_ENUM.UNHEALTHY;\n      }\n\n      if (resource.spec.replicas !== resource.status.readyReplicas || resource.status.unavailableReplicas > 0) {\n        return STATES_ENUM.WARNING;\n      }\n\n      return STATES_ENUM.HEALTHY;\n    },\n\n    fleetStatus() {\n      const resources = this.currentCluster.isLocal ? [\n        /**\n         * 'fleetStatefulSet' could take a while to be created by rancher.\n         * During that startup period, only 'fleetDeployment' will be used to calculate the fleet agent status.\n         */\n        ...(this.fleetStatefulSet ? [this.fleetStatefulSet, this.fleetDeployment] : [this.fleetDeployment]),\n      ] : [\n        this.fleetStatefulSet\n      ];\n\n      if (resources.find((r) => r === 'loading')) {\n        return STATES_ENUM.IN_PROGRESS;\n      }\n\n      for (const resource of resources) {\n        if (!resource || resource.status.conditions?.find((c) => c.status !== 'True') || resource.metadata.state?.error) {\n          return STATES_ENUM.UNHEALTHY;\n        }\n      }\n\n      for (const resource of resources) {\n        if (resource.spec.replicas !== resource.status.readyReplicas || resource.status.unavailableReplicas > 0) {\n          return STATES_ENUM.WARNING;\n        }\n      }\n\n      return STATES_ENUM.HEALTHY;\n    },\n\n    totalCountGaugeInput() {\n      const totalInput = {\n        name:         this.t('clusterIndexPage.resourceGauge.totalResources'),\n        total:        0,\n        useful:       0,\n        warningCount: 0,\n        errorCount:   0\n      };\n\n      this.accessibleResources.forEach((resource) => {\n        const counts = resourceCounts(this.$store, resource);\n\n        Object.entries(counts).forEach((entry) => {\n          totalInput[entry[0]] += entry[1];\n        });\n      });\n\n      return totalInput;\n    },\n\n    hasStats() {\n      return this.currentCluster?.status?.allocatable && this.currentCluster?.status?.requested;\n    },\n\n    cpuReserved() {\n      const total = parseSi(this.currentCluster?.status?.allocatable?.cpu);\n\n      return {\n        total,\n        useful: parseSi(this.currentCluster?.status?.requested?.cpu),\n        units:  this.t('clusterIndexPage.hardwareResourceGauge.units.cores', { count: total })\n      };\n    },\n\n    podsUsed() {\n      return {\n        total:  parseSi(this.currentCluster?.status?.allocatable?.pods || '0'),\n        useful: parseSi(this.currentCluster?.status?.requested?.pods || '0'),\n      };\n    },\n\n    ramReserved() {\n      return createMemoryValues(this.currentCluster?.status?.allocatable?.memory, this.currentCluster?.status?.requested?.memory);\n    },\n\n    metricAggregations() {\n      let checkNodes = this.nodes;\n\n      // Special case local cluster\n      if (this.currentCluster.isLocal) {\n        const nodeNames = this.nodes.reduce((acc, n) => {\n          acc[n.id] = n;\n\n          return acc;\n        }, {});\n\n        checkNodes = this.mgmtNodes.filter((n) => {\n          const nodeName = n.metadata?.labels?.['management.cattle.io/nodename'] || n.id;\n\n          return !!nodeNames[nodeName];\n        });\n      }\n\n      const someNonWorkerRoles = checkNodes.some((node) => node.hasARole && !node.isWorker);\n      const metrics = this.nodeMetrics.filter((nodeMetrics) => {\n        const node = this.nodes.find((nd) => nd.id === nodeMetrics.id);\n\n        return node && (!someNonWorkerRoles || node.isWorker);\n      });\n      const initialAggregation = {\n        cpu:    0,\n        memory: 0\n      };\n\n      if (isEmpty(metrics)) {\n        return null;\n      }\n\n      return metrics.reduce((agg, metric) => {\n        agg.cpu += parseSi(metric.usage.cpu);\n        agg.memory += parseSi(metric.usage.memory);\n\n        return agg;\n      }, initialAggregation);\n    },\n\n    cpuUsed() {\n      const total = parseSi(this.currentCluster?.status?.capacity?.cpu);\n\n      return {\n        total,\n        useful: this.metricAggregations?.cpu,\n        units:  this.t('clusterIndexPage.hardwareResourceGauge.units.cores', { count: total })\n      };\n    },\n\n    ramUsed() {\n      return createMemoryValues(this.currentCluster?.status?.capacity?.memory, this.metricAggregations?.memory);\n    },\n\n    hasMonitoring() {\n      return !!this.clusterCounts?.[0]?.counts?.[CATALOG.APP]?.namespaces?.['cattle-monitoring-system'];\n    },\n\n    canAccessNodes() {\n      return !!this.clusterCounts?.[0]?.counts?.[NODE];\n    },\n\n    canAccessDeployments() {\n      return !!this.clusterCounts?.[0]?.counts?.[WORKLOAD_TYPES.DEPLOYMENT];\n    },\n\n    hasMetricsTabs() {\n      return this.canViewMetrics && ( this.showClusterMetrics || this.showK8sMetrics || this.showEtcdMetrics);\n    },\n\n    hasBadge() {\n      return !!this.currentCluster?.badge;\n    },\n\n    hasDescription() {\n      return !!this.currentCluster?.spec?.description;\n    },\n\n    allEventsLink() {\n      return {\n        name:   'c-cluster-product-resource',\n        params: {\n          product:  EXPLORER,\n          resource: EVENT,\n        }\n      };\n    },\n\n    allSecretsLink() {\n      return {\n        name:   'c-cluster-product-resource',\n        params: {\n          product:  EXPLORER,\n          resource: SECRET,\n        }\n      };\n    }\n  },\n\n  methods: {\n    loadAgents() {\n      if (this.currentCluster.isLocal) {\n        this.setAgentResource('fleetDeployment', WORKLOAD_TYPES.DEPLOYMENT, 'cattle-fleet-system/fleet-controller');\n        this.setAgentResource('fleetStatefulSet', WORKLOAD_TYPES.STATEFUL_SET, 'cattle-fleet-local-system/fleet-agent');\n      } else {\n        this.setAgentResource('fleetStatefulSet', WORKLOAD_TYPES.STATEFUL_SET, 'cattle-fleet-system/fleet-agent');\n        this.setAgentResource('cattleDeployment', WORKLOAD_TYPES.DEPLOYMENT, 'cattle-system/cattle-cluster-agent');\n\n        // Scaling Up/Down cattle deployment causes web sockets disconnection;\n        this.interval = setInterval(() => {\n          this.disconnected = !!this.$store.getters['cluster/inError']({ type: NODE });\n        }, 1000);\n      }\n    },\n\n    async setAgentResource(agent, type, id) {\n      try {\n        this[agent] = await this.$store.dispatch('cluster/find', { type, id });\n      } catch (err) {\n        this[agent] = null;\n      }\n    },\n\n    getComponentStatus(field) {\n      const matching = (this.currentCluster?.status?.componentStatuses || []).filter((s) => s.name.startsWith(field));\n\n      // If there's no matching component status, it's \"healthy\"\n      if ( !matching.length ) {\n        return STATES_ENUM.HEALTHY;\n      }\n\n      const count = matching.reduce((acc, status) => {\n        const conditions = status.conditions.find((c) => c.status !== 'True');\n\n        return !conditions ? acc : acc + 1;\n      }, 0);\n\n      if (count > 0) {\n        return STATES_ENUM.UNHEALTHY;\n      }\n\n      return STATES_ENUM.HEALTHY;\n    },\n\n    showActions() {\n      this.$store.commit('action-menu/show', {\n        resources: this.currentCluster,\n        elem:      this.$refs['cluster-actions'],\n      });\n    },\n\n    // Used by metric-poller mixin\n    async loadMetrics() {\n      this.nodeMetrics = await fetchClusterResources(this.$store, METRIC.NODE, { force: true } );\n    },\n\n    // Events/Alerts tab changed\n    tabChange(neu) {\n      this.selectedTab = neu?.selectedName;\n    },\n\n    async goToHarvesterCluster() {\n      try {\n        const provClusters = await this.$store.dispatch('management/findAll', { type: CAPI.RANCHER_CLUSTER });\n        const provCluster = provClusters.find((p) => p.mgmt.id === this.currentCluster.id);\n\n        await provCluster.goToHarvesterCluster();\n      } catch {\n      }\n    }\n  },\n};\n</script>\n\n<template>\n  <section class=\"dashboard\">\n    <header>\n      <div class=\"title\">\n        <h1>\n          <TabTitle>\n            {{ t('clusterIndexPage.header') }}\n          </TabTitle>\n        </h1>\n        <div\n          v-if=\"hasDescription\"\n          class=\"cluster-dashboard-description\"\n        >\n          <span>{{ currentCluster.spec.description }}</span>\n        </div>\n      </div>\n    </header>\n    <div\n      class=\"cluster-dashboard-glance\"\n    >\n      <div data-testid=\"clusterProvider__label\">\n        <label>{{ t('glance.provider') }}: </label>\n        <span v-if=\"isHarvesterCluster\">\n          <a\n            role=\"button\"\n            @click=\"goToHarvesterCluster\"\n          >\n            {{ displayProvider }}\n          </a>\n        </span>\n        <span v-else>\n          {{ displayProvider }}\n        </span>\n      </div>\n      <div data-testid=\"kubernetesVersion__label\">\n        <label>{{ t('glance.version') }}: </label>\n        <span>{{ currentCluster.kubernetesVersionBase }}</span>\n        <span\n          v-if=\"currentCluster.kubernetesVersionExtension\"\n          style=\"font-size: 0.75em\"\n        >{{ currentCluster.kubernetesVersionExtension }}</span>\n      </div>\n      <div\n        v-if=\"nodes.length > 0\"\n        data-testid=\"architecture__label\"\n      >\n        <label>{{ t('glance.architecture') }}: </label>\n        <span v-clean-tooltip=\"architecture.tooltip\">\n          {{ architecture.label }}\n        </span>\n      </div>\n      <div data-testid=\"created__label\">\n        <label>{{ t('glance.created') }}: </label>\n        <span><LiveDate\n          :value=\"currentCluster.metadata.creationTimestamp\"\n          :add-suffix=\"true\"\n          :show-tooltip=\"true\"\n        /></span>\n      </div>\n      <div :style=\"{'flex':1}\" />\n      <div v-if=\"showClusterTools\">\n        <router-link\n          :to=\"{name: 'c-cluster-explorer-tools'}\"\n          class=\"cluster-tools-link\"\n        >\n          <span>{{ t('nav.clusterTools') }}</span>\n        </router-link>\n      </div>\n      <ConfigBadge\n        v-if=\"currentCluster.canUpdate\"\n        :cluster=\"currentCluster\"\n      />\n    </div>\n\n    <div class=\"resource-gauges\">\n      <ResourceSummary :spoofed-counts=\"totalCountGaugeInput\" />\n      <ResourceSummary\n        v-if=\"canAccessNodes\"\n        resource=\"node\"\n      />\n      <ResourceSummary\n        v-if=\"canAccessDeployments\"\n        resource=\"apps.deployment\"\n      />\n    </div>\n\n    <!-- extension cards -->\n    <div\n      v-if=\"extensionCards.length\"\n      class=\"extension-card-container mt-20\"\n    >\n      <SimpleBox\n        v-for=\"item, i in extensionCards\"\n        :key=\"`extensionCards${i}`\"\n        class=\"extension-card\"\n        :style=\"item.style\"\n      >\n        <h3>\n          {{ item.label }}\n        </h3>\n        <component\n          :is=\"item.component\"\n          :resource=\"currentCluster\"\n        />\n      </SimpleBox>\n    </div>\n\n    <h3\n      v-if=\"hasStats\"\n      class=\"mt-40\"\n    >\n      {{ t('clusterIndexPage.sections.capacity.label') }}\n    </h3>\n    <div\n      v-if=\"hasStats\"\n      class=\"hardware-resource-gauges\"\n    >\n      <HardwareResourceGauge\n        :name=\"t('clusterIndexPage.hardwareResourceGauge.pods')\"\n        :used=\"podsUsed\"\n      />\n      <HardwareResourceGauge\n        :name=\"t('clusterIndexPage.hardwareResourceGauge.cores')\"\n        :reserved=\"cpuReserved\"\n        :used=\"cpuUsed\"\n        :units=\"cpuReserved.units\"\n      />\n      <HardwareResourceGauge\n        :name=\"t('clusterIndexPage.hardwareResourceGauge.ram')\"\n        :reserved=\"ramReserved\"\n        :used=\"ramUsed\"\n        :units=\"ramReserved.units\"\n      />\n    </div>\n\n    <div v-if=\"clusterServices\">\n      <div\n        v-for=\"service in clusterServices\"\n        :key=\"service.name\"\n        class=\"k8s-service-status\"\n        :class=\"{[service.status]: true }\"\n        :data-testid=\"`k8s-service-${ service.name }`\"\n      >\n        <i\n          v-if=\"service.status === STATES_ENUM.IN_PROGRESS\"\n          class=\"icon icon-spinner icon-spin\"\n        />\n        <i\n          v-else-if=\"service.status === STATES_ENUM.HEALTHY\"\n          class=\"icon icon-checkmark\"\n        />\n        <i\n          v-else\n          class=\"icon icon-warning\"\n        />\n        <div class=\"label\">\n          {{ t(service.labelKey) }}\n        </div>\n      </div>\n    </div>\n\n    <div class=\"mt-30\">\n      <Tabbed @changed=\"tabChange\">\n        <Tab\n          name=\"cluster-events\"\n          :label=\"t('clusterIndexPage.sections.events.label')\"\n          :weight=\"2\"\n        >\n          <span class=\"events-table-link\">\n            <router-link :to=\"allEventsLink\">\n              <span>{{ t('glance.eventsTable') }}</span>\n            </router-link>\n          </span>\n          <EventsTable />\n        </Tab>\n        <Tab\n          v-if=\"hasMonitoring\"\n          name=\"cluster-alerts\"\n          :label=\"t('clusterIndexPage.sections.alerts.label')\"\n          :weight=\"1\"\n        >\n          <AlertTable v-if=\"selectedTab === 'cluster-alerts'\" />\n        </Tab>\n        <Tab\n          name=\"cluster-certs\"\n          :label=\"t('clusterIndexPage.sections.certs.label')\"\n          :weight=\"1\"\n        >\n          <span class=\"cert-table-link\">\n            <router-link :to=\"allSecretsLink\">\n              <span>{{ t('glance.secretsTable') }}</span>\n            </router-link>\n          </span>\n          <Certificates v-if=\"selectedTab === 'cluster-certs'\" />\n        </Tab>\n      </Tabbed>\n    </div>\n    <Tabbed\n      v-if=\"hasMetricsTabs\"\n      default-tab=\"cluster-metrics\"\n      :use-hash=\"false\"\n      class=\"mt-30\"\n    >\n      <Tab\n        v-if=\"showClusterMetrics\"\n        name=\"cluster-metrics\"\n        :label=\"t('clusterIndexPage.sections.clusterMetrics.label')\"\n        :weight=\"2\"\n      >\n        <template #default=\"props\">\n          <DashboardMetrics\n            v-if=\"props.active\"\n            :detail-url=\"CLUSTER_METRICS_DETAIL_URL\"\n            :summary-url=\"CLUSTER_METRICS_SUMMARY_URL\"\n            graph-height=\"825px\"\n          />\n        </template>\n      </Tab>\n      <Tab\n        v-if=\"showK8sMetrics\"\n        name=\"k8s-metrics\"\n        :label=\"t('clusterIndexPage.sections.k8sMetrics.label')\"\n        :weight=\"1\"\n      >\n        <template #default=\"props\">\n          <DashboardMetrics\n            v-if=\"props.active\"\n            :detail-url=\"K8S_METRICS_DETAIL_URL\"\n            :summary-url=\"K8S_METRICS_SUMMARY_URL\"\n            graph-height=\"550px\"\n          />\n        </template>\n      </Tab>\n      <Tab\n        v-if=\"showEtcdMetrics\"\n        name=\"etcd-metrics\"\n        :label=\"t('clusterIndexPage.sections.etcdMetrics.label')\"\n        :weight=\"0\"\n      >\n        <template #default=\"props\">\n          <DashboardMetrics\n            v-if=\"props.active\"\n            class=\"etcd-metrics\"\n            :detail-url=\"ETCD_METRICS_DETAIL_URL\"\n            :summary-url=\"ETCD_METRICS_SUMMARY_URL\"\n            graph-height=\"550px\"\n          >\n            <EtcdInfoBanner />\n          </DashboardMetrics>\n        </template>\n      </Tab>\n    </Tabbed>\n  </section>\n</template>\n\n<style lang=\"scss\" scoped>\n.extension-card-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(calc((100%/3) - 40px), 1fr));\n  grid-column-gap: 15px;\n  grid-row-gap: 20px;\n}\n\n@media only screen and (max-width: map-get($breakpoints, \"--viewport-9\")) {\n  .extension-card-container {\n    grid-template-columns: 1fr !important;\n  }\n}\n\n.cluster-dashboard-glance {\n  align-items: center;\n  border-top: 1px solid var(--border);\n  border-bottom: 1px solid var(--border);\n  padding: 10px 0px;\n  display: flex;\n\n  &>*:not(:nth-last-child(-n+2)) {\n    margin-right: 40px;\n\n    & SPAN {\n       font-weight: bold\n    }\n  }\n}\n\n.title {\n  h1 {\n    margin: 0;\n  }\n\n  .cluster-dashboard-description {\n    margin: 5px 0;\n    opacity: 0.7;\n  }\n}\n\n.actions-span {\n  align-self: center;\n}\n\n.events {\n  margin-top: 30px;\n}\n\n.graph-options {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.etcd-metrics ::v-deep .external-link {\n  top: -107px;\n}\n\n.cluster-tools-tip {\n  margin-top: 0;\n}\n\n.cluster-tools-link {\n  display: flex;\n  margin-right: 10px;\n\n  > I {\n    line-height: inherit;\n    margin-right: 4px;\n  }\n\n  &:focus {\n    outline: 0;\n  }\n}\n\n.events-table-link, .cert-table-link {\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 20px;\n}\n\n.k8s-service-status {\n  align-items: center;\n  display: inline-flex;\n  border: 1px solid;\n  border-color: var(--border);\n  margin-top: 20px;\n\n  .label {\n    border-left: 1px solid var(--border);\n  }\n\n  &:not(:last-child) {\n    margin-right: 20px;\n  }\n\n  > div {\n    padding: 5px 20px;\n  }\n\n  > I {\n    text-align: center;\n    padding: 5px 10px;\n  }\n\n  &.unhealthy {\n    border-color: var(--error-border);\n\n    > I {\n      color: var(--error)\n    }\n  }\n\n  &.warning {\n    > I {\n      color: var(--warning)\n    }\n  }\n\n  &.healthy {\n    > I {\n      color: var(--success)\n    }\n  }\n}\n</style>\n"]}]}