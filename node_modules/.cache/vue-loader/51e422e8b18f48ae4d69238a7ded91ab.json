{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/helm.cattle.io.projecthelmchart.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/helm.cattle.io.projecthelmchart.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBUYWJiZWQgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkJzsKaW1wb3J0IGNyZWF0ZUVkaXRWaWV3IGZyb20gJ0BzaGVsbC9taXhpbnMvY3JlYXRlLWVkaXQtdmlldyc7CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCBRdWVzdGlvbnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvUXVlc3Rpb25zJzsKaW1wb3J0IHsgQ09ORklHX01BUCwgTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCBqc3lhbWwgZnJvbSAnanMteWFtbCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ3J1UmVzb3VyY2UsCiAgICBMYWJlbGVkU2VsZWN0LAogICAgTGFiZWxlZElucHV0LAogICAgVGFiYmVkLAogICAgUXVlc3Rpb25zLAogICAgTG9hZGluZwogIH0sCgogIG1peGluczogW2NyZWF0ZUVkaXRWaWV3XSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgICBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjYXRhbG9nL2xvYWQnKTsKICAgIGNvbnN0IGluU3RvcmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXShOQU1FU1BBQ0UpOwogICAgY29uc3QgZmVkZXJhdG9yU3lzdGVtTmFtZXNwYWNlc0NvbmZpZ01hcCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmQnLCB7IHR5cGU6IENPTkZJR19NQVAsIGlkOiAnY2F0dGxlLW1vbml0b3Jpbmctc3lzdGVtL3Byb21ldGhldXMtZmVkZXJhdG9yLXN5c3RlbS1uYW1lc3BhY2VzJyB9KTsKCiAgICB0aGlzLnN5c3RlbU5hbWVzcGFjZXMgPSBKU09OLnBhcnNlKGZlZGVyYXRvclN5c3RlbU5hbWVzcGFjZXNDb25maWdNYXA/LmRhdGE/Llsnc3lzdGVtLW5hbWVzcGFjZXMuanNvbiddKTsKCiAgICB0aGlzLm5hbWVzcGFjZXMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzW2AkeyBpblN0b3JlIH0vYWxsYF0oTkFNRVNQQUNFKQogICAgICAuZmlsdGVyKHRoaXMubmFtZXNwYWNlRmlsdGVyKQogICAgICAubWFwKHRoaXMubmFtZXNwYWNlTWFwcGVyKTsKCiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICB9LAoKICBkYXRhKCkgewogICAgaWYgKCF0aGlzLnZhbHVlLnNwZWMudmFsdWVzKSB7CiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLnNwZWMsICd2YWx1ZXMnLCB7fSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgc3lzdGVtTmFtZXNwYWNlczogICAgICAgICAgIG51bGwsCiAgICAgIG5hbWVzcGFjZXM6ICAgICAgICAgICAgICAgICBbXSwKICAgICAgbG9hZGluZzogICAgICAgICAgICAgICAgICAgIHRydWUsCiAgICAgIGluU3RvcmU6ICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXSgpLAogICAgICBzZWxlY3RlZE5hbWVzcGFjZVF1ZXN0aW9uczogbnVsbCwKICAgIH07CiAgfSwKCiAgd2F0Y2g6IHsKICAgIC8qKgogICAgICogR2l2ZW4gdGhlIGN1cnJlbnQgbmFtZXNwYWNlLCBmZXRjaCBhIHNwZWNpZmljIHNlY3JldCBmcm9tIHdpdGhpbiB3aGljaCB3aWxsIGNvbnRhaW4gYSBxdWVzdGlvbnMueWFtbAogICAgICovCiAgICBhc3luYyBjdXJyZW50TmFtZXNwYWNlKG5ldSwgb2xkKSB7CiAgICAgIGlmICghbmV1KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBjb25maWdNYXBSZWxhdGlvbnNoaXAgPSBuZXUubWV0YWRhdGE/LnJlbGF0aW9uc2hpcHMuZmluZCgocmVsYXRpb25zaGlwKSA9PiByZWxhdGlvbnNoaXA/LnRvVHlwZSA9PT0gQ09ORklHX01BUCk7CgogICAgICBpZiAoIWNvbmZpZ01hcFJlbGF0aW9uc2hpcD8udG9JZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goYCR7IHRoaXMuaW5TdG9yZSB9L2ZpbmRgLCB7IHR5cGU6IENPTkZJR19NQVAsIGlkOiBjb25maWdNYXBSZWxhdGlvbnNoaXAudG9JZCB9KTsKICAgICAgY29uc3QgcXVlc3Rpb25zWWFtbCA9IHJlcz8uZGF0YT8uWydxdWVzdGlvbnMueWFtbCddOwoKICAgICAgaWYgKCFxdWVzdGlvbnNZYW1sKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuc2VsZWN0ZWROYW1lc3BhY2VRdWVzdGlvbnMgPSBqc3lhbWwubG9hZChxdWVzdGlvbnNZYW1sKT8ucXVlc3Rpb25zOwogICAgfQogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBjdXJyZW50TmFtZXNwYWNlKCkgewogICAgICByZXR1cm4gdGhpcy5uYW1lc3BhY2VzLmZpbmQoKG5hbWVzcGFjZSkgPT4gbmFtZXNwYWNlLmlkID09PSB0aGlzLnZhbHVlPy5tZXRhZGF0YT8ubmFtZXNwYWNlKTsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBnZXROYW1lc3BhY2VDb25maWdNYXBJZChuYW1lc3BhY2UpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudE5hbWVzcGFjZT8ubWV0YWRhdGE/LnJlbGF0aW9uc2hpcHMuZmluZCgocmVsYXRpb25zaGlwKSA9PiByZWxhdGlvbnNoaXA/LnRvVHlwZSA9PT0gJ2NvbmZpZ21hcCcpPy50b0lkOwogICAgfSwKICAgIG5hbWVzcGFjZUZpbHRlcihuYW1lc3BhY2UpIHsKICAgICAgY29uc3QgZXhjbHVkZVByb2plY3RzID0gWy4uLnRoaXMuc3lzdGVtTmFtZXNwYWNlcz8uc3lzdGVtUHJvamVjdExhYmVsVmFsdWVzIHx8IFtdLCB0aGlzLnN5c3RlbU5hbWVzcGFjZXM/LnByb2plY3RSZWxlYXNlTGFiZWxWYWx1ZV07CgogICAgICByZXR1cm4gbmFtZXNwYWNlPy5wcm9qZWN0ICYmIG5hbWVzcGFjZT8ubWV0YWRhdGE/LmxhYmVscz8uWydoZWxtLmNhdHRsZS5pby9oZWxtLXByb2plY3Qtb3BlcmF0ZWQnXSAmJiAhZXhjbHVkZVByb2plY3RzLmluY2x1ZGVzKG5hbWVzcGFjZS5wcm9qZWN0SWQpOwogICAgfSwKICAgIG5hbWVzcGFjZU1hcHBlcihuYW1lc3BhY2UpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAuLi5uYW1lc3BhY2UsCiAgICAgICAgY29uZmlnTWFwSWQ6IHRoaXMuZ2V0TmFtZXNwYWNlQ29uZmlnTWFwSWQobmFtZXNwYWNlKSwKICAgICAgICBsYWJlbDogICAgICAgbmFtZXNwYWNlPy5wcm9qZWN0Py5zcGVjPy5kaXNwbGF5TmFtZSwKICAgICAgICB2YWx1ZTogICAgICAgbmFtZXNwYWNlPy5pZCwKICAgICAgfTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["helm.cattle.io.projecthelmchart.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"helm.cattle.io.projecthelmchart.vue","sourceRoot":"node_modules/@rancher/shell/edit","sourcesContent":["<script>\nimport Tabbed from '@shell/components/Tabbed';\nimport createEditView from '@shell/mixins/create-edit-view';\nimport CruResource from '@shell/components/CruResource';\nimport Questions from '@shell/components/Questions';\nimport { CONFIG_MAP, NAMESPACE } from '@shell/config/types';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport Loading from '@shell/components/Loading';\nimport jsyaml from 'js-yaml';\n\nexport default {\n  components: {\n    CruResource,\n    LabeledSelect,\n    LabeledInput,\n    Tabbed,\n    Questions,\n    Loading\n  },\n\n  mixins: [createEditView],\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  async fetch() {\n    await this.$store.dispatch('catalog/load');\n    const inStore = this.$store.getters['currentStore'](NAMESPACE);\n    const federatorSystemNamespacesConfigMap = await this.$store.dispatch('cluster/find', { type: CONFIG_MAP, id: 'cattle-monitoring-system/prometheus-federator-system-namespaces' });\n\n    this.systemNamespaces = JSON.parse(federatorSystemNamespacesConfigMap?.data?.['system-namespaces.json']);\n\n    this.namespaces = this.$store.getters[`${ inStore }/all`](NAMESPACE)\n      .filter(this.namespaceFilter)\n      .map(this.namespaceMapper);\n\n    this.loading = false;\n  },\n\n  data() {\n    if (!this.value.spec.values) {\n      this.$set(this.value.spec, 'values', {});\n    }\n\n    return {\n      systemNamespaces:           null,\n      namespaces:                 [],\n      loading:                    true,\n      inStore:                    this.$store.getters['currentStore'](),\n      selectedNamespaceQuestions: null,\n    };\n  },\n\n  watch: {\n    /**\n     * Given the current namespace, fetch a specific secret from within which will contain a questions.yaml\n     */\n    async currentNamespace(neu, old) {\n      if (!neu) {\n        return;\n      }\n\n      const configMapRelationship = neu.metadata?.relationships.find((relationship) => relationship?.toType === CONFIG_MAP);\n\n      if (!configMapRelationship?.toId) {\n        return;\n      }\n\n      const res = await this.$store.dispatch(`${ this.inStore }/find`, { type: CONFIG_MAP, id: configMapRelationship.toId });\n      const questionsYaml = res?.data?.['questions.yaml'];\n\n      if (!questionsYaml) {\n        return;\n      }\n      this.selectedNamespaceQuestions = jsyaml.load(questionsYaml)?.questions;\n    }\n  },\n\n  computed: {\n    currentNamespace() {\n      return this.namespaces.find((namespace) => namespace.id === this.value?.metadata?.namespace);\n    }\n  },\n\n  methods: {\n    getNamespaceConfigMapId(namespace) {\n      return this.currentNamespace?.metadata?.relationships.find((relationship) => relationship?.toType === 'configmap')?.toId;\n    },\n    namespaceFilter(namespace) {\n      const excludeProjects = [...this.systemNamespaces?.systemProjectLabelValues || [], this.systemNamespaces?.projectReleaseLabelValue];\n\n      return namespace?.project && namespace?.metadata?.labels?.['helm.cattle.io/helm-project-operated'] && !excludeProjects.includes(namespace.projectId);\n    },\n    namespaceMapper(namespace) {\n      return {\n        ...namespace,\n        configMapId: this.getNamespaceConfigMapId(namespace),\n        label:       namespace?.project?.spec?.displayName,\n        value:       namespace?.id,\n      };\n    }\n  }\n};\n</script>\n\n<template>\n  <CruResource\n    v-if=\"!loading\"\n    :done-route=\"doneRoute\"\n    :resource=\"value\"\n    :mode=\"mode\"\n    :errors=\"errors\"\n    :apply-hooks=\"applyHooks\"\n    @finish=\"save\"\n  >\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.metadata.namespace\"\n          :label=\"t('namespace.project.label')\"\n          :options=\"namespaces\"\n          required\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.metadata.description\"\n          :label=\"t('nameNsDescription.description.label')\"\n        />\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col span-12\">\n        <Tabbed\n          v-if=\"!!currentNamespace && selectedNamespaceQuestions\"\n          ref=\"tabs\"\n          :side-tabs=\"true\"\n        >\n          <Questions\n            v-model=\"value.spec.values\"\n            tabbed=\"multiple\"\n            :target-namespace=\"value.metadata.namespace\"\n            :source=\"selectedNamespaceQuestions\"\n          />\n        </Tabbed>\n      </div>\n    </div>\n  </CruResource>\n  <Loading v-else />\n</template>\n\n<style lang=\"scss\" scoped>\n.row {\n  margin-bottom: 20px;\n}\n</style>\n"]}]}