{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/SetupUIPlugins.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/SetupUIPlugins.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IEFzeW5jQnV0dG9uLCB7IEFTWU5DX0JVVFRPTl9TVEFURVMgfSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Bc3luY0J1dHRvbic7CmltcG9ydCBJY29uTWVzc2FnZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9JY29uTWVzc2FnZS52dWUnOwppbXBvcnQgeyBDQVRBTE9HLCBNQU5BR0VNRU5UIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IENBVEFMT0cgYXMgQ0FUQUxPR19BTk5PVEFUSU9OUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKaW1wb3J0IERpYWxvZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9EaWFsb2cudnVlJzsKaW1wb3J0IENoZWNrYm94IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vQ2hlY2tib3gvQ2hlY2tib3gudnVlJzsKaW1wb3J0IEJhbm5lciBmcm9tICdAY29tcG9uZW50cy9CYW5uZXIvQmFubmVyLnZ1ZSc7CmltcG9ydCB7IGlzUmFuY2hlclByaW1lIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy92ZXJzaW9uJzsKCmltcG9ydCB7CiAgVUlfUExVR0lOX05BTUVTUEFDRSwKICBVSV9QTFVHSU5fQ0hBUlRTLAogIFVJX1BMVUdJTl9PUEVSQVRPUl9SRVBPX05BTUUsCiAgVUlfUExVR0lOU19SRVBPX05BTUUsCiAgVUlfUExVR0lOU19SRVBPX1VSTCwKICBVSV9QTFVHSU5TX1JFUE9fQlJBTkNILAogIFVJX1BMVUdJTlNfUEFSVE5FUlNfUkVQT19OQU1FLAogIFVJX1BMVUdJTlNfUEFSVE5FUlNfUkVQT19VUkwsCiAgVUlfUExVR0lOU19QQVJUTkVSU19SRVBPX0JSQU5DSCwKfSBmcm9tICdAc2hlbGwvY29uZmlnL3VpcGx1Z2lucyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQXN5bmNCdXR0b24sCiAgICBDaGVja2JveCwKICAgIEJhbm5lciwKICAgIEljb25NZXNzYWdlLAogICAgRGlhbG9nLAogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgLy8gQ2hlY2sgdG8gc2VlIHRoYXQgdGhlIGNoYXJ0cyB3ZSBuZWVkIGFyZSBhdmFpbGFibGUKICAgIGNvbnN0IGMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjYXRhbG9nL3Jhd0NoYXJ0cyddOwogICAgY29uc3QgY2hhcnRzID0gT2JqZWN0LnZhbHVlcyhjKTsKICAgIGNvbnN0IGZvdW5kID0gW107CgogICAgVUlfUExVR0lOX0NIQVJUUy5mb3JFYWNoKChjKSA9PiB7CiAgICAgIGNvbnN0IGYgPSBjaGFydHMuZmluZCgoY2hhcnQpID0+IGNoYXJ0LnJlcG9OYW1lID09PSBVSV9QTFVHSU5fT1BFUkFUT1JfUkVQT19OQU1FICYgY2hhcnQuY2hhcnROYW1lID09PSBjKTsKCiAgICAgIGlmIChmKSB7CiAgICAgICAgZm91bmQucHVzaChmKTsKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5oYXZlQ2hhcnRzID0gKGZvdW5kLmxlbmd0aCA9PT0gVUlfUExVR0lOX0NIQVJUUy5sZW5ndGgpOwoKICAgIGlmICh0aGlzLmhhdmVDaGFydHMpIHsKICAgICAgdGhpcy5pbnN0YWxsQ2hhcnRzID0gZm91bmQ7CgogICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9zY2hlbWFGb3InXShDQVRBTE9HLkNMVVNURVJfUkVQTykpIHsKICAgICAgICAvLyB3ZSBuZWVkIHRvIGZvcmNlIHRoZSByZXF1ZXN0LCBzbyB0aGF0IHdlIGtub3cgYXQgYWxsIHRpbWVzIGlmIHdoYXQncyB0aGUgc3RhdHVzIG9mIHRoZSBvZmZpY2FsIGFuZCBwYXJ0bmVycyByZXBvcyAoaW5zdGFsbGVkIG9yIG5vdCkKICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBDQVRBTE9HLkNMVVNURVJfUkVQTywgb3B0OiB7IGZvcmNlOiB0cnVlIH0gfSk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmRlZmF1bHRSZWdpc3RyeVNldHRpbmcgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kJywgewogICAgICB0eXBlOiBNQU5BR0VNRU5ULlNFVFRJTkcsCiAgICAgIGlkOiAgICdzeXN0ZW0tZGVmYXVsdC1yZWdpc3RyeScKICAgIH0pOwoKICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiAgICAgICB0cnVlLAogICAgICBoYXZlQ2hhcnRzOiAgICBmYWxzZSwKICAgICAgaW5zdGFsbENoYXJ0czogW10sCiAgICAgIGVycm9yczogICAgICAgIFtdLAogICAgICBwcmltZTogICAgICAgICBpc1JhbmNoZXJQcmltZSgpLAogICAgICBhZGRSZXBvczogICAgICB7CiAgICAgICAgb2ZmaWNpYWw6IHRydWUsCiAgICAgICAgcGFydG5lcnM6IHRydWUsCiAgICAgIH0sCiAgICAgIHJlcG9zSW5mbzogewogICAgICAgIG9mZmljaWFsOiB7CiAgICAgICAgICBuYW1lOiAgIFVJX1BMVUdJTlNfUkVQT19OQU1FLAogICAgICAgICAgdXJsOiAgICBVSV9QTFVHSU5TX1JFUE9fVVJMLAogICAgICAgICAgYnJhbmNoOiBVSV9QTFVHSU5TX1JFUE9fQlJBTkNILAogICAgICAgIH0sCiAgICAgICAgcGFydG5lcnM6IHsKICAgICAgICAgIG5hbWU6ICAgVUlfUExVR0lOU19QQVJUTkVSU19SRVBPX05BTUUsCiAgICAgICAgICB1cmw6ICAgIFVJX1BMVUdJTlNfUEFSVE5FUlNfUkVQT19VUkwsCiAgICAgICAgICBicmFuY2g6IFVJX1BMVUdJTlNfUEFSVE5FUlNfUkVQT19CUkFOQ0gsCiAgICAgICAgfQogICAgICB9LAogICAgICBidXR0b25TdGF0ZTogICAgICAgICAgICBBU1lOQ19CVVRUT05fU1RBVEVTLkFDVElPTiwKICAgICAgZGVmYXVsdFJlZ2lzdHJ5U2V0dGluZzogbnVsbCwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoeyByZXBvczogJ2NhdGFsb2cvcmVwb3MnIH0pLAogICAgaGFzUmFuY2hlclVJUGx1Z2luc1JlcG8oKSB7CiAgICAgIHJldHVybiAhIXRoaXMucmVwb3MuZmluZCgocikgPT4gci51cmxEaXNwbGF5ID09PSBVSV9QTFVHSU5TX1JFUE9fVVJMKTsKICAgIH0sCiAgICBoYXNSYW5jaGVyVUlQYXJ0bmVyc1BsdWdpbnNSZXBvKCkgewogICAgICByZXR1cm4gISF0aGlzLnJlcG9zLmZpbmQoKHIpID0+IHIudXJsRGlzcGxheSA9PT0gVUlfUExVR0lOU19QQVJUTkVSU19SRVBPX1VSTCk7CiAgICB9LAogICAgaXNBbnlSZXBvQXZhaWxhYmxlRm9ySW5zdGFsbCgpIHsKICAgICAgcmV0dXJuIChpc1JhbmNoZXJQcmltZSgpICYmICF0aGlzLmhhc1JhbmNoZXJVSVBsdWdpbnNSZXBvKSB8fCAhdGhpcy5oYXNSYW5jaGVyVUlQYXJ0bmVyc1BsdWdpbnNSZXBvOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGluc3RhbGxDaGFydChpbnN0YWxsQ2hhcnQpIHsKICAgICAgY29uc3QgdmVyc2lvbiA9IGluc3RhbGxDaGFydC52ZXJzaW9uc1swXTsKICAgICAgY29uc3QgcmVwb1R5cGUgPSB2ZXJzaW9uLnJlcG9UeXBlOwogICAgICBjb25zdCByZXBvTmFtZSA9IHZlcnNpb24ucmVwb05hbWU7CiAgICAgIGNvbnN0IHJlcG8gPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjYXRhbG9nL3JlcG8nXSh7IHJlcG9UeXBlLCByZXBvTmFtZSB9KTsKCiAgICAgIGNvbnN0IGNoYXJ0ID0gewogICAgICAgIGNoYXJ0TmFtZTogICBpbnN0YWxsQ2hhcnQuY2hhcnROYW1lLAogICAgICAgIHZlcnNpb246ICAgICB2ZXJzaW9uLnZlcnNpb24sCiAgICAgICAgcmVsZWFzZU5hbWU6IGluc3RhbGxDaGFydC5jaGFydE5hbWUsCiAgICAgICAgYW5ub3RhdGlvbnM6IHsKICAgICAgICAgIFtDQVRBTE9HX0FOTk9UQVRJT05TLlNPVVJDRV9SRVBPX1RZUEVdOiByZXBvVHlwZSwKICAgICAgICAgIFtDQVRBTE9HX0FOTk9UQVRJT05TLlNPVVJDRV9SRVBPX05BTUVdOiByZXBvTmFtZQogICAgICAgIH0sCiAgICAgICAgdmFsdWVzOiB7fQogICAgICB9OwoKICAgICAgLy8gUGFzcyBpbiB0aGUgc3lzdGVtIGRlZmF1bHQgcmVnaXN0cnkgcHJvcGVydHkgaWYgc2V0CiAgICAgIGNvbnN0IGRlZmF1bHRSZWdpc3RyeSA9IHRoaXMuZGVmYXVsdFJlZ2lzdHJ5U2V0dGluZz8udmFsdWUgfHwgJyc7CgogICAgICBpZiAoZGVmYXVsdFJlZ2lzdHJ5KSB7CiAgICAgICAgY2hhcnQudmFsdWVzLmdsb2JhbCA9IGNoYXJ0LnZhbHVlcy5nbG9iYWwgfHwge307CiAgICAgICAgY2hhcnQudmFsdWVzLmdsb2JhbC5jYXR0bGUgPSBjaGFydC52YWx1ZXMuZ2xvYmFsLmNhdHRsZSB8fCB7fTsKICAgICAgICBjaGFydC52YWx1ZXMuZ2xvYmFsLmNhdHRsZS5zeXN0ZW1EZWZhdWx0UmVnaXN0cnkgPSBkZWZhdWx0UmVnaXN0cnk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlucHV0ID0gewogICAgICAgIGNoYXJ0czogICAgW2NoYXJ0XSwKICAgICAgICB3YWl0OiAgICAgIHRydWUsCiAgICAgICAgbmFtZXNwYWNlOiBVSV9QTFVHSU5fTkFNRVNQQUNFLAogICAgICB9OwoKICAgICAgY29uc3QgYWN0aW9uID0gJ2luc3RhbGwnOwogICAgICBjb25zdCByZXMgPSBhd2FpdCByZXBvLmRvQWN0aW9uKGFjdGlvbiwgaW5wdXQpOwogICAgICBjb25zdCBvcGVyYXRpb25JZCA9IGAkeyByZXMub3BlcmF0aW9uTmFtZXNwYWNlIH0vJHsgcmVzLm9wZXJhdGlvbk5hbWUgfWA7CgogICAgICBhd2FpdCByZXBvLndhaXRGb3JPcGVyYXRpb24ob3BlcmF0aW9uSWQpOwoKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmRpc3BhdGNoKGBtYW5hZ2VtZW50L2ZpbmRgLCB7CiAgICAgICAgdHlwZTogQ0FUQUxPRy5PUEVSQVRJT04sCiAgICAgICAgaWQ6ICAgb3BlcmF0aW9uSWQKICAgICAgfSk7CiAgICB9LAoKICAgIGFzeW5jIGVuYWJsZSgpIHsKICAgICAgdGhpcy5lcnJvcnMgPSBbXTsKCiAgICAgIC8vIGZvcmNlIHVwZGF0ZSBvZiBjbHVzdGVyIHJlcG9zIHNvIHRoYXQgbW9kYWwgaGF2ZSB0aGUgY29ycmVjdCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgb2ZmaWNpYWwgYW5kIHBhcnRuZXJzIHJlcG8KICAgICAgdGhpcy4kZW1pdCgncmVmcmVzaENoYXJ0cycpOwoKICAgICAgLy8gUmVzZXQgY2hlY2tib3ggYmFzZWQgb24gaWYgdGhlIHJlcG8gaXMgYWxyZWFkeSBpbnN0YWxsZWQKICAgICAgdGhpcy5hZGRSZXBvcyA9IHsKICAgICAgICBvZmZpY2lhbDogaXNSYW5jaGVyUHJpbWUoKSAmJiAhdGhpcy5oYXNSYW5jaGVyVUlQbHVnaW5zUmVwbywKICAgICAgICBwYXJ0bmVyczogIXRoaXMuaGFzUmFuY2hlclVJUGFydG5lcnNQbHVnaW5zUmVwbywKICAgICAgfTsKCiAgICAgIHRoaXMuJG1vZGFsLnNob3coJ2NvbmZpcm0tdWlwbHVnaW5zLXNldHVwJyk7CiAgICB9LAoKICAgIGFzeW5jIGRpYWxvZ0Nsb3NlZChvaykgewogICAgICB0aGlzLmVycm9ycyA9IFtdOwoKICAgICAgLy8gVXNlciB3YW50cyB0byBwcm9jZWVkCiAgICAgIGlmIChvaykgewogICAgICAgIHRoaXMuYnV0dG9uU3RhdGUgPSBBU1lOQ19CVVRUT05fU1RBVEVTLldBSVRJTkc7CgogICAgICAgIGlmIChPYmplY3QudmFsdWVzKHRoaXMuYWRkUmVwb3MpLmZpbmQoKHYpID0+IHYpKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLmFkZERlZmF1bHRIZWxtUmVwb3NpdG9yaWVzKCk7CiAgICAgICAgfQoKICAgICAgICBhd2FpdCB0aGlzLmluc3RhbGxQbHVnaW5DaGFydHMoKTsKCiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwMCkpOwoKICAgICAgICB0aGlzLmJ1dHRvblN0YXRlID0gdGhpcy5lcnJvcnMubGVuZ3RoID4gMCA/IEFTWU5DX0JVVFRPTl9TVEFURVMuRVJST1IgOiBBU1lOQ19CVVRUT05fU1RBVEVTLkFDVElPTjsKCiAgICAgICAgdGhpcy4kZW1pdCgnZG9uZScpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGFkZERlZmF1bHRIZWxtUmVwb3NpdG9yaWVzKCkgewogICAgICBjb25zdCBwcm9taXNlcyA9IFtdOwoKICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5hZGRSZXBvcykgewogICAgICAgIGlmICh0aGlzLmFkZFJlcG9zW2tleV0pIHsKICAgICAgICAgIGNvbnN0IHBsdWdpbkNSID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvY3JlYXRlJywgewogICAgICAgICAgICB0eXBlOiAgICAgQ0FUQUxPRy5DTFVTVEVSX1JFUE8sCiAgICAgICAgICAgIG1ldGFkYXRhOiB7IG5hbWU6IHRoaXMucmVwb3NJbmZvW2tleV0ubmFtZSB9LAogICAgICAgICAgICBzcGVjOiAgICAgewogICAgICAgICAgICAgIGdpdEJyYW5jaDogdGhpcy5yZXBvc0luZm9ba2V5XS5icmFuY2gsCiAgICAgICAgICAgICAgZ2l0UmVwbzogICB0aGlzLnJlcG9zSW5mb1trZXldLnVybCwKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgICAgcHJvbWlzZXMucHVzaChwbHVnaW5DUi5zYXZlKCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgcmVzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHByb21pc2VzKTsKCiAgICAgIHJlcy5mb3JFYWNoKChyZXN1bHQpID0+IHsKICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ3JlamVjdGVkJykgewogICAgICAgICAgY29uc29sZS5lcnJvcihyZXN1bHQucmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgogICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChyZXN1bHQucmVhc29uKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBpbnN0YWxsUGx1Z2luQ2hhcnRzKCkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaW5zdGFsbENoYXJ0cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGNoYXJ0ID0gdGhpcy5pbnN0YWxsQ2hhcnRzW2ldOwoKICAgICAgICB0cnkgewogICAgICAgICAgYXdhaXQgdGhpcy5pbnN0YWxsQ2hhcnQoY2hhcnQpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goZS5tZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKSk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["SetupUIPlugins.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"SetupUIPlugins.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/uiplugins","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport AsyncButton, { ASYNC_BUTTON_STATES } from '@shell/components/AsyncButton';\nimport IconMessage from '@shell/components/IconMessage.vue';\nimport { CATALOG, MANAGEMENT } from '@shell/config/types';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport Dialog from '@shell/components/Dialog.vue';\nimport Checkbox from '@components/Form/Checkbox/Checkbox.vue';\nimport Banner from '@components/Banner/Banner.vue';\nimport { isRancherPrime } from '@shell/config/version';\n\nimport {\n  UI_PLUGIN_NAMESPACE,\n  UI_PLUGIN_CHARTS,\n  UI_PLUGIN_OPERATOR_REPO_NAME,\n  UI_PLUGINS_REPO_NAME,\n  UI_PLUGINS_REPO_URL,\n  UI_PLUGINS_REPO_BRANCH,\n  UI_PLUGINS_PARTNERS_REPO_NAME,\n  UI_PLUGINS_PARTNERS_REPO_URL,\n  UI_PLUGINS_PARTNERS_REPO_BRANCH,\n} from '@shell/config/uiplugins';\n\nexport default {\n  components: {\n    AsyncButton,\n    Checkbox,\n    Banner,\n    IconMessage,\n    Dialog,\n  },\n\n  async fetch() {\n    // Check to see that the charts we need are available\n    const c = this.$store.getters['catalog/rawCharts'];\n    const charts = Object.values(c);\n    const found = [];\n\n    UI_PLUGIN_CHARTS.forEach((c) => {\n      const f = charts.find((chart) => chart.repoName === UI_PLUGIN_OPERATOR_REPO_NAME & chart.chartName === c);\n\n      if (f) {\n        found.push(f);\n      }\n    });\n\n    this.haveCharts = (found.length === UI_PLUGIN_CHARTS.length);\n\n    if (this.haveCharts) {\n      this.installCharts = found;\n\n      if (this.$store.getters['management/schemaFor'](CATALOG.CLUSTER_REPO)) {\n        // we need to force the request, so that we know at all times if what's the status of the offical and partners repos (installed or not)\n        await this.$store.dispatch('management/findAll', { type: CATALOG.CLUSTER_REPO, opt: { force: true } });\n      }\n    }\n\n    this.defaultRegistrySetting = await this.$store.dispatch('management/find', {\n      type: MANAGEMENT.SETTING,\n      id:   'system-default-registry'\n    });\n\n    this.loading = false;\n  },\n\n  data() {\n    return {\n      loading:       true,\n      haveCharts:    false,\n      installCharts: [],\n      errors:        [],\n      prime:         isRancherPrime(),\n      addRepos:      {\n        official: true,\n        partners: true,\n      },\n      reposInfo: {\n        official: {\n          name:   UI_PLUGINS_REPO_NAME,\n          url:    UI_PLUGINS_REPO_URL,\n          branch: UI_PLUGINS_REPO_BRANCH,\n        },\n        partners: {\n          name:   UI_PLUGINS_PARTNERS_REPO_NAME,\n          url:    UI_PLUGINS_PARTNERS_REPO_URL,\n          branch: UI_PLUGINS_PARTNERS_REPO_BRANCH,\n        }\n      },\n      buttonState:            ASYNC_BUTTON_STATES.ACTION,\n      defaultRegistrySetting: null,\n    };\n  },\n\n  computed: {\n    ...mapGetters({ repos: 'catalog/repos' }),\n    hasRancherUIPluginsRepo() {\n      return !!this.repos.find((r) => r.urlDisplay === UI_PLUGINS_REPO_URL);\n    },\n    hasRancherUIPartnersPluginsRepo() {\n      return !!this.repos.find((r) => r.urlDisplay === UI_PLUGINS_PARTNERS_REPO_URL);\n    },\n    isAnyRepoAvailableForInstall() {\n      return (isRancherPrime() && !this.hasRancherUIPluginsRepo) || !this.hasRancherUIPartnersPluginsRepo;\n    }\n  },\n\n  methods: {\n    async installChart(installChart) {\n      const version = installChart.versions[0];\n      const repoType = version.repoType;\n      const repoName = version.repoName;\n      const repo = this.$store.getters['catalog/repo']({ repoType, repoName });\n\n      const chart = {\n        chartName:   installChart.chartName,\n        version:     version.version,\n        releaseName: installChart.chartName,\n        annotations: {\n          [CATALOG_ANNOTATIONS.SOURCE_REPO_TYPE]: repoType,\n          [CATALOG_ANNOTATIONS.SOURCE_REPO_NAME]: repoName\n        },\n        values: {}\n      };\n\n      // Pass in the system default registry property if set\n      const defaultRegistry = this.defaultRegistrySetting?.value || '';\n\n      if (defaultRegistry) {\n        chart.values.global = chart.values.global || {};\n        chart.values.global.cattle = chart.values.global.cattle || {};\n        chart.values.global.cattle.systemDefaultRegistry = defaultRegistry;\n      }\n\n      const input = {\n        charts:    [chart],\n        wait:      true,\n        namespace: UI_PLUGIN_NAMESPACE,\n      };\n\n      const action = 'install';\n      const res = await repo.doAction(action, input);\n      const operationId = `${ res.operationNamespace }/${ res.operationName }`;\n\n      await repo.waitForOperation(operationId);\n\n      return this.$store.dispatch(`management/find`, {\n        type: CATALOG.OPERATION,\n        id:   operationId\n      });\n    },\n\n    async enable() {\n      this.errors = [];\n\n      // force update of cluster repos so that modal have the correct information about the official and partners repo\n      this.$emit('refreshCharts');\n\n      // Reset checkbox based on if the repo is already installed\n      this.addRepos = {\n        official: isRancherPrime() && !this.hasRancherUIPluginsRepo,\n        partners: !this.hasRancherUIPartnersPluginsRepo,\n      };\n\n      this.$modal.show('confirm-uiplugins-setup');\n    },\n\n    async dialogClosed(ok) {\n      this.errors = [];\n\n      // User wants to proceed\n      if (ok) {\n        this.buttonState = ASYNC_BUTTON_STATES.WAITING;\n\n        if (Object.values(this.addRepos).find((v) => v)) {\n          await this.addDefaultHelmRepositories();\n        }\n\n        await this.installPluginCharts();\n\n        await new Promise((resolve) => setTimeout(resolve, 5000));\n\n        this.buttonState = this.errors.length > 0 ? ASYNC_BUTTON_STATES.ERROR : ASYNC_BUTTON_STATES.ACTION;\n\n        this.$emit('done');\n      }\n    },\n\n    async addDefaultHelmRepositories() {\n      const promises = [];\n\n      for (const key in this.addRepos) {\n        if (this.addRepos[key]) {\n          const pluginCR = await this.$store.dispatch('management/create', {\n            type:     CATALOG.CLUSTER_REPO,\n            metadata: { name: this.reposInfo[key].name },\n            spec:     {\n              gitBranch: this.reposInfo[key].branch,\n              gitRepo:   this.reposInfo[key].url,\n            }\n          });\n\n          promises.push(pluginCR.save());\n        }\n      }\n\n      const res = await Promise.allSettled(promises);\n\n      res.forEach((result) => {\n        if (result.status === 'rejected') {\n          console.error(result.reason); // eslint-disable-line no-console\n\n          this.errors.push(result.reason);\n        }\n      });\n    },\n\n    async installPluginCharts() {\n      for (let i = 0; i < this.installCharts.length; i++) {\n        const chart = this.installCharts[i];\n\n        try {\n          await this.installChart(chart);\n        } catch (e) {\n          this.errors.push(e.message);\n        }\n      }\n\n      return new Promise((resolve) => setTimeout(resolve, 2000));\n    }\n  }\n};\n</script>\n<template>\n  <div>\n    <IconMessage\n      :vertical=\"true\"\n      :subtle=\"false\"\n      icon=\"icon-gear\"\n    >\n      <template v-slot:message>\n        <h2>\n          {{ t('plugins.setup.title') }}\n        </h2>\n        <div v-if=\"!loading\">\n          <div v-if=\"!haveCharts\">\n            <p>\n              {{ t('plugins.setup.prompt.cant') }}\n            </p>\n          </div>\n          <div v-else>\n            <p>\n              {{ t('plugins.setup.prompt.can') }}\n            </p>\n            <AsyncButton\n              mode=\"enable\"\n              :manual=\"true\"\n              :current-phase=\"buttonState\"\n              class=\"enable-plugin-support\"\n              data-testid=\"extension-enable-operator\"\n              @click=\"enable\"\n            />\n          </div>\n          <div\n            v-for=\"(e, i) in errors\"\n            :key=\"i\"\n            class=\"plugin-setup-error\"\n          >\n            {{ e }}\n          </div>\n        </div>\n      </template>\n    </IconMessage>\n    <Dialog\n      name=\"confirm-uiplugins-setup\"\n      :title=\"t('plugins.setup.install.title')\"\n      @closed=\"dialogClosed\"\n    >\n      <template>\n        <p class=\"mb-20\">\n          {{ t('plugins.setup.install.prompt') }}\n        </p>\n        <Banner\n          v-if=\"isAnyRepoAvailableForInstall\"\n          color=\"info\"\n          class=\"mb-20\"\n        >\n          {{ t('plugins.setup.install.airgap') }}\n        </Banner>\n        <!-- Official rancher repo -->\n        <div\n          v-if=\"prime\"\n          class=\"mb-15\"\n        >\n          <Checkbox\n            v-model=\"addRepos.official\"\n            :disabled=\"hasRancherUIPluginsRepo\"\n            :primary=\"true\"\n            label-key=\"plugins.setup.install.addRancherRepo\"\n            data-testid=\"extension-enable-operator-official-repo\"\n          />\n          <div\n            v-if=\"hasRancherUIPluginsRepo\"\n            class=\"checkbox-info\"\n          >\n            ({{ t('plugins.setup.installed') }})\n          </div>\n        </div>\n        <!-- Partners rancher repo -->\n        <div\n          class=\"mb-15\"\n        >\n          <Checkbox\n            v-model=\"addRepos.partners\"\n            :disabled=\"hasRancherUIPartnersPluginsRepo\"\n            :primary=\"true\"\n            label-key=\"plugins.setup.install.addPartnersRancherRepo\"\n            data-testid=\"extension-enable-operator-partners-repo\"\n          />\n          <div\n            v-if=\"hasRancherUIPartnersPluginsRepo\"\n            class=\"checkbox-info\"\n          >\n            ({{ t('plugins.setup.installed') }})\n          </div>\n        </div>\n      </template>\n    </Dialog>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n  .enable-plugin-support {\n    font-size: 14px;\n    margin-top: 20px;\n  }\n\n  .plugin-setup-error {\n    font-size: 14px;\n    color: var(--error);\n    margin: 10px 0 0 0;\n  }\n\n  .checkbox-info {\n    margin-left: 20px;\n    opacity: 0.7;\n  }\n</style>\n"]}]}