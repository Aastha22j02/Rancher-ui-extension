{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/detail/fleet.cattle.io.bundle.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/detail/fleet.cattle.io.bundle.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IEZMRUVUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCBGbGVldEJ1bmRsZVJlc291cmNlcyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mbGVldC9GbGVldEJ1bmRsZVJlc291cmNlcy52dWUnOwppbXBvcnQgU29ydGFibGVUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Tb3J0YWJsZVRhYmxlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRmxlZXRCdW5kbGVEZXRhaWwnLAoKICBjb21wb25lbnRzOiB7CiAgICBGbGVldEJ1bmRsZVJlc291cmNlcywKICAgIFNvcnRhYmxlVGFibGUsCiAgfSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7IHJlcG86IG51bGwgfTsKICB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIGNvbnN0IHsgbmFtZXNwYWNlLCBsYWJlbHMgfSA9IHRoaXMudmFsdWUubWV0YWRhdGE7CiAgICBjb25zdCByZXBvTmFtZSA9IGAkeyBuYW1lc3BhY2UgfS8keyBsYWJlbHNbJ2ZsZWV0LmNhdHRsZS5pby9yZXBvLW5hbWUnXSB9YDsKCiAgICBpZiAodGhpcy5oYXNSZXBvTGFiZWwpIHsKICAgICAgdGhpcy5yZXBvID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZCcsIHsgdHlwZTogRkxFRVQuR0lUX1JFUE8sIGlkOiByZXBvTmFtZSB9KTsKICAgIH0KICB9LAoKICBjb21wdXRlZDogewogICAgaGFzUmVwb0xhYmVsKCkgewogICAgICByZXR1cm4gISEodGhpcy52YWx1ZT8ubWV0YWRhdGE/LmxhYmVscyAmJiB0aGlzLnZhbHVlPy5tZXRhZGF0YT8ubGFiZWxzWydmbGVldC5jYXR0bGUuaW8vcmVwby1uYW1lJ10pOwogICAgfSwKICAgIGJ1bmRsZVJlc291cmNlcygpIHsKICAgICAgaWYgKHRoaXMuaGFzUmVwb0xhYmVsKSB7CiAgICAgICAgY29uc3QgYnVuZGxlUmVzb3VyY2VJZHMgPSB0aGlzLmJ1bmRsZVJlc291cmNlSWRzOwoKICAgICAgICByZXR1cm4gdGhpcy5yZXBvPy5zdGF0dXM/LnJlc291cmNlcz8uZmlsdGVyKChyZXNvdXJjZSkgPT4gewogICAgICAgICAgcmV0dXJuIGJ1bmRsZVJlc291cmNlSWRzLmluY2x1ZGVzKHJlc291cmNlLm5hbWUpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMudmFsdWU/LnNwZWM/LnJlc291cmNlcz8ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU/LnNwZWM/LnJlc291cmNlcy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNvbnRlbnQ6IGl0ZW0uY29udGVudCwKICAgICAgICAgICAgbmFtZTogICAgaXRlbS5uYW1lLmluY2x1ZGVzKCcuJykgPyBpdGVtLm5hbWUuc3BsaXQoJy4nKVswXSA6IGl0ZW0ubmFtZQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIFtdOwogICAgfSwKICAgIHJlc291cmNlSGVhZGVycygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgICAgJ25hbWUnLAogICAgICAgICAgdmFsdWU6ICAgICduYW1lJywKICAgICAgICAgIHNvcnQ6ICAgICBbJ25hbWUnXSwKICAgICAgICAgIGxhYmVsS2V5OiAndGFibGVIZWFkZXJzLm5hbWUnLAogICAgICAgIH0sCiAgICAgIF07CiAgICB9LAogICAgcmVzb3VyY2VDb3VudCgpIHsKICAgICAgcmV0dXJuICh0aGlzLmJ1bmRsZVJlc291cmNlcyAmJiB0aGlzLmJ1bmRsZVJlc291cmNlcy5sZW5ndGgpIHx8IHRoaXMudmFsdWU/LnNwZWM/LnJlc291cmNlcz8ubGVuZ3RoOwogICAgfSwKICAgIGJ1bmRsZVJlc291cmNlSWRzKCkgewogICAgICBpZiAodGhpcy52YWx1ZS5zdGF0dXM/LnJlc291cmNlS2V5KSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU/LnN0YXR1cz8ucmVzb3VyY2VLZXkubWFwKChpdGVtKSA9PiBpdGVtLm5hbWUpOwogICAgICB9CgogICAgICByZXR1cm4gW107CiAgICB9CiAgfQp9OwoK"},{"version":3,"sources":["fleet.cattle.io.bundle.vue"],"names":[],"mappings":";AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"fleet.cattle.io.bundle.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport { FLEET } from '@shell/config/types';\nimport FleetBundleResources from '@shell/components/fleet/FleetBundleResources.vue';\nimport SortableTable from '@shell/components/SortableTable';\n\nexport default {\n  name: 'FleetBundleDetail',\n\n  components: {\n    FleetBundleResources,\n    SortableTable,\n  },\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    }\n  },\n\n  data() {\n    return { repo: null };\n  },\n\n  async fetch() {\n    const { namespace, labels } = this.value.metadata;\n    const repoName = `${ namespace }/${ labels['fleet.cattle.io/repo-name'] }`;\n\n    if (this.hasRepoLabel) {\n      this.repo = await this.$store.dispatch('management/find', { type: FLEET.GIT_REPO, id: repoName });\n    }\n  },\n\n  computed: {\n    hasRepoLabel() {\n      return !!(this.value?.metadata?.labels && this.value?.metadata?.labels['fleet.cattle.io/repo-name']);\n    },\n    bundleResources() {\n      if (this.hasRepoLabel) {\n        const bundleResourceIds = this.bundleResourceIds;\n\n        return this.repo?.status?.resources?.filter((resource) => {\n          return bundleResourceIds.includes(resource.name);\n        });\n      } else if (this.value?.spec?.resources?.length) {\n        return this.value?.spec?.resources.map((item) => {\n          return {\n            content: item.content,\n            name:    item.name.includes('.') ? item.name.split('.')[0] : item.name\n          };\n        });\n      }\n\n      return [];\n    },\n    resourceHeaders() {\n      return [\n        {\n          name:     'name',\n          value:    'name',\n          sort:     ['name'],\n          labelKey: 'tableHeaders.name',\n        },\n      ];\n    },\n    resourceCount() {\n      return (this.bundleResources && this.bundleResources.length) || this.value?.spec?.resources?.length;\n    },\n    bundleResourceIds() {\n      if (this.value.status?.resourceKey) {\n        return this.value?.status?.resourceKey.map((item) => item.name);\n      }\n\n      return [];\n    }\n  }\n};\n\n</script>\n\n<template>\n  <div>\n    <div class=\"bundle-title mt-20 mb-20\">\n      <h2>{{ t('fleet.bundles.resources') }}</h2>\n      <span>{{ resourceCount }}</span>\n    </div>\n    <FleetBundleResources\n      v-if=\"hasRepoLabel\"\n      :value=\"bundleResources\"\n    />\n    <SortableTable\n      v-else\n      :rows=\"bundleResources\"\n      :headers=\"resourceHeaders\"\n      :table-actions=\"false\"\n      :row-actions=\"false\"\n      key-field=\"tableKey\"\n      default-sort-by=\"state\"\n      :paged=\"true\"\n    />\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.bundle-title {\n  display: flex;\n  align-items: center;\n\n  h2 {\n    margin: 0 10px 0 0;\n  }\n\n  span {\n    background-color: var(--darker);\n    color: var(--default);\n    padding: 5px 10px;\n    border-radius: 15px;\n  }\n}\n</style>\n"]}]}