{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/edit/management.cattle.io.setting.vue?vue&type=style&index=0&id=0ad06cfa&lang=scss&scoped=true","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/edit/management.cattle.io.setting.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1725271300564},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1725271300920},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/postcss-loader/src/index.js","mtime":1725271300857},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/sass-loader/dist/cjs.js","mtime":1725271288422},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5lZGl0LWNoYW5nZSB7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBkaXNwbGF5OiBmbGV4OwoKICA+IGg1IHsKICAgIGZsZXg6IDE7CiAgfQp9Cgo6OnYtZGVlcCAuZWRpdC1oZWxwIGNvZGUgewogIHBhZGRpbmc6IDFweCA1cHg7Cn0K"},{"version":3,"sources":["management.cattle.io.setting.vue"],"names":[],"mappings":";AAmPA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"management.cattle.io.setting.vue","sourceRoot":"node_modules/@rancher/shell/edit","sourcesContent":["<script>\nimport CruResource from '@shell/components/CruResource';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { Banner } from '@components/Banner';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { TextAreaAutoGrow } from '@components/Form/TextArea';\nimport formRulesGenerator from '@shell/utils/validators/formRules/index';\n\nimport { ALLOWED_SETTINGS, SETTING } from '@shell/config/settings';\nimport { RadioGroup } from '@components/Form/Radio';\nimport FormValidation from '@shell/mixins/form-validation';\nimport { setBrand } from '@shell/config/private-label';\nimport { keyBy, mapValues } from 'lodash';\nimport { isLocalhost, isServerUrl } from '@shell/utils/validators/setting';\n\nexport default {\n  components: {\n    CruResource,\n    LabeledInput,\n    LabeledSelect,\n    RadioGroup,\n    TextAreaAutoGrow,\n    Banner\n  },\n\n  mixins: [CreateEditView, FormValidation],\n\n  data() {\n    const t = this.$store.getters['i18n/t'];\n\n    return {\n      setting:        ALLOWED_SETTINGS[this.value.id],\n      description:    t(`advancedSettings.descriptions.${ this.value.id }`),\n      editHelp:       t(`advancedSettings.editHelp.${ this.value.id }`),\n      enumOptions:    [],\n      canReset:       false,\n      errors:         [],\n      fvFormRuleSets: [],\n    };\n  },\n\n  created() {\n    this.value.value = this.value.value || this.value.default;\n    this.enumOptions = this.setting?.kind === 'enum' ? this.setting.options.map((id) => ({\n      label: `advancedSettings.enum.${ this.value.id }.${ id }`,\n      value: id,\n    })) : [];\n    this.canReset = this.setting?.canReset || !!this.value.default;\n    this.fvFormRuleSets = this.setting?.ruleSet ? [{\n      path:  'value',\n      rules: this.setting.ruleSet.map(({ name }) => name)\n    }] : [];\n  },\n\n  computed: {\n    fvExtraRules() {\n      const t = this.$store.getters['i18n/t'];\n\n      // We map the setting rulesets to use values to define validation from factory\n      return this.setting?.ruleSet ? mapValues(\n        keyBy(this.setting.ruleSet, 'name'),\n        // The validation is curried and may require the factory argument for the ValidatorFactory\n        ({ key, name, factoryArg }) => {\n          const rule = formRulesGenerator(t, key ? { key } : {})[name];\n\n          return factoryArg ? rule(factoryArg) : rule;\n        }) : {};\n    },\n\n    showLocalhostWarning() {\n      return isServerUrl(this.value.id) && isLocalhost(this.value.value);\n    },\n\n    validationPassed() {\n      return this.fvFormIsValid && this.fvGetPathErrors(['value']).length === 0;\n    }\n  },\n\n  methods: {\n    convertToString(event) {\n      this.value.value = `${ event.target.value }`;\n    },\n\n    saveSettings(done) {\n      const t = this.$store.getters['i18n/t'];\n\n      // Validate the JSON if the setting is a json value\n      if (this.setting.kind === 'json') {\n        try {\n          JSON.parse(this.value.value);\n          this.errors = [];\n        } catch (e) {\n          this.errors = [t('advancedSettings.edit.invalidJSON')];\n\n          return done(false);\n        }\n      }\n\n      if (this.value?.id === SETTING.BRAND) {\n        setBrand(this.value.value);\n      }\n\n      this.save(done);\n    },\n\n    useDefault(ev) {\n      // Lose the focus on the button after click\n      if (ev && ev.srcElement) {\n        ev.srcElement.blur();\n      }\n\n      if (isServerUrl(this.value.id) && !this.value.default) {\n        return;\n      }\n\n      this.value.value = this.value.default;\n    }\n  }\n};\n</script>\n\n<template>\n  <CruResource\n    class=\"route\"\n    :done-route=\"'c-cluster-product-resource'\"\n    :errors=\"fvUnreportedValidationErrors\"\n    :mode=\"mode\"\n    :resource=\"value\"\n    :subtypes=\"[]\"\n    :can-yaml=\"false\"\n    :validation-passed=\"validationPassed\"\n    @error=\"e=>errors = e\"\n    @finish=\"saveSettings\"\n    @cancel=\"done\"\n  >\n    <h4>{{ description }}</h4>\n\n    <h5\n      v-if=\"editHelp\"\n      v-clean-html=\"editHelp\"\n      class=\"edit-help\"\n    />\n\n    <div class=\"edit-change mt-20\">\n      <h5 v-t=\"'advancedSettings.edit.changeSetting'\" />\n      <button\n        data-testid=\"advanced_settings_use_default\"\n        :disabled=\"!canReset\"\n        type=\"button\"\n        class=\"btn role-primary\"\n        @click=\"useDefault\"\n      >\n        {{ t('advancedSettings.edit.useDefault') }}\n      </button>\n    </div>\n\n    <Banner\n      v-if=\"showLocalhostWarning\"\n      color=\"warning\"\n      :label=\"t('validation.setting.serverUrl.localhost')\"\n    />\n\n    <Banner\n      v-for=\"(err, i) in fvGetPathErrors(['value'])\"\n      :key=\"i\"\n      color=\"error\"\n      :label=\"err\"\n    />\n\n    <div class=\"mt-20\">\n      <div v-if=\"setting.kind === 'enum'\">\n        <LabeledSelect\n          v-model=\"value.value\"\n          data-testid=\"input-setting-enum\"\n          :label=\"t('advancedSettings.edit.value')\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :localized-label=\"true\"\n          :mode=\"mode\"\n          :required=\"true\"\n          :options=\"enumOptions\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'boolean'\">\n        <RadioGroup\n          v-model=\"value.value\"\n          data-testid=\"input-setting-boolean\"\n          name=\"settings_value\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :labels=\"[t('advancedSettings.edit.trueOption'), t('advancedSettings.edit.falseOption')]\"\n          :options=\"['true', 'false']\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'multiline' || setting.kind === 'json'\">\n        <TextAreaAutoGrow\n          v-model=\"value.value\"\n          data-testid=\"input-setting-json\"\n          :required=\"true\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :min-height=\"254\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'integer'\">\n        <LabeledInput\n          v-model=\"value.value\"\n          data-testid=\"input-setting-integer\"\n          :label=\"t('advancedSettings.edit.value')\"\n          :mode=\"mode\"\n          type=\"number\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :required=\"true\"\n        />\n      </div>\n      <div v-else>\n        <LabeledInput\n          v-model=\"value.value\"\n          data-testid=\"input-setting-generic\"\n          :localized-label=\"true\"\n          :required=\"true\"\n          :mode=\"mode\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :label=\"t('advancedSettings.edit.value')\"\n        />\n      </div>\n    </div>\n  </CruResource>\n</template>\n\n<style lang=\"scss\" scoped>\n  .edit-change {\n    align-items: center;\n    display: flex;\n\n    > h5 {\n      flex: 1;\n    }\n  }\n\n  ::v-deep .edit-help code {\n    padding: 1px 5px;\n  }\n</style>\n"]}]}