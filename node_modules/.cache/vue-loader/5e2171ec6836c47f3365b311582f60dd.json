{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/list/management.cattle.io.user.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/list/management.cattle.io.user.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBBc3luY0J1dHRvbiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Bc3luY0J1dHRvbic7CmltcG9ydCB7IE5PUk1BTiB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBOQU1FIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9wcm9kdWN0L2F1dGgnOwppbXBvcnQgUmVzb3VyY2VUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9SZXNvdXJjZVRhYmxlJzsKaW1wb3J0IE1hc3RoZWFkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1Jlc291cmNlTGlzdC9NYXN0aGVhZCc7CmltcG9ydCBSZXNvdXJjZUZldGNoIGZyb20gJ0BzaGVsbC9taXhpbnMvcmVzb3VyY2UtZmV0Y2gnOwppbXBvcnQgeyBpc0FkbWluVXNlciB9IGZyb20gJ0BzaGVsbC9zdG9yZS90eXBlLW1hcCc7CmltcG9ydCBUYWJsZURhdGFVc2VySWNvbiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJsZURhdGFVc2VySWNvbic7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQXN5bmNCdXR0b24sCiAgICBSZXNvdXJjZVRhYmxlLAogICAgTWFzdGhlYWQsCiAgICBUYWJsZURhdGFVc2VySWNvbiwKICB9LAogIG1peGluczogW1Jlc291cmNlRmV0Y2hdLAogIHByb3BzOiAgewogICAgcmVzb3VyY2U6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIGxvYWRJbmRldGVybWluYXRlOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAoKICAgIGluY3JlbWVudGFsTG9hZGluZ0luZGljYXRvcjogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKCiAgICB1c2VRdWVyeVBhcmFtc0ZvclNpbXBsZUZpbHRlcmluZzogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBjb25zdCBzdG9yZSA9IHRoaXMuJHN0b3JlOwoKICAgIGF3YWl0IHN0b3JlLmRpc3BhdGNoKGByYW5jaGVyL2ZpbmRBbGxgLCB7IHR5cGU6IE5PUk1BTi5VU0VSIH0pOwoKICAgIGF3YWl0IHRoaXMuJGZldGNoVHlwZSh0aGlzLnJlc291cmNlKTsKCiAgICB0aGlzLmNhblJlZnJlc2hBY2Nlc3MgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9yZXF1ZXN0JywgeyB1cmw6ICcvdjMvdXNlcnM/bGltaXQ9MCcgfSkKICAgICAgLnRoZW4oKHJlcykgPT4gISFyZXM/LmFjdGlvbnM/LnJlZnJlc2hhdXRocHJvdmlkZXJhY2Nlc3MpOwogIH0sCgogIGRhdGEoKSB7CiAgICBjb25zdCBnZXR0ZXJzID0gdGhpcy4kc3RvcmUuZ2V0dGVyczsKCiAgICBjb25zdCBzY2hlbWEgPSBnZXR0ZXJzW2BtYW5hZ2VtZW50L3NjaGVtYUZvcmBdKHRoaXMucmVzb3VyY2UpOwoKICAgIHJldHVybiB7CiAgICAgIHNjaGVtYSwKICAgICAgY2FuUmVmcmVzaEFjY2VzczogZmFsc2UsCiAgICB9OwogIH0sCgogICRsb2FkaW5nUmVzb3VyY2VzKCkgewogICAgLy8gcmVzdWx0cyBhcmUgZmlsdGVyZWQgc28gd2Ugd291bGRuJ3QgZ2V0IHRoZSBjb3JyZWN0IGNvdW50IG9uIGluZGljYXRvci4uLgogICAgcmV0dXJuIHsgbG9hZEluZGV0ZXJtaW5hdGU6IHRydWUgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgaGVhZGVycygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2hlYWRlcnNGb3InXSh0aGlzLnNjaGVtYSk7CiAgICB9LAoKICAgIGdyb3VwQnkoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9ncm91cEJ5Rm9yJ10odGhpcy5zY2hlbWEpOwogICAgfSwKCiAgICB1c2VycygpIHsKICAgICAgaWYgKCAhdGhpcy5yb3dzICkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgLy8gVXBkYXRlIHRoZSBsaXN0IG9mIHVzZXJzCiAgICAgIC8vIDEpIE9ubHkgc2hvdyBzeXN0ZW0gdXNlcnMgaW4gZXhwbG9yZXIvdXNlcnMgYW5kIG5vdCBpbiBhdXRoL3VzZXJzCiAgICAgIC8vIDIpIFN1cHBsZW1lbnQgdXNlciB3aXRoIGluZm8gdG8gZW5hYmxlL2Rpc2FibGUgdGhlIHJlZnJlc2ggZ3JvdXAgbWVtYmVyc2hpcCBhY3Rpb24gKHRoaXMgaXMgbm90IHBlcnNpc3RlZCBvbiBzYXZlKQogICAgICBjb25zdCBwYXJhbXMgPSB7IC4uLnRoaXMuJHJvdXRlLnBhcmFtcyB9OwogICAgICBjb25zdCByZXF1aXJlZFVzZXJzID0gcGFyYW1zLnByb2R1Y3QgPT09IE5BTUUgPyB0aGlzLnJvd3MuZmlsdGVyKChhKSA9PiAhYS5pc1N5c3RlbSkgOiB0aGlzLnJvd3M7CgogICAgICByZXF1aXJlZFVzZXJzLmZvckVhY2goKHIpID0+IHsKICAgICAgICByLmNhblJlZnJlc2hBY2Nlc3MgPSB0aGlzLmNhblJlZnJlc2hBY2Nlc3M7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHJlcXVpcmVkVXNlcnM7CiAgICB9LAoKICAgIGlzQWRtaW4oKSB7CiAgICAgIHJldHVybiBpc0FkbWluVXNlcih0aGlzLiRzdG9yZS5nZXR0ZXJzKTsKICAgIH0sCiAgfSwKCiAgbWV0aG9kczogewogICAgYXN5bmMgcmVmcmVzaEdyb3VwTWVtYmVyc2hpcHMoYnV0dG9uRG9uZSkgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyYW5jaGVyL2NvbGxlY3Rpb25BY3Rpb24nLCB7CiAgICAgICAgICB0eXBlOiAgICAgICBOT1JNQU4uVVNFUiwKICAgICAgICAgIGFjdGlvbk5hbWU6ICdyZWZyZXNoYXV0aHByb3ZpZGVyYWNjZXNzJywKICAgICAgICB9KTsKCiAgICAgICAgYnV0dG9uRG9uZSh0cnVlKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL2Zyb21FcnJvcicsIHsgdGl0bGU6IHRoaXMudCgndXNlci5saXN0LmVycm9yUmVmcmVzaGluZ0dyb3VwTWVtYmVyc2hpcHMnKSwgZXJyIH0sIHsgcm9vdDogdHJ1ZSB9KTsKICAgICAgICBidXR0b25Eb25lKGZhbHNlKTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["management.cattle.io.user.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"management.cattle.io.user.vue","sourceRoot":"node_modules/@rancher/shell/list","sourcesContent":["<script>\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { NORMAN } from '@shell/config/types';\nimport { NAME } from '@shell/config/product/auth';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Masthead from '@shell/components/ResourceList/Masthead';\nimport ResourceFetch from '@shell/mixins/resource-fetch';\nimport { isAdminUser } from '@shell/store/type-map';\nimport TableDataUserIcon from '@shell/components/TableDataUserIcon';\n\nexport default {\n  components: {\n    AsyncButton,\n    ResourceTable,\n    Masthead,\n    TableDataUserIcon,\n  },\n  mixins: [ResourceFetch],\n  props:  {\n    resource: {\n      type:     String,\n      required: true,\n    },\n\n    loadIndeterminate: {\n      type:    Boolean,\n      default: false\n    },\n\n    incrementalLoadingIndicator: {\n      type:    Boolean,\n      default: false\n    },\n\n    useQueryParamsForSimpleFiltering: {\n      type:    Boolean,\n      default: false\n    }\n  },\n  async fetch() {\n    const store = this.$store;\n\n    await store.dispatch(`rancher/findAll`, { type: NORMAN.USER });\n\n    await this.$fetchType(this.resource);\n\n    this.canRefreshAccess = await this.$store.dispatch('rancher/request', { url: '/v3/users?limit=0' })\n      .then((res) => !!res?.actions?.refreshauthprovideraccess);\n  },\n\n  data() {\n    const getters = this.$store.getters;\n\n    const schema = getters[`management/schemaFor`](this.resource);\n\n    return {\n      schema,\n      canRefreshAccess: false,\n    };\n  },\n\n  $loadingResources() {\n    // results are filtered so we wouldn't get the correct count on indicator...\n    return { loadIndeterminate: true };\n  },\n\n  computed: {\n    headers() {\n      return this.$store.getters['type-map/headersFor'](this.schema);\n    },\n\n    groupBy() {\n      return this.$store.getters['type-map/groupByFor'](this.schema);\n    },\n\n    users() {\n      if ( !this.rows ) {\n        return [];\n      }\n\n      // Update the list of users\n      // 1) Only show system users in explorer/users and not in auth/users\n      // 2) Supplement user with info to enable/disable the refresh group membership action (this is not persisted on save)\n      const params = { ...this.$route.params };\n      const requiredUsers = params.product === NAME ? this.rows.filter((a) => !a.isSystem) : this.rows;\n\n      requiredUsers.forEach((r) => {\n        r.canRefreshAccess = this.canRefreshAccess;\n      });\n\n      return requiredUsers;\n    },\n\n    isAdmin() {\n      return isAdminUser(this.$store.getters);\n    },\n  },\n\n  methods: {\n    async refreshGroupMemberships(buttonDone) {\n      try {\n        await this.$store.dispatch('rancher/collectionAction', {\n          type:       NORMAN.USER,\n          actionName: 'refreshauthprovideraccess',\n        });\n\n        buttonDone(true);\n      } catch (err) {\n        this.$store.dispatch('growl/fromError', { title: this.t('user.list.errorRefreshingGroupMemberships'), err }, { root: true });\n        buttonDone(false);\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <Masthead\n      :schema=\"schema\"\n      :resource=\"resource\"\n      :show-incremental-loading-indicator=\"incrementalLoadingIndicator\"\n      :load-resources=\"loadResources\"\n      :load-indeterminate=\"loadIndeterminate\"\n    >\n      <template slot=\"extraActions\">\n        <AsyncButton\n          v-if=\"canRefreshAccess\"\n          mode=\"refresh\"\n          :action-label=\"t('authGroups.actions.refresh')\"\n          :waiting-label=\"t('authGroups.actions.refresh')\"\n          :success-label=\"t('authGroups.actions.refresh')\"\n          :error-label=\"t('authGroups.actions.refresh')\"\n          @click=\"refreshGroupMemberships\"\n        />\n      </template>\n      <template\n        v-if=\"isAdmin\"\n        #subHeader\n      >\n        <router-link\n          :to=\"{ name: 'c-cluster-auth-user.retention'}\"\n          class=\"btn role-link btn-sm btn-user-retention\"\n          data-testid=\"router-link-user-retention\"\n        >\n          <i class=\"icon icon-gear\" />\n          {{ t('user.retention.button.label') }}\n        </router-link>\n      </template>\n    </Masthead>\n\n    <ResourceTable\n      :schema=\"schema\"\n      :rows=\"users\"\n      :group-by=\"groupBy\"\n      :loading=\"loading\"\n      :use-query-params-for-simple-filtering=\"useQueryParamsForSimpleFiltering\"\n      :force-update-live-and-delayed=\"forceUpdateLiveAndDelayed\"\n    >\n      <template #col:user-state=\"{row}\">\n        <td>\n          <TableDataUserIcon\n            :user-state=\"row.stateDisplay\"\n            :is-active=\"row.state === 'active'\"\n          />\n        </td>\n      </template>\n    </ResourceTable>\n  </div>\n</template>\n\n<style lang=\"scss\">\n  .btn-user-retention {\n    display: flex;\n    gap: 0.25rem;\n    padding: 0;\n  }\n</style>\n"]}]}