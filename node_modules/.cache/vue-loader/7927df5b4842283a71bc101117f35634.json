{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/pages/c/_cluster/explorer/tools/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/pages/c/_cluster/explorer/tools/index.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCB7IF9GTEFHR0VELCBERVBSRUNBVEVEIGFzIERFUFJFQ0FURURfUVVFUlksIEhJRERFTiwgRlJPTV9UT09MUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvcXVlcnktcGFyYW1zJzsKaW1wb3J0IHsgZmlsdGVyQW5kQXJyYW5nZUNoYXJ0cyB9IGZyb20gJ0BzaGVsbC9zdG9yZS9jYXRhbG9nJzsKaW1wb3J0IHsgQ0FUQUxPRywgTk9STUFOIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IENBVEFMT0cgYXMgQ0FUQUxPR19BTk5PVEFUSU9OUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKaW1wb3J0IExhenlJbWFnZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9MYXp5SW1hZ2UnOwppbXBvcnQgeyBpc0FsdGVybmF0ZSB9IGZyb20gJ0BzaGVsbC91dGlscy9wbGF0Zm9ybSc7CmltcG9ydCBJY29uTWVzc2FnZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9JY29uTWVzc2FnZSc7CmltcG9ydCBUeXBlRGVzY3JpcHRpb24gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVHlwZURlc2NyaXB0aW9uJzsKaW1wb3J0IFRhYlRpdGxlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYlRpdGxlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBMYXp5SW1hZ2UsIExvYWRpbmcsIEljb25NZXNzYWdlLCBUeXBlRGVzY3JpcHRpb24sIFRhYlRpdGxlCiAgfSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2F0YWxvZy9sb2FkJywgeyBmb3JjZTogdHJ1ZSwgcmVzZXQ6IHRydWUgfSk7CgogICAgY29uc3QgcXVlcnkgPSB0aGlzLiRyb3V0ZS5xdWVyeTsKCiAgICB0aGlzLnNob3dEZXByZWNhdGVkID0gcXVlcnlbREVQUkVDQVRFRF9RVUVSWV0gPT09ICd0cnVlJyB8fCBxdWVyeVtERVBSRUNBVEVEX1FVRVJZXSA9PT0gX0ZMQUdHRUQ7CiAgICB0aGlzLnNob3dIaWRkZW4gPSBxdWVyeVtISURERU5dID09PSBfRkxBR0dFRDsKCiAgICB0aGlzLmFsbEluc3RhbGxlZCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmRBbGwnLCB7IHR5cGU6IENBVEFMT0cuQVBQIH0pOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhbGxJbnN0YWxsZWQ6ICAgIG51bGwsCiAgICAgIHYxU3lzdGVtQ2F0YWxvZzogbnVsbCwKICAgICAgc3lzdGVtUHJvamVjdDogICBudWxsLAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pLAogICAgLi4ubWFwR2V0dGVycyh7IGFsbENoYXJ0czogJ2NhdGFsb2cvY2hhcnRzJywgbG9hZGluZ0Vycm9yczogJ2NhdGFsb2cvZXJyb3JzJyB9KSwKICAgIC4uLm1hcEdldHRlcnMoeyB0OiAnaTE4bi90JyB9KSwKCiAgICB2MUFwcHMoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL2FsbCddKE5PUk1BTi5BUFApOwogICAgfSwKCiAgICBuYW1lc3BhY2VzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snYWN0aXZlTmFtZXNwYWNlQ2FjaGUnXTsKICAgIH0sCgogICAgcmFuY2hlckNhdGFsb2coKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjYXRhbG9nL3JlcG9zJ10uZmluZCgoeCkgPT4geC5pc1JhbmNoZXIpOwogICAgfSwKCiAgICBpbnN0YWxsZWRBcHBzKCkgewogICAgICByZXR1cm4gdGhpcy5hbGxJbnN0YWxsZWQ7CiAgICB9LAoKICAgIGluc3RhbGxlZEFwcEZvckNoYXJ0KCkgewogICAgICBjb25zdCBvdXQgPSB7fTsKCiAgICAgIGZvciAoY29uc3QgYXBwIG9mICh0aGlzLmluc3RhbGxlZEFwcHMgfHwgW10pKSB7CiAgICAgICAgY29uc3QgbWF0Y2hpbmcgPSBhcHAubWF0Y2hpbmdDaGFydCgpOwoKICAgICAgICBpZiAoICFtYXRjaGluZyApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgb3V0W21hdGNoaW5nLmlkXSA9IGFwcDsKICAgICAgfQoKICAgICAgcmV0dXJuIG91dDsKICAgIH0sCgogICAgb3B0aW9ucygpIHsKICAgICAgY29uc3QgY2x1c3RlclByb3ZpZGVyID0gdGhpcy5jdXJyZW50Q2x1c3Rlci5zdGF0dXMucHJvdmlkZXIgfHwgJ290aGVyJzsKICAgICAgY29uc3QgZW5hYmxlZENoYXJ0cyA9ICh0aGlzLmFsbENoYXJ0cyB8fCBbXSk7CgogICAgICBsZXQgY2hhcnRzID0gZmlsdGVyQW5kQXJyYW5nZUNoYXJ0cyhlbmFibGVkQ2hhcnRzLCB7CiAgICAgICAgY2x1c3RlclByb3ZpZGVyLAogICAgICAgIHNob3dEZXByZWNhdGVkOiB0aGlzLnNob3dEZXByZWNhdGVkLAogICAgICAgIHNob3dIaWRkZW46ICAgICB0aGlzLnNob3dIaWRkZW4sCiAgICAgICAgc2hvd1JlcG9zOiAgICAgIFt0aGlzLnJhbmNoZXJDYXRhbG9nPy5fa2V5XSwKICAgICAgICBzaG93VHlwZXM6ICAgICAgW0NBVEFMT0dfQU5OT1RBVElPTlMuX0NMVVNURVJfVE9PTF0sCiAgICAgIH0pOwoKICAgICAgY2hhcnRzID0gY2hhcnRzLmZpbHRlcigoYykgPT4gYy5zaWRlTGFiZWwgIT09ICdFeHBlcmltZW50YWwnKTsKCiAgICAgIGNvbnN0IGNoYXJ0c1dpdGhBcHBzID0gY2hhcnRzLm1hcCgoY2hhcnQpID0+IHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgY2hhcnQsCiAgICAgICAgICBhcHA6IHRoaXMuaW5zdGFsbGVkQXBwRm9yQ2hhcnRbY2hhcnQuaWRdLAogICAgICAgIH07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGNoYXJ0c1dpdGhBcHBzOwogICAgfSwKICB9LAoKICB3YXRjaDogewogICAgbmFtZXNwYWNlcygpIHsKICAgICAgLy8gV2hlbiB0aGUgbmFtZXNwYWNlcyBjaGFuZ2UsIGNoZWNrIHRoZSB2MSBhcHBzIC0gbWlnaHQgaW5kaWNhdGUgYWRkIG9yIHJlbW92YWwgb2YgYSB2MSBhcHAKICAgICAgaWYgKHRoaXMuc3lzdGVtUHJvamVjdCkgewogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyYW5jaGVyL2ZpbmRBbGwnLCB7CiAgICAgICAgICB0eXBlOiBOT1JNQU4uQVBQLAogICAgICAgICAgb3B0OiAgeyB1cmw6IGAvdjMvcHJvamVjdC8keyB0aGlzLnN5c3RlbVByb2plY3QgfS9hcHBzYCwgZm9yY2U6IHRydWUgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHdpbmRvdy5jID0gdGhpczsKICB9LAoKICBtZXRob2RzOiB7CiAgICBlZGl0KGFwcCwgdmVyc2lvbikgewogICAgICBhcHAuZ29Ub1VwZ3JhZGUodmVyc2lvbiwgdHJ1ZSk7CiAgICB9LAoKICAgIHJlbW92ZShhcHAsIGV2ZW50KSB7CiAgICAgIGNvbnN0IGFsdCA9IGlzQWx0ZXJuYXRlKGV2ZW50KTsKCiAgICAgIGlmICghYWx0KSB7CiAgICAgICAgYXBwLnByb21wdFJlbW92ZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFVzZXIgaGVsZCBhbHQga2V5LCBzbyBkb24ndCBwcm9tcHQKICAgICAgICBhcHAucmVtb3ZlKCk7CiAgICAgIH0KICAgIH0sCgogICAgaW5zdGFsbChjaGFydCkgewogICAgICBjaGFydC5nb1RvSW5zdGFsbChGUk9NX1RPT0xTKTsKICAgIH0sCgogICAgb3BlblYxVG9vbChpZCkgewogICAgICBjb25zdCBjbHVzdGVyID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY3VycmVudENsdXN0ZXInXTsKICAgICAgY29uc3Qgcm91dGUgPSB7CiAgICAgICAgbmFtZTogICAnYy1jbHVzdGVyLWV4cGxvcmVyLXRvb2xzLXBhZ2VzLXBhZ2UnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgY2x1c3RlcjogY2x1c3Rlci5pZCwKICAgICAgICAgIHByb2R1Y3Q6ICdleHBsb3JlcicsCiAgICAgICAgICBwYWdlOiAgICBpZCwKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZShyb3V0ZSk7CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/explorer/tools","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport Loading from '@shell/components/Loading';\nimport { _FLAGGED, DEPRECATED as DEPRECATED_QUERY, HIDDEN, FROM_TOOLS } from '@shell/config/query-params';\nimport { filterAndArrangeCharts } from '@shell/store/catalog';\nimport { CATALOG, NORMAN } from '@shell/config/types';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport LazyImage from '@shell/components/LazyImage';\nimport { isAlternate } from '@shell/utils/platform';\nimport IconMessage from '@shell/components/IconMessage';\nimport TypeDescription from '@shell/components/TypeDescription';\nimport TabTitle from '@shell/components/TabTitle';\n\nexport default {\n  components: {\n    LazyImage, Loading, IconMessage, TypeDescription, TabTitle\n  },\n\n  async fetch() {\n    await this.$store.dispatch('catalog/load', { force: true, reset: true });\n\n    const query = this.$route.query;\n\n    this.showDeprecated = query[DEPRECATED_QUERY] === 'true' || query[DEPRECATED_QUERY] === _FLAGGED;\n    this.showHidden = query[HIDDEN] === _FLAGGED;\n\n    this.allInstalled = await this.$store.dispatch('cluster/findAll', { type: CATALOG.APP });\n  },\n\n  data() {\n    return {\n      allInstalled:    null,\n      v1SystemCatalog: null,\n      systemProject:   null,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    ...mapGetters({ allCharts: 'catalog/charts', loadingErrors: 'catalog/errors' }),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    v1Apps() {\n      return this.$store.getters['rancher/all'](NORMAN.APP);\n    },\n\n    namespaces() {\n      return this.$store.getters['activeNamespaceCache'];\n    },\n\n    rancherCatalog() {\n      return this.$store.getters['catalog/repos'].find((x) => x.isRancher);\n    },\n\n    installedApps() {\n      return this.allInstalled;\n    },\n\n    installedAppForChart() {\n      const out = {};\n\n      for (const app of (this.installedApps || [])) {\n        const matching = app.matchingChart();\n\n        if ( !matching ) {\n          continue;\n        }\n\n        out[matching.id] = app;\n      }\n\n      return out;\n    },\n\n    options() {\n      const clusterProvider = this.currentCluster.status.provider || 'other';\n      const enabledCharts = (this.allCharts || []);\n\n      let charts = filterAndArrangeCharts(enabledCharts, {\n        clusterProvider,\n        showDeprecated: this.showDeprecated,\n        showHidden:     this.showHidden,\n        showRepos:      [this.rancherCatalog?._key],\n        showTypes:      [CATALOG_ANNOTATIONS._CLUSTER_TOOL],\n      });\n\n      charts = charts.filter((c) => c.sideLabel !== 'Experimental');\n\n      const chartsWithApps = charts.map((chart) => {\n        return {\n          chart,\n          app: this.installedAppForChart[chart.id],\n        };\n      });\n\n      return chartsWithApps;\n    },\n  },\n\n  watch: {\n    namespaces() {\n      // When the namespaces change, check the v1 apps - might indicate add or removal of a v1 app\n      if (this.systemProject) {\n        this.$store.dispatch('rancher/findAll', {\n          type: NORMAN.APP,\n          opt:  { url: `/v3/project/${ this.systemProject }/apps`, force: true }\n        });\n      }\n    }\n  },\n\n  mounted() {\n    window.c = this;\n  },\n\n  methods: {\n    edit(app, version) {\n      app.goToUpgrade(version, true);\n    },\n\n    remove(app, event) {\n      const alt = isAlternate(event);\n\n      if (!alt) {\n        app.promptRemove();\n      } else {\n        // User held alt key, so don't prompt\n        app.remove();\n      }\n    },\n\n    install(chart) {\n      chart.goToInstall(FROM_TOOLS);\n    },\n\n    openV1Tool(id) {\n      const cluster = this.$store.getters['currentCluster'];\n      const route = {\n        name:   'c-cluster-explorer-tools-pages-page',\n        params: {\n          cluster: cluster.id,\n          product: 'explorer',\n          page:    id,\n        }\n      };\n\n      this.$router.replace(route);\n    },\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n  $margin: 10px;\n  $logo: 50px;\n\n  .grid {\n    display: flex;\n    justify-content: flex-start;\n    flex-wrap: wrap;\n    margin: 0 -1*$margin;\n\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-4')) {\n      .item {\n        width: 100%;\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-7')) {\n      .item {\n        width: 100%;\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-9')) {\n      .item {\n        width: calc(50% - 2 * #{$margin});\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-12')) {\n      .item {\n        width: calc(33.33333% - 2 * #{$margin});\n      }\n    }\n\n    .item {\n      display: grid;\n      grid-template-areas:  \"logo name-version name-version\"\n                            \"description description description\"\n                            \"state state action\";\n      grid-template-columns: $logo auto min-content;\n      grid-template-rows: 50px 55px 35px;\n      row-gap: $margin;\n      column-gap: $margin;\n\n      margin: $margin;\n      padding: $margin;\n      position: relative;\n      border: 1px solid var(--border);\n      border-radius: calc( 1.5 * var(--border-radius));\n\n      .logo {\n        grid-area: logo;\n        text-align: center;\n        width: $logo;\n        height: $logo;\n        border-radius: calc(2 * var(--border-radius));\n        overflow: hidden;\n        background-color: white;\n\n        img {\n          width: $logo - 4px;\n          height: $logo - 4px;\n          object-fit: contain;\n          position: relative;\n          top: 2px;\n        }\n\n        > i {\n          background-color: var(--box-bg);\n          border-radius: 50%;\n          font-size: 32px;\n          line-height: 50px;\n          width: 50px;\n        }\n      }\n\n      .name-version {\n        grid-area: name-version;\n        padding: 10px 0 0 0;\n      }\n\n      .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin: 0;\n      }\n\n      .os-label {\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        padding: 3px;\n        font-size: 12px;\n        line-height: 12px;\n        background-color: var(--primary);\n        color: var(--primary-text);\n      }\n\n      .version {\n        color: var(--muted);\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        font-size: 0.9em;\n        margin-top: 4px;\n      }\n\n      .description {\n        grid-area: description;\n      }\n\n      .description-content {\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 3;\n        line-clamp: 3;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        color: var(--text-muted);\n      }\n\n      .state {\n        grid-area: state;\n      }\n\n      .action {\n        grid-area: action;\n        white-space: nowrap;\n\n        button {\n          height: 30px;\n        }\n      }\n    }\n  }\n</style>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else-if=\"options.length\">\n    <h1>\n      <TabTitle>{{ t('catalog.tools.header') }}</TabTitle>\n    </h1>\n    <TypeDescription\n      resource=\"chart\"\n    />\n\n    <div class=\"grid\">\n      <div\n        v-for=\"opt in options\"\n        :key=\"opt.chart.id\"\n        class=\"item\"\n        :data-testid=\"`cluster-tools-app-${opt.chart.id}`\"\n      >\n        <div\n          class=\"logo\"\n        >\n          <i\n            v-if=\"opt.chart.iconName\"\n            class=\"icon\"\n            :class=\"opt.chart.iconName\"\n          />\n          <LazyImage\n            v-else\n            :src=\"opt.chart.icon\"\n          />\n        </div>\n        <div class=\"name-version\">\n          <div>\n            <h3 class=\"name\">\n              {{ opt.chart.chartNameDisplay }}\n            </h3>\n            <label\n              v-if=\"opt.chart.deploysOnWindows\"\n              class=\"os-label\"\n            >{{ t('catalog.charts.deploysOnWindows') }}</label>\n          </div>\n          <div class=\"version\">\n            <template v-if=\"opt.app && opt.app.upgradeAvailable\">\n              v{{ opt.app.currentVersion }} <b><i class=\"icon icon-chevron-right\" /> v{{ opt.app.upgradeAvailable }}</b>\n            </template>\n            <template v-else-if=\"opt.app\">\n              v{{ opt.app.currentVersion }}\n            </template>\n            <template v-else-if=\"opt.chart.versions.length\">\n              v{{ opt.chart.versions[0].version }}\n            </template>\n          </div>\n        </div>\n        <div class=\"description\">\n          <div\n            v-clean-html=\"opt.chart.chartDescription\"\n            class=\"description-content\"\n          />\n        </div>\n        <div class=\"action\">\n          <template v-if=\"opt.blocked\">\n            <button\n              v-clean-html=\"t('catalog.tools.action.install')\"\n              disabled=\"true\"\n              class=\"btn btn-sm role-primary\"\n            />\n          </template>\n          <template v-else-if=\"opt.app\">\n            <button\n              class=\"btn btn-sm role-secondary\"\n              @click=\"remove(opt.app, $event)\"\n            >\n              <i class=\"icon icon-delete icon-lg\" />\n            </button>\n            <button\n              v-clean-html=\"t('catalog.tools.action.edit')\"\n              class=\"btn btn-sm role-secondary\"\n              @click=\"edit(opt.app)\"\n            />\n          </template>\n          <template v-else>\n            <button\n              v-clean-html=\"t('catalog.tools.action.install')\"\n              class=\"btn btn-sm role-primary\"\n              @click=\"install(opt.chart)\"\n            />\n          </template>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div v-else>\n    <IconMessage\n      icon=\"icon-warning\"\n      message-key=\"catalog.tools.noTools\"\n    />\n  </div>\n</template>\n"]}]}