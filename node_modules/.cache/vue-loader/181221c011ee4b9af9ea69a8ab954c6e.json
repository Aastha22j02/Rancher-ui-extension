{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/components/PromptRemove.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/components/PromptRemove.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGdldCwgaXNFbXB0eSB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBlc2NhcGVIdG1sLCByZXNvdXJjZU5hbWVzIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IENhcmQgfSBmcm9tICdAY29tcG9uZW50cy9DYXJkJzsKaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0NoZWNrYm94JzsKaW1wb3J0IHsgYWx0ZXJuYXRlTGFiZWwgfSBmcm9tICdAc2hlbGwvdXRpbHMvcGxhdGZvcm0nOwppbXBvcnQgeyB1bmlxIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2FycmF5JzsKaW1wb3J0IEFzeW5jQnV0dG9uIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0FzeW5jQnV0dG9uJzsKaW1wb3J0IHsgQ0FUQUxPRyBhcyBDQVRBTE9HX0FOTk9UQVRJT05TIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBDQVRBTE9HIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IEFwcE1vZGFsIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0FwcE1vZGFsLnZ1ZSc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1Byb21wdFJlbW92ZScsCgogIGNvbXBvbmVudHM6IHsKICAgIENhcmQsIENoZWNrYm94LCBBc3luY0J1dHRvbiwgTGFiZWxlZElucHV0LCBBcHBNb2RhbAogIH0sCiAgcHJvcHM6IHsKICAgIC8qKgogICAgICogSW5oZXJpdGVkIGdsb2JhbCBpZGVudGlmaWVyIHByZWZpeCBmb3IgdGVzdHMKICAgICAqIERlZmluZSBhIHRlcm0gYmFzZWQgb24gdGhlIHBhcmVudCBjb21wb25lbnQgdG8gYXZvaWQgY29uZmxpY3RzIG9uIG11bHRpcGxlIGNvbXBvbmVudHMKICAgICAqLwogICAgY29tcG9uZW50VGVzdGlkOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ3Byb21wdC1yZW1vdmUnCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgY29uc3QgeyByZXNvdXJjZSB9ID0gdGhpcy4kcm91dGUucGFyYW1zOwoKICAgIHJldHVybiB7CiAgICAgIGhhc0N1c3RvbVJlbW92ZTogICAgIGZhbHNlLAogICAgICByYW5kb21Qb3NpdGlvbjogICAgICBNYXRoLnJhbmRvbSgpLAogICAgICBjb25maXJtTmFtZTogICAgICAgICAnJywKICAgICAgZXJyb3I6ICAgICAgICAgICAgICAgJycsCiAgICAgIHdhcm5pbmc6ICAgICAgICAgICAgICcnLAogICAgICBwcmV2ZW50RGVsZXRlOiAgICAgICBmYWxzZSwKICAgICAgcmVtb3ZlQ29tcG9uZW50OiAgICAgdGhpcy4kc3RvcmUuZ2V0dGVyc1sndHlwZS1tYXAvaW1wb3J0Q3VzdG9tUHJvbXB0UmVtb3ZlJ10ocmVzb3VyY2UpLAogICAgICBjaGFydHNUb1JlbW92ZUlzQXBwOiBmYWxzZSwKICAgICAgY2hhcnRzRGVsZXRlQ3JkOiAgICAgZmFsc2UsCiAgICAgIHNob3dNb2RhbDogICAgICAgICAgIGZhbHNlLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBuYW1lcygpIHsKICAgICAgcmV0dXJuIHRoaXMudG9SZW1vdmUubWFwKChvYmopID0+IG9iai5uYW1lRGlzcGxheSkuc2xpY2UoMCwgNSk7CiAgICB9LAoKICAgIG5hbWVUb01hdGNoUG9zaXRpb24oKSB7CiAgICAgIGNvbnN0IHZpc2libGVOYW1lcyA9IE1hdGgubWluKDUsIHRoaXMubmFtZXMubGVuZ3RoKTsKICAgICAgY29uc3QgcmFuZG9tTmFtZVBvcyA9IE1hdGguZmxvb3IodGhpcy5yYW5kb21Qb3NpdGlvbiAqIHZpc2libGVOYW1lcyk7CgogICAgICByZXR1cm4gcmFuZG9tTmFtZVBvczsKICAgIH0sCgogICAgbmFtZVRvTWF0Y2goKSB7CiAgICAgIHJldHVybiB0aGlzLm5hbWVzW3RoaXMubmFtZVRvTWF0Y2hQb3NpdGlvbl07CiAgICB9LAoKICAgIHR5cGUoKSB7CiAgICAgIGNvbnN0IHR5cGVzID0gbmV3IFNldCh0aGlzLnRvUmVtb3ZlLnJlZHVjZSgoYXJyYXksIGVhY2gpID0+IHsKICAgICAgICBhcnJheS5wdXNoKGVhY2gudHlwZSk7CgogICAgICAgIHJldHVybiBhcnJheTsKICAgICAgfSwgW10pKTsKCiAgICAgIGlmICh0eXBlcy5zaXplID4gMSkgewogICAgICAgIHJldHVybiB0aGlzLnQoJ2dlbmVyaWMucmVzb3VyY2UnLCB7IGNvdW50OiB0aGlzLnRvUmVtb3ZlLmxlbmd0aCB9KTsKICAgICAgfQoKICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy50b1JlbW92ZVswXT8uc2NoZW1hOwoKICAgICAgaWYgKCAhc2NoZW1hICkgewogICAgICAgIHJldHVybiBgcmVzb3VyY2UkeyB0aGlzLnRvUmVtb3ZlLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnIH1gOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndHlwZS1tYXAvbGFiZWxGb3InXShzY2hlbWEsIHRoaXMudG9SZW1vdmUubGVuZ3RoKTsKICAgIH0sCgogICAgc2VsZkxpbmtzKCkgewogICAgICByZXR1cm4gdGhpcy50b1JlbW92ZS5tYXAoKHJlc291cmNlKSA9PiB7CiAgICAgICAgcmV0dXJuIGdldChyZXNvdXJjZSwgJ2xpbmtzLnNlbGYnKTsKICAgICAgfSk7CiAgICB9LAoKICAgIG5lZWRzQ29uZmlybSgpIHsKICAgICAgY29uc3QgZmlyc3QgPSB0aGlzLnRvUmVtb3ZlWzBdOwoKICAgICAgcmV0dXJuIGZpcnN0Py5jb25maXJtUmVtb3ZlOwogICAgfSwKCiAgICBwbHVzTW9yZSgpIHsKICAgICAgY29uc3QgcmVtYWluaW5nID0gdGhpcy50b1JlbW92ZS5sZW5ndGggLSB0aGlzLm5hbWVzLmxlbmd0aDsKCiAgICAgIHJldHVybiB0aGlzLnQoJ3Byb21wdFJlbW92ZS5hbmRPdGhlcnMnLCB7IGNvdW50OiByZW1haW5pbmcgfSk7CiAgICB9LAoKICAgIC8vIGlmIHRoZSBjdXJyZW50IHJvdXRlIGVuZHMgd2l0aCB0aGUgSUQgb2YgdGhlIHJlc291cmNlIGJlaW5nIGRlbGV0ZWQsIHdoYXRldmVyIHBhZ2UgdGhpcyBpcyB3b250IGJlIHZhbGlkIGFmdGVyIHN1Y2Nlc3NmdWwgZGVsZXRpb246IG5hdmlnYXRlIGF3YXkKICAgIGRvbmVMb2NhdGlvbigpIHsKICAgICAgLy8gaWYgZGVsZXRpbmcgbW9yZSB0aGFuIG9uZSByZXNvdXJjZSwgdGhpcyBpcyBoYXBwZW5pbmcgaW4gbGlzdCB2aWV3IGFuZCBzaG91bGRuJ3QgcmVkaXJlY3QgYW55d2hlcmUKICAgICAgaWYgKHRoaXMudG9SZW1vdmUubGVuZ3RoID4gMSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAodGhpcy50b1JlbW92ZVswXS5kb25lTG9jYXRpb25SZW1vdmUpIHsKICAgICAgICByZXR1cm4gdGhpcy50b1JlbW92ZVswXS5kb25lTG9jYXRpb25SZW1vdmU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGN1cnJlbnRSb3V0ZSA9IHRoaXMudG9SZW1vdmVbMF0uY3VycmVudFJvdXRlKCk7CiAgICAgIGNvbnN0IG91dCA9IHt9OwogICAgICBjb25zdCBwYXJhbXMgPSB7IC4uLmN1cnJlbnRSb3V0ZS5wYXJhbXMgfTsKCiAgICAgIGlmIChwYXJhbXMuaWQgJiYgKHBhcmFtcy5pZCA9PT0gdGhpcy50b1JlbW92ZVswXT8ubWV0YWRhdGE/Lm5hbWUgfHwgcGFyYW1zLmlkID09PSB0aGlzLnRvUmVtb3ZlWzBdLmlkKSkgewogICAgICAgIGxldCB7IG5hbWUgPSAnJyB9ID0gY3VycmVudFJvdXRlOwoKICAgICAgICBjb25zdCBpZEluZGV4ID0gbmFtZS5pbmRleE9mKCctaWQnKTsKCiAgICAgICAgaWYgKGlkSW5kZXggIT09IC0xKSB7CiAgICAgICAgICBuYW1lID0gbmFtZS5zbGljZSgwLCBpZEluZGV4KTsKICAgICAgICB9CgogICAgICAgIGlmIChwYXJhbXMubmFtZXNwYWNlKSB7CiAgICAgICAgICBjb25zdCBuYW1lc3BhY2VJbmRleCA9IG5hbWUuaW5kZXhPZignLW5hbWVzcGFjZScpOwoKICAgICAgICAgIGlmIChuYW1lc3BhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgbmFtZSA9IG5hbWUuc2xpY2UoMCwgbmFtZXNwYWNlSW5kZXgpOwogICAgICAgICAgfQogICAgICAgICAgZGVsZXRlIHBhcmFtcy5uYW1lc3BhY2U7CiAgICAgICAgfQogICAgICAgIGRlbGV0ZSBwYXJhbXMuaWQ7CgogICAgICAgIG91dC5wYXJhbXMgPSBwYXJhbXM7CiAgICAgICAgb3V0Lm5hbWUgPSBuYW1lOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBjdXJyZW50Um91dGVyKCkgewogICAgICAvLyAuLi5kb24ndCBuZWVkIGEgcm91dGVyIGlmIHRoZXJlJ3Mgbm8gcm91dGUgdG8gZ28gdG8KICAgICAgaWYgKCF0aGlzLmRvbmVMb2NhdGlvbikgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnRvUmVtb3ZlWzBdLmN1cnJlbnRSb3V0ZXIoKTsKICAgICAgfQogICAgfSwKCiAgICBwcm90aXAoKSB7CiAgICAgIHJldHVybiB0aGlzLnQoJ3Byb21wdFJlbW92ZS5wcm90aXAnLCB7IGFsdGVybmF0ZUxhYmVsIH0pOwogICAgfSwKCiAgICBkZWxldGVEaXNhYmxlZCgpIHsKICAgICAgY29uc3QgY29uZmlybUZhaWxlZCA9IHRoaXMubmVlZHNDb25maXJtICYmIHRoaXMuY29uZmlybU5hbWUgIT09IHRoaXMubmFtZVRvTWF0Y2g7CgogICAgICByZXR1cm4gdGhpcy5wcmV2ZW50RGVsZXRlIHx8IGNvbmZpcm1GYWlsZWQ7CiAgICB9LAoKICAgIC4uLm1hcFN0YXRlKCdhY3Rpb24tbWVudScsIFsnc2hvd1Byb21wdFJlbW92ZScsICd0b1JlbW92ZSddKSwKICAgIC4uLm1hcEdldHRlcnMoeyB0OiAnaTE4bi90JyB9KSwKICB9LAoKICB3YXRjaDogewogICAgc2hvd1Byb21wdFJlbW92ZShzaG93KSB7CiAgICAgIGlmIChzaG93KSB7CiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnRvUmVtb3ZlWzBdOwoKICAgICAgICBpZiAodGhpcy5jdXJyZW50Um91dGVyPy5jdXJyZW50Um91dGU/Lm5hbWUgPT09ICdjLWNsdXN0ZXItZXhwbG9yZXItdG9vbHMnICYmCiAgICAgICAgICAgIHNlbGVjdGVkLnR5cGUgPT09IENBVEFMT0cuQVBQICYmCiAgICAgICAgICAgIHNlbGVjdGVkLnNwZWM/LmNoYXJ0Py5tZXRhZGF0YT8uYW5ub3RhdGlvbnNbQ0FUQUxPR19BTk5PVEFUSU9OUy5BVVRPX0lOU1RBTExdKSB7CiAgICAgICAgICB0aGlzLmNoYXJ0c1RvUmVtb3ZlSXNBcHAgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zaG93TW9kYWwgPSB0cnVlOwoKICAgICAgICBsZXQgeyByZXNvdXJjZSB9ID0gdGhpcy4kcm91dGUucGFyYW1zOwoKICAgICAgICBpZiAodGhpcy50b1JlbW92ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICByZXNvdXJjZSA9IHNlbGVjdGVkLnR5cGU7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmhhc0N1c3RvbVJlbW92ZSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2hhc0N1c3RvbVByb21wdFJlbW92ZSddKHJlc291cmNlKTsKCiAgICAgICAgdGhpcy5yZW1vdmVDb21wb25lbnQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9pbXBvcnRDdXN0b21Qcm9tcHRSZW1vdmUnXShyZXNvdXJjZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zaG93TW9kYWwgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICAvLyBjaGVjayBmb3IgYW55IHJlc291cmNlcyB3aXRoIGEgZGVsZXRpb24gcHJldmVudGlvbiBtZXNzYWdlLAogICAgLy8gaWYgbm9uZSBmb3VuZCAoZGVsZXRlIGlzIGFsbG93ZWQpLCB0aGVuIGNoZWNrIGZvciBhbnkgcmVzb3VyY2VzIHdpdGggYSB3YXJuaW5nIG1lc3NhZ2UKICAgIHRvUmVtb3ZlKG5ldSkgewogICAgICBsZXQgbWVzc2FnZTsKICAgICAgY29uc3QgcHJldmVudERlbGV0aW9uTWVzc2FnZXMgPSBuZXUuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnByZXZlbnREZWxldGlvbk1lc3NhZ2UpOwoKICAgICAgdGhpcy5wcmV2ZW50RGVsZXRlID0gZmFsc2U7CgogICAgICBpZiAoISFwcmV2ZW50RGVsZXRpb25NZXNzYWdlcy5sZW5ndGgpIHsKICAgICAgICB0aGlzLnByZXZlbnREZWxldGUgPSB0cnVlOwogICAgICAgIG1lc3NhZ2UgPSBwcmV2ZW50RGVsZXRpb25NZXNzYWdlc1swXS5wcmV2ZW50RGVsZXRpb25NZXNzYWdlOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHdhcm5EZWxldGlvbk1lc3NhZ2VzID0gbmV1LmZpbHRlcigoaXRlbSkgPT4gaXRlbS53YXJuRGVsZXRpb25NZXNzYWdlKTsKCiAgICAgICAgaWYgKCEhd2FybkRlbGV0aW9uTWVzc2FnZXMubGVuZ3RoKSB7CiAgICAgICAgICBtZXNzYWdlID0gd2FybkRlbGV0aW9uTWVzc2FnZXNbMF0ud2FybkRlbGV0aW9uTWVzc2FnZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnZnVuY3Rpb24nICkgewogICAgICAgIHRoaXMud2FybmluZyA9IG1lc3NhZ2UodGhpcy50b1JlbW92ZSk7CiAgICAgIH0gZWxzZSBpZiAoISFtZXNzYWdlKSB7CiAgICAgICAgdGhpcy53YXJuaW5nID0gbWVzc2FnZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLndhcm5pbmcgPSAnJzsKICAgICAgfQogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHJlc291cmNlTmFtZXMsCiAgICBlc2NhcGVIdG1sLAogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMuY29uZmlybU5hbWUgPSAnJzsKICAgICAgdGhpcy5lcnJvciA9ICcnOwogICAgICB0aGlzLmNoYXJ0c0RlbGV0ZUNyZCA9IGZhbHNlOwogICAgICB0aGlzLmNoYXJ0c1RvUmVtb3ZlSXNBcHAgPSBmYWxzZTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhY3Rpb24tbWVudS90b2dnbGVQcm9tcHRSZW1vdmUnKTsKICAgIH0sCgogICAgYXN5bmMgcmVtb3ZlKGJ0bkNCKSB7CiAgICAgIGlmICh0aGlzLmRvbmVMb2NhdGlvbikgewogICAgICAgIC8vIGRvbmVMb2NhdGlvbiB3aWxsIHJlY29tcHV0ZSB0byB1bmRlZmluZWQgd2hlbiBkZWxldGUgcmVxdWVzdCBjb21wbGV0ZXMKICAgICAgICB0aGlzLmNhY2hlZERvbmVMb2NhdGlvbiA9IHsgLi4udGhpcy5kb25lTG9jYXRpb24gfTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaGFzQ3VzdG9tUmVtb3ZlICYmIHRoaXMuJHJlZnM/LmN1c3RvbVByb21wdD8ucmVtb3ZlKSB7CiAgICAgICAgbGV0IGhhbmRsZWQgPSB0aGlzLiRyZWZzLmN1c3RvbVByb21wdC5yZW1vdmUoYnRuQ0IpOwoKICAgICAgICAvLyBJZiB0aGUgcmVzcG9uc2UgaXMgYSBwcm9taXNlLCB0aGVuIHdhaXQgZm9yIHRoZSBwcm9taXNlCiAgICAgICAgaWYgKGhhbmRsZWQgJiYgaGFuZGxlZC50aGVuKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBoYW5kbGVkID0gYXdhaXQgaGFuZGxlZDsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyOwogICAgICAgICAgICBidG5DQihmYWxzZSk7CgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBJZiB0aGUgcmVtb3ZlIGZ1bmN0aW9uIGZvciB0aGUgY3VzdG9tIGRpYWxvZyBoYW5kbGVkIHRoZSByZXF1ZXN0LCBpdCBjYW4gcmV0dXJuIHRydWUgb3Igbm90IHJldHVybiBhbnl0aGluZwogICAgICAgIC8vIGlmIGl0IHJldHVybmVkIGZhbHNlLCB0aGVuIGl0IHdhbnRzIHVzIHRvIGNvbnRpbnVlIHdpdGggdGhlIGRlbGV0aW9uIGxvZ2ljIGJlbG93IC0gdGhpcyBpcyB1c2VmdWwKICAgICAgICAvLyB3aGVyZSB0aGUgY3VzdG9tIGRpYWxvZyBuZWVkcyB0byBkZWxldGUgYWRkaXRpb25hbCByZXNvdXJjZXMgLSBpdCBoYW5kbGVzIHRob3NlIGFuZCByZXRydXJucyBmYWxzZSB0byBnZXQgdXMKICAgICAgICAvLyB0byBkZWxldGUgdGhlIG1haW4gcmVzb3VyY2UKICAgICAgICBpZiAoaGFuZGxlZCA9PT0gdW5kZWZpbmVkIHx8IGhhbmRsZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3Qgc2VyaWFsUmVtb3ZlID0gdGhpcy50b1JlbW92ZS5zb21lKChyZXNvdXJjZSkgPT4gcmVzb3VyY2UucmVtb3ZlU2VyaWFsbHkpOwoKICAgICAgaWYgKHNlcmlhbFJlbW92ZSkgewogICAgICAgIHRoaXMuc2VyaWFsUmVtb3ZlKGJ0bkNCKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhcmFsbGVsUmVtb3ZlKGJ0bkNCKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHNlcmlhbFJlbW92ZShidG5DQikgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHNwb29mZWRUeXBlcyA9IHRoaXMuZ2V0U3Bvb2ZlZFR5cGVzKHRoaXMudG9SZW1vdmUpOwoKICAgICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHRoaXMudG9SZW1vdmUpIHsKICAgICAgICAgIGF3YWl0IHJlc291cmNlLnJlbW92ZSgpOwogICAgICAgIH0KCiAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU3Bvb2ZlZFR5cGVzKHNwb29mZWRUeXBlcyk7CiAgICAgICAgdGhpcy5kb25lKCk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuZXJyb3IgPSBlcnIubWVzc2FnZSB8fCBlcnI7CiAgICAgICAgYnRuQ0IoZmFsc2UpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgcGFyYWxsZWxSZW1vdmUoYnRuQ0IpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAodHlwZW9mIHRoaXMudG9SZW1vdmVbMF0uYnVsa1JlbW92ZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGF3YWl0IHRoaXMudG9SZW1vdmVbMF0uYnVsa1JlbW92ZSh0aGlzLnRvUmVtb3ZlLCB7fSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHRoaXMudG9SZW1vdmUubWFwKChyZXNvdXJjZSkgPT4gcmVzb3VyY2UucmVtb3ZlKCkpKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHNwb29mZWRUeXBlcyA9IHRoaXMuZ2V0U3Bvb2ZlZFR5cGVzKHRoaXMudG9SZW1vdmUpOwoKICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hTcG9vZmVkVHlwZXMoc3Bvb2ZlZFR5cGVzKTsKCiAgICAgICAgdGhpcy5kb25lKCk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuZXJyb3IgPSBlcnIubWVzc2FnZSB8fCBlcnI7CiAgICAgICAgYnRuQ0IoZmFsc2UpOwogICAgICB9CiAgICB9LAogICAgZG9uZSgpIHsKICAgICAgaWYgKCB0aGlzLmNhY2hlZERvbmVMb2NhdGlvbiAmJiAhaXNFbXB0eSh0aGlzLmNhY2hlZERvbmVMb2NhdGlvbikgKSB7CiAgICAgICAgdGhpcy5jdXJyZW50Um91dGVyLnB1c2godGhpcy5jYWNoZWREb25lTG9jYXRpb24pOwogICAgICB9CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0sCiAgICBnZXRTcG9vZmVkVHlwZXMocmVzb3VyY2VzKSB7CiAgICAgIGNvbnN0IHVuaXF1ZVJlc291cmNlVHlwZXMgPSB1bmlxKHRoaXMudG9SZW1vdmUubWFwKChyZXNvdXJjZSkgPT4gcmVzb3VyY2UudHlwZSkpOwoKICAgICAgcmV0dXJuIHVuaXF1ZVJlc291cmNlVHlwZXMuZmlsdGVyKHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2lzU3Bvb2ZlZCddKTsKICAgIH0sCgogICAgLy8gSWYgc3Bvb2ZlZCB3ZSBuZWVkIHRvIHJlbG9hZCB0aGUgdmFsdWVzIGFzIHRoZSBzZXJ2ZXIgY2FuJ3QgaGF2ZSB3YXRjaGVycyBmb3IgdGhlbS4KICAgIHJlZnJlc2hTcG9vZmVkVHlwZXModHlwZXMpIHsKICAgICAgY29uc3QgaW5TdG9yZSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRQcm9kdWN0J10uaW5TdG9yZTsKICAgICAgY29uc3QgcHJvbWlzZXMgPSB0eXBlcy5tYXAoKHR5cGUpID0+IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGAkeyBpblN0b3JlIH0vZmluZEFsbGAsIHsgdHlwZSwgb3B0OiB7IGZvcmNlOiB0cnVlIH0gfSwgeyByb290OiB0cnVlIH0pKTsKCiAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7CiAgICB9LAoKICAgIGFzeW5jIGNoYXJ0QWRkQ3JkVG9SZW1vdmUoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy50b1JlbW92ZVswXS5yZWxhdGVkUmVzb3VyY2VzVG9SZW1vdmUoKTsKCiAgICAgICAgaWYgKCF0aGlzLnRvUmVtb3ZlLmluY2x1ZGVzKHJlcykpIHsKICAgICAgICAgIHRoaXMudG9SZW1vdmUucHVzaChyZXMpOwogICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuY2hhcnRzRGVsZXRlQ3JkKSB7CiAgICAgICAgICB0aGlzLnRvUmVtb3ZlLnBvcChyZXMpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5lcnJvciA9IGVycjsKICAgICAgICB0aGlzLmNoYXJ0c0RlbGV0ZUNyZCA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["PromptRemove.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PromptRemove.vue","sourceRoot":"node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { get, isEmpty } from '@shell/utils/object';\nimport { escapeHtml, resourceNames } from '@shell/utils/string';\nimport { Card } from '@components/Card';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { alternateLabel } from '@shell/utils/platform';\nimport { uniq } from '@shell/utils/array';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { CATALOG } from '@shell/config/types';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport AppModal from '@shell/components/AppModal.vue';\n\nexport default {\n  name: 'PromptRemove',\n\n  components: {\n    Card, Checkbox, AsyncButton, LabeledInput, AppModal\n  },\n  props: {\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'prompt-remove'\n    }\n  },\n  data() {\n    const { resource } = this.$route.params;\n\n    return {\n      hasCustomRemove:     false,\n      randomPosition:      Math.random(),\n      confirmName:         '',\n      error:               '',\n      warning:             '',\n      preventDelete:       false,\n      removeComponent:     this.$store.getters['type-map/importCustomPromptRemove'](resource),\n      chartsToRemoveIsApp: false,\n      chartsDeleteCrd:     false,\n      showModal:           false,\n    };\n  },\n  computed: {\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    nameToMatchPosition() {\n      const visibleNames = Math.min(5, this.names.length);\n      const randomNamePos = Math.floor(this.randomPosition * visibleNames);\n\n      return randomNamePos;\n    },\n\n    nameToMatch() {\n      return this.names[this.nameToMatchPosition];\n    },\n\n    type() {\n      const types = new Set(this.toRemove.reduce((array, each) => {\n        array.push(each.type);\n\n        return array;\n      }, []));\n\n      if (types.size > 1) {\n        return this.t('generic.resource', { count: this.toRemove.length });\n      }\n\n      const schema = this.toRemove[0]?.schema;\n\n      if ( !schema ) {\n        return `resource${ this.toRemove.length === 1 ? '' : 's' }`;\n      }\n\n      return this.$store.getters['type-map/labelFor'](schema, this.toRemove.length);\n    },\n\n    selfLinks() {\n      return this.toRemove.map((resource) => {\n        return get(resource, 'links.self');\n      });\n    },\n\n    needsConfirm() {\n      const first = this.toRemove[0];\n\n      return first?.confirmRemove;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n\n    // if the current route ends with the ID of the resource being deleted, whatever page this is wont be valid after successful deletion: navigate away\n    doneLocation() {\n      // if deleting more than one resource, this is happening in list view and shouldn't redirect anywhere\n      if (this.toRemove.length > 1) {\n        return null;\n      }\n\n      if (this.toRemove[0].doneLocationRemove) {\n        return this.toRemove[0].doneLocationRemove;\n      }\n\n      const currentRoute = this.toRemove[0].currentRoute();\n      const out = {};\n      const params = { ...currentRoute.params };\n\n      if (params.id && (params.id === this.toRemove[0]?.metadata?.name || params.id === this.toRemove[0].id)) {\n        let { name = '' } = currentRoute;\n\n        const idIndex = name.indexOf('-id');\n\n        if (idIndex !== -1) {\n          name = name.slice(0, idIndex);\n        }\n\n        if (params.namespace) {\n          const namespaceIndex = name.indexOf('-namespace');\n\n          if (namespaceIndex !== -1) {\n            name = name.slice(0, namespaceIndex);\n          }\n          delete params.namespace;\n        }\n        delete params.id;\n\n        out.params = params;\n        out.name = name;\n      }\n\n      return out;\n    },\n\n    currentRouter() {\n      // ...don't need a router if there's no route to go to\n      if (!this.doneLocation) {\n        return null;\n      } else {\n        return this.toRemove[0].currentRouter();\n      }\n    },\n\n    protip() {\n      return this.t('promptRemove.protip', { alternateLabel });\n    },\n\n    deleteDisabled() {\n      const confirmFailed = this.needsConfirm && this.confirmName !== this.nameToMatch;\n\n      return this.preventDelete || confirmFailed;\n    },\n\n    ...mapState('action-menu', ['showPromptRemove', 'toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n  },\n\n  watch: {\n    showPromptRemove(show) {\n      if (show) {\n        const selected = this.toRemove[0];\n\n        if (this.currentRouter?.currentRoute?.name === 'c-cluster-explorer-tools' &&\n            selected.type === CATALOG.APP &&\n            selected.spec?.chart?.metadata?.annotations[CATALOG_ANNOTATIONS.AUTO_INSTALL]) {\n          this.chartsToRemoveIsApp = true;\n        }\n\n        this.showModal = true;\n\n        let { resource } = this.$route.params;\n\n        if (this.toRemove.length > 0) {\n          resource = selected.type;\n        }\n\n        this.hasCustomRemove = this.$store.getters['type-map/hasCustomPromptRemove'](resource);\n\n        this.removeComponent = this.$store.getters['type-map/importCustomPromptRemove'](resource);\n      } else {\n        this.showModal = false;\n      }\n    },\n\n    // check for any resources with a deletion prevention message,\n    // if none found (delete is allowed), then check for any resources with a warning message\n    toRemove(neu) {\n      let message;\n      const preventDeletionMessages = neu.filter((item) => item.preventDeletionMessage);\n\n      this.preventDelete = false;\n\n      if (!!preventDeletionMessages.length) {\n        this.preventDelete = true;\n        message = preventDeletionMessages[0].preventDeletionMessage;\n      } else {\n        const warnDeletionMessages = neu.filter((item) => item.warnDeletionMessage);\n\n        if (!!warnDeletionMessages.length) {\n          message = warnDeletionMessages[0].warnDeletionMessage;\n        }\n      }\n      if (typeof message === 'function' ) {\n        this.warning = message(this.toRemove);\n      } else if (!!message) {\n        this.warning = message;\n      } else {\n        this.warning = '';\n      }\n    }\n  },\n\n  methods: {\n    resourceNames,\n    escapeHtml,\n    close() {\n      this.confirmName = '';\n      this.error = '';\n      this.chartsDeleteCrd = false;\n      this.chartsToRemoveIsApp = false;\n      this.$store.commit('action-menu/togglePromptRemove');\n    },\n\n    async remove(btnCB) {\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        this.cachedDoneLocation = { ...this.doneLocation };\n      }\n\n      if (this.hasCustomRemove && this.$refs?.customPrompt?.remove) {\n        let handled = this.$refs.customPrompt.remove(btnCB);\n\n        // If the response is a promise, then wait for the promise\n        if (handled && handled.then) {\n          try {\n            handled = await handled;\n          } catch (err) {\n            this.error = err;\n            btnCB(false);\n\n            return;\n          }\n        }\n\n        // If the remove function for the custom dialog handled the request, it can return true or not return anything\n        // if it returned false, then it wants us to continue with the deletion logic below - this is useful\n        // where the custom dialog needs to delete additional resources - it handles those and retrurns false to get us\n        // to delete the main resource\n        if (handled === undefined || handled) {\n          return;\n        }\n      }\n      const serialRemove = this.toRemove.some((resource) => resource.removeSerially);\n\n      if (serialRemove) {\n        this.serialRemove(btnCB);\n      } else {\n        this.parallelRemove(btnCB);\n      }\n    },\n    async serialRemove(btnCB) {\n      try {\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        for (const resource of this.toRemove) {\n          await resource.remove();\n        }\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    async parallelRemove(btnCB) {\n      try {\n        if (typeof this.toRemove[0].bulkRemove !== 'undefined') {\n          await this.toRemove[0].bulkRemove(this.toRemove, {});\n        } else {\n          await Promise.all(this.toRemove.map((resource) => resource.remove()));\n        }\n\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    done() {\n      if ( this.cachedDoneLocation && !isEmpty(this.cachedDoneLocation) ) {\n        this.currentRouter.push(this.cachedDoneLocation);\n      }\n      this.close();\n    },\n    getSpoofedTypes(resources) {\n      const uniqueResourceTypes = uniq(this.toRemove.map((resource) => resource.type));\n\n      return uniqueResourceTypes.filter(this.$store.getters['type-map/isSpoofed']);\n    },\n\n    // If spoofed we need to reload the values as the server can't have watchers for them.\n    refreshSpoofedTypes(types) {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const promises = types.map((type) => this.$store.dispatch(`${ inStore }/findAll`, { type, opt: { force: true } }, { root: true }));\n\n      return Promise.all(promises);\n    },\n\n    async chartAddCrdToRemove() {\n      try {\n        const res = await this.toRemove[0].relatedResourcesToRemove();\n\n        if (!this.toRemove.includes(res)) {\n          this.toRemove.push(res);\n        } else if (!this.chartsDeleteCrd) {\n          this.toRemove.pop(res);\n        }\n      } catch (err) {\n        this.error = err;\n        this.chartsDeleteCrd = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <app-modal\n    v-if=\"showModal\"\n    custom-class=\"remove-modal\"\n    name=\"promptRemove\"\n    :width=\"400\"\n    height=\"auto\"\n    styles=\"max-height: 100vh;\"\n    @close=\"close\"\n  >\n    <Card\n      class=\"prompt-remove\"\n      :show-highlight-border=\"false\"\n    >\n      <h4\n        slot=\"title\"\n        class=\"text-default-text\"\n      >\n        {{ t('promptRemove.title') }}\n      </h4>\n      <div slot=\"body\">\n        <div class=\"mb-10\">\n          <template v-if=\"!hasCustomRemove\">\n            {{ t('promptRemove.attemptingToRemove', { type }) }} <span\n              v-clean-html=\"resourceNames(names, plusMore, t)\"\n            />\n          </template>\n\n          <template>\n            <component\n              :is=\"removeComponent\"\n              v-if=\"hasCustomRemove\"\n              ref=\"customPrompt\"\n              v-model=\"toRemove\"\n              v-bind=\"_data\"\n              :close=\"close\"\n              :needs-confirm=\"needsConfirm\"\n              :value=\"toRemove\"\n              :names=\"names\"\n              :type=\"type\"\n              :done-location=\"doneLocation\"\n              @errors=\"e => error = e\"\n              @done=\"done\"\n            />\n            <div\n              v-if=\"needsConfirm\"\n              class=\"mt-10\"\n            >\n              <span\n                v-clean-html=\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) }, true)\"\n              />\n            </div>\n          </template>\n        </div>\n        <LabeledInput\n          v-if=\"needsConfirm\"\n          id=\"confirm\"\n          v-model=\"confirmName\"\n          v-focus\n          :data-testid=\"componentTestid + '-input'\"\n          type=\"text\"\n        >\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n          <div\n            v-if=\"!needsConfirm\"\n            class=\"text-info mt-20\"\n          >\n            {{ protip }}\n          </div>\n          <Checkbox\n            v-if=\"chartsToRemoveIsApp\"\n            v-model=\"chartsDeleteCrd\"\n            label-key=\"promptRemoveApp.removeCrd\"\n            class=\"mt-10 type\"\n            @input=\"chartAddCrdToRemove\"\n          />\n        </labeledinput>\n        <template v-else>\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n        </template>\n      </div>\n      <template #actions>\n        <button\n          class=\"btn role-secondary\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n        <div class=\"spacer\" />\n        <AsyncButton\n          mode=\"delete\"\n          class=\"btn bg-error ml-10\"\n          :disabled=\"deleteDisabled\"\n          :data-testid=\"componentTestid + '-confirm-button'\"\n          @click=\"remove\"\n        />\n      </template>\n    </Card>\n  </app-modal>\n</template>\n\n<style lang='scss'>\n  .prompt-remove {\n    &.card-container {\n      box-shadow: none;\n    }\n    #confirm {\n      width: 90%;\n      margin-left: 3px;\n    }\n\n    .actions {\n      text-align: right;\n    }\n\n    .card-actions {\n      display: flex;\n\n      .spacer {\n        flex: 1;\n      }\n    }\n  }\n</style>\n"]}]}