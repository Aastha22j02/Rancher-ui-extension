{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList/index.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IGlzRW1wdHkgZnJvbSAnbG9kYXNoL2lzRW1wdHknOwoKaW1wb3J0IFJlc291cmNlTWFuYWdlciBmcm9tICdAc2hlbGwvbWl4aW5zL3Jlc291cmNlLW1hbmFnZXInOwppbXBvcnQgeyBTRVJWSUNFLCBXT1JLTE9BRF9UWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBVSV9QTFVHSU5fTEFCRUxTLCBVSV9QTFVHSU5fTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy91aXBsdWdpbnMnOwppbXBvcnQgeyBVSV9QTFVHSU5fQ0FUQUxPRyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdGFibGUtaGVhZGVycyc7CgppbXBvcnQgUmVzb3VyY2VUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9SZXNvdXJjZVRhYmxlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2F0YWxvZ0xpc3QnLAoKICBjb21wb25lbnRzOiB7IFJlc291cmNlVGFibGUgfSwKCiAgbWl4aW5zOiBbUmVzb3VyY2VNYW5hZ2VyXSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IGFjdGlvbnMgPSBbCiAgICAgIHsKICAgICAgICBhY3Rpb246ICAnc2hvd0NhdGFsb2dVbmluc3RhbGxEaWFsb2cnLAogICAgICAgIGxhYmVsOiAgIHRoaXMudCgncGx1Z2lucy51bmluc3RhbGwubGFiZWwnKSwKICAgICAgICBpY29uOiAgICAnaWNvbiBpY29uLXRyYXNoJywKICAgICAgICBlbmFibGVkOiB0cnVlLAogICAgICB9CiAgICBdOwoKICAgIHJldHVybiB7CiAgICAgIGFjdGlvbnMsCiAgICAgIGNhdGFsb2dIZWFkZXJzOiBVSV9QTFVHSU5fQ0FUQUxPRywKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoeyBhbGxSZXBvczogJ2NhdGFsb2cvcmVwb3MnIH0pLAoKICAgIG5hbWVzcGFjZWREZXBsb3ltZW50cygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oV09SS0xPQURfVFlQRVMuREVQTE9ZTUVOVCkuZmlsdGVyKChkZXApID0+IGRlcC5tZXRhZGF0YS5uYW1lc3BhY2UgPT09IFVJX1BMVUdJTl9OQU1FU1BBQ0UpOwogICAgfSwKCiAgICBuYW1lc3BhY2VkU2VydmljZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2FsbCddKFNFUlZJQ0UpLmZpbHRlcigoc3ZjKSA9PiBzdmMubWV0YWRhdGEubmFtZXNwYWNlID09PSBVSV9QTFVHSU5fTkFNRVNQQUNFKTsKICAgIH0sCgogICAgY2F0YWxvZ1Jvd3MoKSB7CiAgICAgIGNvbnN0IHJvd3MgPSBbXTsKICAgICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuYWN0aW9uczsKCiAgICAgIGlmICggIWlzRW1wdHkodGhpcy5uYW1lc3BhY2VkRGVwbG95bWVudHMpICkgewogICAgICAgIHRoaXMubmFtZXNwYWNlZERlcGxveW1lbnRzLmZvckVhY2goKGRlcGxveSkgPT4gewogICAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gW3RoaXMubmFtZXNwYWNlZFNlcnZpY2VzLCB0aGlzLmFsbFJlcG9zXTsKICAgICAgICAgIGNvbnN0IGRlcGxveU5hbWUgPSBkZXBsb3kubWV0YWRhdGE/LmxhYmVscz8uW1VJX1BMVUdJTl9MQUJFTFMuQ0FUQUxPR19JTUFHRV07CgogICAgICAgICAgaWYgKCBkZXBsb3lOYW1lICkgewogICAgICAgICAgICBjb25zdCBvdXQgPSB7CiAgICAgICAgICAgICAgbmFtZTogICAgICAgICAgICAgICAgICAgICAgIGRlcGxveU5hbWUsCiAgICAgICAgICAgICAgc3RhdGU6ICAgICAgICAgICAgICAgICAgICAgIGRlcGxveS5tZXRhZGF0YT8uc3RhdGU/Lm5hbWUsCiAgICAgICAgICAgICAgaW1hZ2U6ICAgICAgICAgICAgICAgICAgICAgIGRlcGxveS5zcGVjPy50ZW1wbGF0ZT8uc3BlYz8uY29udGFpbmVyc1swXT8uaW1hZ2UsCiAgICAgICAgICAgICAgc2VydmljZTogICAgICAgICAgICAgICAgICAgIG51bGwsCiAgICAgICAgICAgICAgcmVwbzogICAgICAgICAgICAgICAgICAgICAgIG51bGwsCiAgICAgICAgICAgICAgYXZhaWxhYmxlQWN0aW9uczogICAgICAgICAgIGFjdGlvbnMsCiAgICAgICAgICAgICAgc2hvd0NhdGFsb2dVbmluc3RhbGxEaWFsb2c6ICgpID0+IHRoaXMuJGVtaXQoJ3Nob3dDYXRhbG9nVW5pbnN0YWxsRGlhbG9nJywgb3V0KQogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdCBrZXlzID0gWydzZXJ2aWNlJywgJ3JlcG8nXTsKCiAgICAgICAgICAgIHJlc291cmNlcy5mb3JFYWNoKChyZXNvdXJjZSwgaSkgPT4gewogICAgICAgICAgICAgIG91dFtrZXlzW2ldXSA9IHJlc291cmNlPy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0ubWV0YWRhdGE/LmxhYmVscz8uW1VJX1BMVUdJTl9MQUJFTFMuQ0FUQUxPR19JTUFHRV0gPT09IGRlcGxveU5hbWUpWzBdOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHJvd3MucHVzaChvdXQpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gcm93czsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport isEmpty from 'lodash/isEmpty';\n\nimport ResourceManager from '@shell/mixins/resource-manager';\nimport { SERVICE, WORKLOAD_TYPES } from '@shell/config/types';\nimport { UI_PLUGIN_LABELS, UI_PLUGIN_NAMESPACE } from '@shell/config/uiplugins';\nimport { UI_PLUGIN_CATALOG } from '@shell/config/table-headers';\n\nimport ResourceTable from '@shell/components/ResourceTable';\n\nexport default {\n  name: 'CatalogList',\n\n  components: { ResourceTable },\n\n  mixins: [ResourceManager],\n\n  data() {\n    const actions = [\n      {\n        action:  'showCatalogUninstallDialog',\n        label:   this.t('plugins.uninstall.label'),\n        icon:    'icon icon-trash',\n        enabled: true,\n      }\n    ];\n\n    return {\n      actions,\n      catalogHeaders: UI_PLUGIN_CATALOG,\n    };\n  },\n\n  computed: {\n    ...mapGetters({ allRepos: 'catalog/repos' }),\n\n    namespacedDeployments() {\n      return this.$store.getters['management/all'](WORKLOAD_TYPES.DEPLOYMENT).filter((dep) => dep.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    },\n\n    namespacedServices() {\n      return this.$store.getters['management/all'](SERVICE).filter((svc) => svc.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    },\n\n    catalogRows() {\n      const rows = [];\n      const actions = this.actions;\n\n      if ( !isEmpty(this.namespacedDeployments) ) {\n        this.namespacedDeployments.forEach((deploy) => {\n          const resources = [this.namespacedServices, this.allRepos];\n          const deployName = deploy.metadata?.labels?.[UI_PLUGIN_LABELS.CATALOG_IMAGE];\n\n          if ( deployName ) {\n            const out = {\n              name:                       deployName,\n              state:                      deploy.metadata?.state?.name,\n              image:                      deploy.spec?.template?.spec?.containers[0]?.image,\n              service:                    null,\n              repo:                       null,\n              availableActions:           actions,\n              showCatalogUninstallDialog: () => this.$emit('showCatalogUninstallDialog', out)\n            };\n            const keys = ['service', 'repo'];\n\n            resources.forEach((resource, i) => {\n              out[keys[i]] = resource?.filter((item) => item.metadata?.labels?.[UI_PLUGIN_LABELS.CATALOG_IMAGE] === deployName)[0];\n            });\n\n            rows.push(out);\n          }\n        });\n      }\n\n      return rows;\n    }\n  },\n};\n</script>\n\n<template>\n  <div class=\"row mt-20\">\n    <div class=\"col span-12\">\n      <ResourceTable\n        :headers=\"catalogHeaders\"\n        :rows=\"catalogRows\"\n        :paging=\"true\"\n        :rows-per-page=\"10\"\n        :table-actions=\"false\"\n        key-field=\"name\"\n      >\n        <template #header-left>\n          <div>\n            <button\n              class=\"btn bg-primary mr-10\"\n              type=\"button\"\n              aria-haspopup=\"dialog\"\n              data-testid=\"extensions-catalog-load-dialog\"\n              @click=\"$emit('showCatalogLoadDialog')\"\n            >\n              {{ t('plugins.manageCatalog.imageLoad.load') }}\n            </button>\n          </div>\n        </template>\n      </ResourceTable>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.sub-row {\n  border-bottom: 1px solid var(--sortable-table-top-divider);\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n\n.col {\n  display: flex;\n  flex-direction: column;\n\n  section {\n    margin-bottom: 1.5rem;\n  }\n\n  .title {\n    margin-bottom: 0.5rem;\n  }\n}\n</style>\n"]}]}