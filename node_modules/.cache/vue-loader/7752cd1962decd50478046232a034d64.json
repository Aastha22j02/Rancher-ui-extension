{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/edit/management.cattle.io.setting.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/edit/management.cattle.io.setting.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IExhYmVsZWRTZWxlY3QgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9MYWJlbGVkU2VsZWN0JzsKaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsKaW1wb3J0IENyZWF0ZUVkaXRWaWV3IGZyb20gJ0BzaGVsbC9taXhpbnMvY3JlYXRlLWVkaXQtdmlldyc7CmltcG9ydCB7IFRleHRBcmVhQXV0b0dyb3cgfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL1RleHRBcmVhJzsKaW1wb3J0IGZvcm1SdWxlc0dlbmVyYXRvciBmcm9tICdAc2hlbGwvdXRpbHMvdmFsaWRhdG9ycy9mb3JtUnVsZXMvaW5kZXgnOwoKaW1wb3J0IHsgQUxMT1dFRF9TRVRUSU5HUywgU0VUVElORyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2V0dGluZ3MnOwppbXBvcnQgeyBSYWRpb0dyb3VwIH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9SYWRpbyc7CmltcG9ydCBGb3JtVmFsaWRhdGlvbiBmcm9tICdAc2hlbGwvbWl4aW5zL2Zvcm0tdmFsaWRhdGlvbic7CmltcG9ydCB7IHNldEJyYW5kIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9wcml2YXRlLWxhYmVsJzsKaW1wb3J0IHsga2V5QnksIG1hcFZhbHVlcyB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IGlzTG9jYWxob3N0LCBpc1NlcnZlclVybCB9IGZyb20gJ0BzaGVsbC91dGlscy92YWxpZGF0b3JzL3NldHRpbmcnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIENydVJlc291cmNlLAogICAgTGFiZWxlZElucHV0LAogICAgTGFiZWxlZFNlbGVjdCwKICAgIFJhZGlvR3JvdXAsCiAgICBUZXh0QXJlYUF1dG9Hcm93LAogICAgQmFubmVyCiAgfSwKCiAgbWl4aW5zOiBbQ3JlYXRlRWRpdFZpZXcsIEZvcm1WYWxpZGF0aW9uXSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IHQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydpMThuL3QnXTsKCiAgICByZXR1cm4gewogICAgICBzZXR0aW5nOiAgICAgICAgQUxMT1dFRF9TRVRUSU5HU1t0aGlzLnZhbHVlLmlkXSwKICAgICAgZGVzY3JpcHRpb246ICAgIHQoYGFkdmFuY2VkU2V0dGluZ3MuZGVzY3JpcHRpb25zLiR7IHRoaXMudmFsdWUuaWQgfWApLAogICAgICBlZGl0SGVscDogICAgICAgdChgYWR2YW5jZWRTZXR0aW5ncy5lZGl0SGVscC4keyB0aGlzLnZhbHVlLmlkIH1gKSwKICAgICAgZW51bU9wdGlvbnM6ICAgIFtdLAogICAgICBjYW5SZXNldDogICAgICAgZmFsc2UsCiAgICAgIGVycm9yczogICAgICAgICBbXSwKICAgICAgZnZGb3JtUnVsZVNldHM6IFtdLAogICAgfTsKICB9LAoKICBjcmVhdGVkKCkgewogICAgdGhpcy52YWx1ZS52YWx1ZSA9IHRoaXMudmFsdWUudmFsdWUgfHwgdGhpcy52YWx1ZS5kZWZhdWx0OwogICAgdGhpcy5lbnVtT3B0aW9ucyA9IHRoaXMuc2V0dGluZz8ua2luZCA9PT0gJ2VudW0nID8gdGhpcy5zZXR0aW5nLm9wdGlvbnMubWFwKChpZCkgPT4gKHsKICAgICAgbGFiZWw6IGBhZHZhbmNlZFNldHRpbmdzLmVudW0uJHsgdGhpcy52YWx1ZS5pZCB9LiR7IGlkIH1gLAogICAgICB2YWx1ZTogaWQsCiAgICB9KSkgOiBbXTsKICAgIHRoaXMuY2FuUmVzZXQgPSB0aGlzLnNldHRpbmc/LmNhblJlc2V0IHx8ICEhdGhpcy52YWx1ZS5kZWZhdWx0OwogICAgdGhpcy5mdkZvcm1SdWxlU2V0cyA9IHRoaXMuc2V0dGluZz8ucnVsZVNldCA/IFt7CiAgICAgIHBhdGg6ICAndmFsdWUnLAogICAgICBydWxlczogdGhpcy5zZXR0aW5nLnJ1bGVTZXQubWFwKCh7IG5hbWUgfSkgPT4gbmFtZSkKICAgIH1dIDogW107CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGZ2RXh0cmFSdWxlcygpIHsKICAgICAgY29uc3QgdCA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2kxOG4vdCddOwoKICAgICAgLy8gV2UgbWFwIHRoZSBzZXR0aW5nIHJ1bGVzZXRzIHRvIHVzZSB2YWx1ZXMgdG8gZGVmaW5lIHZhbGlkYXRpb24gZnJvbSBmYWN0b3J5CiAgICAgIHJldHVybiB0aGlzLnNldHRpbmc/LnJ1bGVTZXQgPyBtYXBWYWx1ZXMoCiAgICAgICAga2V5QnkodGhpcy5zZXR0aW5nLnJ1bGVTZXQsICduYW1lJyksCiAgICAgICAgLy8gVGhlIHZhbGlkYXRpb24gaXMgY3VycmllZCBhbmQgbWF5IHJlcXVpcmUgdGhlIGZhY3RvcnkgYXJndW1lbnQgZm9yIHRoZSBWYWxpZGF0b3JGYWN0b3J5CiAgICAgICAgKHsga2V5LCBuYW1lLCBmYWN0b3J5QXJnIH0pID0+IHsKICAgICAgICAgIGNvbnN0IHJ1bGUgPSBmb3JtUnVsZXNHZW5lcmF0b3IodCwga2V5ID8geyBrZXkgfSA6IHt9KVtuYW1lXTsKCiAgICAgICAgICByZXR1cm4gZmFjdG9yeUFyZyA/IHJ1bGUoZmFjdG9yeUFyZykgOiBydWxlOwogICAgICAgIH0pIDoge307CiAgICB9LAoKICAgIHNob3dMb2NhbGhvc3RXYXJuaW5nKCkgewogICAgICByZXR1cm4gaXNTZXJ2ZXJVcmwodGhpcy52YWx1ZS5pZCkgJiYgaXNMb2NhbGhvc3QodGhpcy52YWx1ZS52YWx1ZSk7CiAgICB9LAoKICAgIHZhbGlkYXRpb25QYXNzZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmZ2Rm9ybUlzVmFsaWQgJiYgdGhpcy5mdkdldFBhdGhFcnJvcnMoWyd2YWx1ZSddKS5sZW5ndGggPT09IDA7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgY29udmVydFRvU3RyaW5nKGV2ZW50KSB7CiAgICAgIHRoaXMudmFsdWUudmFsdWUgPSBgJHsgZXZlbnQudGFyZ2V0LnZhbHVlIH1gOwogICAgfSwKCiAgICBzYXZlU2V0dGluZ3MoZG9uZSkgewogICAgICBjb25zdCB0ID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi90J107CgogICAgICAvLyBWYWxpZGF0ZSB0aGUgSlNPTiBpZiB0aGUgc2V0dGluZyBpcyBhIGpzb24gdmFsdWUKICAgICAgaWYgKHRoaXMuc2V0dGluZy5raW5kID09PSAnanNvbicpIHsKICAgICAgICB0cnkgewogICAgICAgICAgSlNPTi5wYXJzZSh0aGlzLnZhbHVlLnZhbHVlKTsKICAgICAgICAgIHRoaXMuZXJyb3JzID0gW107CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgdGhpcy5lcnJvcnMgPSBbdCgnYWR2YW5jZWRTZXR0aW5ncy5lZGl0LmludmFsaWRKU09OJyldOwoKICAgICAgICAgIHJldHVybiBkb25lKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnZhbHVlPy5pZCA9PT0gU0VUVElORy5CUkFORCkgewogICAgICAgIHNldEJyYW5kKHRoaXMudmFsdWUudmFsdWUpOwogICAgICB9CgogICAgICB0aGlzLnNhdmUoZG9uZSk7CiAgICB9LAoKICAgIHVzZURlZmF1bHQoZXYpIHsKICAgICAgLy8gTG9zZSB0aGUgZm9jdXMgb24gdGhlIGJ1dHRvbiBhZnRlciBjbGljawogICAgICBpZiAoZXYgJiYgZXYuc3JjRWxlbWVudCkgewogICAgICAgIGV2LnNyY0VsZW1lbnQuYmx1cigpOwogICAgICB9CgogICAgICBpZiAoaXNTZXJ2ZXJVcmwodGhpcy52YWx1ZS5pZCkgJiYgIXRoaXMudmFsdWUuZGVmYXVsdCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy52YWx1ZS52YWx1ZSA9IHRoaXMudmFsdWUuZGVmYXVsdDsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["management.cattle.io.setting.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"management.cattle.io.setting.vue","sourceRoot":"node_modules/@rancher/shell/edit","sourcesContent":["<script>\nimport CruResource from '@shell/components/CruResource';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { Banner } from '@components/Banner';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { TextAreaAutoGrow } from '@components/Form/TextArea';\nimport formRulesGenerator from '@shell/utils/validators/formRules/index';\n\nimport { ALLOWED_SETTINGS, SETTING } from '@shell/config/settings';\nimport { RadioGroup } from '@components/Form/Radio';\nimport FormValidation from '@shell/mixins/form-validation';\nimport { setBrand } from '@shell/config/private-label';\nimport { keyBy, mapValues } from 'lodash';\nimport { isLocalhost, isServerUrl } from '@shell/utils/validators/setting';\n\nexport default {\n  components: {\n    CruResource,\n    LabeledInput,\n    LabeledSelect,\n    RadioGroup,\n    TextAreaAutoGrow,\n    Banner\n  },\n\n  mixins: [CreateEditView, FormValidation],\n\n  data() {\n    const t = this.$store.getters['i18n/t'];\n\n    return {\n      setting:        ALLOWED_SETTINGS[this.value.id],\n      description:    t(`advancedSettings.descriptions.${ this.value.id }`),\n      editHelp:       t(`advancedSettings.editHelp.${ this.value.id }`),\n      enumOptions:    [],\n      canReset:       false,\n      errors:         [],\n      fvFormRuleSets: [],\n    };\n  },\n\n  created() {\n    this.value.value = this.value.value || this.value.default;\n    this.enumOptions = this.setting?.kind === 'enum' ? this.setting.options.map((id) => ({\n      label: `advancedSettings.enum.${ this.value.id }.${ id }`,\n      value: id,\n    })) : [];\n    this.canReset = this.setting?.canReset || !!this.value.default;\n    this.fvFormRuleSets = this.setting?.ruleSet ? [{\n      path:  'value',\n      rules: this.setting.ruleSet.map(({ name }) => name)\n    }] : [];\n  },\n\n  computed: {\n    fvExtraRules() {\n      const t = this.$store.getters['i18n/t'];\n\n      // We map the setting rulesets to use values to define validation from factory\n      return this.setting?.ruleSet ? mapValues(\n        keyBy(this.setting.ruleSet, 'name'),\n        // The validation is curried and may require the factory argument for the ValidatorFactory\n        ({ key, name, factoryArg }) => {\n          const rule = formRulesGenerator(t, key ? { key } : {})[name];\n\n          return factoryArg ? rule(factoryArg) : rule;\n        }) : {};\n    },\n\n    showLocalhostWarning() {\n      return isServerUrl(this.value.id) && isLocalhost(this.value.value);\n    },\n\n    validationPassed() {\n      return this.fvFormIsValid && this.fvGetPathErrors(['value']).length === 0;\n    }\n  },\n\n  methods: {\n    convertToString(event) {\n      this.value.value = `${ event.target.value }`;\n    },\n\n    saveSettings(done) {\n      const t = this.$store.getters['i18n/t'];\n\n      // Validate the JSON if the setting is a json value\n      if (this.setting.kind === 'json') {\n        try {\n          JSON.parse(this.value.value);\n          this.errors = [];\n        } catch (e) {\n          this.errors = [t('advancedSettings.edit.invalidJSON')];\n\n          return done(false);\n        }\n      }\n\n      if (this.value?.id === SETTING.BRAND) {\n        setBrand(this.value.value);\n      }\n\n      this.save(done);\n    },\n\n    useDefault(ev) {\n      // Lose the focus on the button after click\n      if (ev && ev.srcElement) {\n        ev.srcElement.blur();\n      }\n\n      if (isServerUrl(this.value.id) && !this.value.default) {\n        return;\n      }\n\n      this.value.value = this.value.default;\n    }\n  }\n};\n</script>\n\n<template>\n  <CruResource\n    class=\"route\"\n    :done-route=\"'c-cluster-product-resource'\"\n    :errors=\"fvUnreportedValidationErrors\"\n    :mode=\"mode\"\n    :resource=\"value\"\n    :subtypes=\"[]\"\n    :can-yaml=\"false\"\n    :validation-passed=\"validationPassed\"\n    @error=\"e=>errors = e\"\n    @finish=\"saveSettings\"\n    @cancel=\"done\"\n  >\n    <h4>{{ description }}</h4>\n\n    <h5\n      v-if=\"editHelp\"\n      v-clean-html=\"editHelp\"\n      class=\"edit-help\"\n    />\n\n    <div class=\"edit-change mt-20\">\n      <h5 v-t=\"'advancedSettings.edit.changeSetting'\" />\n      <button\n        data-testid=\"advanced_settings_use_default\"\n        :disabled=\"!canReset\"\n        type=\"button\"\n        class=\"btn role-primary\"\n        @click=\"useDefault\"\n      >\n        {{ t('advancedSettings.edit.useDefault') }}\n      </button>\n    </div>\n\n    <Banner\n      v-if=\"showLocalhostWarning\"\n      color=\"warning\"\n      :label=\"t('validation.setting.serverUrl.localhost')\"\n    />\n\n    <Banner\n      v-for=\"(err, i) in fvGetPathErrors(['value'])\"\n      :key=\"i\"\n      color=\"error\"\n      :label=\"err\"\n    />\n\n    <div class=\"mt-20\">\n      <div v-if=\"setting.kind === 'enum'\">\n        <LabeledSelect\n          v-model=\"value.value\"\n          data-testid=\"input-setting-enum\"\n          :label=\"t('advancedSettings.edit.value')\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :localized-label=\"true\"\n          :mode=\"mode\"\n          :required=\"true\"\n          :options=\"enumOptions\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'boolean'\">\n        <RadioGroup\n          v-model=\"value.value\"\n          data-testid=\"input-setting-boolean\"\n          name=\"settings_value\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :labels=\"[t('advancedSettings.edit.trueOption'), t('advancedSettings.edit.falseOption')]\"\n          :options=\"['true', 'false']\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'multiline' || setting.kind === 'json'\">\n        <TextAreaAutoGrow\n          v-model=\"value.value\"\n          data-testid=\"input-setting-json\"\n          :required=\"true\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :min-height=\"254\"\n        />\n      </div>\n      <div v-else-if=\"setting.kind === 'integer'\">\n        <LabeledInput\n          v-model=\"value.value\"\n          data-testid=\"input-setting-integer\"\n          :label=\"t('advancedSettings.edit.value')\"\n          :mode=\"mode\"\n          type=\"number\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :required=\"true\"\n        />\n      </div>\n      <div v-else>\n        <LabeledInput\n          v-model=\"value.value\"\n          data-testid=\"input-setting-generic\"\n          :localized-label=\"true\"\n          :required=\"true\"\n          :mode=\"mode\"\n          :rules=\"fvGetAndReportPathRules('value')\"\n          :label=\"t('advancedSettings.edit.value')\"\n        />\n      </div>\n    </div>\n  </CruResource>\n</template>\n\n<style lang=\"scss\" scoped>\n  .edit-change {\n    align-items: center;\n    display: flex;\n\n    > h5 {\n      flex: 1;\n    }\n  }\n\n  ::v-deep .edit-help code {\n    padding: 1px 5px;\n  }\n</style>\n"]}]}