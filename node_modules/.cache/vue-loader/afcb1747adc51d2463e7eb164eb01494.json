{"remainingRequest":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/chart/istio.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@rancher/shell/chart/istio.vue","mtime":1725271280091},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/susecon-2024-ext-demo/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnOwppbXBvcnQganN5YW1sIGZyb20gJ2pzLXlhbWwnOwppbXBvcnQgeyBDaGVja2JveCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vQ2hlY2tib3gnOwppbXBvcnQgWWFtbEVkaXRvciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9ZYW1sRWRpdG9yJzsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgRmlsZVNlbGVjdG9yIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vRmlsZVNlbGVjdG9yJzsKaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsKCmNvbnN0IGRlZmF1bHRPdmVybGF5RmlsZSA9IGAjYXBpVmVyc2lvbjogaW5zdGFsbC5pc3Rpby5pby92MWFscGhhMQoja2luZDogSXN0aW9PcGVyYXRvcgojc3BlYzoKIyAgY29tcG9uZW50czoKIyAgICBpbmdyZXNzR2F0ZXdheXM6CiMgICAgLSBlbmFibGVkOiB0cnVlCiMgICAgICBuYW1lOiBpc3Rpby1pbmdyZXNzZ2F0ZXdheQojICAgIC0gZW5hYmxlZDogdHJ1ZQojICAgICAgazhzOgojICAgICAgICByZXNvdXJjZXM6CiMgICAgICAgICAgcmVxdWVzdHM6CiMgICAgICAgICAgICBjcHU6IDIwMG0KIyAgICAgICAgc2VydmljZToKIyAgICAgICAgICBwb3J0czoKIyAgICAgICAgICAtIG5hbWU6IHRjcC1jaXRhZGVsLWdycGMtdGxzCiMgICAgICAgICAgICBwb3J0OiA4MDYwCiMgICAgICAgICAgICB0YXJnZXRQb3J0OiA4MDYwCiMgICAgICAgICAgLSBuYW1lOiB0Y3AtZG5zCiMgICAgICAgICAgICBwb3J0OiA1MzUzCiMgICAgICAgIHNlcnZpY2VBbm5vdGF0aW9uczoKIyAgICAgICAgICBjbG91ZC5nb29nbGUuY29tL2xvYWQtYmFsYW5jZXItdHlwZTogaW50ZXJuYWwKIyAgICAgIG5hbWU6IGlsYi1nYXRld2F5CiMgICAgICBuYW1lc3BhY2U6IHVzZXItaW5ncmVzc2dhdGV3YXktbnMKIyAgICAtIGVuYWJsZWQ6IHRydWUKIyAgICAgIGs4czoKIyAgICAgICAgcmVzb3VyY2VzOgojICAgICAgICAgIHJlcXVlc3RzOgojICAgICAgICAgICAgY3B1OiAyMDBtCiMgICAgICAgIHNlcnZpY2U6CiMgICAgICAgICAgcG9ydHM6CiMgICAgICAgICAgLSBuYW1lOiB0Y3AtY2l0YWRlbC1ncnBjLXRscwojICAgICAgICAgICAgcG9ydDogODA2MAojICAgICAgICAgICAgdGFyZ2V0UG9ydDogODA2MAojICAgICAgICAgIC0gbmFtZTogdGNwLWRucwojICAgICAgICAgICAgcG9ydDogNTM1MwojICAgICAgICBzZXJ2aWNlQW5ub3RhdGlvbnM6CiMgICAgICAgICAgY2xvdWQuZ29vZ2xlLmNvbS9sb2FkLWJhbGFuY2VyLXR5cGU6IGludGVybmFsCiMgICAgICBuYW1lOiBvdGhlci1nYXRld2F5CiMgICAgICBuYW1lc3BhY2U6IGlzdGlvLXN5c3RlbQpgOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIENoZWNrYm94LAogICAgRmlsZVNlbGVjdG9yLAogICAgWWFtbEVkaXRvciwKICAgIEJhbm5lcgogIH0sCgogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiAgICBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgbGV0IG92ZXJsYXlGaWxlID0gdGhpcy52YWx1ZS5vdmVybGF5RmlsZTsKCiAgICBpZiAoIW92ZXJsYXlGaWxlPy5sZW5ndGgpIHsKICAgICAgb3ZlcmxheUZpbGUgPSBkZWZhdWx0T3ZlcmxheUZpbGU7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgb3ZlcmxheUZpbGUsCiAgICAgIHNob3dLaWFsaUJhbm5lcjogdGhpcy52YWx1ZS5raWFsaT8uZW5hYmxlZAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10sIHsgdDogJ2kxOG4vdCcgfSksCiAgICB2YWx1ZXNZYW1sOiB7CiAgICAgIGdldCgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgeWFtbCA9IGpzeWFtbC5kdW1wKHRoaXMudmFsdWUpOwoKICAgICAgICAgIHJldHVybiB5YW1sOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0OiBkZWJvdW5jZShmdW5jdGlvbihuZXUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3Qgb2JqID0ganN5YW1sLmxvYWQobmV1KTsKCiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMudmFsdWUsIG9iaik7CiAgICAgICAgfSBjYXRjaCAoZSkgewoKICAgICAgICB9CiAgICAgIH0sIDUwMCkKICAgIH0sCiAgfSwKCiAgbWV0aG9kczogewogICAgdXBkYXRlKCkgewogICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHRoaXMudmFsdWUpOwogICAgfSwKCiAgICB2YWx1ZXNDaGFuZ2VkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAganN5YW1sLmxvYWQodmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSA9PT0gZGVmYXVsdE92ZXJsYXlGaWxlKSB7CiAgICAgICAgICB2YWx1ZSA9ICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm92ZXJsYXlGaWxlID0gdmFsdWU7CiAgICAgICAgfQogICAgICAgIHRoaXMudmFsdWUub3ZlcmxheUZpbGUgPSB2YWx1ZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICB9CiAgICB9LAoKICAgIG9uRmlsZVNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuJHJlZnNbJ3lhbWwtZWRpdG9yJ10udXBkYXRlVmFsdWUodmFsdWUpOwogICAgfSwKCiAgICBjaGFuZ2VLaWFsaSh2YWx1ZSkgewogICAgICBpZiAodmFsdWUgJiYgdGhpcy52YWx1ZS5waWxvdCkgewogICAgICAgIHRoaXMudmFsdWUucGlsb3QuZW5hYmxlZCA9IHRydWU7CiAgICAgICAgdGhpcy5zaG93S2lhbGlCYW5uZXIgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCF2YWx1ZSkgewogICAgICAgIHRoaXMuc2hvd0tpYWxpQmFubmVyID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["istio.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"istio.vue","sourceRoot":"node_modules/@rancher/shell/chart","sourcesContent":["<script>\nimport debounce from 'lodash/debounce';\nimport jsyaml from 'js-yaml';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport YamlEditor from '@shell/components/YamlEditor';\nimport { mapGetters } from 'vuex';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport { Banner } from '@components/Banner';\n\nconst defaultOverlayFile = `#apiVersion: install.istio.io/v1alpha1\n#kind: IstioOperator\n#spec:\n#  components:\n#    ingressGateways:\n#    - enabled: true\n#      name: istio-ingressgateway\n#    - enabled: true\n#      k8s:\n#        resources:\n#          requests:\n#            cpu: 200m\n#        service:\n#          ports:\n#          - name: tcp-citadel-grpc-tls\n#            port: 8060\n#            targetPort: 8060\n#          - name: tcp-dns\n#            port: 5353\n#        serviceAnnotations:\n#          cloud.google.com/load-balancer-type: internal\n#      name: ilb-gateway\n#      namespace: user-ingressgateway-ns\n#    - enabled: true\n#      k8s:\n#        resources:\n#          requests:\n#            cpu: 200m\n#        service:\n#          ports:\n#          - name: tcp-citadel-grpc-tls\n#            port: 8060\n#            targetPort: 8060\n#          - name: tcp-dns\n#            port: 5353\n#        serviceAnnotations:\n#          cloud.google.com/load-balancer-type: internal\n#      name: other-gateway\n#      namespace: istio-system\n`;\n\nexport default {\n  components: {\n    Checkbox,\n    FileSelector,\n    YamlEditor,\n    Banner\n  },\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  data() {\n    let overlayFile = this.value.overlayFile;\n\n    if (!overlayFile?.length) {\n      overlayFile = defaultOverlayFile;\n    }\n\n    return {\n      overlayFile,\n      showKialiBanner: this.value.kiali?.enabled\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster'], { t: 'i18n/t' }),\n    valuesYaml: {\n      get() {\n        try {\n          const yaml = jsyaml.dump(this.value);\n\n          return yaml;\n        } catch (e) {\n          return null;\n        }\n      },\n      set: debounce(function(neu) {\n        try {\n          const obj = jsyaml.load(neu);\n\n          Object.assign(this.value, obj);\n        } catch (e) {\n\n        }\n      }, 500)\n    },\n  },\n\n  methods: {\n    update() {\n      this.$emit('input', this.value);\n    },\n\n    valuesChanged(value) {\n      try {\n        jsyaml.load(value);\n        if (value === defaultOverlayFile) {\n          value = '';\n        } else {\n          this.overlayFile = value;\n        }\n        this.value.overlayFile = value;\n      } catch (e) {\n      }\n    },\n\n    onFileSelected(value) {\n      this.$refs['yaml-editor'].updateValue(value);\n    },\n\n    changeKiali(value) {\n      if (value && this.value.pilot) {\n        this.value.pilot.enabled = true;\n        this.showKialiBanner = true;\n      } else if (!value) {\n        this.showKialiBanner = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <h3>\n      {{ t('istio.titles.components') }}\n    </h3>\n    <div class=\"row mb-10\">\n      <div\n        v-if=\"value.cni\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.cni.enabled\"\n          :label=\"t('istio.cni')\"\n          @input=\"update\"\n        />\n      </div>\n      <div\n        v-if=\"value.ingressGateways\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.ingressGateways.enabled\"\n          :label=\"t('istio.ingressGateway')\"\n        />\n      </div>\n      <div\n        v-if=\"value.egressGateways\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.egressGateways.enabled\"\n          :label=\"t('istio.egressGateway')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-10\">\n      <div\n        v-if=\"value.pilot\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.pilot.enabled\"\n          :label=\"t('istio.pilot')\"\n          :disabled=\"value.kiali && value.kiali.enabled\"\n        />\n      </div>\n      <div\n        v-if=\"value.policy\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.policy.enabled\"\n          :label=\"t('istio.policy')\"\n        />\n      </div>\n      <div\n        v-if=\"value.telemetry\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.telemetry.enabled\"\n          :label=\"t('istio.telemetry')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-20\">\n      <div\n        v-if=\"value.kiali\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.kiali.enabled\"\n          :label=\"t('istio.kiali')\"\n          @input=\"changeKiali\"\n        />\n      </div>\n      <div\n        v-if=\"value.tracing\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.tracing.enabled\"\n          :label=\"t('istio.tracing')\"\n        />\n      </div>\n      <div class=\"col span-4\" />\n    </div>\n    <div\n      v-if=\"showKialiBanner\"\n      class=\"row\"\n    >\n      <div class=\"col span-12\">\n        <Banner color=\"info\">\n          <span\n            v-clean-html=\"t('istio.pilotRequired', {}, true)\"\n          />\n        </Banner>\n      </div>\n    </div>\n\n    <h3>{{ t('istio.customOverlayFile.label') }}</h3>\n    <div class=\"custom-overlay\">\n      <Banner color=\"info\">\n        <span\n          v-clean-html=\"t('istio.customOverlayFile.tip', {}, true)\"\n        />\n      </Banner>\n      <YamlEditor\n        ref=\"yaml-editor\"\n        class=\"yaml-editor mb-10\"\n        :value=\"overlayFile\"\n        @onInput=\"valuesChanged\"\n      />\n      <FileSelector\n        class=\"role-primary  btn-sm\"\n        :label=\"t('generic.readFromFile')\"\n        @selected=\"onFileSelected\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang='scss'>\n  $yaml-height: 200px;\n\n  .custom-overlay {\n    &>DIV{\n      color: var(--input-label);\n      &>*{\n        padding: 3px;\n      }\n    }\n\n    & .yaml-editor{\n      flex: 1;\n      min-height: $yaml-height;\n      & .code-mirror .CodeMirror {\n        position: initial;\n        height: auto;\n        min-height: $yaml-height;\n      }\n    }\n  }\n</style>\n"]}]}