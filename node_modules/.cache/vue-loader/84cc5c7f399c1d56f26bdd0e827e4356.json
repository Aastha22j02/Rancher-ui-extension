{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/detail/fleet.cattle.io.gitrepo.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/detail/fleet.cattle.io.gitrepo.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgUmVzb3VyY2VUYWJzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vUmVzb3VyY2VUYWJzJzsKaW1wb3J0IEZsZWV0U3VtbWFyeSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mbGVldC9GbGVldFN1bW1hcnknOwppbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdAY29tcG9uZW50cy9CYW5uZXInOwppbXBvcnQgRmxlZXRSZXNvdXJjZXMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZmxlZXQvRmxlZXRSZXNvdXJjZXMnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgeyBGTEVFVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBpc0hhcnZlc3RlckNsdXN0ZXIgfSBmcm9tICdAc2hlbGwvdXRpbHMvY2x1c3Rlcic7CmltcG9ydCBGbGVldEJ1bmRsZXMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZmxlZXQvRmxlZXRCdW5kbGVzLnZ1ZSc7CmltcG9ydCB7IHJlc291cmNlQ291bnRzIH0gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvUmVzb3VyY2VTdW1tYXJ5LnZ1ZSc7CmltcG9ydCB7IGNoZWNrU2NoZW1hc0ZvckZpbmRBbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2F1dGgnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEZXRhaWxHaXRSZXBvJywKCiAgY29tcG9uZW50czogewogICAgTG9hZGluZywKICAgIEZsZWV0UmVzb3VyY2VzLAogICAgRmxlZXRTdW1tYXJ5LAogICAgQmFubmVyLAogICAgUmVzb3VyY2VUYWJzLAogICAgVGFiLAogICAgRmxlZXRCdW5kbGVzLAogIH0sCgogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiAgICAgT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFsbEZsZWV0Q2x1c3RlcnM6ICAgICBbXSwKICAgICAgYWxsQnVuZGxlczogICAgICAgICAgIFtdLAogICAgICBhbGxCdW5kbGVEZXBsb3ltZW50czogW10sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGdpdFJlcG9IYXNDbHVzdGVycygpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWU/LmNsdXN0ZXJSZXNvdXJjZVN0YXR1cz8ubGVuZ3RoOwogICAgfSwKICAgIGNsdXN0ZXJTY2hlbWEoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKEZMRUVULkNMVVNURVIpOwogICAgfSwKICAgIGhhcnZlc3RlckNsdXN0ZXJzKCkgewogICAgICBjb25zdCBoYXJ2ZXN0ZXIgPSB7fTsKCiAgICAgIHRoaXMuYWxsRmxlZXRDbHVzdGVycy5mb3JFYWNoKChjKSA9PiB7CiAgICAgICAgaWYgKGlzSGFydmVzdGVyQ2x1c3RlcihjKSkgewogICAgICAgICAgaGFydmVzdGVyW2MubWV0YWRhdGEubmFtZV0gPSBjOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICByZXR1cm4gaGFydmVzdGVyOwogICAgfSwKICAgIGJ1bmRsZUNvdW50cygpIHsKICAgICAgcmV0dXJuIHJlc291cmNlQ291bnRzKHRoaXMuJHN0b3JlLCBGTEVFVC5CVU5ETEUpOwogICAgfSwKICAgIGJ1bmRsZXMoKSB7CiAgICAgIGNvbnN0IGhhcnZlc3RlciA9IHRoaXMuaGFydmVzdGVyQ2x1c3RlcnM7CgogICAgICBjb25zdCBidW5kbGVzID0gdGhpcy5hbGxCdW5kbGVzLmZpbHRlcigoYnVuZGxlKSA9PiB7CiAgICAgICAgY29uc3QgdGFyZ2V0cyA9IGJ1bmRsZS5zcGVjPy50YXJnZXRzIHx8IFtdOwoKICAgICAgICAvLyBGaWx0ZXIgb3V0IGFueSBidW5kbGUgdGhhdCBoYXMgb25lIHRhcmdldCB3aG9zZSBjbHVzdGVyIGlzIGEgaGFydmVzdGVyIGNsdXN0ZXIKICAgICAgICBpZiAodGFyZ2V0cy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgIHJldHVybiAhaGFydmVzdGVyW3RhcmdldHNbMF0uY2x1c3Rlck5hbWVdOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGJ1bmRsZXM7CiAgICB9LAogIH0sCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBjb25zdCBhbGxEaXNwYXRjaGVzID0gYXdhaXQgY2hlY2tTY2hlbWFzRm9yRmluZEFsbEhhc2goewogICAgICBhbGxCdW5kbGVzOiB7CiAgICAgICAgaW5TdG9yZVR5cGU6ICdtYW5hZ2VtZW50JywKICAgICAgICB0eXBlOiAgICAgICAgRkxFRVQuQlVORExFCiAgICAgIH0sCgogICAgICBhbGxCdW5kbGVEZXBsb3ltZW50czogewogICAgICAgIGluU3RvcmVUeXBlOiAnbWFuYWdlbWVudCcsCiAgICAgICAgdHlwZTogICAgICAgIEZMRUVULkJVTkRMRV9ERVBMT1lNRU5UCiAgICAgIH0sCgogICAgICBhbGxGbGVldENsdXN0ZXJzOiB7CiAgICAgICAgaW5TdG9yZVR5cGU6ICdtYW5hZ2VtZW50JywKICAgICAgICB0eXBlOiAgICAgICAgRkxFRVQuQ0xVU1RFUgogICAgICB9LAogICAgICBjbHVzdGVyR3JvdXBzOiB7CiAgICAgICAgaW5TdG9yZVR5cGU6ICdtYW5hZ2VtZW50JywKICAgICAgICB0eXBlOiAgICAgICAgRkxFRVQuQ0xVU1RFUl9HUk9VUAogICAgICB9CiAgICB9LCB0aGlzLiRzdG9yZSk7CgogICAgdGhpcy5hbGxCdW5kbGVEZXBsb3ltZW50cyA9IGFsbERpc3BhdGNoZXMuYWxsQnVuZGxlRGVwbG95bWVudHMgfHwgW107CiAgICB0aGlzLmFsbEJ1bmRsZXMgPSBhbGxEaXNwYXRjaGVzLmFsbEJ1bmRsZXMgfHwgW107CiAgICB0aGlzLmFsbEZsZWV0Q2x1c3RlcnMgPSBhbGxEaXNwYXRjaGVzLmFsbEZsZWV0Q2x1c3RlcnMgfHwgW107CiAgfSwKCn07Cg=="},{"version":3,"sources":["fleet.cattle.io.gitrepo.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA","file":"fleet.cattle.io.gitrepo.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport Loading from '@shell/components/Loading';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport FleetSummary from '@shell/components/fleet/FleetSummary';\nimport { Banner } from '@components/Banner';\nimport FleetResources from '@shell/components/fleet/FleetResources';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport { FLEET } from '@shell/config/types';\nimport { isHarvesterCluster } from '@shell/utils/cluster';\nimport FleetBundles from '@shell/components/fleet/FleetBundles.vue';\nimport { resourceCounts } from '@shell/components/ResourceSummary.vue';\nimport { checkSchemasForFindAllHash } from '@shell/utils/auth';\n\nexport default {\n  name: 'DetailGitRepo',\n\n  components: {\n    Loading,\n    FleetResources,\n    FleetSummary,\n    Banner,\n    ResourceTabs,\n    Tab,\n    FleetBundles,\n  },\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  data() {\n    return {\n      allFleetClusters:     [],\n      allBundles:           [],\n      allBundleDeployments: [],\n    };\n  },\n  computed: {\n    gitRepoHasClusters() {\n      return this.value?.clusterResourceStatus?.length;\n    },\n    clusterSchema() {\n      return this.$store.getters['management/schemaFor'](FLEET.CLUSTER);\n    },\n    harvesterClusters() {\n      const harvester = {};\n\n      this.allFleetClusters.forEach((c) => {\n        if (isHarvesterCluster(c)) {\n          harvester[c.metadata.name] = c;\n        }\n      });\n\n      return harvester;\n    },\n    bundleCounts() {\n      return resourceCounts(this.$store, FLEET.BUNDLE);\n    },\n    bundles() {\n      const harvester = this.harvesterClusters;\n\n      const bundles = this.allBundles.filter((bundle) => {\n        const targets = bundle.spec?.targets || [];\n\n        // Filter out any bundle that has one target whose cluster is a harvester cluster\n        if (targets.length === 1) {\n          return !harvester[targets[0].clusterName];\n        }\n\n        return true;\n      });\n\n      return bundles;\n    },\n  },\n  async fetch() {\n    const allDispatches = await checkSchemasForFindAllHash({\n      allBundles: {\n        inStoreType: 'management',\n        type:        FLEET.BUNDLE\n      },\n\n      allBundleDeployments: {\n        inStoreType: 'management',\n        type:        FLEET.BUNDLE_DEPLOYMENT\n      },\n\n      allFleetClusters: {\n        inStoreType: 'management',\n        type:        FLEET.CLUSTER\n      },\n      clusterGroups: {\n        inStoreType: 'management',\n        type:        FLEET.CLUSTER_GROUP\n      }\n    }, this.$store);\n\n    this.allBundleDeployments = allDispatches.allBundleDeployments || [];\n    this.allBundles = allDispatches.allBundles || [];\n    this.allFleetClusters = allDispatches.allFleetClusters || [];\n  },\n\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div\n    v-else\n    class=\"mt-20\"\n  >\n    <FleetSummary\n      v-if=\"gitRepoHasClusters\"\n      :value=\"value\"\n      :bundles=\"bundles\"\n      class=\"mb-20\"\n    />\n    <Banner\n      v-else\n      color=\"info\"\n      class=\"mb-20\"\n    >\n      {{ t('fleet.fleetSummary.noClustersGitRepo') }}\n    </Banner>\n    <ResourceTabs\n      v-model=\"value\"\n      mode=\"view\"\n      class=\"mt-20\"\n      :need-related=\"false\"\n    >\n      <Tab\n        v-if=\"!!allBundles.length\"\n        label=\"Bundles\"\n        name=\"bundles\"\n        :weight=\"30\"\n      >\n        <FleetBundles :value=\"value\" />\n      </Tab>\n      <Tab\n        label=\"Resources\"\n        name=\"resources\"\n        :weight=\"20\"\n      >\n        <FleetResources :value=\"value\" />\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n"]}]}