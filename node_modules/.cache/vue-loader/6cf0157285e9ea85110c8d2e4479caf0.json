{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/components/fleet/FleetSummary.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/components/fleet/FleetSummary.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFNUQVRFUywgU1RBVEVTX0VOVU0gfSBmcm9tICdAc2hlbGwvcGx1Z2lucy9kYXNoYm9hcmQtc3RvcmUvcmVzb3VyY2UtY2xhc3MnOwppbXBvcnQgRmxlZXRTdGF0dXMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZmxlZXQvRmxlZXRTdGF0dXMnOwoKY29uc3QgZ2V0UmVzb3VyY2VEZWZhdWx0U3RhdGUgPSAobGFiZWxHZXR0ZXIsIHN0YXRlS2V5KSA9PiB7CiAgcmV0dXJuIHsKICAgIHJlYWR5OiB7CiAgICAgIGNvdW50OiAgMCwKICAgICAgY29sb3I6ICBTVEFURVNbU1RBVEVTX0VOVU0uUkVBRFldLmNvbG9yLAogICAgICBsYWJlbDogIGxhYmVsR2V0dGVyKGAkeyBzdGF0ZUtleSB9LiR7IFNUQVRFU19FTlVNLlJFQURZIH1gLCBudWxsLCBTVEFURVNbU1RBVEVTX0VOVU0uUkVBRFldLmxhYmVsICksCiAgICAgIHN0YXR1czogU1RBVEVTX0VOVU0uUkVBRFkKICAgIH0sCiAgICBpbmZvOiB7CiAgICAgIGNvdW50OiAgMCwKICAgICAgY29sb3I6ICBTVEFURVNbU1RBVEVTX0VOVU0uSU5GT10uY29sb3IsCiAgICAgIGxhYmVsOiAgbGFiZWxHZXR0ZXIoYCR7IHN0YXRlS2V5IH0uJHsgU1RBVEVTX0VOVU0uSU5GTyB9YCwgbnVsbCwgU1RBVEVTW1NUQVRFU19FTlVNLklORk9dLmxhYmVsICksCiAgICAgIHN0YXR1czogU1RBVEVTX0VOVU0uSU5GTwogICAgfSwKICAgIHdhcm5pbmc6IHsKICAgICAgY291bnQ6ICAwLAogICAgICBjb2xvcjogIFNUQVRFU1tTVEFURVNfRU5VTS5XQVJOSU5HXS5jb2xvciwKICAgICAgbGFiZWw6ICBsYWJlbEdldHRlcihgJHsgc3RhdGVLZXkgfS4keyBTVEFURVNfRU5VTS5XQVJOSU5HIH1gLCBudWxsLCBTVEFURVNbU1RBVEVTX0VOVU0uV0FSTklOR10ubGFiZWwgKSwKICAgICAgc3RhdHVzOiBTVEFURVNfRU5VTS5XQVJOSU5HCiAgICB9LAogICAgbm90cmVhZHk6IHsKICAgICAgY291bnQ6ICAwLAogICAgICBjb2xvcjogIFNUQVRFU1tTVEFURVNfRU5VTS5OT1RfUkVBRFldLmNvbG9yLAogICAgICBsYWJlbDogIGxhYmVsR2V0dGVyKGAkeyBzdGF0ZUtleSB9LiR7IFNUQVRFU19FTlVNLk5PVF9SRUFEWSB9YCwgbnVsbCwgU1RBVEVTW1NUQVRFU19FTlVNLk5PVF9SRUFEWV0ubGFiZWwgKSwKICAgICAgc3RhdHVzOiBTVEFURVNfRU5VTS5OT1RfUkVBRFkKICAgIH0sCiAgICBlcnJvcjogewogICAgICBjb3VudDogIDAsCiAgICAgIGNvbG9yOiAgU1RBVEVTW1NUQVRFU19FTlVNLkVSUk9SXS5jb2xvciwKICAgICAgbGFiZWw6ICBsYWJlbEdldHRlcihgJHsgc3RhdGVLZXkgfS4keyBTVEFURVNfRU5VTS5FUlJPUiB9YCwgbnVsbCwgU1RBVEVTW1NUQVRFU19FTlVNLkVSUk9SXS5sYWJlbCApLAogICAgICBzdGF0dXM6IFNUQVRFU19FTlVNLkVSUk9SCiAgICB9LAogICAgZXJyYXBwbGllZDogewogICAgICBjb3VudDogIDAsCiAgICAgIGNvbG9yOiAgU1RBVEVTW1NUQVRFU19FTlVNLkVSUl9BUFBMSUVEXS5jb2xvciwKICAgICAgbGFiZWw6ICBsYWJlbEdldHRlcihgJHsgc3RhdGVLZXkgfS4keyBTVEFURVNfRU5VTS5FUlJfQVBQTElFRCB9YCwgbnVsbCwgU1RBVEVTW1NUQVRFU19FTlVNLkVSUl9BUFBMSUVEXS5sYWJlbCApLAogICAgICBzdGF0dXM6IFNUQVRFU19FTlVNLkVSUl9BUFBMSUVELAogICAgfSwKICAgIHdhaXRhcHBsaWVkOiB7CiAgICAgIGNvdW50OiAgMCwKICAgICAgY29sb3I6ICBTVEFURVNbU1RBVEVTX0VOVU0uV0FJVF9BUFBMSUVEXS5jb2xvciwKICAgICAgbGFiZWw6ICBsYWJlbEdldHRlcihgJHsgc3RhdGVLZXkgfS4keyBTVEFURVNfRU5VTS5XQUlUX0FQUExJRUQgfWAsIG51bGwsIFNUQVRFU1tTVEFURVNfRU5VTS5XQUlUX0FQUExJRURdLmxhYmVsICksCiAgICAgIHN0YXR1czogU1RBVEVTX0VOVU0uV0FJVF9BUFBMSUVECiAgICB9LAogICAgdW5rbm93bjogewogICAgICBjb3VudDogIDAsCiAgICAgIGNvbG9yOiAgU1RBVEVTW1NUQVRFU19FTlVNLlVOS05PV05dLmNvbG9yLAogICAgICBsYWJlbDogIGxhYmVsR2V0dGVyKGAkeyBzdGF0ZUtleSB9LiR7IFNUQVRFU19FTlVNLlVOS05PV04gfWAsIG51bGwsIFNUQVRFU1tTVEFURVNfRU5VTS5VTktOT1dOXS5sYWJlbCApLAogICAgICBzdGF0dXM6IFNUQVRFU19FTlVNLlVOS05PV04KICAgIH0KICB9Owp9OwoKZXhwb3J0IGRlZmF1bHQgewoKICBuYW1lOiAnRmxlZXRTdW1tYXJ5JywKCiAgY29tcG9uZW50czogeyBGbGVldFN0YXR1cyB9LAoKICBwcm9wczogewogICAgYnVuZGxlczogewogICAgICB0eXBlOiAgICBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10sCiAgICB9LAogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIHN0YXRlS2V5OiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2ZsZWV0LmZsZWV0U3VtbWFyeS5zdGF0ZScKICAgIH0sCiAgfSwKCiAgY29tcHV0ZWQ6IHsKCiAgICByZXBvTmFtZSgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUubWV0YWRhdGEubmFtZTsKICAgIH0sCgogICAgYnVuZGxlQ291bnRzKCkgewogICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLmJ1bmRsZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnJlcG9OYW1lID09PSB0aGlzLnJlcG9OYW1lKTsKCiAgICAgIGlmICghcmVzb3VyY2VzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgY29uc3Qgb3V0ID0geyAuLi5nZXRSZXNvdXJjZURlZmF1bHRTdGF0ZSh0aGlzLiRzdG9yZS5nZXR0ZXJzWydpMThuL3dpdGhGYWxsYmFjayddLCB0aGlzLnN0YXRlS2V5KSB9OwoKICAgICAgcmVzb3VyY2VzLmZvckVhY2goKHsgc3RhdHVzLCBtZXRhZGF0YSB9KSA9PiB7CiAgICAgICAgaWYgKCFzdGF0dXMpIHsKICAgICAgICAgIG91dFtTVEFURVNfRU5VTS5VTktOT1dOXS5jb3VudCArPSAxOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGsgPSBzdGF0dXM/LnN1bW1hcnkucmVhZHkgPiAwICYmIHN0YXR1cz8uc3VtbWFyeS5kZXNpcmVkUmVhZHkgPT09IHN0YXR1cy5zdW1tYXJ5LnJlYWR5OwoKICAgICAgICBpZiAoaykgewogICAgICAgICAgb3V0LnJlYWR5LmNvdW50ICs9IDE7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3RhdGUgPSBtZXRhZGF0YS5zdGF0ZT8ubmFtZT8udG9Mb3dlckNhc2UoKTsKCiAgICAgICAgaWYgKHN0YXRlICYmIG91dFtzdGF0ZV0pIHsKICAgICAgICAgIG91dFtzdGF0ZV0uY291bnQgKz0gMTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCB7IGNvbmRpdGlvbnMgfSA9IHN0YXR1czsKCiAgICAgICAgY29uc3Qgbm90UmVhZHkgPSBjb25kaXRpb25zLmZpbmQoKHsgdHJhbnNpdGlvbmluZywgbWVzc2FnZSB9KSA9PiB7CiAgICAgICAgICByZXR1cm4gdHJhbnNpdGlvbmluZyAmJiAhbWVzc2FnZS5pbmNsdWRlcyhTVEFURVNfRU5VTS5FUlJPUikgJiYgIW1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhTVEFURVNfRU5VTS5FUlJfQVBQTElFRCk7CiAgICAgICAgfSk7CgogICAgICAgIGlmICghIW5vdFJlYWR5KSB7CiAgICAgICAgICBvdXQubm90cmVhZHkuY291bnQgKz0gMTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayBjb25kaXRpb25zCiAgICAgICAgY29uc3QgZXJyQXBwbGllZCA9IGNvbmRpdGlvbnMuZmluZCgoeyBlcnJvciwgbWVzc2FnZSB9KSA9PiAhIWVycm9yICYmIG1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhTVEFURVNfRU5VTS5FUlJfQVBQTElFRCkpOwoKICAgICAgICBpZiAoZXJyQXBwbGllZCkgewogICAgICAgICAgb3V0W1NUQVRFU19FTlVNLkVSUl9BUFBMSUVEXS5jb3VudCArPSAxOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGVycm9yU3RhdGUgPSBjb25kaXRpb25zLmZpbmQoKHsgZXJyb3IsIG1lc3NhZ2UgfSkgPT4gISFlcnJvciAmJiBtZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoU1RBVEVTX0VOVU0uRVJST1IpKTsKCiAgICAgICAgaWYgKG91dFtlcnJvclN0YXRlXSkgewogICAgICAgICAgb3V0W2Vycm9yU3RhdGVdLmNvdW50ICs9IDE7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgb3V0LnVua25vd24uY291bnQgKz0gMTsKICAgICAgfSk7CgogICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhvdXQpLm1hcCgoaXRlbSkgPT4gewogICAgICAgIGl0ZW0udmFsdWUgPSBpdGVtLmNvdW50OwoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICB9LAoKICAgIHJlc291cmNlQ291bnRzKCkgewogICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLnZhbHVlLnN0YXR1cy5yZXNvdXJjZXMgfHwgW107CiAgICAgIGNvbnN0IG91dCA9IHsgLi4uZ2V0UmVzb3VyY2VEZWZhdWx0U3RhdGUodGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXSwgdGhpcy5zdGF0ZUtleSkgfTsKCiAgICAgIHJlc291cmNlcy5mb3JFYWNoKCh7IHN0YXRlIH0pID0+IHsKICAgICAgICBjb25zdCBrID0gc3RhdGU/LnRvTG93ZXJDYXNlKCk7CgogICAgICAgIGlmIChvdXRba10pIHsKICAgICAgICAgIG91dFtrXS5jb3VudCArPSAxOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgb3V0LnVua25vd24uY291bnQgKz0gMTsKICAgICAgfSk7CgogICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhvdXQpLm1hcCgoaXRlbSkgPT4gewogICAgICAgIGl0ZW0udmFsdWUgPSBpdGVtLmNvdW50OwoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICB9LAoKICB9LAoKfTsK"},{"version":3,"sources":["FleetSummary.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA","file":"FleetSummary.vue","sourceRoot":"node_modules/@rancher/shell/components/fleet","sourcesContent":["<script>\nimport { STATES, STATES_ENUM } from '@shell/plugins/dashboard-store/resource-class';\nimport FleetStatus from '@shell/components/fleet/FleetStatus';\n\nconst getResourceDefaultState = (labelGetter, stateKey) => {\n  return {\n    ready: {\n      count:  0,\n      color:  STATES[STATES_ENUM.READY].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.READY }`, null, STATES[STATES_ENUM.READY].label ),\n      status: STATES_ENUM.READY\n    },\n    info: {\n      count:  0,\n      color:  STATES[STATES_ENUM.INFO].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.INFO }`, null, STATES[STATES_ENUM.INFO].label ),\n      status: STATES_ENUM.INFO\n    },\n    warning: {\n      count:  0,\n      color:  STATES[STATES_ENUM.WARNING].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.WARNING }`, null, STATES[STATES_ENUM.WARNING].label ),\n      status: STATES_ENUM.WARNING\n    },\n    notready: {\n      count:  0,\n      color:  STATES[STATES_ENUM.NOT_READY].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.NOT_READY }`, null, STATES[STATES_ENUM.NOT_READY].label ),\n      status: STATES_ENUM.NOT_READY\n    },\n    error: {\n      count:  0,\n      color:  STATES[STATES_ENUM.ERROR].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.ERROR }`, null, STATES[STATES_ENUM.ERROR].label ),\n      status: STATES_ENUM.ERROR\n    },\n    errapplied: {\n      count:  0,\n      color:  STATES[STATES_ENUM.ERR_APPLIED].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.ERR_APPLIED }`, null, STATES[STATES_ENUM.ERR_APPLIED].label ),\n      status: STATES_ENUM.ERR_APPLIED,\n    },\n    waitapplied: {\n      count:  0,\n      color:  STATES[STATES_ENUM.WAIT_APPLIED].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.WAIT_APPLIED }`, null, STATES[STATES_ENUM.WAIT_APPLIED].label ),\n      status: STATES_ENUM.WAIT_APPLIED\n    },\n    unknown: {\n      count:  0,\n      color:  STATES[STATES_ENUM.UNKNOWN].color,\n      label:  labelGetter(`${ stateKey }.${ STATES_ENUM.UNKNOWN }`, null, STATES[STATES_ENUM.UNKNOWN].label ),\n      status: STATES_ENUM.UNKNOWN\n    }\n  };\n};\n\nexport default {\n\n  name: 'FleetSummary',\n\n  components: { FleetStatus },\n\n  props: {\n    bundles: {\n      type:    Array,\n      default: () => [],\n    },\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    stateKey: {\n      type:    String,\n      default: 'fleet.fleetSummary.state'\n    },\n  },\n\n  computed: {\n\n    repoName() {\n      return this.value.metadata.name;\n    },\n\n    bundleCounts() {\n      const resources = this.bundles.filter((item) => item.repoName === this.repoName);\n\n      if (!resources.length) {\n        return [];\n      }\n\n      const out = { ...getResourceDefaultState(this.$store.getters['i18n/withFallback'], this.stateKey) };\n\n      resources.forEach(({ status, metadata }) => {\n        if (!status) {\n          out[STATES_ENUM.UNKNOWN].count += 1;\n\n          return;\n        }\n\n        const k = status?.summary.ready > 0 && status?.summary.desiredReady === status.summary.ready;\n\n        if (k) {\n          out.ready.count += 1;\n\n          return;\n        }\n\n        const state = metadata.state?.name?.toLowerCase();\n\n        if (state && out[state]) {\n          out[state].count += 1;\n\n          return;\n        }\n\n        const { conditions } = status;\n\n        const notReady = conditions.find(({ transitioning, message }) => {\n          return transitioning && !message.includes(STATES_ENUM.ERROR) && !message.toLowerCase().includes(STATES_ENUM.ERR_APPLIED);\n        });\n\n        if (!!notReady) {\n          out.notready.count += 1;\n\n          return;\n        }\n\n        // check conditions\n        const errApplied = conditions.find(({ error, message }) => !!error && message.toLowerCase().includes(STATES_ENUM.ERR_APPLIED));\n\n        if (errApplied) {\n          out[STATES_ENUM.ERR_APPLIED].count += 1;\n\n          return;\n        }\n\n        const errorState = conditions.find(({ error, message }) => !!error && message.toLowerCase().includes(STATES_ENUM.ERROR));\n\n        if (out[errorState]) {\n          out[errorState].count += 1;\n\n          return;\n        }\n\n        out.unknown.count += 1;\n      });\n\n      return Object.values(out).map((item) => {\n        item.value = item.count;\n\n        return item;\n      });\n    },\n\n    resourceCounts() {\n      const resources = this.value.status.resources || [];\n      const out = { ...getResourceDefaultState(this.$store.getters['i18n/withFallback'], this.stateKey) };\n\n      resources.forEach(({ state }) => {\n        const k = state?.toLowerCase();\n\n        if (out[k]) {\n          out[k].count += 1;\n\n          return;\n        }\n        out.unknown.count += 1;\n      });\n\n      return Object.values(out).map((item) => {\n        item.value = item.count;\n\n        return item;\n      });\n    },\n\n  },\n\n};\n</script>\n\n<template>\n  <div class=\"row flexwrap\">\n    <FleetStatus\n      v-if=\"bundleCounts.length\"\n      title=\"Bundles\"\n      :values=\"bundleCounts\"\n      value-key=\"count\"\n      data-testid=\"gitrepo-bundle-summary\"\n    />\n    <FleetStatus\n      title=\"Resources\"\n      :values=\"resourceCounts\"\n      value-key=\"count\"\n      data-testid=\"gitrepo-deployment-summary\"\n    />\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n   .flexwrap .fleet-status {\n    max-width: 50%;\n    margin-right: 15px;\n\n    &:last-child {\n      margin: 0\n    }\n  }\n  .countbox {\n    min-width: 150px;\n    width: 12.5%;\n    margin-bottom: 10px;\n  }\n</style>\n"]}]}