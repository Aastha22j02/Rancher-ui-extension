{"remainingRequest":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/suseconf/node_modules/@rancher/shell/detail/networking.k8s.io.ingress.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/detail/networking.k8s.io.ingress.vue","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1725271300920}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOw0KaW1wb3J0IHsgU0VDUkVULCBTRVJWSUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7DQppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsNCmltcG9ydCBSdWxlcyBmcm9tICdAc2hlbGwvZWRpdC9uZXR3b3JraW5nLms4cy5pby5pbmdyZXNzL1J1bGVzJzsNCmltcG9ydCBSZXNvdXJjZVRhYnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9SZXNvdXJjZVRhYnMnOw0KaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiJzsNCmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsNCmltcG9ydCB7IEZpbHRlckFyZ3MsIFBhZ2luYXRpb25QYXJhbUZpbHRlciB9IGZyb20gJ0BzaGVsbC90eXBlcy9zdG9yZS9wYWdpbmF0aW9uLnR5cGVzJzsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAgICAgICAnQ1JVSW5ncmVzcycsDQogIGNvbXBvbmVudHM6IHsNCiAgICBSZXNvdXJjZVRhYnMsDQogICAgUnVsZXMsDQogICAgVGFiDQogIH0sDQogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3XSwNCiAgYXN5bmMgZmV0Y2goKSB7DQogICAgY29uc3QgcHJvbWlzZXMgPSB7DQogICAgICBzZXJ2aWNlczogICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VSVklDRSB9KSwNCiAgICAgIHJlc291cmNlRmllbGRzOiB0aGlzLnNjaGVtYS5mZXRjaFJlc291cmNlRmllbGRzKCksDQogICAgfTsNCg0KICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzW2BjbHVzdGVyL3BhZ2luYXRpb25FbmFibGVkYF0oU0VDUkVUKSkgew0KICAgICAgY29uc3QgZmluZFBhZ2VBcmdzID0geyAvLyBPZiB0eXBlIEFjdGlvbkZpbmRQYWdlQXJncw0KICAgICAgICBuYW1lc3BhY2VkOiB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWVzcGFjZSwNCiAgICAgICAgcGFnaW5hdGlvbjogbmV3IEZpbHRlckFyZ3Moew0KICAgICAgICAgIGZpbHRlcnM6IFBhZ2luYXRpb25QYXJhbUZpbHRlci5jcmVhdGVTaW5nbGVGaWVsZCh7DQogICAgICAgICAgICBmaWVsZDogJ21ldGFkYXRhLmZpZWxkcy4xJywNCiAgICAgICAgICAgIHZhbHVlOiBUWVBFUy5UTFMNCiAgICAgICAgICB9KQ0KICAgICAgICB9KSwNCiAgICAgIH07DQoNCiAgICAgIHByb21pc2VzLmZpbHRlcmVkU2VjcmV0cyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGBjbHVzdGVyL2ZpbmRQYWdlYCwgeyB0eXBlOiBTRUNSRVQsIG9wdDogZmluZFBhZ2VBcmdzIH0pOw0KICAgIH0gZWxzZSB7DQogICAgICBwcm9taXNlcy5zZWNyZXRzID0gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VDUkVUIH0pOw0KICAgIH0NCiAgICBjb25zdCBoYXNoID0gYXdhaXQgYWxsSGFzaChwcm9taXNlcyk7DQoNCiAgICB0aGlzLmFsbFNlcnZpY2VzID0gaGFzaC5zZXJ2aWNlczsNCiAgICB0aGlzLmFsbFNlY3JldHMgPSBoYXNoLnNlY3JldHM7DQogICAgdGhpcy5maWx0ZXJlZFNlY3JldHMgPSBoYXNoLmZpbHRlcmVkU2VjcmV0czsNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgYWxsU2VjcmV0czogICAgICBudWxsLA0KICAgICAgZmlsdGVyZWRTZWNyZXRzOiBudWxsLA0KICAgICAgYWxsU2VydmljZXM6ICAgICBbXSwNCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIHNlcnZpY2VUYXJnZXRzKCkgew0KICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyQnlDdXJyZW50UmVzb3VyY2VOYW1lc3BhY2UodGhpcy5hbGxTZXJ2aWNlcykNCiAgICAgICAgLm1hcCgoc2VydmljZSkgPT4gKHsNCiAgICAgICAgICBsYWJlbDogc2VydmljZS5tZXRhZGF0YS5uYW1lLA0KICAgICAgICAgIHZhbHVlOiBzZXJ2aWNlLm1ldGFkYXRhLm5hbWUsDQogICAgICAgICAgcG9ydHM6IHNlcnZpY2Uuc3BlYy5wb3J0cz8ubWFwKChwKSA9PiBwLnBvcnQpDQogICAgICAgIH0pKTsNCiAgICB9LA0KICAgIGZpcnN0VGFiTGFiZWwoKSB7DQogICAgICByZXR1cm4gdGhpcy5pc1ZpZXcgPyB0aGlzLnQoJ2luZ3Jlc3MucnVsZXNBbmRDZXJ0aWZpY2F0ZXMudGl0bGUnKSA6IHRoaXMudCgnaW5ncmVzcy5ydWxlcy50aXRsZScpOw0KICAgIH0sDQogICAgY2VydGlmaWNhdGVzKCkgew0KICAgICAgbGV0IGZpbHRlcmVkU2VjcmV0czsNCg0KICAgICAgaWYgKHRoaXMuZmlsdGVyZWRTZWNyZXRzKSB7DQogICAgICAgIGZpbHRlcmVkU2VjcmV0cyA9IHRoaXMuZmlsdGVyZWRTZWNyZXRzOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLmFsbFNlY3JldHMgKSB7DQogICAgICAgIGZpbHRlcmVkU2VjcmV0cyA9IHRoaXMuZmlsdGVyQnlDdXJyZW50UmVzb3VyY2VOYW1lc3BhY2UodGhpcy5hbGxTZWNyZXRzLmZpbHRlcigoc2VjcmV0KSA9PiBzZWNyZXQuX3R5cGUgPT09IFRZUEVTLlRMUykpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gZmlsdGVyZWRTZWNyZXRzLm1hcCgoc2VjcmV0KSA9PiB7DQogICAgICAgIGNvbnN0IHsgaWQgfSA9IHNlY3JldDsNCg0KICAgICAgICByZXR1cm4gaWQuc2xpY2UoaWQuaW5kZXhPZignLycpICsgMSk7DQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZmlsdGVyQnlDdXJyZW50UmVzb3VyY2VOYW1lc3BhY2UocmVzb3VyY2VzKSB7DQogICAgICByZXR1cm4gcmVzb3VyY2VzLmZpbHRlcigocmVzb3VyY2UpID0+IHsNCiAgICAgICAgcmV0dXJuIHJlc291cmNlLm1ldGFkYXRhLm5hbWVzcGFjZSA9PT0gdGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lc3BhY2U7DQogICAgICB9KTsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["networking.k8s.io.ingress.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"networking.k8s.io.ingress.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\r\nimport { allHash } from '@shell/utils/promise';\r\nimport { SECRET, SERVICE } from '@shell/config/types';\r\nimport CreateEditView from '@shell/mixins/create-edit-view';\r\nimport Rules from '@shell/edit/networking.k8s.io.ingress/Rules';\r\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\r\nimport Tab from '@shell/components/Tabbed/Tab';\r\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\r\nimport { FilterArgs, PaginationParamFilter } from '@shell/types/store/pagination.types';\r\n\r\nexport default {\r\n  name:       'CRUIngress',\r\n  components: {\r\n    ResourceTabs,\r\n    Rules,\r\n    Tab\r\n  },\r\n  mixins: [CreateEditView],\r\n  async fetch() {\r\n    const promises = {\r\n      services:       this.$store.dispatch('cluster/findAll', { type: SERVICE }),\r\n      resourceFields: this.schema.fetchResourceFields(),\r\n    };\r\n\r\n    if (this.$store.getters[`cluster/paginationEnabled`](SECRET)) {\r\n      const findPageArgs = { // Of type ActionFindPageArgs\r\n        namespaced: this.value.metadata.namespace,\r\n        pagination: new FilterArgs({\r\n          filters: PaginationParamFilter.createSingleField({\r\n            field: 'metadata.fields.1',\r\n            value: TYPES.TLS\r\n          })\r\n        }),\r\n      };\r\n\r\n      promises.filteredSecrets = this.$store.dispatch(`cluster/findPage`, { type: SECRET, opt: findPageArgs });\r\n    } else {\r\n      promises.secrets = this.$store.dispatch('cluster/findAll', { type: SECRET });\r\n    }\r\n    const hash = await allHash(promises);\r\n\r\n    this.allServices = hash.services;\r\n    this.allSecrets = hash.secrets;\r\n    this.filteredSecrets = hash.filteredSecrets;\r\n  },\r\n  data() {\r\n    return {\r\n      allSecrets:      null,\r\n      filteredSecrets: null,\r\n      allServices:     [],\r\n    };\r\n  },\r\n  computed: {\r\n    serviceTargets() {\r\n      return this.filterByCurrentResourceNamespace(this.allServices)\r\n        .map((service) => ({\r\n          label: service.metadata.name,\r\n          value: service.metadata.name,\r\n          ports: service.spec.ports?.map((p) => p.port)\r\n        }));\r\n    },\r\n    firstTabLabel() {\r\n      return this.isView ? this.t('ingress.rulesAndCertificates.title') : this.t('ingress.rules.title');\r\n    },\r\n    certificates() {\r\n      let filteredSecrets;\r\n\r\n      if (this.filteredSecrets) {\r\n        filteredSecrets = this.filteredSecrets;\r\n      } else if (this.allSecrets ) {\r\n        filteredSecrets = this.filterByCurrentResourceNamespace(this.allSecrets.filter((secret) => secret._type === TYPES.TLS));\r\n      } else {\r\n        return [];\r\n      }\r\n\r\n      return filteredSecrets.map((secret) => {\r\n        const { id } = secret;\r\n\r\n        return id.slice(id.indexOf('/') + 1);\r\n      });\r\n    },\r\n  },\r\n  methods: {\r\n    filterByCurrentResourceNamespace(resources) {\r\n      return resources.filter((resource) => {\r\n        return resource.metadata.namespace === this.value.metadata.namespace;\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<template>\r\n  <ResourceTabs\r\n    v-model=\"value\"\r\n    mode=\"view\"\r\n    class=\"mt-20\"\r\n  >\r\n    <Tab\r\n      :label=\"t('ingress.rules.title')\"\r\n      name=\"rules\"\r\n      :weight=\"1\"\r\n    >\r\n      <Rules\r\n        v-model=\"value\"\r\n        :mode=\"mode\"\r\n        :service-targets=\"serviceTargets\"\r\n        :certificates=\"certificates\"\r\n      />\r\n    </Tab>\r\n  </ResourceTabs>\r\n</template>\r\n"]}]}