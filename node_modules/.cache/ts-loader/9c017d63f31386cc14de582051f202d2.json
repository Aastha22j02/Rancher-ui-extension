{"remainingRequest":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js??ref--17-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js","mtime":1725271299135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbW91bnQgfSBmcm9tICdAdnVlL3Rlc3QtdXRpbHMnOwppbXBvcnQgRm9ybVZhbGlkYXRpb24gZnJvbSAnQHNoZWxsL21peGlucy9mb3JtLXZhbGlkYXRpb24nOwppbXBvcnQgTW9uaXRvcmluZyBmcm9tICdAc2hlbGwvZWRpdC9tb25pdG9yaW5nLmNvcmVvcy5jb20ucHJvbWV0aGV1c3J1bGUvaW5kZXgudnVlJzsKaW1wb3J0IHsgX0VESVQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmRlc2NyaWJlKCdlZGl0OiBtYW5hZ2VtZW50LmNhdHRsZS5pby5zZXR0aW5nIHNob3VsZCcsICgpID0+IHsKICAgIGNvbnN0IE1PQ0tFRF9FUlJPUlMgPSBbJ2Vycm9yMScsICdlcnJvcjInLCAnZXJyb3IzJywgJ2Vycm9yNCcsICdlcnJvcjUnXTsKICAgIGNvbnN0IEVSUk9SX0JBTk5FUl9TRUxFQ1RPUiA9ICdbZGF0YS10ZXN0aWQ9ImJhbm5lci1jbG9zZSJdJzsKICAgIGNvbnN0IHJlcXVpcmVkU2V0dXAgPSAoKSA9PiAoewogICAgICAgIC8vIFJlbW92ZSBhbGwgdGhlc2UgbW9ja3MgYWZ0ZXIgbWlncmF0aW9uIHRvIFZ1ZSAyLjcvMyBkdWUgbWl4aW4gbG9naWMKICAgICAgICBtb2NrczogewogICAgICAgICAgICAkc3RvcmU6IHsKICAgICAgICAgICAgICAgIGRpc3BhdGNoOiBqZXN0LmZuKCksCiAgICAgICAgICAgICAgICBnZXR0ZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0b3JlOiAoKSA9PiAnY3VycmVudF9zdG9yZScsCiAgICAgICAgICAgICAgICAgICAgJ2N1cnJlbnRfc3RvcmUvc2NoZW1hRm9yJzogamVzdC5mbigpLAogICAgICAgICAgICAgICAgICAgICdjdXJyZW50X3N0b3JlL2FsbCc6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgICAgICAnaTE4bi90JzogamVzdC5mbigpLAogICAgICAgICAgICAgICAgICAgICdpMThuL2V4aXN0cyc6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2VzOiAoKSA9PiAoe30pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICRyb3V0ZTogeyBxdWVyeTogeyBBUzogJycgfSwgbmFtZTogJycgfSwKICAgICAgICAgICAgJHJvdXRlcjogeyBhcHBseVF1ZXJ5OiBqZXN0LmZuKCkgfQogICAgICAgIH0KICAgIH0pOwogICAgaXQoJ3Nob3VsZCBjbG9zZSBlcnJvciBiYW5uZXJzJywgYXN5bmMgKCkgPT4gewogICAgICAgIGplc3Quc3B5T24oRm9ybVZhbGlkYXRpb24uY29tcHV0ZWQsICdmdlVucmVwb3J0ZWRWYWxpZGF0aW9uRXJyb3JzJykubW9ja1JldHVyblZhbHVlKE1PQ0tFRF9FUlJPUlMpOwogICAgICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChNb25pdG9yaW5nLCB7CiAgICAgICAgICAgIHByb3BzRGF0YTogewogICAgICAgICAgICAgICAgY2FuWWFtbDogZmFsc2UsCiAgICAgICAgICAgICAgICBtb2RlOiBfRURJVCwKICAgICAgICAgICAgICAgIHJlc291cmNlOiB7fSwKICAgICAgICAgICAgICAgIHZhbHVlOiB7IHZhbHVlOiAnYW55dGhpbmcnIH0sCiAgICAgICAgICAgICAgICBuYW1lOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICAuLi5yZXF1aXJlZFNldHVwKCkKICAgICAgICB9KTsKICAgICAgICBjb25zdCBlcnJvckJhbm5lcnMgPSB3cmFwcGVyLmZpbmRBbGwoRVJST1JfQkFOTkVSX1NFTEVDVE9SKTsKICAgICAgICAvLyBBc3NlcnQgdGhhdCBhbGwgdGhlIGVycm9yIGJhbm5lcnMgYXJlIHJlbmRlcmVkCiAgICAgICAgZXhwZWN0KGVycm9yQmFubmVycykudG9IYXZlTGVuZ3RoKE1PQ0tFRF9FUlJPUlMubGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1PQ0tFRF9FUlJPUlMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYXdhaXQgZXJyb3JCYW5uZXJzLmF0KDApLnRyaWdnZXIoJ2NsaWNrJyk7CiAgICAgICAgICAgIGNvbnN0IHJlc3VsdEVycm9yQmFubmVycyA9IHdyYXBwZXIuZmluZEFsbChFUlJPUl9CQU5ORVJfU0VMRUNUT1IpOwogICAgICAgICAgICAvLyBBc3NlcnQgdGhhdCBhbiBlcnJvciBiYW5uZXIgaXMgY2xvc2VkIHVudGlsIHRoZSBsYXN0IG9uZQogICAgICAgICAgICBleHBlY3QocmVzdWx0RXJyb3JCYW5uZXJzKS50b0hhdmVMZW5ndGgoTU9DS0VEX0VSUk9SUy5sZW5ndGggLSAxIC0gaSk7CiAgICAgICAgfQogICAgfSk7Cn0pOwo="},{"version":3,"file":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","sourceRoot":"","sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,iBAAiB,CAAC;AACxC,OAAO,cAAc,MAAM,+BAA+B,CAAC;AAC3D,OAAO,UAAU,MAAM,4DAA4D,CAAC;AACpF,OAAO,EAAE,KAAK,EAAE,MAAM,4BAA4B,CAAC;AAEnD,QAAQ,CAAC,2CAA2C,EAAE,GAAG,EAAE;IACzD,MAAM,aAAa,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;IACzE,MAAM,qBAAqB,GAAG,8BAA8B,CAAC;IAC7D,MAAM,aAAa,GAAG,GAAG,EAAE,CAAC,CAAC;QAC3B,sEAAsE;QACtE,KAAK,EAAE;YACL,MAAM,EAAE;gBACN,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;gBACnB,OAAO,EAAG;oBACR,YAAY,EAAe,GAAG,EAAE,CAAC,eAAe;oBAChD,yBAAyB,EAAE,IAAI,CAAC,EAAE,EAAE;oBACpC,mBAAmB,EAAQ,IAAI,CAAC,EAAE,EAAE;oBACpC,QAAQ,EAAmB,IAAI,CAAC,EAAE,EAAE;oBACpC,aAAa,EAAc,IAAI,CAAC,EAAE,EAAE;oBACpC,UAAU,EAAiB,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC;iBACtC;aACF;YACD,MAAM,EAAG,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;YACxC,OAAO,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE;SACnC;KACF,CAAC,CAAC;IAEH,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAG,EAAE;QACzC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,EAAE,8BAA8B,CAAC,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;QAEnG,MAAM,OAAO,GAAG,KAAK,CAAC,UAAU,EAAE;YAChC,SAAS,EAAE;gBACT,OAAO,EAAG,KAAK;gBACf,IAAI,EAAM,KAAK;gBACf,QAAQ,EAAE,EAAE;gBACZ,KAAK,EAAK,EAAE,KAAK,EAAE,UAAU,EAAE;gBAC/B,IAAI,EAAM,EAAE;aACb;YACD,GAAG,aAAa,EAAE;SACnB,CAAC,CAAC;QAEH,MAAM,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QAE5D,iDAAiD;QACjD,MAAM,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAExD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,MAAM,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,OAAO,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;YAElE,2DAA2D;YAC3D,MAAM,CAAC,kBAAkB,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;SACvE;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { mount } from '@vue/test-utils';\nimport FormValidation from '@shell/mixins/form-validation';\nimport Monitoring from '@shell/edit/monitoring.coreos.com.prometheusrule/index.vue';\nimport { _EDIT } from '@shell/config/query-params';\n\ndescribe('edit: management.cattle.io.setting should', () => {\n  const MOCKED_ERRORS = ['error1', 'error2', 'error3', 'error4', 'error5'];\n  const ERROR_BANNER_SELECTOR = '[data-testid=\"banner-close\"]';\n  const requiredSetup = () => ({\n    // Remove all these mocks after migration to Vue 2.7/3 due mixin logic\n    mocks: {\n      $store: {\n        dispatch: jest.fn(),\n        getters:  {\n          currentStore:              () => 'current_store',\n          'current_store/schemaFor': jest.fn(),\n          'current_store/all':       jest.fn(),\n          'i18n/t':                  jest.fn(),\n          'i18n/exists':             jest.fn(),\n          namespaces:                () => ({})\n        }\n      },\n      $route:  { query: { AS: '' }, name: '' },\n      $router: { applyQuery: jest.fn() }\n    }\n  });\n\n  it('should close error banners', async() => {\n    jest.spyOn(FormValidation.computed, 'fvUnreportedValidationErrors').mockReturnValue(MOCKED_ERRORS);\n\n    const wrapper = mount(Monitoring, {\n      propsData: {\n        canYaml:  false,\n        mode:     _EDIT,\n        resource: {},\n        value:    { value: 'anything' },\n        name:     ''\n      },\n      ...requiredSetup()\n    });\n\n    const errorBanners = wrapper.findAll(ERROR_BANNER_SELECTOR);\n\n    // Assert that all the error banners are rendered\n    expect(errorBanners).toHaveLength(MOCKED_ERRORS.length);\n\n    for (let i = 0; i < MOCKED_ERRORS.length; i++) {\n      await errorBanners.at(0).trigger('click');\n      const resultErrorBanners = wrapper.findAll(ERROR_BANNER_SELECTOR);\n\n      // Assert that an error banner is closed until the last one\n      expect(resultErrorBanners).toHaveLength(MOCKED_ERRORS.length - 1 - i);\n    }\n  });\n});\n"]}]}