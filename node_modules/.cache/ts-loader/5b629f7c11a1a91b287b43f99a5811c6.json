{"remainingRequest":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js??ref--17-1!/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts","dependencies":[{"path":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts","mtime":1725338146566},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/babel-loader/lib/index.js","mtime":1725271298942},{"path":"/home/ubuntu/suseconf/node_modules/cache-loader/dist/cjs.js","mtime":1725271299021},{"path":"/home/ubuntu/suseconf/node_modules/ts-loader/index.js","mtime":1725271299135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyogZXNsaW50LWRpc2FibGUgamVzdC9uby1ob29rcyAqLwppbXBvcnQgeyBtb3VudCB9IGZyb20gJ0B2dWUvdGVzdC11dGlscyc7CmltcG9ydCB7IF9FRElUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgb2lkYyBmcm9tICdAc2hlbGwvZWRpdC9hdXRoL29pZGMudnVlJzsKamVzdC5tb2NrKCdAc2hlbGwvdXRpbHMvY2xpcGJvYXJkJywgKCkgPT4gewogICAgcmV0dXJuIHsgY29weVRleHRUb0NsaXBib2FyZDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoe30pKSB9Owp9KTsKY29uc3QgdmFsaWRDbGllbnRJZCA9ICdyYW5jaGVyb2lkYyc7CmNvbnN0IHZhbGlkQ2xpZW50U2VjcmV0ID0gJ1RPa1V4ZzBQNjdtMVVYV05rSkxIRFBrVVpGSUtPV1NxJzsKY29uc3QgdmFsaWRVcmwgPSAnaHR0cHM6Ly9sb2NhbGhvc3Q6ODA4MCc7CmNvbnN0IHZhbGlkUmVhbG0gPSAncmFuY2hlcnJlYWxtJzsKY29uc3QgdmFsaWRSYW5jaGVyVXJsID0gJ2h0dHBzOi8vbG9jYWxob3N0L3ZlcmlmeS1hdXRoJzsKY29uc3QgdmFsaWRJc3N1ZXIgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3JlYWxtcy9yYW5jaGVycmVhbG0nOwpjb25zdCB2YWxpZEF1dGhFbmRwb2ludCA9ICdodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL3JhbmNoZXJyZWFsbS9wcm90b2NvbC9vcGVuaWQtY29ubmVjdC9hdXRoJzsKY29uc3QgdmFsaWRTY29wZSA9ICdvcGVuaWQgcHJvZmlsZSBlbWFpbCc7CmNvbnN0IG1vY2tNb2RlbCA9IHsKICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgaWQ6ICdnZW5lcmljb2lkYycsCiAgICByYW5jaGVyVXJsOiB2YWxpZFJhbmNoZXJVcmwsCiAgICBpc3N1ZXI6IHZhbGlkSXNzdWVyLAogICAgYXV0aEVuZHBvaW50OiB2YWxpZEF1dGhFbmRwb2ludCwKICAgIHNjb3BlOiB2YWxpZFNjb3BlLAogICAgY2xpZW50SWQ6IHZhbGlkQ2xpZW50SWQsCiAgICBjbGllbnRTZWNyZXQ6IHZhbGlkQ2xpZW50U2VjcmV0LAogICAgdHlwZTogJ2dlbmVyaWNPSURDQ29uZmlnJywKfTsKY29uc3QgbW9ja2VkQXV0aENvbmZpZ01peGluID0gewogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpc0VuYWJsaW5nOiBmYWxzZSwKICAgICAgICAgICAgZWRpdENvbmZpZzogZmFsc2UsCiAgICAgICAgICAgIG1vZGVsOiB7IC4uLm1vY2tNb2RlbCB9LAogICAgICAgICAgICBzZXJ2ZXJTZXR0aW5nOiBudWxsLAogICAgICAgICAgICBlcnJvcnM6IFtdLAogICAgICAgICAgICBvcmlnaW5hbE1vZGVsOiBudWxsLAogICAgICAgICAgICBwcmluY2lwYWxzOiBbXSwKICAgICAgICAgICAgYXV0aENvbmZpZ05hbWU6ICdvaWRjJywKICAgICAgICB9OwogICAgfSwKICAgIGNvbXB1dGVkOiB7fSwKICAgIG1ldGhvZHM6IHt9Cn07CmRlc2NyaWJlKCdvaWRjLnZ1ZScsICgpID0+IHsKICAgIGxldCB3cmFwcGVyOwogICAgY29uc3QgcmVxdWlyZWRTZXR1cCA9ICgpID0+ICh7CiAgICAgICAgbWl4aW5zOiBbbW9ja2VkQXV0aENvbmZpZ01peGluXSwKICAgICAgICBtb2NrczogewogICAgICAgICAgICAkZmV0Y2hTdGF0ZTogeyBwZW5kaW5nOiBmYWxzZSB9LAogICAgICAgICAgICAkc3RvcmU6IHsKICAgICAgICAgICAgICAgIGdldHRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RvcmU6ICgpID0+ICdjdXJyZW50X3N0b3JlJywKICAgICAgICAgICAgICAgICAgICAnY3VycmVudF9zdG9yZS9zY2hlbWFGb3InOiBqZXN0LmZuKCksCiAgICAgICAgICAgICAgICAgICAgJ2N1cnJlbnRfc3RvcmUvYWxsJzogamVzdC5mbigpLAogICAgICAgICAgICAgICAgICAgICdpMThuL3QnOiAodmFsKSA9PiB2YWwsCiAgICAgICAgICAgICAgICAgICAgJ2kxOG4vZXhpc3RzJzogamVzdC5mbigpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGRpc3BhdGNoOiBqZXN0LmZuKCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJHJvdXRlOiB7IHF1ZXJ5OiB7IEFTOiAnJyB9LCBwYXJhbXM6IHsgaWQ6ICdvaWNkJyB9IH0sCiAgICAgICAgICAgICRyb3V0ZXI6IHsgYXBwbHlRdWVyeTogamVzdC5mbigpIH0sCiAgICAgICAgfSwKICAgICAgICBwcm9wc0RhdGE6IHsKICAgICAgICAgICAgdmFsdWU6IHsgYXBwbGljYXRpb25TZWNyZXQ6ICcnIH0sCiAgICAgICAgICAgIG1vZGU6IF9FRElULAogICAgICAgIH0sCiAgICB9KTsKICAgIGJlZm9yZUVhY2goKCkgPT4gewogICAgICAgIHdyYXBwZXIgPSBtb3VudChvaWRjLCB7IC4uLnJlcXVpcmVkU2V0dXAoKSB9KTsKICAgIH0pOwogICAgYWZ0ZXJFYWNoKCgpID0+IHsKICAgICAgICB3cmFwcGVyLmRlc3Ryb3koKTsKICAgIH0pOwogICAgaXQoJ2hhdmUgIkNyZWF0ZSIgYnV0dG9uIGVuYWJsZWQgd2hlbiBwcm92aWRlciBpcyBlbmFibGVkIGFuZCBub3QgZWRpdGluZyBjb25maWcnLCBhc3luYyAoKSA9PiB7CiAgICAgICAgd3JhcHBlci5zZXREYXRhKHsgbW9kZWw6IHsgZW5hYmxlZDogdHJ1ZSB9LCBlZGl0Q29uZmlnOiBmYWxzZSB9KTsKICAgICAgICBhd2FpdCB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSB3cmFwcGVyLmZpbmQoJ1tkYXRhLXRlc3RpZD0iZm9ybS1zYXZlIl0nKS5lbGVtZW50OwogICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgIH0pOwogICAgaXQoJ2hhdmUgIkNyZWF0ZSIgYnV0dG9uIGRpc2FibGVkIHdoZW4gcHJvdmlkZXIgaXMgZGlzYWJsZWQgYW5kIGVkaXRpbmcgY29uZmlnIGJlZm9yZSBmaWVsZHMgYXJlIGZpbGxlZCBpbicsIGFzeW5jICgpID0+IHsKICAgICAgICB3cmFwcGVyLnNldERhdGEoeyBtb2RlbDoge30sIGVkaXRDb25maWc6IHRydWUgfSk7CiAgICAgICAgYXdhaXQgd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gd3JhcHBlci5maW5kKCdbZGF0YS10ZXN0aWQ9ImZvcm0tc2F2ZSJdJykuZWxlbWVudDsKICAgICAgICBleHBlY3Qoc2F2ZUJ1dHRvbi5kaXNhYmxlZCkudG9CZSh0cnVlKTsKICAgIH0pOwogICAgaXQoJ2hhdmUgIkNyZWF0ZSIgYnV0dG9uIGRpc2FibGVkIHdoZW4gcHJvdmlkZXIgaXMgZGlzYWJsZWQgYW5kIGVkaXRpbmcgY29uZmlnIGFmdGVyIHJlcXVpcmVkIGZpZWxkcyBhbmQgc2NvcGUgaXMgbWlzc2luZyBvcGVuaWQnLCBhc3luYyAoKSA9PiB7CiAgICAgICAgd3JhcHBlci5zZXREYXRhKHsgb2lkY1VybHM6IHsgdXJsOiB2YWxpZFVybCwgcmVhbG06IHZhbGlkUmVhbG0gfSB9KTsKICAgICAgICBhd2FpdCB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSB3cmFwcGVyLmZpbmQoJ1tkYXRhLXRlc3RpZD0iZm9ybS1zYXZlIl0nKS5lbGVtZW50OwogICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKHRydWUpOwogICAgfSk7CiAgICBpdCgnaGF2ZSAiQ3JlYXRlIiBidXR0b24gZW5hYmxlZCB3aGVuIGN1c3RvbUVuZHBvaW50IGlzIGRpc2FibGVkIGFuZCByZXF1aXJlZCBmaWVsZHMgYXJlIGZpbGxlZCBpbicsIGFzeW5jICgpID0+IHsKICAgICAgICB3cmFwcGVyLnNldERhdGEoeyBvaWRjVXJsczogeyB1cmw6IHZhbGlkVXJsLCByZWFsbTogdmFsaWRSZWFsbSB9LCBvaWRjU2NvcGU6IHZhbGlkU2NvcGUuc3BsaXQoJyAnKSB9KTsKICAgICAgICBhd2FpdCB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSB3cmFwcGVyLmZpbmQoJ1tkYXRhLXRlc3RpZD0iZm9ybS1zYXZlIl0nKS5lbGVtZW50OwogICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgIH0pOwogICAgaXQoJ2hhdmUgIkNyZWF0ZSIgYnV0dG9uIGVuYWJsZWQgd2hlbiBjdXN0b21FbmRwb2ludCBpcyBlbmFibGVkIGFuZCByZXF1aXJlZCBmaWVsZHMgYXJlIGZpbGxlZCBpbicsIGFzeW5jICgpID0+IHsKICAgICAgICB3cmFwcGVyLnNldERhdGEoeyBjdXN0b21FbmRwb2ludDogeyB2YWx1ZTogdHJ1ZSB9LCBvaWRjU2NvcGU6IHZhbGlkU2NvcGUuc3BsaXQoJyAnKSB9KTsKICAgICAgICBhd2FpdCB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSB3cmFwcGVyLmZpbmQoJ1tkYXRhLXRlc3RpZD0iZm9ybS1zYXZlIl0nKS5lbGVtZW50OwogICAgICAgIGV4cGVjdChzYXZlQnV0dG9uLmRpc2FibGVkKS50b0JlKGZhbHNlKTsKICAgIH0pOwogICAgaXQoJ3VwZGF0ZXMgaXNzdWVyIGVuZHBvaW50IHdoZW4gb2lkY1VybHMudXJsIGFuZCBvaWRjVXJscy5yZWFsbSBjaGFuZ2VzJywgYXN5bmMgKCkgPT4gewogICAgICAgIHdyYXBwZXIuc2V0RGF0YSh7IG9pZGNVcmxzOiB7IHVybDogdmFsaWRVcmwgfSB9KTsKICAgICAgICBhd2FpdCB3cmFwcGVyLnZtLiRuZXh0VGljaygpOwogICAgICAgIGV4cGVjdCh3cmFwcGVyLnZtLm1vZGVsLmlzc3VlcikudG9CZShgJHt2YWxpZFVybH0vcmVhbG1zL2ApOwogICAgICAgIHdyYXBwZXIuc2V0RGF0YSh7IG9pZGNVcmxzOiB7IHJlYWxtOiB2YWxpZFJlYWxtIH0gfSk7CiAgICAgICAgYXdhaXQgd3JhcHBlci52bS4kbmV4dFRpY2soKTsKICAgICAgICBleHBlY3Qod3JhcHBlci52bS5tb2RlbC5pc3N1ZXIpLnRvQmUoYCR7dmFsaWRVcmx9L3JlYWxtcy8ke3ZhbGlkUmVhbG19YCk7CiAgICB9KTsKfSk7Cg=="},{"version":3,"file":"/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts","sourceRoot":"","sources":["/home/ubuntu/suseconf/node_modules/@rancher/shell/edit/auth/__tests__/oidc.test.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable jest/no-hooks */\nimport { mount } from '@vue/test-utils';\nimport { _EDIT } from '@shell/config/query-params';\n\nimport oidc from '@shell/edit/auth/oidc.vue';\n\njest.mock('@shell/utils/clipboard', () => {\n  return { copyTextToClipboard: jest.fn(() => Promise.resolve({})) };\n});\n\nconst validClientId = 'rancheroidc';\nconst validClientSecret = 'TOkUxg0P67m1UXWNkJLHDPkUZFIKOWSq';\nconst validUrl = 'https://localhost:8080';\nconst validRealm = 'rancherrealm';\nconst validRancherUrl = 'https://localhost/verify-auth';\nconst validIssuer = 'http://localhost:8080/realms/rancherrealm';\nconst validAuthEndpoint = 'http://localhost:8080/realms/rancherrealm/protocol/openid-connect/auth';\nconst validScope = 'openid profile email';\n\nconst mockModel = {\n  enabled:      false,\n  id:           'genericoidc',\n  rancherUrl:   validRancherUrl,\n  issuer:       validIssuer,\n  authEndpoint: validAuthEndpoint,\n  scope:        validScope,\n  clientId:     validClientId,\n  clientSecret: validClientSecret,\n  type:         'genericOIDCConfig',\n};\n\nconst mockedAuthConfigMixin = {\n  data() {\n    return {\n      isEnabling:     false,\n      editConfig:     false,\n      model:          { ...mockModel },\n      serverSetting:  null,\n      errors:         [],\n      originalModel:  null,\n      principals:     [],\n      authConfigName: 'oidc',\n    };\n  },\n  computed: {},\n  methods:  {}\n};\n\ndescribe('oidc.vue', () => {\n  let wrapper: any;\n  const requiredSetup = () => ({\n    mixins: [mockedAuthConfigMixin],\n    mocks:  {\n      $fetchState: { pending: false },\n      $store:      {\n        getters: {\n          currentStore:              () => 'current_store',\n          'current_store/schemaFor': jest.fn(),\n          'current_store/all':       jest.fn(),\n          'i18n/t':                  (val: string) => val,\n          'i18n/exists':             jest.fn(),\n        },\n        dispatch: jest.fn()\n      },\n      $route:  { query: { AS: '' }, params: { id: 'oicd' } },\n      $router: { applyQuery: jest.fn() },\n    },\n    propsData: {\n      value: { applicationSecret: '' },\n      mode:  _EDIT,\n    },\n  });\n\n  beforeEach(() => {\n    wrapper = mount(oidc, { ...requiredSetup() });\n  });\n  afterEach(() => {\n    wrapper.destroy();\n  });\n\n  it('have \"Create\" button enabled when provider is enabled and not editing config', async() => {\n    wrapper.setData({ model: { enabled: true }, editConfig: false });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('have \"Create\" button disabled when provider is disabled and editing config before fields are filled in', async() => {\n    wrapper.setData({ model: {}, editConfig: true });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(true);\n  });\n\n  it('have \"Create\" button disabled when provider is disabled and editing config after required fields and scope is missing openid', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl, realm: validRealm } });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(true);\n  });\n\n  it('have \"Create\" button enabled when customEndpoint is disabled and required fields are filled in', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl, realm: validRealm }, oidcScope: validScope.split(' ') });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('have \"Create\" button enabled when customEndpoint is enabled and required fields are filled in', async() => {\n    wrapper.setData({ customEndpoint: { value: true }, oidcScope: validScope.split(' ') });\n    await wrapper.vm.$nextTick();\n\n    const saveButton = wrapper.find('[data-testid=\"form-save\"]').element as HTMLInputElement;\n\n    expect(saveButton.disabled).toBe(false);\n  });\n\n  it('updates issuer endpoint when oidcUrls.url and oidcUrls.realm changes', async() => {\n    wrapper.setData({ oidcUrls: { url: validUrl } });\n    await wrapper.vm.$nextTick();\n\n    expect(wrapper.vm.model.issuer).toBe(`${ validUrl }/realms/`);\n\n    wrapper.setData({ oidcUrls: { realm: validRealm } });\n    await wrapper.vm.$nextTick();\n\n    expect(wrapper.vm.model.issuer).toBe(`${ validUrl }/realms/${ validRealm }`);\n  });\n});\n"]}]}